var Ed=Object.defineProperty;var n0=g=>{throw TypeError(g)};var Sd=(g,A,L)=>A in g?Ed(g,A,{enumerable:!0,configurable:!0,writable:!0,value:L}):g[A]=L;var Kr=(g,A,L)=>Sd(g,typeof A!="symbol"?A+"":A,L),Ql=(g,A,L)=>A.has(g)||n0("Cannot "+L);var Fe=(g,A,L)=>(Ql(g,A,"read from private field"),L?L.call(g):A.get(g)),zt=(g,A,L)=>A.has(g)?n0("Cannot add the same private member more than once"):A instanceof WeakSet?A.add(g):A.set(g,L),Xt=(g,A,L,B)=>(Ql(g,A,"write to private field"),B?B.call(g,L):A.set(g,L),L),Mt=(g,A,L)=>(Ql(g,A,"access private method"),L);var Gi=(g,A,L,B)=>({set _(W){Xt(g,A,W,L)},get _(){return Fe(g,A,B)}});function _mergeNamespaces(g,A){for(var L=0;L<A.length;L++){const B=A[L];if(typeof B!="string"&&!Array.isArray(B)){for(const W in B)if(W!=="default"&&!(W in g)){const q=Object.getOwnPropertyDescriptor(B,W);q&&Object.defineProperty(g,W,q.get?q:{enumerable:!0,get:()=>B[W]})}}}return Object.freeze(Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}))}(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))B(W);new MutationObserver(W=>{for(const q of W)if(q.type==="childList")for(const J of q.addedNodes)J.tagName==="LINK"&&J.rel==="modulepreload"&&B(J)}).observe(document,{childList:!0,subtree:!0});function L(W){const q={};return W.integrity&&(q.integrity=W.integrity),W.referrerPolicy&&(q.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?q.credentials="include":W.crossOrigin==="anonymous"?q.credentials="omit":q.credentials="same-origin",q}function B(W){if(W.ep)return;W.ep=!0;const q=L(W);fetch(W.href,q)}})();function getDefaultExportFromCjs(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}function getAugmentedNamespace(g){if(Object.prototype.hasOwnProperty.call(g,"__esModule"))return g;var A=g.default;if(typeof A=="function"){var L=function B(){return this instanceof B?Reflect.construct(A,arguments,this.constructor):A.apply(this,arguments)};L.prototype=A.prototype}else L={};return Object.defineProperty(L,"__esModule",{value:!0}),Object.keys(g).forEach(function(B){var W=Object.getOwnPropertyDescriptor(g,B);Object.defineProperty(L,B,W.get?W:{enumerable:!0,get:function(){return g[B]}})}),L}var react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var g=Symbol.for("react.element"),A=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),J=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),se=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),le=Symbol.iterator;function pe(at){return at===null||typeof at!="object"?null:(at=le&&at[le]||at["@@iterator"],typeof at=="function"?at:null)}var he={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ue=Object.assign,ce={};function fe(at,Ee,ye){this.props=at,this.context=Ee,this.refs=ce,this.updater=ye||he}fe.prototype.isReactComponent={},fe.prototype.setState=function(at,Ee){if(typeof at!="object"&&typeof at!="function"&&at!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,at,Ee,"setState")},fe.prototype.forceUpdate=function(at){this.updater.enqueueForceUpdate(this,at,"forceUpdate")};function me(){}me.prototype=fe.prototype;function ke(at,Ee,ye){this.props=at,this.context=Ee,this.refs=ce,this.updater=ye||he}var xe=ke.prototype=new me;xe.constructor=ke,ue(xe,fe.prototype),xe.isPureReactComponent=!0;var Le=Array.isArray,Se=Object.prototype.hasOwnProperty,Te={current:null},ge={key:!0,ref:!0,__self:!0,__source:!0};function Ce(at,Ee,ye){var ve,Pe={},rt=null,st=null;if(Ee!=null)for(ve in Ee.ref!==void 0&&(st=Ee.ref),Ee.key!==void 0&&(rt=""+Ee.key),Ee)Se.call(Ee,ve)&&!ge.hasOwnProperty(ve)&&(Pe[ve]=Ee[ve]);var ot=arguments.length-2;if(ot===1)Pe.children=ye;else if(1<ot){for(var mt=Array(ot),At=0;At<ot;At++)mt[At]=arguments[At+2];Pe.children=mt}if(at&&at.defaultProps)for(ve in ot=at.defaultProps,ot)Pe[ve]===void 0&&(Pe[ve]=ot[ve]);return{$$typeof:g,type:at,key:rt,ref:st,props:Pe,_owner:Te.current}}function be(at,Ee){return{$$typeof:g,type:at.type,key:Ee,ref:at.ref,props:at.props,_owner:at._owner}}function nt(at){return typeof at=="object"&&at!==null&&at.$$typeof===g}function Ae(at){var Ee={"=":"=0",":":"=2"};return"$"+at.replace(/[=:]/g,function(ye){return Ee[ye]})}var De=/\/+/g;function lt(at,Ee){return typeof at=="object"&&at!==null&&at.key!=null?Ae(""+at.key):Ee.toString(36)}function Ct(at,Ee,ye,ve,Pe){var rt=typeof at;(rt==="undefined"||rt==="boolean")&&(at=null);var st=!1;if(at===null)st=!0;else switch(rt){case"string":case"number":st=!0;break;case"object":switch(at.$$typeof){case g:case A:st=!0}}if(st)return st=at,Pe=Pe(st),at=ve===""?"."+lt(st,0):ve,Le(Pe)?(ye="",at!=null&&(ye=at.replace(De,"$&/")+"/"),Ct(Pe,Ee,ye,"",function(At){return At})):Pe!=null&&(nt(Pe)&&(Pe=be(Pe,ye+(!Pe.key||st&&st.key===Pe.key?"":(""+Pe.key).replace(De,"$&/")+"/")+at)),Ee.push(Pe)),1;if(st=0,ve=ve===""?".":ve+":",Le(at))for(var ot=0;ot<at.length;ot++){rt=at[ot];var mt=ve+lt(rt,ot);st+=Ct(rt,Ee,ye,mt,Pe)}else if(mt=pe(at),typeof mt=="function")for(at=mt.call(at),ot=0;!(rt=at.next()).done;)rt=rt.value,mt=ve+lt(rt,ot++),st+=Ct(rt,Ee,ye,mt,Pe);else if(rt==="object")throw Ee=String(at),Error("Objects are not valid as a React child (found: "+(Ee==="[object Object]"?"object with keys {"+Object.keys(at).join(", ")+"}":Ee)+"). If you meant to render a collection of children, use an array instead.");return st}function ft(at,Ee,ye){if(at==null)return at;var ve=[],Pe=0;return Ct(at,ve,"","",function(rt){return Ee.call(ye,rt,Pe++)}),ve}function Et(at){if(at._status===-1){var Ee=at._result;Ee=Ee(),Ee.then(function(ye){(at._status===0||at._status===-1)&&(at._status=1,at._result=ye)},function(ye){(at._status===0||at._status===-1)&&(at._status=2,at._result=ye)}),at._status===-1&&(at._status=0,at._result=Ee)}if(at._status===1)return at._result.default;throw at._result}var gt={current:null},bt={transition:null},Ie={ReactCurrentDispatcher:gt,ReactCurrentBatchConfig:bt,ReactCurrentOwner:Te};function pt(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ft,forEach:function(at,Ee,ye){ft(at,function(){Ee.apply(this,arguments)},ye)},count:function(at){var Ee=0;return ft(at,function(){Ee++}),Ee},toArray:function(at){return ft(at,function(Ee){return Ee})||[]},only:function(at){if(!nt(at))throw Error("React.Children.only expected to receive a single React element child.");return at}},react_production_min.Component=fe,react_production_min.Fragment=L,react_production_min.Profiler=W,react_production_min.PureComponent=ke,react_production_min.StrictMode=B,react_production_min.Suspense=ae,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ie,react_production_min.act=pt,react_production_min.cloneElement=function(at,Ee,ye){if(at==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+at+".");var ve=ue({},at.props),Pe=at.key,rt=at.ref,st=at._owner;if(Ee!=null){if(Ee.ref!==void 0&&(rt=Ee.ref,st=Te.current),Ee.key!==void 0&&(Pe=""+Ee.key),at.type&&at.type.defaultProps)var ot=at.type.defaultProps;for(mt in Ee)Se.call(Ee,mt)&&!ge.hasOwnProperty(mt)&&(ve[mt]=Ee[mt]===void 0&&ot!==void 0?ot[mt]:Ee[mt])}var mt=arguments.length-2;if(mt===1)ve.children=ye;else if(1<mt){ot=Array(mt);for(var At=0;At<mt;At++)ot[At]=arguments[At+2];ve.children=ot}return{$$typeof:g,type:at.type,key:Pe,ref:rt,props:ve,_owner:st}},react_production_min.createContext=function(at){return at={$$typeof:J,_currentValue:at,_currentValue2:at,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},at.Provider={$$typeof:q,_context:at},at.Consumer=at},react_production_min.createElement=Ce,react_production_min.createFactory=function(at){var Ee=Ce.bind(null,at);return Ee.type=at,Ee},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(at){return{$$typeof:re,render:at}},react_production_min.isValidElement=nt,react_production_min.lazy=function(at){return{$$typeof:ie,_payload:{_status:-1,_result:at},_init:Et}},react_production_min.memo=function(at,Ee){return{$$typeof:se,type:at,compare:Ee===void 0?null:Ee}},react_production_min.startTransition=function(at){var Ee=bt.transition;bt.transition={};try{at()}finally{bt.transition=Ee}},react_production_min.unstable_act=pt,react_production_min.useCallback=function(at,Ee){return gt.current.useCallback(at,Ee)},react_production_min.useContext=function(at){return gt.current.useContext(at)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(at){return gt.current.useDeferredValue(at)},react_production_min.useEffect=function(at,Ee){return gt.current.useEffect(at,Ee)},react_production_min.useId=function(){return gt.current.useId()},react_production_min.useImperativeHandle=function(at,Ee,ye){return gt.current.useImperativeHandle(at,Ee,ye)},react_production_min.useInsertionEffect=function(at,Ee){return gt.current.useInsertionEffect(at,Ee)},react_production_min.useLayoutEffect=function(at,Ee){return gt.current.useLayoutEffect(at,Ee)},react_production_min.useMemo=function(at,Ee){return gt.current.useMemo(at,Ee)},react_production_min.useReducer=function(at,Ee,ye){return gt.current.useReducer(at,Ee,ye)},react_production_min.useRef=function(at){return gt.current.useRef(at)},react_production_min.useState=function(at){return gt.current.useState(at)},react_production_min.useSyncExternalStore=function(at,Ee,ye){return gt.current.useSyncExternalStore(at,Ee,ye)},react_production_min.useTransition=function(){return gt.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports),e$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(g){function A(bt,Ie){var pt=bt.length;bt.push(Ie);e:for(;0<pt;){var at=pt-1>>>1,Ee=bt[at];if(0<W(Ee,Ie))bt[at]=Ie,bt[pt]=Ee,pt=at;else break e}}function L(bt){return bt.length===0?null:bt[0]}function B(bt){if(bt.length===0)return null;var Ie=bt[0],pt=bt.pop();if(pt!==Ie){bt[0]=pt;e:for(var at=0,Ee=bt.length,ye=Ee>>>1;at<ye;){var ve=2*(at+1)-1,Pe=bt[ve],rt=ve+1,st=bt[rt];if(0>W(Pe,pt))rt<Ee&&0>W(st,Pe)?(bt[at]=st,bt[rt]=pt,at=rt):(bt[at]=Pe,bt[ve]=pt,at=ve);else if(rt<Ee&&0>W(st,pt))bt[at]=st,bt[rt]=pt,at=rt;else break e}}return Ie}function W(bt,Ie){var pt=bt.sortIndex-Ie.sortIndex;return pt!==0?pt:bt.id-Ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var q=performance;g.unstable_now=function(){return q.now()}}else{var J=Date,re=J.now();g.unstable_now=function(){return J.now()-re}}var ae=[],se=[],ie=1,le=null,pe=3,he=!1,ue=!1,ce=!1,fe=typeof setTimeout=="function"?setTimeout:null,me=typeof clearTimeout=="function"?clearTimeout:null,ke=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function xe(bt){for(var Ie=L(se);Ie!==null;){if(Ie.callback===null)B(se);else if(Ie.startTime<=bt)B(se),Ie.sortIndex=Ie.expirationTime,A(ae,Ie);else break;Ie=L(se)}}function Le(bt){if(ce=!1,xe(bt),!ue)if(L(ae)!==null)ue=!0,Et(Se);else{var Ie=L(se);Ie!==null&&gt(Le,Ie.startTime-bt)}}function Se(bt,Ie){ue=!1,ce&&(ce=!1,me(Ce),Ce=-1),he=!0;var pt=pe;try{for(xe(Ie),le=L(ae);le!==null&&(!(le.expirationTime>Ie)||bt&&!Ae());){var at=le.callback;if(typeof at=="function"){le.callback=null,pe=le.priorityLevel;var Ee=at(le.expirationTime<=Ie);Ie=g.unstable_now(),typeof Ee=="function"?le.callback=Ee:le===L(ae)&&B(ae),xe(Ie)}else B(ae);le=L(ae)}if(le!==null)var ye=!0;else{var ve=L(se);ve!==null&&gt(Le,ve.startTime-Ie),ye=!1}return ye}finally{le=null,pe=pt,he=!1}}var Te=!1,ge=null,Ce=-1,be=5,nt=-1;function Ae(){return!(g.unstable_now()-nt<be)}function De(){if(ge!==null){var bt=g.unstable_now();nt=bt;var Ie=!0;try{Ie=ge(!0,bt)}finally{Ie?lt():(Te=!1,ge=null)}}else Te=!1}var lt;if(typeof ke=="function")lt=function(){ke(De)};else if(typeof MessageChannel<"u"){var Ct=new MessageChannel,ft=Ct.port2;Ct.port1.onmessage=De,lt=function(){ft.postMessage(null)}}else lt=function(){fe(De,0)};function Et(bt){ge=bt,Te||(Te=!0,lt())}function gt(bt,Ie){Ce=fe(function(){bt(g.unstable_now())},Ie)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(bt){bt.callback=null},g.unstable_continueExecution=function(){ue||he||(ue=!0,Et(Se))},g.unstable_forceFrameRate=function(bt){0>bt||125<bt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):be=0<bt?Math.floor(1e3/bt):5},g.unstable_getCurrentPriorityLevel=function(){return pe},g.unstable_getFirstCallbackNode=function(){return L(ae)},g.unstable_next=function(bt){switch(pe){case 1:case 2:case 3:var Ie=3;break;default:Ie=pe}var pt=pe;pe=Ie;try{return bt()}finally{pe=pt}},g.unstable_pauseExecution=function(){},g.unstable_requestPaint=function(){},g.unstable_runWithPriority=function(bt,Ie){switch(bt){case 1:case 2:case 3:case 4:case 5:break;default:bt=3}var pt=pe;pe=bt;try{return Ie()}finally{pe=pt}},g.unstable_scheduleCallback=function(bt,Ie,pt){var at=g.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?at+pt:at):pt=at,bt){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=pt+Ee,bt={id:ie++,callback:Ie,priorityLevel:bt,startTime:pt,expirationTime:Ee,sortIndex:-1},pt>at?(bt.sortIndex=pt,A(se,bt),L(ae)===null&&bt===L(se)&&(ce?(me(Ce),Ce=-1):ce=!0,gt(Le,pt-at))):(bt.sortIndex=Ee,A(ae,bt),ue||he||(ue=!0,Et(Se))),bt},g.unstable_shouldYield=Ae,g.unstable_wrapCallback=function(bt){var Ie=pe;return function(){var pt=pe;pe=Ie;try{return bt.apply(this,arguments)}finally{pe=pt}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var g=requireReact(),A=requireScheduler();function L(V){for(var K="https://reactjs.org/docs/error-decoder.html?invariant="+V,ne=1;ne<arguments.length;ne++)K+="&args[]="+encodeURIComponent(arguments[ne]);return"Minified React error #"+V+"; visit "+K+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var B=new Set,W={};function q(V,K){J(V,K),J(V+"Capture",K)}function J(V,K){for(W[V]=K,V=0;V<K.length;V++)B.add(K[V])}var re=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ae=Object.prototype.hasOwnProperty,se=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ie={},le={};function pe(V){return ae.call(le,V)?!0:ae.call(ie,V)?!1:se.test(V)?le[V]=!0:(ie[V]=!0,!1)}function he(V,K,ne,oe){if(ne!==null&&ne.type===0)return!1;switch(typeof K){case"function":case"symbol":return!0;case"boolean":return oe?!1:ne!==null?!ne.acceptsBooleans:(V=V.toLowerCase().slice(0,5),V!=="data-"&&V!=="aria-");default:return!1}}function ue(V,K,ne,oe){if(K===null||typeof K>"u"||he(V,K,ne,oe))return!0;if(oe)return!1;if(ne!==null)switch(ne.type){case 3:return!K;case 4:return K===!1;case 5:return isNaN(K);case 6:return isNaN(K)||1>K}return!1}function ce(V,K,ne,oe,_e,Re,ct){this.acceptsBooleans=K===2||K===3||K===4,this.attributeName=oe,this.attributeNamespace=_e,this.mustUseProperty=ne,this.propertyName=V,this.type=K,this.sanitizeURL=Re,this.removeEmptyString=ct}var fe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(V){fe[V]=new ce(V,0,!1,V,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(V){var K=V[0];fe[K]=new ce(K,1,!1,V[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(V){fe[V]=new ce(V,2,!1,V.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(V){fe[V]=new ce(V,2,!1,V,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(V){fe[V]=new ce(V,3,!1,V.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(V){fe[V]=new ce(V,3,!0,V,null,!1,!1)}),["capture","download"].forEach(function(V){fe[V]=new ce(V,4,!1,V,null,!1,!1)}),["cols","rows","size","span"].forEach(function(V){fe[V]=new ce(V,6,!1,V,null,!1,!1)}),["rowSpan","start"].forEach(function(V){fe[V]=new ce(V,5,!1,V.toLowerCase(),null,!1,!1)});var me=/[\-:]([a-z])/g;function ke(V){return V[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(V){var K=V.replace(me,ke);fe[K]=new ce(K,1,!1,V,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(V){var K=V.replace(me,ke);fe[K]=new ce(K,1,!1,V,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(V){var K=V.replace(me,ke);fe[K]=new ce(K,1,!1,V,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(V){fe[V]=new ce(V,1,!1,V.toLowerCase(),null,!1,!1)}),fe.xlinkHref=new ce("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(V){fe[V]=new ce(V,1,!1,V.toLowerCase(),null,!0,!0)});function xe(V,K,ne,oe){var _e=fe.hasOwnProperty(K)?fe[K]:null;(_e!==null?_e.type!==0:oe||!(2<K.length)||K[0]!=="o"&&K[0]!=="O"||K[1]!=="n"&&K[1]!=="N")&&(ue(K,ne,_e,oe)&&(ne=null),oe||_e===null?pe(K)&&(ne===null?V.removeAttribute(K):V.setAttribute(K,""+ne)):_e.mustUseProperty?V[_e.propertyName]=ne===null?_e.type===3?!1:"":ne:(K=_e.attributeName,oe=_e.attributeNamespace,ne===null?V.removeAttribute(K):(_e=_e.type,ne=_e===3||_e===4&&ne===!0?"":""+ne,oe?V.setAttributeNS(oe,K,ne):V.setAttribute(K,ne))))}var Le=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Se=Symbol.for("react.element"),Te=Symbol.for("react.portal"),ge=Symbol.for("react.fragment"),Ce=Symbol.for("react.strict_mode"),be=Symbol.for("react.profiler"),nt=Symbol.for("react.provider"),Ae=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),lt=Symbol.for("react.suspense"),Ct=Symbol.for("react.suspense_list"),ft=Symbol.for("react.memo"),Et=Symbol.for("react.lazy"),gt=Symbol.for("react.offscreen"),bt=Symbol.iterator;function Ie(V){return V===null||typeof V!="object"?null:(V=bt&&V[bt]||V["@@iterator"],typeof V=="function"?V:null)}var pt=Object.assign,at;function Ee(V){if(at===void 0)try{throw Error()}catch(ne){var K=ne.stack.trim().match(/\n( *(at )?)/);at=K&&K[1]||""}return`
`+at+V}var ye=!1;function ve(V,K){if(!V||ye)return"";ye=!0;var ne=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(K)if(K=function(){throw Error()},Object.defineProperty(K.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(K,[])}catch(ir){var oe=ir}Reflect.construct(V,[],K)}else{try{K.call()}catch(ir){oe=ir}V.call(K.prototype)}else{try{throw Error()}catch(ir){oe=ir}V()}}catch(ir){if(ir&&oe&&typeof ir.stack=="string"){for(var _e=ir.stack.split(`
`),Re=oe.stack.split(`
`),ct=_e.length-1,Rt=Re.length-1;1<=ct&&0<=Rt&&_e[ct]!==Re[Rt];)Rt--;for(;1<=ct&&0<=Rt;ct--,Rt--)if(_e[ct]!==Re[Rt]){if(ct!==1||Rt!==1)do if(ct--,Rt--,0>Rt||_e[ct]!==Re[Rt]){var Ot=`
`+_e[ct].replace(" at new "," at ");return V.displayName&&Ot.includes("<anonymous>")&&(Ot=Ot.replace("<anonymous>",V.displayName)),Ot}while(1<=ct&&0<=Rt);break}}}finally{ye=!1,Error.prepareStackTrace=ne}return(V=V?V.displayName||V.name:"")?Ee(V):""}function Pe(V){switch(V.tag){case 5:return Ee(V.type);case 16:return Ee("Lazy");case 13:return Ee("Suspense");case 19:return Ee("SuspenseList");case 0:case 2:case 15:return V=ve(V.type,!1),V;case 11:return V=ve(V.type.render,!1),V;case 1:return V=ve(V.type,!0),V;default:return""}}function rt(V){if(V==null)return null;if(typeof V=="function")return V.displayName||V.name||null;if(typeof V=="string")return V;switch(V){case ge:return"Fragment";case Te:return"Portal";case be:return"Profiler";case Ce:return"StrictMode";case lt:return"Suspense";case Ct:return"SuspenseList"}if(typeof V=="object")switch(V.$$typeof){case Ae:return(V.displayName||"Context")+".Consumer";case nt:return(V._context.displayName||"Context")+".Provider";case De:var K=V.render;return V=V.displayName,V||(V=K.displayName||K.name||"",V=V!==""?"ForwardRef("+V+")":"ForwardRef"),V;case ft:return K=V.displayName||null,K!==null?K:rt(V.type)||"Memo";case Et:K=V._payload,V=V._init;try{return rt(V(K))}catch{}}return null}function st(V){var K=V.type;switch(V.tag){case 24:return"Cache";case 9:return(K.displayName||"Context")+".Consumer";case 10:return(K._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return V=K.render,V=V.displayName||V.name||"",K.displayName||(V!==""?"ForwardRef("+V+")":"ForwardRef");case 7:return"Fragment";case 5:return K;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rt(K);case 8:return K===Ce?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof K=="function")return K.displayName||K.name||null;if(typeof K=="string")return K}return null}function ot(V){switch(typeof V){case"boolean":case"number":case"string":case"undefined":return V;case"object":return V;default:return""}}function mt(V){var K=V.type;return(V=V.nodeName)&&V.toLowerCase()==="input"&&(K==="checkbox"||K==="radio")}function At(V){var K=mt(V)?"checked":"value",ne=Object.getOwnPropertyDescriptor(V.constructor.prototype,K),oe=""+V[K];if(!V.hasOwnProperty(K)&&typeof ne<"u"&&typeof ne.get=="function"&&typeof ne.set=="function"){var _e=ne.get,Re=ne.set;return Object.defineProperty(V,K,{configurable:!0,get:function(){return _e.call(this)},set:function(ct){oe=""+ct,Re.call(this,ct)}}),Object.defineProperty(V,K,{enumerable:ne.enumerable}),{getValue:function(){return oe},setValue:function(ct){oe=""+ct},stopTracking:function(){V._valueTracker=null,delete V[K]}}}}function It(V){V._valueTracker||(V._valueTracker=At(V))}function it(V){if(!V)return!1;var K=V._valueTracker;if(!K)return!0;var ne=K.getValue(),oe="";return V&&(oe=mt(V)?V.checked?"true":"false":V.value),V=oe,V!==ne?(K.setValue(V),!0):!1}function Vt(V){if(V=V||(typeof document<"u"?document:void 0),typeof V>"u")return null;try{return V.activeElement||V.body}catch{return V.body}}function Yt(V,K){var ne=K.checked;return pt({},K,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:ne??V._wrapperState.initialChecked})}function Zt(V,K){var ne=K.defaultValue==null?"":K.defaultValue,oe=K.checked!=null?K.checked:K.defaultChecked;ne=ot(K.value!=null?K.value:ne),V._wrapperState={initialChecked:oe,initialValue:ne,controlled:K.type==="checkbox"||K.type==="radio"?K.checked!=null:K.value!=null}}function Lt(V,K){K=K.checked,K!=null&&xe(V,"checked",K,!1)}function Ft(V,K){Lt(V,K);var ne=ot(K.value),oe=K.type;if(ne!=null)oe==="number"?(ne===0&&V.value===""||V.value!=ne)&&(V.value=""+ne):V.value!==""+ne&&(V.value=""+ne);else if(oe==="submit"||oe==="reset"){V.removeAttribute("value");return}K.hasOwnProperty("value")?kt(V,K.type,ne):K.hasOwnProperty("defaultValue")&&kt(V,K.type,ot(K.defaultValue)),K.checked==null&&K.defaultChecked!=null&&(V.defaultChecked=!!K.defaultChecked)}function ht(V,K,ne){if(K.hasOwnProperty("value")||K.hasOwnProperty("defaultValue")){var oe=K.type;if(!(oe!=="submit"&&oe!=="reset"||K.value!==void 0&&K.value!==null))return;K=""+V._wrapperState.initialValue,ne||K===V.value||(V.value=K),V.defaultValue=K}ne=V.name,ne!==""&&(V.name=""),V.defaultChecked=!!V._wrapperState.initialChecked,ne!==""&&(V.name=ne)}function kt(V,K,ne){(K!=="number"||Vt(V.ownerDocument)!==V)&&(ne==null?V.defaultValue=""+V._wrapperState.initialValue:V.defaultValue!==""+ne&&(V.defaultValue=""+ne))}var Dt=Array.isArray;function Bt(V,K,ne,oe){if(V=V.options,K){K={};for(var _e=0;_e<ne.length;_e++)K["$"+ne[_e]]=!0;for(ne=0;ne<V.length;ne++)_e=K.hasOwnProperty("$"+V[ne].value),V[ne].selected!==_e&&(V[ne].selected=_e),_e&&oe&&(V[ne].defaultSelected=!0)}else{for(ne=""+ot(ne),K=null,_e=0;_e<V.length;_e++){if(V[_e].value===ne){V[_e].selected=!0,oe&&(V[_e].defaultSelected=!0);return}K!==null||V[_e].disabled||(K=V[_e])}K!==null&&(K.selected=!0)}}function Qt(V,K){if(K.dangerouslySetInnerHTML!=null)throw Error(L(91));return pt({},K,{value:void 0,defaultValue:void 0,children:""+V._wrapperState.initialValue})}function or(V,K){var ne=K.value;if(ne==null){if(ne=K.children,K=K.defaultValue,ne!=null){if(K!=null)throw Error(L(92));if(Dt(ne)){if(1<ne.length)throw Error(L(93));ne=ne[0]}K=ne}K==null&&(K=""),ne=K}V._wrapperState={initialValue:ot(ne)}}function ar(V,K){var ne=ot(K.value),oe=ot(K.defaultValue);ne!=null&&(ne=""+ne,ne!==V.value&&(V.value=ne),K.defaultValue==null&&V.defaultValue!==ne&&(V.defaultValue=ne)),oe!=null&&(V.defaultValue=""+oe)}function Nt(V){var K=V.textContent;K===V._wrapperState.initialValue&&K!==""&&K!==null&&(V.value=K)}function fr(V){switch(V){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ur(V,K){return V==null||V==="http://www.w3.org/1999/xhtml"?fr(K):V==="http://www.w3.org/2000/svg"&&K==="foreignObject"?"http://www.w3.org/1999/xhtml":V}var Pr,Rr=function(V){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(K,ne,oe,_e){MSApp.execUnsafeLocalFunction(function(){return V(K,ne,oe,_e)})}:V}(function(V,K){if(V.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in V)V.innerHTML=K;else{for(Pr=Pr||document.createElement("div"),Pr.innerHTML="<svg>"+K.valueOf().toString()+"</svg>",K=Pr.firstChild;V.firstChild;)V.removeChild(V.firstChild);for(;K.firstChild;)V.appendChild(K.firstChild)}});function vr(V,K){if(K){var ne=V.firstChild;if(ne&&ne===V.lastChild&&ne.nodeType===3){ne.nodeValue=K;return}}V.textContent=K}var dr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},br=["Webkit","ms","Moz","O"];Object.keys(dr).forEach(function(V){br.forEach(function(K){K=K+V.charAt(0).toUpperCase()+V.substring(1),dr[K]=dr[V]})});function Ir(V,K,ne){return K==null||typeof K=="boolean"||K===""?"":ne||typeof K!="number"||K===0||dr.hasOwnProperty(V)&&dr[V]?(""+K).trim():K+"px"}function zr(V,K){V=V.style;for(var ne in K)if(K.hasOwnProperty(ne)){var oe=ne.indexOf("--")===0,_e=Ir(ne,K[ne],oe);ne==="float"&&(ne="cssFloat"),oe?V.setProperty(ne,_e):V[ne]=_e}}var lr=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ht(V,K){if(K){if(lr[V]&&(K.children!=null||K.dangerouslySetInnerHTML!=null))throw Error(L(137,V));if(K.dangerouslySetInnerHTML!=null){if(K.children!=null)throw Error(L(60));if(typeof K.dangerouslySetInnerHTML!="object"||!("__html"in K.dangerouslySetInnerHTML))throw Error(L(61))}if(K.style!=null&&typeof K.style!="object")throw Error(L(62))}}function $t(V,K){if(V.indexOf("-")===-1)return typeof K.is=="string";switch(V){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kr=null;function Wr(V){return V=V.target||V.srcElement||window,V.correspondingUseElement&&(V=V.correspondingUseElement),V.nodeType===3?V.parentNode:V}var Ur=null,Tt=null,rr=null;function hr(V){if(V=Li(V)){if(typeof Ur!="function")throw Error(L(280));var K=V.stateNode;K&&(K=vs(K),Ur(V.stateNode,V.type,K))}}function Cr(V){Tt?rr?rr.push(V):rr=[V]:Tt=V}function Fr(){if(Tt){var V=Tt,K=rr;if(rr=Tt=null,hr(V),K)for(V=0;V<K.length;V++)hr(K[V])}}function yr(V,K){return V(K)}function St(){}var xt=!1;function Pt(V,K,ne){if(xt)return V(K,ne);xt=!0;try{return yr(V,K,ne)}finally{xt=!1,(Tt!==null||rr!==null)&&(St(),Fr())}}function Gt(V,K){var ne=V.stateNode;if(ne===null)return null;var oe=vs(ne);if(oe===null)return null;ne=oe[K];e:switch(K){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(oe=!oe.disabled)||(V=V.type,oe=!(V==="button"||V==="input"||V==="select"||V==="textarea")),V=!oe;break e;default:V=!1}if(V)return null;if(ne&&typeof ne!="function")throw Error(L(231,K,typeof ne));return ne}var qt=!1;if(re)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){qt=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{qt=!1}function cr(V,K,ne,oe,_e,Re,ct,Rt,Ot){var ir=Array.prototype.slice.call(arguments,3);try{K.apply(ne,ir)}catch(_r){this.onError(_r)}}var Tr=!1,Ar=null,Oe=!1,vt=null,ut={onError:function(V){Tr=!0,Ar=V}};function dt(V,K,ne,oe,_e,Re,ct,Rt,Ot){Tr=!1,Ar=null,cr.apply(ut,arguments)}function wt(V,K,ne,oe,_e,Re,ct,Rt,Ot){if(dt.apply(this,arguments),Tr){if(Tr){var ir=Ar;Tr=!1,Ar=null}else throw Error(L(198));Oe||(Oe=!0,vt=ir)}}function yt(V){var K=V,ne=V;if(V.alternate)for(;K.return;)K=K.return;else{V=K;do K=V,(K.flags&4098)!==0&&(ne=K.return),V=K.return;while(V)}return K.tag===3?ne:null}function Ut(V){if(V.tag===13){var K=V.memoizedState;if(K===null&&(V=V.alternate,V!==null&&(K=V.memoizedState)),K!==null)return K.dehydrated}return null}function tr(V){if(yt(V)!==V)throw Error(L(188))}function Kt(V){var K=V.alternate;if(!K){if(K=yt(V),K===null)throw Error(L(188));return K!==V?null:V}for(var ne=V,oe=K;;){var _e=ne.return;if(_e===null)break;var Re=_e.alternate;if(Re===null){if(oe=_e.return,oe!==null){ne=oe;continue}break}if(_e.child===Re.child){for(Re=_e.child;Re;){if(Re===ne)return tr(_e),V;if(Re===oe)return tr(_e),K;Re=Re.sibling}throw Error(L(188))}if(ne.return!==oe.return)ne=_e,oe=Re;else{for(var ct=!1,Rt=_e.child;Rt;){if(Rt===ne){ct=!0,ne=_e,oe=Re;break}if(Rt===oe){ct=!0,oe=_e,ne=Re;break}Rt=Rt.sibling}if(!ct){for(Rt=Re.child;Rt;){if(Rt===ne){ct=!0,ne=Re,oe=_e;break}if(Rt===oe){ct=!0,oe=Re,ne=_e;break}Rt=Rt.sibling}if(!ct)throw Error(L(189))}}if(ne.alternate!==oe)throw Error(L(190))}if(ne.tag!==3)throw Error(L(188));return ne.stateNode.current===ne?V:K}function jt(V){return V=Kt(V),V!==null?er(V):null}function er(V){if(V.tag===5||V.tag===6)return V;for(V=V.child;V!==null;){var K=er(V);if(K!==null)return K;V=V.sibling}return null}var pr=A.unstable_scheduleCallback,wr=A.unstable_cancelCallback,Lr=A.unstable_shouldYield,Er=A.unstable_requestPaint,xr=A.unstable_now,Vr=A.unstable_getCurrentPriorityLevel,qr=A.unstable_ImmediatePriority,Jr=A.unstable_UserBlockingPriority,sn=A.unstable_NormalPriority,Ta=A.unstable_LowPriority,sa=A.unstable_IdlePriority,jn=null,hn=null;function di(V){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(jn,V,void 0,(V.current.flags&128)===128)}catch{}}var on=Math.clz32?Math.clz32:W0,B0=Math.log,U0=Math.LN2;function W0(V){return V>>>=0,V===0?32:31-(B0(V)/U0|0)|0}var ts=64,rs=4194304;function pi(V){switch(V&-V){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return V&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return V&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return V}}function ns(V,K){var ne=V.pendingLanes;if(ne===0)return 0;var oe=0,_e=V.suspendedLanes,Re=V.pingedLanes,ct=ne&268435455;if(ct!==0){var Rt=ct&~_e;Rt!==0?oe=pi(Rt):(Re&=ct,Re!==0&&(oe=pi(Re)))}else ct=ne&~_e,ct!==0?oe=pi(ct):Re!==0&&(oe=pi(Re));if(oe===0)return 0;if(K!==0&&K!==oe&&(K&_e)===0&&(_e=oe&-oe,Re=K&-K,_e>=Re||_e===16&&(Re&4194240)!==0))return K;if((oe&4)!==0&&(oe|=ne&16),K=V.entangledLanes,K!==0)for(V=V.entanglements,K&=oe;0<K;)ne=31-on(K),_e=1<<ne,oe|=V[ne],K&=~_e;return oe}function H0(V,K){switch(V){case 1:case 2:case 4:return K+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return K+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $0(V,K){for(var ne=V.suspendedLanes,oe=V.pingedLanes,_e=V.expirationTimes,Re=V.pendingLanes;0<Re;){var ct=31-on(Re),Rt=1<<ct,Ot=_e[ct];Ot===-1?((Rt&ne)===0||(Rt&oe)!==0)&&(_e[ct]=H0(Rt,K)):Ot<=K&&(V.expiredLanes|=Rt),Re&=~Rt}}function vo(V){return V=V.pendingLanes&-1073741825,V!==0?V:V&1073741824?1073741824:0}function Dc(){var V=ts;return ts<<=1,(ts&4194240)===0&&(ts=64),V}function wo(V){for(var K=[],ne=0;31>ne;ne++)K.push(V);return K}function mi(V,K,ne){V.pendingLanes|=K,K!==536870912&&(V.suspendedLanes=0,V.pingedLanes=0),V=V.eventTimes,K=31-on(K),V[K]=ne}function z0(V,K){var ne=V.pendingLanes&~K;V.pendingLanes=K,V.suspendedLanes=0,V.pingedLanes=0,V.expiredLanes&=K,V.mutableReadLanes&=K,V.entangledLanes&=K,K=V.entanglements;var oe=V.eventTimes;for(V=V.expirationTimes;0<ne;){var _e=31-on(ne),Re=1<<_e;K[_e]=0,oe[_e]=-1,V[_e]=-1,ne&=~Re}}function yo(V,K){var ne=V.entangledLanes|=K;for(V=V.entanglements;ne;){var oe=31-on(ne),_e=1<<oe;_e&K|V[oe]&K&&(V[oe]|=K),ne&=~_e}}var Yr=0;function Ic(V){return V&=-V,1<V?4<V?(V&268435455)!==0?16:536870912:4:1}var Nc,Eo,Mc,Oc,Bc,So=!1,as=[],oa=null,la=null,ca=null,_i=new Map,gi=new Map,ua=[],X0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uc(V,K){switch(V){case"focusin":case"focusout":oa=null;break;case"dragenter":case"dragleave":la=null;break;case"mouseover":case"mouseout":ca=null;break;case"pointerover":case"pointerout":_i.delete(K.pointerId);break;case"gotpointercapture":case"lostpointercapture":gi.delete(K.pointerId)}}function xi(V,K,ne,oe,_e,Re){return V===null||V.nativeEvent!==Re?(V={blockedOn:K,domEventName:ne,eventSystemFlags:oe,nativeEvent:Re,targetContainers:[_e]},K!==null&&(K=Li(K),K!==null&&Eo(K)),V):(V.eventSystemFlags|=oe,K=V.targetContainers,_e!==null&&K.indexOf(_e)===-1&&K.push(_e),V)}function V0(V,K,ne,oe,_e){switch(K){case"focusin":return oa=xi(oa,V,K,ne,oe,_e),!0;case"dragenter":return la=xi(la,V,K,ne,oe,_e),!0;case"mouseover":return ca=xi(ca,V,K,ne,oe,_e),!0;case"pointerover":var Re=_e.pointerId;return _i.set(Re,xi(_i.get(Re)||null,V,K,ne,oe,_e)),!0;case"gotpointercapture":return Re=_e.pointerId,gi.set(Re,xi(gi.get(Re)||null,V,K,ne,oe,_e)),!0}return!1}function Wc(V){var K=ba(V.target);if(K!==null){var ne=yt(K);if(ne!==null){if(K=ne.tag,K===13){if(K=Ut(ne),K!==null){V.blockedOn=K,Bc(V.priority,function(){Mc(ne)});return}}else if(K===3&&ne.stateNode.current.memoizedState.isDehydrated){V.blockedOn=ne.tag===3?ne.stateNode.containerInfo:null;return}}}V.blockedOn=null}function is(V){if(V.blockedOn!==null)return!1;for(var K=V.targetContainers;0<K.length;){var ne=Ao(V.domEventName,V.eventSystemFlags,K[0],V.nativeEvent);if(ne===null){ne=V.nativeEvent;var oe=new ne.constructor(ne.type,ne);kr=oe,ne.target.dispatchEvent(oe),kr=null}else return K=Li(ne),K!==null&&Eo(K),V.blockedOn=ne,!1;K.shift()}return!0}function Hc(V,K,ne){is(V)&&ne.delete(K)}function j0(){So=!1,oa!==null&&is(oa)&&(oa=null),la!==null&&is(la)&&(la=null),ca!==null&&is(ca)&&(ca=null),_i.forEach(Hc),gi.forEach(Hc)}function vi(V,K){V.blockedOn===K&&(V.blockedOn=null,So||(So=!0,A.unstable_scheduleCallback(A.unstable_NormalPriority,j0)))}function wi(V){function K(_e){return vi(_e,V)}if(0<as.length){vi(as[0],V);for(var ne=1;ne<as.length;ne++){var oe=as[ne];oe.blockedOn===V&&(oe.blockedOn=null)}}for(oa!==null&&vi(oa,V),la!==null&&vi(la,V),ca!==null&&vi(ca,V),_i.forEach(K),gi.forEach(K),ne=0;ne<ua.length;ne++)oe=ua[ne],oe.blockedOn===V&&(oe.blockedOn=null);for(;0<ua.length&&(ne=ua[0],ne.blockedOn===null);)Wc(ne),ne.blockedOn===null&&ua.shift()}var Wa=Le.ReactCurrentBatchConfig,ss=!0;function G0(V,K,ne,oe){var _e=Yr,Re=Wa.transition;Wa.transition=null;try{Yr=1,ko(V,K,ne,oe)}finally{Yr=_e,Wa.transition=Re}}function Y0(V,K,ne,oe){var _e=Yr,Re=Wa.transition;Wa.transition=null;try{Yr=4,ko(V,K,ne,oe)}finally{Yr=_e,Wa.transition=Re}}function ko(V,K,ne,oe){if(ss){var _e=Ao(V,K,ne,oe);if(_e===null)$o(V,K,oe,os,ne),Uc(V,oe);else if(V0(_e,V,K,ne,oe))oe.stopPropagation();else if(Uc(V,oe),K&4&&-1<X0.indexOf(V)){for(;_e!==null;){var Re=Li(_e);if(Re!==null&&Nc(Re),Re=Ao(V,K,ne,oe),Re===null&&$o(V,K,oe,os,ne),Re===_e)break;_e=Re}_e!==null&&oe.stopPropagation()}else $o(V,K,oe,null,ne)}}var os=null;function Ao(V,K,ne,oe){if(os=null,V=Wr(oe),V=ba(V),V!==null)if(K=yt(V),K===null)V=null;else if(ne=K.tag,ne===13){if(V=Ut(K),V!==null)return V;V=null}else if(ne===3){if(K.stateNode.current.memoizedState.isDehydrated)return K.tag===3?K.stateNode.containerInfo:null;V=null}else K!==V&&(V=null);return os=V,null}function $c(V){switch(V){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vr()){case qr:return 1;case Jr:return 4;case sn:case Ta:return 16;case sa:return 536870912;default:return 16}default:return 16}}var fa=null,To=null,ls=null;function zc(){if(ls)return ls;var V,K=To,ne=K.length,oe,_e="value"in fa?fa.value:fa.textContent,Re=_e.length;for(V=0;V<ne&&K[V]===_e[V];V++);var ct=ne-V;for(oe=1;oe<=ct&&K[ne-oe]===_e[Re-oe];oe++);return ls=_e.slice(V,1<oe?1-oe:void 0)}function cs(V){var K=V.keyCode;return"charCode"in V?(V=V.charCode,V===0&&K===13&&(V=13)):V=K,V===10&&(V=13),32<=V||V===13?V:0}function us(){return!0}function Xc(){return!1}function Fn(V){function K(ne,oe,_e,Re,ct){this._reactName=ne,this._targetInst=_e,this.type=oe,this.nativeEvent=Re,this.target=ct,this.currentTarget=null;for(var Rt in V)V.hasOwnProperty(Rt)&&(ne=V[Rt],this[Rt]=ne?ne(Re):Re[Rt]);return this.isDefaultPrevented=(Re.defaultPrevented!=null?Re.defaultPrevented:Re.returnValue===!1)?us:Xc,this.isPropagationStopped=Xc,this}return pt(K.prototype,{preventDefault:function(){this.defaultPrevented=!0;var ne=this.nativeEvent;ne&&(ne.preventDefault?ne.preventDefault():typeof ne.returnValue!="unknown"&&(ne.returnValue=!1),this.isDefaultPrevented=us)},stopPropagation:function(){var ne=this.nativeEvent;ne&&(ne.stopPropagation?ne.stopPropagation():typeof ne.cancelBubble!="unknown"&&(ne.cancelBubble=!0),this.isPropagationStopped=us)},persist:function(){},isPersistent:us}),K}var Ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(V){return V.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bo=Fn(Ha),yi=pt({},Ha,{view:0,detail:0}),K0=Fn(yi),Co,Fo,Ei,fs=pt({},yi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Po,button:0,buttons:0,relatedTarget:function(V){return V.relatedTarget===void 0?V.fromElement===V.srcElement?V.toElement:V.fromElement:V.relatedTarget},movementX:function(V){return"movementX"in V?V.movementX:(V!==Ei&&(Ei&&V.type==="mousemove"?(Co=V.screenX-Ei.screenX,Fo=V.screenY-Ei.screenY):Fo=Co=0,Ei=V),Co)},movementY:function(V){return"movementY"in V?V.movementY:Fo}}),Vc=Fn(fs),q0=pt({},fs,{dataTransfer:0}),J0=Fn(q0),Q0=pt({},yi,{relatedTarget:0}),Ro=Fn(Q0),Z0=pt({},Ha,{animationName:0,elapsedTime:0,pseudoElement:0}),eh=Fn(Z0),th=pt({},Ha,{clipboardData:function(V){return"clipboardData"in V?V.clipboardData:window.clipboardData}}),rh=Fn(th),nh=pt({},Ha,{data:0}),jc=Fn(nh),ah={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ih={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oh(V){var K=this.nativeEvent;return K.getModifierState?K.getModifierState(V):(V=sh[V])?!!K[V]:!1}function Po(){return oh}var lh=pt({},yi,{key:function(V){if(V.key){var K=ah[V.key]||V.key;if(K!=="Unidentified")return K}return V.type==="keypress"?(V=cs(V),V===13?"Enter":String.fromCharCode(V)):V.type==="keydown"||V.type==="keyup"?ih[V.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Po,charCode:function(V){return V.type==="keypress"?cs(V):0},keyCode:function(V){return V.type==="keydown"||V.type==="keyup"?V.keyCode:0},which:function(V){return V.type==="keypress"?cs(V):V.type==="keydown"||V.type==="keyup"?V.keyCode:0}}),ch=Fn(lh),uh=pt({},fs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gc=Fn(uh),fh=pt({},yi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Po}),hh=Fn(fh),dh=pt({},Ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),ph=Fn(dh),mh=pt({},fs,{deltaX:function(V){return"deltaX"in V?V.deltaX:"wheelDeltaX"in V?-V.wheelDeltaX:0},deltaY:function(V){return"deltaY"in V?V.deltaY:"wheelDeltaY"in V?-V.wheelDeltaY:"wheelDelta"in V?-V.wheelDelta:0},deltaZ:0,deltaMode:0}),_h=Fn(mh),gh=[9,13,27,32],Lo=re&&"CompositionEvent"in window,Si=null;re&&"documentMode"in document&&(Si=document.documentMode);var xh=re&&"TextEvent"in window&&!Si,Yc=re&&(!Lo||Si&&8<Si&&11>=Si),Kc=" ",qc=!1;function Jc(V,K){switch(V){case"keyup":return gh.indexOf(K.keyCode)!==-1;case"keydown":return K.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qc(V){return V=V.detail,typeof V=="object"&&"data"in V?V.data:null}var $a=!1;function vh(V,K){switch(V){case"compositionend":return Qc(K);case"keypress":return K.which!==32?null:(qc=!0,Kc);case"textInput":return V=K.data,V===Kc&&qc?null:V;default:return null}}function wh(V,K){if($a)return V==="compositionend"||!Lo&&Jc(V,K)?(V=zc(),ls=To=fa=null,$a=!1,V):null;switch(V){case"paste":return null;case"keypress":if(!(K.ctrlKey||K.altKey||K.metaKey)||K.ctrlKey&&K.altKey){if(K.char&&1<K.char.length)return K.char;if(K.which)return String.fromCharCode(K.which)}return null;case"compositionend":return Yc&&K.locale!=="ko"?null:K.data;default:return null}}var yh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zc(V){var K=V&&V.nodeName&&V.nodeName.toLowerCase();return K==="input"?!!yh[V.type]:K==="textarea"}function eu(V,K,ne,oe){Cr(oe),K=_s(K,"onChange"),0<K.length&&(ne=new bo("onChange","change",null,ne,oe),V.push({event:ne,listeners:K}))}var ki=null,Ai=null;function Eh(V){xu(V,0)}function hs(V){var K=Ga(V);if(it(K))return V}function Sh(V,K){if(V==="change")return K}var tu=!1;if(re){var Do;if(re){var Io="oninput"in document;if(!Io){var ru=document.createElement("div");ru.setAttribute("oninput","return;"),Io=typeof ru.oninput=="function"}Do=Io}else Do=!1;tu=Do&&(!document.documentMode||9<document.documentMode)}function nu(){ki&&(ki.detachEvent("onpropertychange",au),Ai=ki=null)}function au(V){if(V.propertyName==="value"&&hs(Ai)){var K=[];eu(K,Ai,V,Wr(V)),Pt(Eh,K)}}function kh(V,K,ne){V==="focusin"?(nu(),ki=K,Ai=ne,ki.attachEvent("onpropertychange",au)):V==="focusout"&&nu()}function Ah(V){if(V==="selectionchange"||V==="keyup"||V==="keydown")return hs(Ai)}function Th(V,K){if(V==="click")return hs(K)}function bh(V,K){if(V==="input"||V==="change")return hs(K)}function Ch(V,K){return V===K&&(V!==0||1/V===1/K)||V!==V&&K!==K}var Wn=typeof Object.is=="function"?Object.is:Ch;function Ti(V,K){if(Wn(V,K))return!0;if(typeof V!="object"||V===null||typeof K!="object"||K===null)return!1;var ne=Object.keys(V),oe=Object.keys(K);if(ne.length!==oe.length)return!1;for(oe=0;oe<ne.length;oe++){var _e=ne[oe];if(!ae.call(K,_e)||!Wn(V[_e],K[_e]))return!1}return!0}function iu(V){for(;V&&V.firstChild;)V=V.firstChild;return V}function su(V,K){var ne=iu(V);V=0;for(var oe;ne;){if(ne.nodeType===3){if(oe=V+ne.textContent.length,V<=K&&oe>=K)return{node:ne,offset:K-V};V=oe}e:{for(;ne;){if(ne.nextSibling){ne=ne.nextSibling;break e}ne=ne.parentNode}ne=void 0}ne=iu(ne)}}function ou(V,K){return V&&K?V===K?!0:V&&V.nodeType===3?!1:K&&K.nodeType===3?ou(V,K.parentNode):"contains"in V?V.contains(K):V.compareDocumentPosition?!!(V.compareDocumentPosition(K)&16):!1:!1}function lu(){for(var V=window,K=Vt();K instanceof V.HTMLIFrameElement;){try{var ne=typeof K.contentWindow.location.href=="string"}catch{ne=!1}if(ne)V=K.contentWindow;else break;K=Vt(V.document)}return K}function No(V){var K=V&&V.nodeName&&V.nodeName.toLowerCase();return K&&(K==="input"&&(V.type==="text"||V.type==="search"||V.type==="tel"||V.type==="url"||V.type==="password")||K==="textarea"||V.contentEditable==="true")}function Fh(V){var K=lu(),ne=V.focusedElem,oe=V.selectionRange;if(K!==ne&&ne&&ne.ownerDocument&&ou(ne.ownerDocument.documentElement,ne)){if(oe!==null&&No(ne)){if(K=oe.start,V=oe.end,V===void 0&&(V=K),"selectionStart"in ne)ne.selectionStart=K,ne.selectionEnd=Math.min(V,ne.value.length);else if(V=(K=ne.ownerDocument||document)&&K.defaultView||window,V.getSelection){V=V.getSelection();var _e=ne.textContent.length,Re=Math.min(oe.start,_e);oe=oe.end===void 0?Re:Math.min(oe.end,_e),!V.extend&&Re>oe&&(_e=oe,oe=Re,Re=_e),_e=su(ne,Re);var ct=su(ne,oe);_e&&ct&&(V.rangeCount!==1||V.anchorNode!==_e.node||V.anchorOffset!==_e.offset||V.focusNode!==ct.node||V.focusOffset!==ct.offset)&&(K=K.createRange(),K.setStart(_e.node,_e.offset),V.removeAllRanges(),Re>oe?(V.addRange(K),V.extend(ct.node,ct.offset)):(K.setEnd(ct.node,ct.offset),V.addRange(K)))}}for(K=[],V=ne;V=V.parentNode;)V.nodeType===1&&K.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<K.length;ne++)V=K[ne],V.element.scrollLeft=V.left,V.element.scrollTop=V.top}}var Rh=re&&"documentMode"in document&&11>=document.documentMode,za=null,Mo=null,bi=null,Oo=!1;function cu(V,K,ne){var oe=ne.window===ne?ne.document:ne.nodeType===9?ne:ne.ownerDocument;Oo||za==null||za!==Vt(oe)||(oe=za,"selectionStart"in oe&&No(oe)?oe={start:oe.selectionStart,end:oe.selectionEnd}:(oe=(oe.ownerDocument&&oe.ownerDocument.defaultView||window).getSelection(),oe={anchorNode:oe.anchorNode,anchorOffset:oe.anchorOffset,focusNode:oe.focusNode,focusOffset:oe.focusOffset}),bi&&Ti(bi,oe)||(bi=oe,oe=_s(Mo,"onSelect"),0<oe.length&&(K=new bo("onSelect","select",null,K,ne),V.push({event:K,listeners:oe}),K.target=za)))}function ds(V,K){var ne={};return ne[V.toLowerCase()]=K.toLowerCase(),ne["Webkit"+V]="webkit"+K,ne["Moz"+V]="moz"+K,ne}var Xa={animationend:ds("Animation","AnimationEnd"),animationiteration:ds("Animation","AnimationIteration"),animationstart:ds("Animation","AnimationStart"),transitionend:ds("Transition","TransitionEnd")},Bo={},uu={};re&&(uu=document.createElement("div").style,"AnimationEvent"in window||(delete Xa.animationend.animation,delete Xa.animationiteration.animation,delete Xa.animationstart.animation),"TransitionEvent"in window||delete Xa.transitionend.transition);function ps(V){if(Bo[V])return Bo[V];if(!Xa[V])return V;var K=Xa[V],ne;for(ne in K)if(K.hasOwnProperty(ne)&&ne in uu)return Bo[V]=K[ne];return V}var fu=ps("animationend"),hu=ps("animationiteration"),du=ps("animationstart"),pu=ps("transitionend"),mu=new Map,_u="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ha(V,K){mu.set(V,K),q(K,[V])}for(var Uo=0;Uo<_u.length;Uo++){var Wo=_u[Uo],Ph=Wo.toLowerCase(),Lh=Wo[0].toUpperCase()+Wo.slice(1);ha(Ph,"on"+Lh)}ha(fu,"onAnimationEnd"),ha(hu,"onAnimationIteration"),ha(du,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(pu,"onTransitionEnd"),J("onMouseEnter",["mouseout","mouseover"]),J("onMouseLeave",["mouseout","mouseover"]),J("onPointerEnter",["pointerout","pointerover"]),J("onPointerLeave",["pointerout","pointerover"]),q("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),q("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),q("onBeforeInput",["compositionend","keypress","textInput","paste"]),q("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),q("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),q("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ci="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ci));function gu(V,K,ne){var oe=V.type||"unknown-event";V.currentTarget=ne,wt(oe,K,void 0,V),V.currentTarget=null}function xu(V,K){K=(K&4)!==0;for(var ne=0;ne<V.length;ne++){var oe=V[ne],_e=oe.event;oe=oe.listeners;e:{var Re=void 0;if(K)for(var ct=oe.length-1;0<=ct;ct--){var Rt=oe[ct],Ot=Rt.instance,ir=Rt.currentTarget;if(Rt=Rt.listener,Ot!==Re&&_e.isPropagationStopped())break e;gu(_e,Rt,ir),Re=Ot}else for(ct=0;ct<oe.length;ct++){if(Rt=oe[ct],Ot=Rt.instance,ir=Rt.currentTarget,Rt=Rt.listener,Ot!==Re&&_e.isPropagationStopped())break e;gu(_e,Rt,ir),Re=Ot}}}if(Oe)throw V=vt,Oe=!1,vt=null,V}function Zr(V,K){var ne=K[Yo];ne===void 0&&(ne=K[Yo]=new Set);var oe=V+"__bubble";ne.has(oe)||(vu(K,V,2,!1),ne.add(oe))}function Ho(V,K,ne){var oe=0;K&&(oe|=4),vu(ne,V,oe,K)}var ms="_reactListening"+Math.random().toString(36).slice(2);function Fi(V){if(!V[ms]){V[ms]=!0,B.forEach(function(ne){ne!=="selectionchange"&&(Dh.has(ne)||Ho(ne,!1,V),Ho(ne,!0,V))});var K=V.nodeType===9?V:V.ownerDocument;K===null||K[ms]||(K[ms]=!0,Ho("selectionchange",!1,K))}}function vu(V,K,ne,oe){switch($c(K)){case 1:var _e=G0;break;case 4:_e=Y0;break;default:_e=ko}ne=_e.bind(null,K,ne,V),_e=void 0,!qt||K!=="touchstart"&&K!=="touchmove"&&K!=="wheel"||(_e=!0),oe?_e!==void 0?V.addEventListener(K,ne,{capture:!0,passive:_e}):V.addEventListener(K,ne,!0):_e!==void 0?V.addEventListener(K,ne,{passive:_e}):V.addEventListener(K,ne,!1)}function $o(V,K,ne,oe,_e){var Re=oe;if((K&1)===0&&(K&2)===0&&oe!==null)e:for(;;){if(oe===null)return;var ct=oe.tag;if(ct===3||ct===4){var Rt=oe.stateNode.containerInfo;if(Rt===_e||Rt.nodeType===8&&Rt.parentNode===_e)break;if(ct===4)for(ct=oe.return;ct!==null;){var Ot=ct.tag;if((Ot===3||Ot===4)&&(Ot=ct.stateNode.containerInfo,Ot===_e||Ot.nodeType===8&&Ot.parentNode===_e))return;ct=ct.return}for(;Rt!==null;){if(ct=ba(Rt),ct===null)return;if(Ot=ct.tag,Ot===5||Ot===6){oe=Re=ct;continue e}Rt=Rt.parentNode}}oe=oe.return}Pt(function(){var ir=Re,_r=Wr(ne),gr=[];e:{var mr=mu.get(V);if(mr!==void 0){var Dr=bo,Mr=V;switch(V){case"keypress":if(cs(ne)===0)break e;case"keydown":case"keyup":Dr=ch;break;case"focusin":Mr="focus",Dr=Ro;break;case"focusout":Mr="blur",Dr=Ro;break;case"beforeblur":case"afterblur":Dr=Ro;break;case"click":if(ne.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Dr=Vc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Dr=J0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Dr=hh;break;case fu:case hu:case du:Dr=eh;break;case pu:Dr=ph;break;case"scroll":Dr=K0;break;case"wheel":Dr=_h;break;case"copy":case"cut":case"paste":Dr=rh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Dr=Gc}var Or=(K&4)!==0,ln=!Or&&V==="scroll",Jt=Or?mr!==null?mr+"Capture":null:mr;Or=[];for(var Wt=ir,nr;Wt!==null;){nr=Wt;var Sr=nr.stateNode;if(nr.tag===5&&Sr!==null&&(nr=Sr,Jt!==null&&(Sr=Gt(Wt,Jt),Sr!=null&&Or.push(Ri(Wt,Sr,nr)))),ln)break;Wt=Wt.return}0<Or.length&&(mr=new Dr(mr,Mr,null,ne,_r),gr.push({event:mr,listeners:Or}))}}if((K&7)===0){e:{if(mr=V==="mouseover"||V==="pointerover",Dr=V==="mouseout"||V==="pointerout",mr&&ne!==kr&&(Mr=ne.relatedTarget||ne.fromElement)&&(ba(Mr)||Mr[Jn]))break e;if((Dr||mr)&&(mr=_r.window===_r?_r:(mr=_r.ownerDocument)?mr.defaultView||mr.parentWindow:window,Dr?(Mr=ne.relatedTarget||ne.toElement,Dr=ir,Mr=Mr?ba(Mr):null,Mr!==null&&(ln=yt(Mr),Mr!==ln||Mr.tag!==5&&Mr.tag!==6)&&(Mr=null)):(Dr=null,Mr=ir),Dr!==Mr)){if(Or=Vc,Sr="onMouseLeave",Jt="onMouseEnter",Wt="mouse",(V==="pointerout"||V==="pointerover")&&(Or=Gc,Sr="onPointerLeave",Jt="onPointerEnter",Wt="pointer"),ln=Dr==null?mr:Ga(Dr),nr=Mr==null?mr:Ga(Mr),mr=new Or(Sr,Wt+"leave",Dr,ne,_r),mr.target=ln,mr.relatedTarget=nr,Sr=null,ba(_r)===ir&&(Or=new Or(Jt,Wt+"enter",Mr,ne,_r),Or.target=nr,Or.relatedTarget=ln,Sr=Or),ln=Sr,Dr&&Mr)t:{for(Or=Dr,Jt=Mr,Wt=0,nr=Or;nr;nr=Va(nr))Wt++;for(nr=0,Sr=Jt;Sr;Sr=Va(Sr))nr++;for(;0<Wt-nr;)Or=Va(Or),Wt--;for(;0<nr-Wt;)Jt=Va(Jt),nr--;for(;Wt--;){if(Or===Jt||Jt!==null&&Or===Jt.alternate)break t;Or=Va(Or),Jt=Va(Jt)}Or=null}else Or=null;Dr!==null&&wu(gr,mr,Dr,Or,!1),Mr!==null&&ln!==null&&wu(gr,ln,Mr,Or,!0)}}e:{if(mr=ir?Ga(ir):window,Dr=mr.nodeName&&mr.nodeName.toLowerCase(),Dr==="select"||Dr==="input"&&mr.type==="file")var Br=Sh;else if(Zc(mr))if(tu)Br=bh;else{Br=Ah;var Hr=kh}else(Dr=mr.nodeName)&&Dr.toLowerCase()==="input"&&(mr.type==="checkbox"||mr.type==="radio")&&(Br=Th);if(Br&&(Br=Br(V,ir))){eu(gr,Br,ne,_r);break e}Hr&&Hr(V,mr,ir),V==="focusout"&&(Hr=mr._wrapperState)&&Hr.controlled&&mr.type==="number"&&kt(mr,"number",mr.value)}switch(Hr=ir?Ga(ir):window,V){case"focusin":(Zc(Hr)||Hr.contentEditable==="true")&&(za=Hr,Mo=ir,bi=null);break;case"focusout":bi=Mo=za=null;break;case"mousedown":Oo=!0;break;case"contextmenu":case"mouseup":case"dragend":Oo=!1,cu(gr,ne,_r);break;case"selectionchange":if(Rh)break;case"keydown":case"keyup":cu(gr,ne,_r)}var $r;if(Lo)e:{switch(V){case"compositionstart":var Xr="onCompositionStart";break e;case"compositionend":Xr="onCompositionEnd";break e;case"compositionupdate":Xr="onCompositionUpdate";break e}Xr=void 0}else $a?Jc(V,ne)&&(Xr="onCompositionEnd"):V==="keydown"&&ne.keyCode===229&&(Xr="onCompositionStart");Xr&&(Yc&&ne.locale!=="ko"&&($a||Xr!=="onCompositionStart"?Xr==="onCompositionEnd"&&$a&&($r=zc()):(fa=_r,To="value"in fa?fa.value:fa.textContent,$a=!0)),Hr=_s(ir,Xr),0<Hr.length&&(Xr=new jc(Xr,V,null,ne,_r),gr.push({event:Xr,listeners:Hr}),$r?Xr.data=$r:($r=Qc(ne),$r!==null&&(Xr.data=$r)))),($r=xh?vh(V,ne):wh(V,ne))&&(ir=_s(ir,"onBeforeInput"),0<ir.length&&(_r=new jc("onBeforeInput","beforeinput",null,ne,_r),gr.push({event:_r,listeners:ir}),_r.data=$r))}xu(gr,K)})}function Ri(V,K,ne){return{instance:V,listener:K,currentTarget:ne}}function _s(V,K){for(var ne=K+"Capture",oe=[];V!==null;){var _e=V,Re=_e.stateNode;_e.tag===5&&Re!==null&&(_e=Re,Re=Gt(V,ne),Re!=null&&oe.unshift(Ri(V,Re,_e)),Re=Gt(V,K),Re!=null&&oe.push(Ri(V,Re,_e))),V=V.return}return oe}function Va(V){if(V===null)return null;do V=V.return;while(V&&V.tag!==5);return V||null}function wu(V,K,ne,oe,_e){for(var Re=K._reactName,ct=[];ne!==null&&ne!==oe;){var Rt=ne,Ot=Rt.alternate,ir=Rt.stateNode;if(Ot!==null&&Ot===oe)break;Rt.tag===5&&ir!==null&&(Rt=ir,_e?(Ot=Gt(ne,Re),Ot!=null&&ct.unshift(Ri(ne,Ot,Rt))):_e||(Ot=Gt(ne,Re),Ot!=null&&ct.push(Ri(ne,Ot,Rt)))),ne=ne.return}ct.length!==0&&V.push({event:K,listeners:ct})}var Ih=/\r\n?/g,Nh=/\u0000|\uFFFD/g;function yu(V){return(typeof V=="string"?V:""+V).replace(Ih,`
`).replace(Nh,"")}function gs(V,K,ne){if(K=yu(K),yu(V)!==K&&ne)throw Error(L(425))}function xs(){}var zo=null,Xo=null;function Vo(V,K){return V==="textarea"||V==="noscript"||typeof K.children=="string"||typeof K.children=="number"||typeof K.dangerouslySetInnerHTML=="object"&&K.dangerouslySetInnerHTML!==null&&K.dangerouslySetInnerHTML.__html!=null}var jo=typeof setTimeout=="function"?setTimeout:void 0,Mh=typeof clearTimeout=="function"?clearTimeout:void 0,Eu=typeof Promise=="function"?Promise:void 0,Oh=typeof queueMicrotask=="function"?queueMicrotask:typeof Eu<"u"?function(V){return Eu.resolve(null).then(V).catch(Bh)}:jo;function Bh(V){setTimeout(function(){throw V})}function Go(V,K){var ne=K,oe=0;do{var _e=ne.nextSibling;if(V.removeChild(ne),_e&&_e.nodeType===8)if(ne=_e.data,ne==="/$"){if(oe===0){V.removeChild(_e),wi(K);return}oe--}else ne!=="$"&&ne!=="$?"&&ne!=="$!"||oe++;ne=_e}while(ne);wi(K)}function da(V){for(;V!=null;V=V.nextSibling){var K=V.nodeType;if(K===1||K===3)break;if(K===8){if(K=V.data,K==="$"||K==="$!"||K==="$?")break;if(K==="/$")return null}}return V}function Su(V){V=V.previousSibling;for(var K=0;V;){if(V.nodeType===8){var ne=V.data;if(ne==="$"||ne==="$!"||ne==="$?"){if(K===0)return V;K--}else ne==="/$"&&K++}V=V.previousSibling}return null}var ja=Math.random().toString(36).slice(2),Gn="__reactFiber$"+ja,Pi="__reactProps$"+ja,Jn="__reactContainer$"+ja,Yo="__reactEvents$"+ja,Uh="__reactListeners$"+ja,Wh="__reactHandles$"+ja;function ba(V){var K=V[Gn];if(K)return K;for(var ne=V.parentNode;ne;){if(K=ne[Jn]||ne[Gn]){if(ne=K.alternate,K.child!==null||ne!==null&&ne.child!==null)for(V=Su(V);V!==null;){if(ne=V[Gn])return ne;V=Su(V)}return K}V=ne,ne=V.parentNode}return null}function Li(V){return V=V[Gn]||V[Jn],!V||V.tag!==5&&V.tag!==6&&V.tag!==13&&V.tag!==3?null:V}function Ga(V){if(V.tag===5||V.tag===6)return V.stateNode;throw Error(L(33))}function vs(V){return V[Pi]||null}var Ko=[],Ya=-1;function pa(V){return{current:V}}function en(V){0>Ya||(V.current=Ko[Ya],Ko[Ya]=null,Ya--)}function Qr(V,K){Ya++,Ko[Ya]=V.current,V.current=K}var ma={},xn=pa(ma),kn=pa(!1),Ca=ma;function Ka(V,K){var ne=V.type.contextTypes;if(!ne)return ma;var oe=V.stateNode;if(oe&&oe.__reactInternalMemoizedUnmaskedChildContext===K)return oe.__reactInternalMemoizedMaskedChildContext;var _e={},Re;for(Re in ne)_e[Re]=K[Re];return oe&&(V=V.stateNode,V.__reactInternalMemoizedUnmaskedChildContext=K,V.__reactInternalMemoizedMaskedChildContext=_e),_e}function An(V){return V=V.childContextTypes,V!=null}function ws(){en(kn),en(xn)}function ku(V,K,ne){if(xn.current!==ma)throw Error(L(168));Qr(xn,K),Qr(kn,ne)}function Au(V,K,ne){var oe=V.stateNode;if(K=K.childContextTypes,typeof oe.getChildContext!="function")return ne;oe=oe.getChildContext();for(var _e in oe)if(!(_e in K))throw Error(L(108,st(V)||"Unknown",_e));return pt({},ne,oe)}function ys(V){return V=(V=V.stateNode)&&V.__reactInternalMemoizedMergedChildContext||ma,Ca=xn.current,Qr(xn,V),Qr(kn,kn.current),!0}function Tu(V,K,ne){var oe=V.stateNode;if(!oe)throw Error(L(169));ne?(V=Au(V,K,Ca),oe.__reactInternalMemoizedMergedChildContext=V,en(kn),en(xn),Qr(xn,V)):en(kn),Qr(kn,ne)}var Qn=null,Es=!1,qo=!1;function bu(V){Qn===null?Qn=[V]:Qn.push(V)}function Hh(V){Es=!0,bu(V)}function _a(){if(!qo&&Qn!==null){qo=!0;var V=0,K=Yr;try{var ne=Qn;for(Yr=1;V<ne.length;V++){var oe=ne[V];do oe=oe(!0);while(oe!==null)}Qn=null,Es=!1}catch(_e){throw Qn!==null&&(Qn=Qn.slice(V+1)),pr(qr,_a),_e}finally{Yr=K,qo=!1}}return null}var qa=[],Ja=0,Ss=null,ks=0,Dn=[],In=0,Fa=null,Zn=1,ea="";function Ra(V,K){qa[Ja++]=ks,qa[Ja++]=Ss,Ss=V,ks=K}function Cu(V,K,ne){Dn[In++]=Zn,Dn[In++]=ea,Dn[In++]=Fa,Fa=V;var oe=Zn;V=ea;var _e=32-on(oe)-1;oe&=~(1<<_e),ne+=1;var Re=32-on(K)+_e;if(30<Re){var ct=_e-_e%5;Re=(oe&(1<<ct)-1).toString(32),oe>>=ct,_e-=ct,Zn=1<<32-on(K)+_e|ne<<_e|oe,ea=Re+V}else Zn=1<<Re|ne<<_e|oe,ea=V}function Jo(V){V.return!==null&&(Ra(V,1),Cu(V,1,0))}function Qo(V){for(;V===Ss;)Ss=qa[--Ja],qa[Ja]=null,ks=qa[--Ja],qa[Ja]=null;for(;V===Fa;)Fa=Dn[--In],Dn[In]=null,ea=Dn[--In],Dn[In]=null,Zn=Dn[--In],Dn[In]=null}var Rn=null,Pn=null,tn=!1,Hn=null;function Fu(V,K){var ne=Bn(5,null,null,0);ne.elementType="DELETED",ne.stateNode=K,ne.return=V,K=V.deletions,K===null?(V.deletions=[ne],V.flags|=16):K.push(ne)}function Ru(V,K){switch(V.tag){case 5:var ne=V.type;return K=K.nodeType!==1||ne.toLowerCase()!==K.nodeName.toLowerCase()?null:K,K!==null?(V.stateNode=K,Rn=V,Pn=da(K.firstChild),!0):!1;case 6:return K=V.pendingProps===""||K.nodeType!==3?null:K,K!==null?(V.stateNode=K,Rn=V,Pn=null,!0):!1;case 13:return K=K.nodeType!==8?null:K,K!==null?(ne=Fa!==null?{id:Zn,overflow:ea}:null,V.memoizedState={dehydrated:K,treeContext:ne,retryLane:1073741824},ne=Bn(18,null,null,0),ne.stateNode=K,ne.return=V,V.child=ne,Rn=V,Pn=null,!0):!1;default:return!1}}function Zo(V){return(V.mode&1)!==0&&(V.flags&128)===0}function el(V){if(tn){var K=Pn;if(K){var ne=K;if(!Ru(V,K)){if(Zo(V))throw Error(L(418));K=da(ne.nextSibling);var oe=Rn;K&&Ru(V,K)?Fu(oe,ne):(V.flags=V.flags&-4097|2,tn=!1,Rn=V)}}else{if(Zo(V))throw Error(L(418));V.flags=V.flags&-4097|2,tn=!1,Rn=V}}}function Pu(V){for(V=V.return;V!==null&&V.tag!==5&&V.tag!==3&&V.tag!==13;)V=V.return;Rn=V}function As(V){if(V!==Rn)return!1;if(!tn)return Pu(V),tn=!0,!1;var K;if((K=V.tag!==3)&&!(K=V.tag!==5)&&(K=V.type,K=K!=="head"&&K!=="body"&&!Vo(V.type,V.memoizedProps)),K&&(K=Pn)){if(Zo(V))throw Lu(),Error(L(418));for(;K;)Fu(V,K),K=da(K.nextSibling)}if(Pu(V),V.tag===13){if(V=V.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(L(317));e:{for(V=V.nextSibling,K=0;V;){if(V.nodeType===8){var ne=V.data;if(ne==="/$"){if(K===0){Pn=da(V.nextSibling);break e}K--}else ne!=="$"&&ne!=="$!"&&ne!=="$?"||K++}V=V.nextSibling}Pn=null}}else Pn=Rn?da(V.stateNode.nextSibling):null;return!0}function Lu(){for(var V=Pn;V;)V=da(V.nextSibling)}function Qa(){Pn=Rn=null,tn=!1}function tl(V){Hn===null?Hn=[V]:Hn.push(V)}var $h=Le.ReactCurrentBatchConfig;function Di(V,K,ne){if(V=ne.ref,V!==null&&typeof V!="function"&&typeof V!="object"){if(ne._owner){if(ne=ne._owner,ne){if(ne.tag!==1)throw Error(L(309));var oe=ne.stateNode}if(!oe)throw Error(L(147,V));var _e=oe,Re=""+V;return K!==null&&K.ref!==null&&typeof K.ref=="function"&&K.ref._stringRef===Re?K.ref:(K=function(ct){var Rt=_e.refs;ct===null?delete Rt[Re]:Rt[Re]=ct},K._stringRef=Re,K)}if(typeof V!="string")throw Error(L(284));if(!ne._owner)throw Error(L(290,V))}return V}function Ts(V,K){throw V=Object.prototype.toString.call(K),Error(L(31,V==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":V))}function Du(V){var K=V._init;return K(V._payload)}function Iu(V){function K(Jt,Wt){if(V){var nr=Jt.deletions;nr===null?(Jt.deletions=[Wt],Jt.flags|=16):nr.push(Wt)}}function ne(Jt,Wt){if(!V)return null;for(;Wt!==null;)K(Jt,Wt),Wt=Wt.sibling;return null}function oe(Jt,Wt){for(Jt=new Map;Wt!==null;)Wt.key!==null?Jt.set(Wt.key,Wt):Jt.set(Wt.index,Wt),Wt=Wt.sibling;return Jt}function _e(Jt,Wt){return Jt=ka(Jt,Wt),Jt.index=0,Jt.sibling=null,Jt}function Re(Jt,Wt,nr){return Jt.index=nr,V?(nr=Jt.alternate,nr!==null?(nr=nr.index,nr<Wt?(Jt.flags|=2,Wt):nr):(Jt.flags|=2,Wt)):(Jt.flags|=1048576,Wt)}function ct(Jt){return V&&Jt.alternate===null&&(Jt.flags|=2),Jt}function Rt(Jt,Wt,nr,Sr){return Wt===null||Wt.tag!==6?(Wt=jl(nr,Jt.mode,Sr),Wt.return=Jt,Wt):(Wt=_e(Wt,nr),Wt.return=Jt,Wt)}function Ot(Jt,Wt,nr,Sr){var Br=nr.type;return Br===ge?_r(Jt,Wt,nr.props.children,Sr,nr.key):Wt!==null&&(Wt.elementType===Br||typeof Br=="object"&&Br!==null&&Br.$$typeof===Et&&Du(Br)===Wt.type)?(Sr=_e(Wt,nr.props),Sr.ref=Di(Jt,Wt,nr),Sr.return=Jt,Sr):(Sr=qs(nr.type,nr.key,nr.props,null,Jt.mode,Sr),Sr.ref=Di(Jt,Wt,nr),Sr.return=Jt,Sr)}function ir(Jt,Wt,nr,Sr){return Wt===null||Wt.tag!==4||Wt.stateNode.containerInfo!==nr.containerInfo||Wt.stateNode.implementation!==nr.implementation?(Wt=Gl(nr,Jt.mode,Sr),Wt.return=Jt,Wt):(Wt=_e(Wt,nr.children||[]),Wt.return=Jt,Wt)}function _r(Jt,Wt,nr,Sr,Br){return Wt===null||Wt.tag!==7?(Wt=Ba(nr,Jt.mode,Sr,Br),Wt.return=Jt,Wt):(Wt=_e(Wt,nr),Wt.return=Jt,Wt)}function gr(Jt,Wt,nr){if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number")return Wt=jl(""+Wt,Jt.mode,nr),Wt.return=Jt,Wt;if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case Se:return nr=qs(Wt.type,Wt.key,Wt.props,null,Jt.mode,nr),nr.ref=Di(Jt,null,Wt),nr.return=Jt,nr;case Te:return Wt=Gl(Wt,Jt.mode,nr),Wt.return=Jt,Wt;case Et:var Sr=Wt._init;return gr(Jt,Sr(Wt._payload),nr)}if(Dt(Wt)||Ie(Wt))return Wt=Ba(Wt,Jt.mode,nr,null),Wt.return=Jt,Wt;Ts(Jt,Wt)}return null}function mr(Jt,Wt,nr,Sr){var Br=Wt!==null?Wt.key:null;if(typeof nr=="string"&&nr!==""||typeof nr=="number")return Br!==null?null:Rt(Jt,Wt,""+nr,Sr);if(typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case Se:return nr.key===Br?Ot(Jt,Wt,nr,Sr):null;case Te:return nr.key===Br?ir(Jt,Wt,nr,Sr):null;case Et:return Br=nr._init,mr(Jt,Wt,Br(nr._payload),Sr)}if(Dt(nr)||Ie(nr))return Br!==null?null:_r(Jt,Wt,nr,Sr,null);Ts(Jt,nr)}return null}function Dr(Jt,Wt,nr,Sr,Br){if(typeof Sr=="string"&&Sr!==""||typeof Sr=="number")return Jt=Jt.get(nr)||null,Rt(Wt,Jt,""+Sr,Br);if(typeof Sr=="object"&&Sr!==null){switch(Sr.$$typeof){case Se:return Jt=Jt.get(Sr.key===null?nr:Sr.key)||null,Ot(Wt,Jt,Sr,Br);case Te:return Jt=Jt.get(Sr.key===null?nr:Sr.key)||null,ir(Wt,Jt,Sr,Br);case Et:var Hr=Sr._init;return Dr(Jt,Wt,nr,Hr(Sr._payload),Br)}if(Dt(Sr)||Ie(Sr))return Jt=Jt.get(nr)||null,_r(Wt,Jt,Sr,Br,null);Ts(Wt,Sr)}return null}function Mr(Jt,Wt,nr,Sr){for(var Br=null,Hr=null,$r=Wt,Xr=Wt=0,mn=null;$r!==null&&Xr<nr.length;Xr++){$r.index>Xr?(mn=$r,$r=null):mn=$r.sibling;var Gr=mr(Jt,$r,nr[Xr],Sr);if(Gr===null){$r===null&&($r=mn);break}V&&$r&&Gr.alternate===null&&K(Jt,$r),Wt=Re(Gr,Wt,Xr),Hr===null?Br=Gr:Hr.sibling=Gr,Hr=Gr,$r=mn}if(Xr===nr.length)return ne(Jt,$r),tn&&Ra(Jt,Xr),Br;if($r===null){for(;Xr<nr.length;Xr++)$r=gr(Jt,nr[Xr],Sr),$r!==null&&(Wt=Re($r,Wt,Xr),Hr===null?Br=$r:Hr.sibling=$r,Hr=$r);return tn&&Ra(Jt,Xr),Br}for($r=oe(Jt,$r);Xr<nr.length;Xr++)mn=Dr($r,Jt,Xr,nr[Xr],Sr),mn!==null&&(V&&mn.alternate!==null&&$r.delete(mn.key===null?Xr:mn.key),Wt=Re(mn,Wt,Xr),Hr===null?Br=mn:Hr.sibling=mn,Hr=mn);return V&&$r.forEach(function(Aa){return K(Jt,Aa)}),tn&&Ra(Jt,Xr),Br}function Or(Jt,Wt,nr,Sr){var Br=Ie(nr);if(typeof Br!="function")throw Error(L(150));if(nr=Br.call(nr),nr==null)throw Error(L(151));for(var Hr=Br=null,$r=Wt,Xr=Wt=0,mn=null,Gr=nr.next();$r!==null&&!Gr.done;Xr++,Gr=nr.next()){$r.index>Xr?(mn=$r,$r=null):mn=$r.sibling;var Aa=mr(Jt,$r,Gr.value,Sr);if(Aa===null){$r===null&&($r=mn);break}V&&$r&&Aa.alternate===null&&K(Jt,$r),Wt=Re(Aa,Wt,Xr),Hr===null?Br=Aa:Hr.sibling=Aa,Hr=Aa,$r=mn}if(Gr.done)return ne(Jt,$r),tn&&Ra(Jt,Xr),Br;if($r===null){for(;!Gr.done;Xr++,Gr=nr.next())Gr=gr(Jt,Gr.value,Sr),Gr!==null&&(Wt=Re(Gr,Wt,Xr),Hr===null?Br=Gr:Hr.sibling=Gr,Hr=Gr);return tn&&Ra(Jt,Xr),Br}for($r=oe(Jt,$r);!Gr.done;Xr++,Gr=nr.next())Gr=Dr($r,Jt,Xr,Gr.value,Sr),Gr!==null&&(V&&Gr.alternate!==null&&$r.delete(Gr.key===null?Xr:Gr.key),Wt=Re(Gr,Wt,Xr),Hr===null?Br=Gr:Hr.sibling=Gr,Hr=Gr);return V&&$r.forEach(function(yd){return K(Jt,yd)}),tn&&Ra(Jt,Xr),Br}function ln(Jt,Wt,nr,Sr){if(typeof nr=="object"&&nr!==null&&nr.type===ge&&nr.key===null&&(nr=nr.props.children),typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case Se:e:{for(var Br=nr.key,Hr=Wt;Hr!==null;){if(Hr.key===Br){if(Br=nr.type,Br===ge){if(Hr.tag===7){ne(Jt,Hr.sibling),Wt=_e(Hr,nr.props.children),Wt.return=Jt,Jt=Wt;break e}}else if(Hr.elementType===Br||typeof Br=="object"&&Br!==null&&Br.$$typeof===Et&&Du(Br)===Hr.type){ne(Jt,Hr.sibling),Wt=_e(Hr,nr.props),Wt.ref=Di(Jt,Hr,nr),Wt.return=Jt,Jt=Wt;break e}ne(Jt,Hr);break}else K(Jt,Hr);Hr=Hr.sibling}nr.type===ge?(Wt=Ba(nr.props.children,Jt.mode,Sr,nr.key),Wt.return=Jt,Jt=Wt):(Sr=qs(nr.type,nr.key,nr.props,null,Jt.mode,Sr),Sr.ref=Di(Jt,Wt,nr),Sr.return=Jt,Jt=Sr)}return ct(Jt);case Te:e:{for(Hr=nr.key;Wt!==null;){if(Wt.key===Hr)if(Wt.tag===4&&Wt.stateNode.containerInfo===nr.containerInfo&&Wt.stateNode.implementation===nr.implementation){ne(Jt,Wt.sibling),Wt=_e(Wt,nr.children||[]),Wt.return=Jt,Jt=Wt;break e}else{ne(Jt,Wt);break}else K(Jt,Wt);Wt=Wt.sibling}Wt=Gl(nr,Jt.mode,Sr),Wt.return=Jt,Jt=Wt}return ct(Jt);case Et:return Hr=nr._init,ln(Jt,Wt,Hr(nr._payload),Sr)}if(Dt(nr))return Mr(Jt,Wt,nr,Sr);if(Ie(nr))return Or(Jt,Wt,nr,Sr);Ts(Jt,nr)}return typeof nr=="string"&&nr!==""||typeof nr=="number"?(nr=""+nr,Wt!==null&&Wt.tag===6?(ne(Jt,Wt.sibling),Wt=_e(Wt,nr),Wt.return=Jt,Jt=Wt):(ne(Jt,Wt),Wt=jl(nr,Jt.mode,Sr),Wt.return=Jt,Jt=Wt),ct(Jt)):ne(Jt,Wt)}return ln}var Za=Iu(!0),Nu=Iu(!1),bs=pa(null),Cs=null,ei=null,rl=null;function nl(){rl=ei=Cs=null}function al(V){var K=bs.current;en(bs),V._currentValue=K}function il(V,K,ne){for(;V!==null;){var oe=V.alternate;if((V.childLanes&K)!==K?(V.childLanes|=K,oe!==null&&(oe.childLanes|=K)):oe!==null&&(oe.childLanes&K)!==K&&(oe.childLanes|=K),V===ne)break;V=V.return}}function ti(V,K){Cs=V,rl=ei=null,V=V.dependencies,V!==null&&V.firstContext!==null&&((V.lanes&K)!==0&&(Tn=!0),V.firstContext=null)}function Nn(V){var K=V._currentValue;if(rl!==V)if(V={context:V,memoizedValue:K,next:null},ei===null){if(Cs===null)throw Error(L(308));ei=V,Cs.dependencies={lanes:0,firstContext:V}}else ei=ei.next=V;return K}var Pa=null;function sl(V){Pa===null?Pa=[V]:Pa.push(V)}function Mu(V,K,ne,oe){var _e=K.interleaved;return _e===null?(ne.next=ne,sl(K)):(ne.next=_e.next,_e.next=ne),K.interleaved=ne,ta(V,oe)}function ta(V,K){V.lanes|=K;var ne=V.alternate;for(ne!==null&&(ne.lanes|=K),ne=V,V=V.return;V!==null;)V.childLanes|=K,ne=V.alternate,ne!==null&&(ne.childLanes|=K),ne=V,V=V.return;return ne.tag===3?ne.stateNode:null}var ga=!1;function ol(V){V.updateQueue={baseState:V.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ou(V,K){V=V.updateQueue,K.updateQueue===V&&(K.updateQueue={baseState:V.baseState,firstBaseUpdate:V.firstBaseUpdate,lastBaseUpdate:V.lastBaseUpdate,shared:V.shared,effects:V.effects})}function ra(V,K){return{eventTime:V,lane:K,tag:0,payload:null,callback:null,next:null}}function xa(V,K,ne){var oe=V.updateQueue;if(oe===null)return null;if(oe=oe.shared,(jr&2)!==0){var _e=oe.pending;return _e===null?K.next=K:(K.next=_e.next,_e.next=K),oe.pending=K,ta(V,ne)}return _e=oe.interleaved,_e===null?(K.next=K,sl(oe)):(K.next=_e.next,_e.next=K),oe.interleaved=K,ta(V,ne)}function Fs(V,K,ne){if(K=K.updateQueue,K!==null&&(K=K.shared,(ne&4194240)!==0)){var oe=K.lanes;oe&=V.pendingLanes,ne|=oe,K.lanes=ne,yo(V,ne)}}function Bu(V,K){var ne=V.updateQueue,oe=V.alternate;if(oe!==null&&(oe=oe.updateQueue,ne===oe)){var _e=null,Re=null;if(ne=ne.firstBaseUpdate,ne!==null){do{var ct={eventTime:ne.eventTime,lane:ne.lane,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null};Re===null?_e=Re=ct:Re=Re.next=ct,ne=ne.next}while(ne!==null);Re===null?_e=Re=K:Re=Re.next=K}else _e=Re=K;ne={baseState:oe.baseState,firstBaseUpdate:_e,lastBaseUpdate:Re,shared:oe.shared,effects:oe.effects},V.updateQueue=ne;return}V=ne.lastBaseUpdate,V===null?ne.firstBaseUpdate=K:V.next=K,ne.lastBaseUpdate=K}function Rs(V,K,ne,oe){var _e=V.updateQueue;ga=!1;var Re=_e.firstBaseUpdate,ct=_e.lastBaseUpdate,Rt=_e.shared.pending;if(Rt!==null){_e.shared.pending=null;var Ot=Rt,ir=Ot.next;Ot.next=null,ct===null?Re=ir:ct.next=ir,ct=Ot;var _r=V.alternate;_r!==null&&(_r=_r.updateQueue,Rt=_r.lastBaseUpdate,Rt!==ct&&(Rt===null?_r.firstBaseUpdate=ir:Rt.next=ir,_r.lastBaseUpdate=Ot))}if(Re!==null){var gr=_e.baseState;ct=0,_r=ir=Ot=null,Rt=Re;do{var mr=Rt.lane,Dr=Rt.eventTime;if((oe&mr)===mr){_r!==null&&(_r=_r.next={eventTime:Dr,lane:0,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null});e:{var Mr=V,Or=Rt;switch(mr=K,Dr=ne,Or.tag){case 1:if(Mr=Or.payload,typeof Mr=="function"){gr=Mr.call(Dr,gr,mr);break e}gr=Mr;break e;case 3:Mr.flags=Mr.flags&-65537|128;case 0:if(Mr=Or.payload,mr=typeof Mr=="function"?Mr.call(Dr,gr,mr):Mr,mr==null)break e;gr=pt({},gr,mr);break e;case 2:ga=!0}}Rt.callback!==null&&Rt.lane!==0&&(V.flags|=64,mr=_e.effects,mr===null?_e.effects=[Rt]:mr.push(Rt))}else Dr={eventTime:Dr,lane:mr,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null},_r===null?(ir=_r=Dr,Ot=gr):_r=_r.next=Dr,ct|=mr;if(Rt=Rt.next,Rt===null){if(Rt=_e.shared.pending,Rt===null)break;mr=Rt,Rt=mr.next,mr.next=null,_e.lastBaseUpdate=mr,_e.shared.pending=null}}while(!0);if(_r===null&&(Ot=gr),_e.baseState=Ot,_e.firstBaseUpdate=ir,_e.lastBaseUpdate=_r,K=_e.shared.interleaved,K!==null){_e=K;do ct|=_e.lane,_e=_e.next;while(_e!==K)}else Re===null&&(_e.shared.lanes=0);Ia|=ct,V.lanes=ct,V.memoizedState=gr}}function Uu(V,K,ne){if(V=K.effects,K.effects=null,V!==null)for(K=0;K<V.length;K++){var oe=V[K],_e=oe.callback;if(_e!==null){if(oe.callback=null,oe=ne,typeof _e!="function")throw Error(L(191,_e));_e.call(oe)}}}var Ii={},Yn=pa(Ii),Ni=pa(Ii),Mi=pa(Ii);function La(V){if(V===Ii)throw Error(L(174));return V}function ll(V,K){switch(Qr(Mi,K),Qr(Ni,V),Qr(Yn,Ii),V=K.nodeType,V){case 9:case 11:K=(K=K.documentElement)?K.namespaceURI:ur(null,"");break;default:V=V===8?K.parentNode:K,K=V.namespaceURI||null,V=V.tagName,K=ur(K,V)}en(Yn),Qr(Yn,K)}function ri(){en(Yn),en(Ni),en(Mi)}function Wu(V){La(Mi.current);var K=La(Yn.current),ne=ur(K,V.type);K!==ne&&(Qr(Ni,V),Qr(Yn,ne))}function cl(V){Ni.current===V&&(en(Yn),en(Ni))}var rn=pa(0);function Ps(V){for(var K=V;K!==null;){if(K.tag===13){var ne=K.memoizedState;if(ne!==null&&(ne=ne.dehydrated,ne===null||ne.data==="$?"||ne.data==="$!"))return K}else if(K.tag===19&&K.memoizedProps.revealOrder!==void 0){if((K.flags&128)!==0)return K}else if(K.child!==null){K.child.return=K,K=K.child;continue}if(K===V)break;for(;K.sibling===null;){if(K.return===null||K.return===V)return null;K=K.return}K.sibling.return=K.return,K=K.sibling}return null}var ul=[];function fl(){for(var V=0;V<ul.length;V++)ul[V]._workInProgressVersionPrimary=null;ul.length=0}var Ls=Le.ReactCurrentDispatcher,hl=Le.ReactCurrentBatchConfig,Da=0,nn=null,un=null,dn=null,Ds=!1,Oi=!1,Bi=0,zh=0;function vn(){throw Error(L(321))}function dl(V,K){if(K===null)return!1;for(var ne=0;ne<K.length&&ne<V.length;ne++)if(!Wn(V[ne],K[ne]))return!1;return!0}function pl(V,K,ne,oe,_e,Re){if(Da=Re,nn=K,K.memoizedState=null,K.updateQueue=null,K.lanes=0,Ls.current=V===null||V.memoizedState===null?Gh:Yh,V=ne(oe,_e),Oi){Re=0;do{if(Oi=!1,Bi=0,25<=Re)throw Error(L(301));Re+=1,dn=un=null,K.updateQueue=null,Ls.current=Kh,V=ne(oe,_e)}while(Oi)}if(Ls.current=Ms,K=un!==null&&un.next!==null,Da=0,dn=un=nn=null,Ds=!1,K)throw Error(L(300));return V}function ml(){var V=Bi!==0;return Bi=0,V}function Kn(){var V={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?nn.memoizedState=dn=V:dn=dn.next=V,dn}function Mn(){if(un===null){var V=nn.alternate;V=V!==null?V.memoizedState:null}else V=un.next;var K=dn===null?nn.memoizedState:dn.next;if(K!==null)dn=K,un=V;else{if(V===null)throw Error(L(310));un=V,V={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},dn===null?nn.memoizedState=dn=V:dn=dn.next=V}return dn}function Ui(V,K){return typeof K=="function"?K(V):K}function _l(V){var K=Mn(),ne=K.queue;if(ne===null)throw Error(L(311));ne.lastRenderedReducer=V;var oe=un,_e=oe.baseQueue,Re=ne.pending;if(Re!==null){if(_e!==null){var ct=_e.next;_e.next=Re.next,Re.next=ct}oe.baseQueue=_e=Re,ne.pending=null}if(_e!==null){Re=_e.next,oe=oe.baseState;var Rt=ct=null,Ot=null,ir=Re;do{var _r=ir.lane;if((Da&_r)===_r)Ot!==null&&(Ot=Ot.next={lane:0,action:ir.action,hasEagerState:ir.hasEagerState,eagerState:ir.eagerState,next:null}),oe=ir.hasEagerState?ir.eagerState:V(oe,ir.action);else{var gr={lane:_r,action:ir.action,hasEagerState:ir.hasEagerState,eagerState:ir.eagerState,next:null};Ot===null?(Rt=Ot=gr,ct=oe):Ot=Ot.next=gr,nn.lanes|=_r,Ia|=_r}ir=ir.next}while(ir!==null&&ir!==Re);Ot===null?ct=oe:Ot.next=Rt,Wn(oe,K.memoizedState)||(Tn=!0),K.memoizedState=oe,K.baseState=ct,K.baseQueue=Ot,ne.lastRenderedState=oe}if(V=ne.interleaved,V!==null){_e=V;do Re=_e.lane,nn.lanes|=Re,Ia|=Re,_e=_e.next;while(_e!==V)}else _e===null&&(ne.lanes=0);return[K.memoizedState,ne.dispatch]}function gl(V){var K=Mn(),ne=K.queue;if(ne===null)throw Error(L(311));ne.lastRenderedReducer=V;var oe=ne.dispatch,_e=ne.pending,Re=K.memoizedState;if(_e!==null){ne.pending=null;var ct=_e=_e.next;do Re=V(Re,ct.action),ct=ct.next;while(ct!==_e);Wn(Re,K.memoizedState)||(Tn=!0),K.memoizedState=Re,K.baseQueue===null&&(K.baseState=Re),ne.lastRenderedState=Re}return[Re,oe]}function Hu(){}function $u(V,K){var ne=nn,oe=Mn(),_e=K(),Re=!Wn(oe.memoizedState,_e);if(Re&&(oe.memoizedState=_e,Tn=!0),oe=oe.queue,xl(Vu.bind(null,ne,oe,V),[V]),oe.getSnapshot!==K||Re||dn!==null&&dn.memoizedState.tag&1){if(ne.flags|=2048,Wi(9,Xu.bind(null,ne,oe,_e,K),void 0,null),pn===null)throw Error(L(349));(Da&30)!==0||zu(ne,K,_e)}return _e}function zu(V,K,ne){V.flags|=16384,V={getSnapshot:K,value:ne},K=nn.updateQueue,K===null?(K={lastEffect:null,stores:null},nn.updateQueue=K,K.stores=[V]):(ne=K.stores,ne===null?K.stores=[V]:ne.push(V))}function Xu(V,K,ne,oe){K.value=ne,K.getSnapshot=oe,ju(K)&&Gu(V)}function Vu(V,K,ne){return ne(function(){ju(K)&&Gu(V)})}function ju(V){var K=V.getSnapshot;V=V.value;try{var ne=K();return!Wn(V,ne)}catch{return!0}}function Gu(V){var K=ta(V,1);K!==null&&Vn(K,V,1,-1)}function Yu(V){var K=Kn();return typeof V=="function"&&(V=V()),K.memoizedState=K.baseState=V,V={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:V},K.queue=V,V=V.dispatch=jh.bind(null,nn,V),[K.memoizedState,V]}function Wi(V,K,ne,oe){return V={tag:V,create:K,destroy:ne,deps:oe,next:null},K=nn.updateQueue,K===null?(K={lastEffect:null,stores:null},nn.updateQueue=K,K.lastEffect=V.next=V):(ne=K.lastEffect,ne===null?K.lastEffect=V.next=V:(oe=ne.next,ne.next=V,V.next=oe,K.lastEffect=V)),V}function Ku(){return Mn().memoizedState}function Is(V,K,ne,oe){var _e=Kn();nn.flags|=V,_e.memoizedState=Wi(1|K,ne,void 0,oe===void 0?null:oe)}function Ns(V,K,ne,oe){var _e=Mn();oe=oe===void 0?null:oe;var Re=void 0;if(un!==null){var ct=un.memoizedState;if(Re=ct.destroy,oe!==null&&dl(oe,ct.deps)){_e.memoizedState=Wi(K,ne,Re,oe);return}}nn.flags|=V,_e.memoizedState=Wi(1|K,ne,Re,oe)}function qu(V,K){return Is(8390656,8,V,K)}function xl(V,K){return Ns(2048,8,V,K)}function Ju(V,K){return Ns(4,2,V,K)}function Qu(V,K){return Ns(4,4,V,K)}function Zu(V,K){if(typeof K=="function")return V=V(),K(V),function(){K(null)};if(K!=null)return V=V(),K.current=V,function(){K.current=null}}function ef(V,K,ne){return ne=ne!=null?ne.concat([V]):null,Ns(4,4,Zu.bind(null,K,V),ne)}function vl(){}function tf(V,K){var ne=Mn();K=K===void 0?null:K;var oe=ne.memoizedState;return oe!==null&&K!==null&&dl(K,oe[1])?oe[0]:(ne.memoizedState=[V,K],V)}function rf(V,K){var ne=Mn();K=K===void 0?null:K;var oe=ne.memoizedState;return oe!==null&&K!==null&&dl(K,oe[1])?oe[0]:(V=V(),ne.memoizedState=[V,K],V)}function nf(V,K,ne){return(Da&21)===0?(V.baseState&&(V.baseState=!1,Tn=!0),V.memoizedState=ne):(Wn(ne,K)||(ne=Dc(),nn.lanes|=ne,Ia|=ne,V.baseState=!0),K)}function Xh(V,K){var ne=Yr;Yr=ne!==0&&4>ne?ne:4,V(!0);var oe=hl.transition;hl.transition={};try{V(!1),K()}finally{Yr=ne,hl.transition=oe}}function af(){return Mn().memoizedState}function Vh(V,K,ne){var oe=Ea(V);if(ne={lane:oe,action:ne,hasEagerState:!1,eagerState:null,next:null},sf(V))of(K,ne);else if(ne=Mu(V,K,ne,oe),ne!==null){var _e=Sn();Vn(ne,V,oe,_e),lf(ne,K,oe)}}function jh(V,K,ne){var oe=Ea(V),_e={lane:oe,action:ne,hasEagerState:!1,eagerState:null,next:null};if(sf(V))of(K,_e);else{var Re=V.alternate;if(V.lanes===0&&(Re===null||Re.lanes===0)&&(Re=K.lastRenderedReducer,Re!==null))try{var ct=K.lastRenderedState,Rt=Re(ct,ne);if(_e.hasEagerState=!0,_e.eagerState=Rt,Wn(Rt,ct)){var Ot=K.interleaved;Ot===null?(_e.next=_e,sl(K)):(_e.next=Ot.next,Ot.next=_e),K.interleaved=_e;return}}catch{}finally{}ne=Mu(V,K,_e,oe),ne!==null&&(_e=Sn(),Vn(ne,V,oe,_e),lf(ne,K,oe))}}function sf(V){var K=V.alternate;return V===nn||K!==null&&K===nn}function of(V,K){Oi=Ds=!0;var ne=V.pending;ne===null?K.next=K:(K.next=ne.next,ne.next=K),V.pending=K}function lf(V,K,ne){if((ne&4194240)!==0){var oe=K.lanes;oe&=V.pendingLanes,ne|=oe,K.lanes=ne,yo(V,ne)}}var Ms={readContext:Nn,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useInsertionEffect:vn,useLayoutEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useMutableSource:vn,useSyncExternalStore:vn,useId:vn,unstable_isNewReconciler:!1},Gh={readContext:Nn,useCallback:function(V,K){return Kn().memoizedState=[V,K===void 0?null:K],V},useContext:Nn,useEffect:qu,useImperativeHandle:function(V,K,ne){return ne=ne!=null?ne.concat([V]):null,Is(4194308,4,Zu.bind(null,K,V),ne)},useLayoutEffect:function(V,K){return Is(4194308,4,V,K)},useInsertionEffect:function(V,K){return Is(4,2,V,K)},useMemo:function(V,K){var ne=Kn();return K=K===void 0?null:K,V=V(),ne.memoizedState=[V,K],V},useReducer:function(V,K,ne){var oe=Kn();return K=ne!==void 0?ne(K):K,oe.memoizedState=oe.baseState=K,V={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:V,lastRenderedState:K},oe.queue=V,V=V.dispatch=Vh.bind(null,nn,V),[oe.memoizedState,V]},useRef:function(V){var K=Kn();return V={current:V},K.memoizedState=V},useState:Yu,useDebugValue:vl,useDeferredValue:function(V){return Kn().memoizedState=V},useTransition:function(){var V=Yu(!1),K=V[0];return V=Xh.bind(null,V[1]),Kn().memoizedState=V,[K,V]},useMutableSource:function(){},useSyncExternalStore:function(V,K,ne){var oe=nn,_e=Kn();if(tn){if(ne===void 0)throw Error(L(407));ne=ne()}else{if(ne=K(),pn===null)throw Error(L(349));(Da&30)!==0||zu(oe,K,ne)}_e.memoizedState=ne;var Re={value:ne,getSnapshot:K};return _e.queue=Re,qu(Vu.bind(null,oe,Re,V),[V]),oe.flags|=2048,Wi(9,Xu.bind(null,oe,Re,ne,K),void 0,null),ne},useId:function(){var V=Kn(),K=pn.identifierPrefix;if(tn){var ne=ea,oe=Zn;ne=(oe&~(1<<32-on(oe)-1)).toString(32)+ne,K=":"+K+"R"+ne,ne=Bi++,0<ne&&(K+="H"+ne.toString(32)),K+=":"}else ne=zh++,K=":"+K+"r"+ne.toString(32)+":";return V.memoizedState=K},unstable_isNewReconciler:!1},Yh={readContext:Nn,useCallback:tf,useContext:Nn,useEffect:xl,useImperativeHandle:ef,useInsertionEffect:Ju,useLayoutEffect:Qu,useMemo:rf,useReducer:_l,useRef:Ku,useState:function(){return _l(Ui)},useDebugValue:vl,useDeferredValue:function(V){var K=Mn();return nf(K,un.memoizedState,V)},useTransition:function(){var V=_l(Ui)[0],K=Mn().memoizedState;return[V,K]},useMutableSource:Hu,useSyncExternalStore:$u,useId:af,unstable_isNewReconciler:!1},Kh={readContext:Nn,useCallback:tf,useContext:Nn,useEffect:xl,useImperativeHandle:ef,useInsertionEffect:Ju,useLayoutEffect:Qu,useMemo:rf,useReducer:gl,useRef:Ku,useState:function(){return gl(Ui)},useDebugValue:vl,useDeferredValue:function(V){var K=Mn();return un===null?K.memoizedState=V:nf(K,un.memoizedState,V)},useTransition:function(){var V=gl(Ui)[0],K=Mn().memoizedState;return[V,K]},useMutableSource:Hu,useSyncExternalStore:$u,useId:af,unstable_isNewReconciler:!1};function $n(V,K){if(V&&V.defaultProps){K=pt({},K),V=V.defaultProps;for(var ne in V)K[ne]===void 0&&(K[ne]=V[ne]);return K}return K}function wl(V,K,ne,oe){K=V.memoizedState,ne=ne(oe,K),ne=ne==null?K:pt({},K,ne),V.memoizedState=ne,V.lanes===0&&(V.updateQueue.baseState=ne)}var Os={isMounted:function(V){return(V=V._reactInternals)?yt(V)===V:!1},enqueueSetState:function(V,K,ne){V=V._reactInternals;var oe=Sn(),_e=Ea(V),Re=ra(oe,_e);Re.payload=K,ne!=null&&(Re.callback=ne),K=xa(V,Re,_e),K!==null&&(Vn(K,V,_e,oe),Fs(K,V,_e))},enqueueReplaceState:function(V,K,ne){V=V._reactInternals;var oe=Sn(),_e=Ea(V),Re=ra(oe,_e);Re.tag=1,Re.payload=K,ne!=null&&(Re.callback=ne),K=xa(V,Re,_e),K!==null&&(Vn(K,V,_e,oe),Fs(K,V,_e))},enqueueForceUpdate:function(V,K){V=V._reactInternals;var ne=Sn(),oe=Ea(V),_e=ra(ne,oe);_e.tag=2,K!=null&&(_e.callback=K),K=xa(V,_e,oe),K!==null&&(Vn(K,V,oe,ne),Fs(K,V,oe))}};function cf(V,K,ne,oe,_e,Re,ct){return V=V.stateNode,typeof V.shouldComponentUpdate=="function"?V.shouldComponentUpdate(oe,Re,ct):K.prototype&&K.prototype.isPureReactComponent?!Ti(ne,oe)||!Ti(_e,Re):!0}function uf(V,K,ne){var oe=!1,_e=ma,Re=K.contextType;return typeof Re=="object"&&Re!==null?Re=Nn(Re):(_e=An(K)?Ca:xn.current,oe=K.contextTypes,Re=(oe=oe!=null)?Ka(V,_e):ma),K=new K(ne,Re),V.memoizedState=K.state!==null&&K.state!==void 0?K.state:null,K.updater=Os,V.stateNode=K,K._reactInternals=V,oe&&(V=V.stateNode,V.__reactInternalMemoizedUnmaskedChildContext=_e,V.__reactInternalMemoizedMaskedChildContext=Re),K}function ff(V,K,ne,oe){V=K.state,typeof K.componentWillReceiveProps=="function"&&K.componentWillReceiveProps(ne,oe),typeof K.UNSAFE_componentWillReceiveProps=="function"&&K.UNSAFE_componentWillReceiveProps(ne,oe),K.state!==V&&Os.enqueueReplaceState(K,K.state,null)}function yl(V,K,ne,oe){var _e=V.stateNode;_e.props=ne,_e.state=V.memoizedState,_e.refs={},ol(V);var Re=K.contextType;typeof Re=="object"&&Re!==null?_e.context=Nn(Re):(Re=An(K)?Ca:xn.current,_e.context=Ka(V,Re)),_e.state=V.memoizedState,Re=K.getDerivedStateFromProps,typeof Re=="function"&&(wl(V,K,Re,ne),_e.state=V.memoizedState),typeof K.getDerivedStateFromProps=="function"||typeof _e.getSnapshotBeforeUpdate=="function"||typeof _e.UNSAFE_componentWillMount!="function"&&typeof _e.componentWillMount!="function"||(K=_e.state,typeof _e.componentWillMount=="function"&&_e.componentWillMount(),typeof _e.UNSAFE_componentWillMount=="function"&&_e.UNSAFE_componentWillMount(),K!==_e.state&&Os.enqueueReplaceState(_e,_e.state,null),Rs(V,ne,_e,oe),_e.state=V.memoizedState),typeof _e.componentDidMount=="function"&&(V.flags|=4194308)}function ni(V,K){try{var ne="",oe=K;do ne+=Pe(oe),oe=oe.return;while(oe);var _e=ne}catch(Re){_e=`
Error generating stack: `+Re.message+`
`+Re.stack}return{value:V,source:K,stack:_e,digest:null}}function El(V,K,ne){return{value:V,source:null,stack:ne??null,digest:K??null}}function Sl(V,K){try{console.error(K.value)}catch(ne){setTimeout(function(){throw ne})}}var qh=typeof WeakMap=="function"?WeakMap:Map;function hf(V,K,ne){ne=ra(-1,ne),ne.tag=3,ne.payload={element:null};var oe=K.value;return ne.callback=function(){Xs||(Xs=!0,Bl=oe),Sl(V,K)},ne}function df(V,K,ne){ne=ra(-1,ne),ne.tag=3;var oe=V.type.getDerivedStateFromError;if(typeof oe=="function"){var _e=K.value;ne.payload=function(){return oe(_e)},ne.callback=function(){Sl(V,K)}}var Re=V.stateNode;return Re!==null&&typeof Re.componentDidCatch=="function"&&(ne.callback=function(){Sl(V,K),typeof oe!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var ct=K.stack;this.componentDidCatch(K.value,{componentStack:ct!==null?ct:""})}),ne}function pf(V,K,ne){var oe=V.pingCache;if(oe===null){oe=V.pingCache=new qh;var _e=new Set;oe.set(K,_e)}else _e=oe.get(K),_e===void 0&&(_e=new Set,oe.set(K,_e));_e.has(ne)||(_e.add(ne),V=ud.bind(null,V,K,ne),K.then(V,V))}function mf(V){do{var K;if((K=V.tag===13)&&(K=V.memoizedState,K=K!==null?K.dehydrated!==null:!0),K)return V;V=V.return}while(V!==null);return null}function _f(V,K,ne,oe,_e){return(V.mode&1)===0?(V===K?V.flags|=65536:(V.flags|=128,ne.flags|=131072,ne.flags&=-52805,ne.tag===1&&(ne.alternate===null?ne.tag=17:(K=ra(-1,1),K.tag=2,xa(ne,K,1))),ne.lanes|=1),V):(V.flags|=65536,V.lanes=_e,V)}var Jh=Le.ReactCurrentOwner,Tn=!1;function En(V,K,ne,oe){K.child=V===null?Nu(K,null,ne,oe):Za(K,V.child,ne,oe)}function gf(V,K,ne,oe,_e){ne=ne.render;var Re=K.ref;return ti(K,_e),oe=pl(V,K,ne,oe,Re,_e),ne=ml(),V!==null&&!Tn?(K.updateQueue=V.updateQueue,K.flags&=-2053,V.lanes&=~_e,na(V,K,_e)):(tn&&ne&&Jo(K),K.flags|=1,En(V,K,oe,_e),K.child)}function xf(V,K,ne,oe,_e){if(V===null){var Re=ne.type;return typeof Re=="function"&&!Vl(Re)&&Re.defaultProps===void 0&&ne.compare===null&&ne.defaultProps===void 0?(K.tag=15,K.type=Re,vf(V,K,Re,oe,_e)):(V=qs(ne.type,null,oe,K,K.mode,_e),V.ref=K.ref,V.return=K,K.child=V)}if(Re=V.child,(V.lanes&_e)===0){var ct=Re.memoizedProps;if(ne=ne.compare,ne=ne!==null?ne:Ti,ne(ct,oe)&&V.ref===K.ref)return na(V,K,_e)}return K.flags|=1,V=ka(Re,oe),V.ref=K.ref,V.return=K,K.child=V}function vf(V,K,ne,oe,_e){if(V!==null){var Re=V.memoizedProps;if(Ti(Re,oe)&&V.ref===K.ref)if(Tn=!1,K.pendingProps=oe=Re,(V.lanes&_e)!==0)(V.flags&131072)!==0&&(Tn=!0);else return K.lanes=V.lanes,na(V,K,_e)}return kl(V,K,ne,oe,_e)}function wf(V,K,ne){var oe=K.pendingProps,_e=oe.children,Re=V!==null?V.memoizedState:null;if(oe.mode==="hidden")if((K.mode&1)===0)K.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qr(ii,Ln),Ln|=ne;else{if((ne&1073741824)===0)return V=Re!==null?Re.baseLanes|ne:ne,K.lanes=K.childLanes=1073741824,K.memoizedState={baseLanes:V,cachePool:null,transitions:null},K.updateQueue=null,Qr(ii,Ln),Ln|=V,null;K.memoizedState={baseLanes:0,cachePool:null,transitions:null},oe=Re!==null?Re.baseLanes:ne,Qr(ii,Ln),Ln|=oe}else Re!==null?(oe=Re.baseLanes|ne,K.memoizedState=null):oe=ne,Qr(ii,Ln),Ln|=oe;return En(V,K,_e,ne),K.child}function yf(V,K){var ne=K.ref;(V===null&&ne!==null||V!==null&&V.ref!==ne)&&(K.flags|=512,K.flags|=2097152)}function kl(V,K,ne,oe,_e){var Re=An(ne)?Ca:xn.current;return Re=Ka(K,Re),ti(K,_e),ne=pl(V,K,ne,oe,Re,_e),oe=ml(),V!==null&&!Tn?(K.updateQueue=V.updateQueue,K.flags&=-2053,V.lanes&=~_e,na(V,K,_e)):(tn&&oe&&Jo(K),K.flags|=1,En(V,K,ne,_e),K.child)}function Ef(V,K,ne,oe,_e){if(An(ne)){var Re=!0;ys(K)}else Re=!1;if(ti(K,_e),K.stateNode===null)Us(V,K),uf(K,ne,oe),yl(K,ne,oe,_e),oe=!0;else if(V===null){var ct=K.stateNode,Rt=K.memoizedProps;ct.props=Rt;var Ot=ct.context,ir=ne.contextType;typeof ir=="object"&&ir!==null?ir=Nn(ir):(ir=An(ne)?Ca:xn.current,ir=Ka(K,ir));var _r=ne.getDerivedStateFromProps,gr=typeof _r=="function"||typeof ct.getSnapshotBeforeUpdate=="function";gr||typeof ct.UNSAFE_componentWillReceiveProps!="function"&&typeof ct.componentWillReceiveProps!="function"||(Rt!==oe||Ot!==ir)&&ff(K,ct,oe,ir),ga=!1;var mr=K.memoizedState;ct.state=mr,Rs(K,oe,ct,_e),Ot=K.memoizedState,Rt!==oe||mr!==Ot||kn.current||ga?(typeof _r=="function"&&(wl(K,ne,_r,oe),Ot=K.memoizedState),(Rt=ga||cf(K,ne,Rt,oe,mr,Ot,ir))?(gr||typeof ct.UNSAFE_componentWillMount!="function"&&typeof ct.componentWillMount!="function"||(typeof ct.componentWillMount=="function"&&ct.componentWillMount(),typeof ct.UNSAFE_componentWillMount=="function"&&ct.UNSAFE_componentWillMount()),typeof ct.componentDidMount=="function"&&(K.flags|=4194308)):(typeof ct.componentDidMount=="function"&&(K.flags|=4194308),K.memoizedProps=oe,K.memoizedState=Ot),ct.props=oe,ct.state=Ot,ct.context=ir,oe=Rt):(typeof ct.componentDidMount=="function"&&(K.flags|=4194308),oe=!1)}else{ct=K.stateNode,Ou(V,K),Rt=K.memoizedProps,ir=K.type===K.elementType?Rt:$n(K.type,Rt),ct.props=ir,gr=K.pendingProps,mr=ct.context,Ot=ne.contextType,typeof Ot=="object"&&Ot!==null?Ot=Nn(Ot):(Ot=An(ne)?Ca:xn.current,Ot=Ka(K,Ot));var Dr=ne.getDerivedStateFromProps;(_r=typeof Dr=="function"||typeof ct.getSnapshotBeforeUpdate=="function")||typeof ct.UNSAFE_componentWillReceiveProps!="function"&&typeof ct.componentWillReceiveProps!="function"||(Rt!==gr||mr!==Ot)&&ff(K,ct,oe,Ot),ga=!1,mr=K.memoizedState,ct.state=mr,Rs(K,oe,ct,_e);var Mr=K.memoizedState;Rt!==gr||mr!==Mr||kn.current||ga?(typeof Dr=="function"&&(wl(K,ne,Dr,oe),Mr=K.memoizedState),(ir=ga||cf(K,ne,ir,oe,mr,Mr,Ot)||!1)?(_r||typeof ct.UNSAFE_componentWillUpdate!="function"&&typeof ct.componentWillUpdate!="function"||(typeof ct.componentWillUpdate=="function"&&ct.componentWillUpdate(oe,Mr,Ot),typeof ct.UNSAFE_componentWillUpdate=="function"&&ct.UNSAFE_componentWillUpdate(oe,Mr,Ot)),typeof ct.componentDidUpdate=="function"&&(K.flags|=4),typeof ct.getSnapshotBeforeUpdate=="function"&&(K.flags|=1024)):(typeof ct.componentDidUpdate!="function"||Rt===V.memoizedProps&&mr===V.memoizedState||(K.flags|=4),typeof ct.getSnapshotBeforeUpdate!="function"||Rt===V.memoizedProps&&mr===V.memoizedState||(K.flags|=1024),K.memoizedProps=oe,K.memoizedState=Mr),ct.props=oe,ct.state=Mr,ct.context=Ot,oe=ir):(typeof ct.componentDidUpdate!="function"||Rt===V.memoizedProps&&mr===V.memoizedState||(K.flags|=4),typeof ct.getSnapshotBeforeUpdate!="function"||Rt===V.memoizedProps&&mr===V.memoizedState||(K.flags|=1024),oe=!1)}return Al(V,K,ne,oe,Re,_e)}function Al(V,K,ne,oe,_e,Re){yf(V,K);var ct=(K.flags&128)!==0;if(!oe&&!ct)return _e&&Tu(K,ne,!1),na(V,K,Re);oe=K.stateNode,Jh.current=K;var Rt=ct&&typeof ne.getDerivedStateFromError!="function"?null:oe.render();return K.flags|=1,V!==null&&ct?(K.child=Za(K,V.child,null,Re),K.child=Za(K,null,Rt,Re)):En(V,K,Rt,Re),K.memoizedState=oe.state,_e&&Tu(K,ne,!0),K.child}function Sf(V){var K=V.stateNode;K.pendingContext?ku(V,K.pendingContext,K.pendingContext!==K.context):K.context&&ku(V,K.context,!1),ll(V,K.containerInfo)}function kf(V,K,ne,oe,_e){return Qa(),tl(_e),K.flags|=256,En(V,K,ne,oe),K.child}var Tl={dehydrated:null,treeContext:null,retryLane:0};function bl(V){return{baseLanes:V,cachePool:null,transitions:null}}function Af(V,K,ne){var oe=K.pendingProps,_e=rn.current,Re=!1,ct=(K.flags&128)!==0,Rt;if((Rt=ct)||(Rt=V!==null&&V.memoizedState===null?!1:(_e&2)!==0),Rt?(Re=!0,K.flags&=-129):(V===null||V.memoizedState!==null)&&(_e|=1),Qr(rn,_e&1),V===null)return el(K),V=K.memoizedState,V!==null&&(V=V.dehydrated,V!==null)?((K.mode&1)===0?K.lanes=1:V.data==="$!"?K.lanes=8:K.lanes=1073741824,null):(ct=oe.children,V=oe.fallback,Re?(oe=K.mode,Re=K.child,ct={mode:"hidden",children:ct},(oe&1)===0&&Re!==null?(Re.childLanes=0,Re.pendingProps=ct):Re=Js(ct,oe,0,null),V=Ba(V,oe,ne,null),Re.return=K,V.return=K,Re.sibling=V,K.child=Re,K.child.memoizedState=bl(ne),K.memoizedState=Tl,V):Cl(K,ct));if(_e=V.memoizedState,_e!==null&&(Rt=_e.dehydrated,Rt!==null))return Qh(V,K,ct,oe,Rt,_e,ne);if(Re){Re=oe.fallback,ct=K.mode,_e=V.child,Rt=_e.sibling;var Ot={mode:"hidden",children:oe.children};return(ct&1)===0&&K.child!==_e?(oe=K.child,oe.childLanes=0,oe.pendingProps=Ot,K.deletions=null):(oe=ka(_e,Ot),oe.subtreeFlags=_e.subtreeFlags&14680064),Rt!==null?Re=ka(Rt,Re):(Re=Ba(Re,ct,ne,null),Re.flags|=2),Re.return=K,oe.return=K,oe.sibling=Re,K.child=oe,oe=Re,Re=K.child,ct=V.child.memoizedState,ct=ct===null?bl(ne):{baseLanes:ct.baseLanes|ne,cachePool:null,transitions:ct.transitions},Re.memoizedState=ct,Re.childLanes=V.childLanes&~ne,K.memoizedState=Tl,oe}return Re=V.child,V=Re.sibling,oe=ka(Re,{mode:"visible",children:oe.children}),(K.mode&1)===0&&(oe.lanes=ne),oe.return=K,oe.sibling=null,V!==null&&(ne=K.deletions,ne===null?(K.deletions=[V],K.flags|=16):ne.push(V)),K.child=oe,K.memoizedState=null,oe}function Cl(V,K){return K=Js({mode:"visible",children:K},V.mode,0,null),K.return=V,V.child=K}function Bs(V,K,ne,oe){return oe!==null&&tl(oe),Za(K,V.child,null,ne),V=Cl(K,K.pendingProps.children),V.flags|=2,K.memoizedState=null,V}function Qh(V,K,ne,oe,_e,Re,ct){if(ne)return K.flags&256?(K.flags&=-257,oe=El(Error(L(422))),Bs(V,K,ct,oe)):K.memoizedState!==null?(K.child=V.child,K.flags|=128,null):(Re=oe.fallback,_e=K.mode,oe=Js({mode:"visible",children:oe.children},_e,0,null),Re=Ba(Re,_e,ct,null),Re.flags|=2,oe.return=K,Re.return=K,oe.sibling=Re,K.child=oe,(K.mode&1)!==0&&Za(K,V.child,null,ct),K.child.memoizedState=bl(ct),K.memoizedState=Tl,Re);if((K.mode&1)===0)return Bs(V,K,ct,null);if(_e.data==="$!"){if(oe=_e.nextSibling&&_e.nextSibling.dataset,oe)var Rt=oe.dgst;return oe=Rt,Re=Error(L(419)),oe=El(Re,oe,void 0),Bs(V,K,ct,oe)}if(Rt=(ct&V.childLanes)!==0,Tn||Rt){if(oe=pn,oe!==null){switch(ct&-ct){case 4:_e=2;break;case 16:_e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_e=32;break;case 536870912:_e=268435456;break;default:_e=0}_e=(_e&(oe.suspendedLanes|ct))!==0?0:_e,_e!==0&&_e!==Re.retryLane&&(Re.retryLane=_e,ta(V,_e),Vn(oe,V,_e,-1))}return Xl(),oe=El(Error(L(421))),Bs(V,K,ct,oe)}return _e.data==="$?"?(K.flags|=128,K.child=V.child,K=fd.bind(null,V),_e._reactRetry=K,null):(V=Re.treeContext,Pn=da(_e.nextSibling),Rn=K,tn=!0,Hn=null,V!==null&&(Dn[In++]=Zn,Dn[In++]=ea,Dn[In++]=Fa,Zn=V.id,ea=V.overflow,Fa=K),K=Cl(K,oe.children),K.flags|=4096,K)}function Tf(V,K,ne){V.lanes|=K;var oe=V.alternate;oe!==null&&(oe.lanes|=K),il(V.return,K,ne)}function Fl(V,K,ne,oe,_e){var Re=V.memoizedState;Re===null?V.memoizedState={isBackwards:K,rendering:null,renderingStartTime:0,last:oe,tail:ne,tailMode:_e}:(Re.isBackwards=K,Re.rendering=null,Re.renderingStartTime=0,Re.last=oe,Re.tail=ne,Re.tailMode=_e)}function bf(V,K,ne){var oe=K.pendingProps,_e=oe.revealOrder,Re=oe.tail;if(En(V,K,oe.children,ne),oe=rn.current,(oe&2)!==0)oe=oe&1|2,K.flags|=128;else{if(V!==null&&(V.flags&128)!==0)e:for(V=K.child;V!==null;){if(V.tag===13)V.memoizedState!==null&&Tf(V,ne,K);else if(V.tag===19)Tf(V,ne,K);else if(V.child!==null){V.child.return=V,V=V.child;continue}if(V===K)break e;for(;V.sibling===null;){if(V.return===null||V.return===K)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}oe&=1}if(Qr(rn,oe),(K.mode&1)===0)K.memoizedState=null;else switch(_e){case"forwards":for(ne=K.child,_e=null;ne!==null;)V=ne.alternate,V!==null&&Ps(V)===null&&(_e=ne),ne=ne.sibling;ne=_e,ne===null?(_e=K.child,K.child=null):(_e=ne.sibling,ne.sibling=null),Fl(K,!1,_e,ne,Re);break;case"backwards":for(ne=null,_e=K.child,K.child=null;_e!==null;){if(V=_e.alternate,V!==null&&Ps(V)===null){K.child=_e;break}V=_e.sibling,_e.sibling=ne,ne=_e,_e=V}Fl(K,!0,ne,null,Re);break;case"together":Fl(K,!1,null,null,void 0);break;default:K.memoizedState=null}return K.child}function Us(V,K){(K.mode&1)===0&&V!==null&&(V.alternate=null,K.alternate=null,K.flags|=2)}function na(V,K,ne){if(V!==null&&(K.dependencies=V.dependencies),Ia|=K.lanes,(ne&K.childLanes)===0)return null;if(V!==null&&K.child!==V.child)throw Error(L(153));if(K.child!==null){for(V=K.child,ne=ka(V,V.pendingProps),K.child=ne,ne.return=K;V.sibling!==null;)V=V.sibling,ne=ne.sibling=ka(V,V.pendingProps),ne.return=K;ne.sibling=null}return K.child}function Zh(V,K,ne){switch(K.tag){case 3:Sf(K),Qa();break;case 5:Wu(K);break;case 1:An(K.type)&&ys(K);break;case 4:ll(K,K.stateNode.containerInfo);break;case 10:var oe=K.type._context,_e=K.memoizedProps.value;Qr(bs,oe._currentValue),oe._currentValue=_e;break;case 13:if(oe=K.memoizedState,oe!==null)return oe.dehydrated!==null?(Qr(rn,rn.current&1),K.flags|=128,null):(ne&K.child.childLanes)!==0?Af(V,K,ne):(Qr(rn,rn.current&1),V=na(V,K,ne),V!==null?V.sibling:null);Qr(rn,rn.current&1);break;case 19:if(oe=(ne&K.childLanes)!==0,(V.flags&128)!==0){if(oe)return bf(V,K,ne);K.flags|=128}if(_e=K.memoizedState,_e!==null&&(_e.rendering=null,_e.tail=null,_e.lastEffect=null),Qr(rn,rn.current),oe)break;return null;case 22:case 23:return K.lanes=0,wf(V,K,ne)}return na(V,K,ne)}var Cf,Rl,Ff,Rf;Cf=function(V,K){for(var ne=K.child;ne!==null;){if(ne.tag===5||ne.tag===6)V.appendChild(ne.stateNode);else if(ne.tag!==4&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===K)break;for(;ne.sibling===null;){if(ne.return===null||ne.return===K)return;ne=ne.return}ne.sibling.return=ne.return,ne=ne.sibling}},Rl=function(){},Ff=function(V,K,ne,oe){var _e=V.memoizedProps;if(_e!==oe){V=K.stateNode,La(Yn.current);var Re=null;switch(ne){case"input":_e=Yt(V,_e),oe=Yt(V,oe),Re=[];break;case"select":_e=pt({},_e,{value:void 0}),oe=pt({},oe,{value:void 0}),Re=[];break;case"textarea":_e=Qt(V,_e),oe=Qt(V,oe),Re=[];break;default:typeof _e.onClick!="function"&&typeof oe.onClick=="function"&&(V.onclick=xs)}Ht(ne,oe);var ct;ne=null;for(ir in _e)if(!oe.hasOwnProperty(ir)&&_e.hasOwnProperty(ir)&&_e[ir]!=null)if(ir==="style"){var Rt=_e[ir];for(ct in Rt)Rt.hasOwnProperty(ct)&&(ne||(ne={}),ne[ct]="")}else ir!=="dangerouslySetInnerHTML"&&ir!=="children"&&ir!=="suppressContentEditableWarning"&&ir!=="suppressHydrationWarning"&&ir!=="autoFocus"&&(W.hasOwnProperty(ir)?Re||(Re=[]):(Re=Re||[]).push(ir,null));for(ir in oe){var Ot=oe[ir];if(Rt=_e!=null?_e[ir]:void 0,oe.hasOwnProperty(ir)&&Ot!==Rt&&(Ot!=null||Rt!=null))if(ir==="style")if(Rt){for(ct in Rt)!Rt.hasOwnProperty(ct)||Ot&&Ot.hasOwnProperty(ct)||(ne||(ne={}),ne[ct]="");for(ct in Ot)Ot.hasOwnProperty(ct)&&Rt[ct]!==Ot[ct]&&(ne||(ne={}),ne[ct]=Ot[ct])}else ne||(Re||(Re=[]),Re.push(ir,ne)),ne=Ot;else ir==="dangerouslySetInnerHTML"?(Ot=Ot?Ot.__html:void 0,Rt=Rt?Rt.__html:void 0,Ot!=null&&Rt!==Ot&&(Re=Re||[]).push(ir,Ot)):ir==="children"?typeof Ot!="string"&&typeof Ot!="number"||(Re=Re||[]).push(ir,""+Ot):ir!=="suppressContentEditableWarning"&&ir!=="suppressHydrationWarning"&&(W.hasOwnProperty(ir)?(Ot!=null&&ir==="onScroll"&&Zr("scroll",V),Re||Rt===Ot||(Re=[])):(Re=Re||[]).push(ir,Ot))}ne&&(Re=Re||[]).push("style",ne);var ir=Re;(K.updateQueue=ir)&&(K.flags|=4)}},Rf=function(V,K,ne,oe){ne!==oe&&(K.flags|=4)};function Hi(V,K){if(!tn)switch(V.tailMode){case"hidden":K=V.tail;for(var ne=null;K!==null;)K.alternate!==null&&(ne=K),K=K.sibling;ne===null?V.tail=null:ne.sibling=null;break;case"collapsed":ne=V.tail;for(var oe=null;ne!==null;)ne.alternate!==null&&(oe=ne),ne=ne.sibling;oe===null?K||V.tail===null?V.tail=null:V.tail.sibling=null:oe.sibling=null}}function wn(V){var K=V.alternate!==null&&V.alternate.child===V.child,ne=0,oe=0;if(K)for(var _e=V.child;_e!==null;)ne|=_e.lanes|_e.childLanes,oe|=_e.subtreeFlags&14680064,oe|=_e.flags&14680064,_e.return=V,_e=_e.sibling;else for(_e=V.child;_e!==null;)ne|=_e.lanes|_e.childLanes,oe|=_e.subtreeFlags,oe|=_e.flags,_e.return=V,_e=_e.sibling;return V.subtreeFlags|=oe,V.childLanes=ne,K}function ed(V,K,ne){var oe=K.pendingProps;switch(Qo(K),K.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wn(K),null;case 1:return An(K.type)&&ws(),wn(K),null;case 3:return oe=K.stateNode,ri(),en(kn),en(xn),fl(),oe.pendingContext&&(oe.context=oe.pendingContext,oe.pendingContext=null),(V===null||V.child===null)&&(As(K)?K.flags|=4:V===null||V.memoizedState.isDehydrated&&(K.flags&256)===0||(K.flags|=1024,Hn!==null&&(Hl(Hn),Hn=null))),Rl(V,K),wn(K),null;case 5:cl(K);var _e=La(Mi.current);if(ne=K.type,V!==null&&K.stateNode!=null)Ff(V,K,ne,oe,_e),V.ref!==K.ref&&(K.flags|=512,K.flags|=2097152);else{if(!oe){if(K.stateNode===null)throw Error(L(166));return wn(K),null}if(V=La(Yn.current),As(K)){oe=K.stateNode,ne=K.type;var Re=K.memoizedProps;switch(oe[Gn]=K,oe[Pi]=Re,V=(K.mode&1)!==0,ne){case"dialog":Zr("cancel",oe),Zr("close",oe);break;case"iframe":case"object":case"embed":Zr("load",oe);break;case"video":case"audio":for(_e=0;_e<Ci.length;_e++)Zr(Ci[_e],oe);break;case"source":Zr("error",oe);break;case"img":case"image":case"link":Zr("error",oe),Zr("load",oe);break;case"details":Zr("toggle",oe);break;case"input":Zt(oe,Re),Zr("invalid",oe);break;case"select":oe._wrapperState={wasMultiple:!!Re.multiple},Zr("invalid",oe);break;case"textarea":or(oe,Re),Zr("invalid",oe)}Ht(ne,Re),_e=null;for(var ct in Re)if(Re.hasOwnProperty(ct)){var Rt=Re[ct];ct==="children"?typeof Rt=="string"?oe.textContent!==Rt&&(Re.suppressHydrationWarning!==!0&&gs(oe.textContent,Rt,V),_e=["children",Rt]):typeof Rt=="number"&&oe.textContent!==""+Rt&&(Re.suppressHydrationWarning!==!0&&gs(oe.textContent,Rt,V),_e=["children",""+Rt]):W.hasOwnProperty(ct)&&Rt!=null&&ct==="onScroll"&&Zr("scroll",oe)}switch(ne){case"input":It(oe),ht(oe,Re,!0);break;case"textarea":It(oe),Nt(oe);break;case"select":case"option":break;default:typeof Re.onClick=="function"&&(oe.onclick=xs)}oe=_e,K.updateQueue=oe,oe!==null&&(K.flags|=4)}else{ct=_e.nodeType===9?_e:_e.ownerDocument,V==="http://www.w3.org/1999/xhtml"&&(V=fr(ne)),V==="http://www.w3.org/1999/xhtml"?ne==="script"?(V=ct.createElement("div"),V.innerHTML="<script><\/script>",V=V.removeChild(V.firstChild)):typeof oe.is=="string"?V=ct.createElement(ne,{is:oe.is}):(V=ct.createElement(ne),ne==="select"&&(ct=V,oe.multiple?ct.multiple=!0:oe.size&&(ct.size=oe.size))):V=ct.createElementNS(V,ne),V[Gn]=K,V[Pi]=oe,Cf(V,K,!1,!1),K.stateNode=V;e:{switch(ct=$t(ne,oe),ne){case"dialog":Zr("cancel",V),Zr("close",V),_e=oe;break;case"iframe":case"object":case"embed":Zr("load",V),_e=oe;break;case"video":case"audio":for(_e=0;_e<Ci.length;_e++)Zr(Ci[_e],V);_e=oe;break;case"source":Zr("error",V),_e=oe;break;case"img":case"image":case"link":Zr("error",V),Zr("load",V),_e=oe;break;case"details":Zr("toggle",V),_e=oe;break;case"input":Zt(V,oe),_e=Yt(V,oe),Zr("invalid",V);break;case"option":_e=oe;break;case"select":V._wrapperState={wasMultiple:!!oe.multiple},_e=pt({},oe,{value:void 0}),Zr("invalid",V);break;case"textarea":or(V,oe),_e=Qt(V,oe),Zr("invalid",V);break;default:_e=oe}Ht(ne,_e),Rt=_e;for(Re in Rt)if(Rt.hasOwnProperty(Re)){var Ot=Rt[Re];Re==="style"?zr(V,Ot):Re==="dangerouslySetInnerHTML"?(Ot=Ot?Ot.__html:void 0,Ot!=null&&Rr(V,Ot)):Re==="children"?typeof Ot=="string"?(ne!=="textarea"||Ot!=="")&&vr(V,Ot):typeof Ot=="number"&&vr(V,""+Ot):Re!=="suppressContentEditableWarning"&&Re!=="suppressHydrationWarning"&&Re!=="autoFocus"&&(W.hasOwnProperty(Re)?Ot!=null&&Re==="onScroll"&&Zr("scroll",V):Ot!=null&&xe(V,Re,Ot,ct))}switch(ne){case"input":It(V),ht(V,oe,!1);break;case"textarea":It(V),Nt(V);break;case"option":oe.value!=null&&V.setAttribute("value",""+ot(oe.value));break;case"select":V.multiple=!!oe.multiple,Re=oe.value,Re!=null?Bt(V,!!oe.multiple,Re,!1):oe.defaultValue!=null&&Bt(V,!!oe.multiple,oe.defaultValue,!0);break;default:typeof _e.onClick=="function"&&(V.onclick=xs)}switch(ne){case"button":case"input":case"select":case"textarea":oe=!!oe.autoFocus;break e;case"img":oe=!0;break e;default:oe=!1}}oe&&(K.flags|=4)}K.ref!==null&&(K.flags|=512,K.flags|=2097152)}return wn(K),null;case 6:if(V&&K.stateNode!=null)Rf(V,K,V.memoizedProps,oe);else{if(typeof oe!="string"&&K.stateNode===null)throw Error(L(166));if(ne=La(Mi.current),La(Yn.current),As(K)){if(oe=K.stateNode,ne=K.memoizedProps,oe[Gn]=K,(Re=oe.nodeValue!==ne)&&(V=Rn,V!==null))switch(V.tag){case 3:gs(oe.nodeValue,ne,(V.mode&1)!==0);break;case 5:V.memoizedProps.suppressHydrationWarning!==!0&&gs(oe.nodeValue,ne,(V.mode&1)!==0)}Re&&(K.flags|=4)}else oe=(ne.nodeType===9?ne:ne.ownerDocument).createTextNode(oe),oe[Gn]=K,K.stateNode=oe}return wn(K),null;case 13:if(en(rn),oe=K.memoizedState,V===null||V.memoizedState!==null&&V.memoizedState.dehydrated!==null){if(tn&&Pn!==null&&(K.mode&1)!==0&&(K.flags&128)===0)Lu(),Qa(),K.flags|=98560,Re=!1;else if(Re=As(K),oe!==null&&oe.dehydrated!==null){if(V===null){if(!Re)throw Error(L(318));if(Re=K.memoizedState,Re=Re!==null?Re.dehydrated:null,!Re)throw Error(L(317));Re[Gn]=K}else Qa(),(K.flags&128)===0&&(K.memoizedState=null),K.flags|=4;wn(K),Re=!1}else Hn!==null&&(Hl(Hn),Hn=null),Re=!0;if(!Re)return K.flags&65536?K:null}return(K.flags&128)!==0?(K.lanes=ne,K):(oe=oe!==null,oe!==(V!==null&&V.memoizedState!==null)&&oe&&(K.child.flags|=8192,(K.mode&1)!==0&&(V===null||(rn.current&1)!==0?fn===0&&(fn=3):Xl())),K.updateQueue!==null&&(K.flags|=4),wn(K),null);case 4:return ri(),Rl(V,K),V===null&&Fi(K.stateNode.containerInfo),wn(K),null;case 10:return al(K.type._context),wn(K),null;case 17:return An(K.type)&&ws(),wn(K),null;case 19:if(en(rn),Re=K.memoizedState,Re===null)return wn(K),null;if(oe=(K.flags&128)!==0,ct=Re.rendering,ct===null)if(oe)Hi(Re,!1);else{if(fn!==0||V!==null&&(V.flags&128)!==0)for(V=K.child;V!==null;){if(ct=Ps(V),ct!==null){for(K.flags|=128,Hi(Re,!1),oe=ct.updateQueue,oe!==null&&(K.updateQueue=oe,K.flags|=4),K.subtreeFlags=0,oe=ne,ne=K.child;ne!==null;)Re=ne,V=oe,Re.flags&=14680066,ct=Re.alternate,ct===null?(Re.childLanes=0,Re.lanes=V,Re.child=null,Re.subtreeFlags=0,Re.memoizedProps=null,Re.memoizedState=null,Re.updateQueue=null,Re.dependencies=null,Re.stateNode=null):(Re.childLanes=ct.childLanes,Re.lanes=ct.lanes,Re.child=ct.child,Re.subtreeFlags=0,Re.deletions=null,Re.memoizedProps=ct.memoizedProps,Re.memoizedState=ct.memoizedState,Re.updateQueue=ct.updateQueue,Re.type=ct.type,V=ct.dependencies,Re.dependencies=V===null?null:{lanes:V.lanes,firstContext:V.firstContext}),ne=ne.sibling;return Qr(rn,rn.current&1|2),K.child}V=V.sibling}Re.tail!==null&&xr()>si&&(K.flags|=128,oe=!0,Hi(Re,!1),K.lanes=4194304)}else{if(!oe)if(V=Ps(ct),V!==null){if(K.flags|=128,oe=!0,ne=V.updateQueue,ne!==null&&(K.updateQueue=ne,K.flags|=4),Hi(Re,!0),Re.tail===null&&Re.tailMode==="hidden"&&!ct.alternate&&!tn)return wn(K),null}else 2*xr()-Re.renderingStartTime>si&&ne!==1073741824&&(K.flags|=128,oe=!0,Hi(Re,!1),K.lanes=4194304);Re.isBackwards?(ct.sibling=K.child,K.child=ct):(ne=Re.last,ne!==null?ne.sibling=ct:K.child=ct,Re.last=ct)}return Re.tail!==null?(K=Re.tail,Re.rendering=K,Re.tail=K.sibling,Re.renderingStartTime=xr(),K.sibling=null,ne=rn.current,Qr(rn,oe?ne&1|2:ne&1),K):(wn(K),null);case 22:case 23:return zl(),oe=K.memoizedState!==null,V!==null&&V.memoizedState!==null!==oe&&(K.flags|=8192),oe&&(K.mode&1)!==0?(Ln&1073741824)!==0&&(wn(K),K.subtreeFlags&6&&(K.flags|=8192)):wn(K),null;case 24:return null;case 25:return null}throw Error(L(156,K.tag))}function td(V,K){switch(Qo(K),K.tag){case 1:return An(K.type)&&ws(),V=K.flags,V&65536?(K.flags=V&-65537|128,K):null;case 3:return ri(),en(kn),en(xn),fl(),V=K.flags,(V&65536)!==0&&(V&128)===0?(K.flags=V&-65537|128,K):null;case 5:return cl(K),null;case 13:if(en(rn),V=K.memoizedState,V!==null&&V.dehydrated!==null){if(K.alternate===null)throw Error(L(340));Qa()}return V=K.flags,V&65536?(K.flags=V&-65537|128,K):null;case 19:return en(rn),null;case 4:return ri(),null;case 10:return al(K.type._context),null;case 22:case 23:return zl(),null;case 24:return null;default:return null}}var Ws=!1,yn=!1,rd=typeof WeakSet=="function"?WeakSet:Set,Nr=null;function ai(V,K){var ne=V.ref;if(ne!==null)if(typeof ne=="function")try{ne(null)}catch(oe){an(V,K,oe)}else ne.current=null}function Pl(V,K,ne){try{ne()}catch(oe){an(V,K,oe)}}var Pf=!1;function nd(V,K){if(zo=ss,V=lu(),No(V)){if("selectionStart"in V)var ne={start:V.selectionStart,end:V.selectionEnd};else e:{ne=(ne=V.ownerDocument)&&ne.defaultView||window;var oe=ne.getSelection&&ne.getSelection();if(oe&&oe.rangeCount!==0){ne=oe.anchorNode;var _e=oe.anchorOffset,Re=oe.focusNode;oe=oe.focusOffset;try{ne.nodeType,Re.nodeType}catch{ne=null;break e}var ct=0,Rt=-1,Ot=-1,ir=0,_r=0,gr=V,mr=null;t:for(;;){for(var Dr;gr!==ne||_e!==0&&gr.nodeType!==3||(Rt=ct+_e),gr!==Re||oe!==0&&gr.nodeType!==3||(Ot=ct+oe),gr.nodeType===3&&(ct+=gr.nodeValue.length),(Dr=gr.firstChild)!==null;)mr=gr,gr=Dr;for(;;){if(gr===V)break t;if(mr===ne&&++ir===_e&&(Rt=ct),mr===Re&&++_r===oe&&(Ot=ct),(Dr=gr.nextSibling)!==null)break;gr=mr,mr=gr.parentNode}gr=Dr}ne=Rt===-1||Ot===-1?null:{start:Rt,end:Ot}}else ne=null}ne=ne||{start:0,end:0}}else ne=null;for(Xo={focusedElem:V,selectionRange:ne},ss=!1,Nr=K;Nr!==null;)if(K=Nr,V=K.child,(K.subtreeFlags&1028)!==0&&V!==null)V.return=K,Nr=V;else for(;Nr!==null;){K=Nr;try{var Mr=K.alternate;if((K.flags&1024)!==0)switch(K.tag){case 0:case 11:case 15:break;case 1:if(Mr!==null){var Or=Mr.memoizedProps,ln=Mr.memoizedState,Jt=K.stateNode,Wt=Jt.getSnapshotBeforeUpdate(K.elementType===K.type?Or:$n(K.type,Or),ln);Jt.__reactInternalSnapshotBeforeUpdate=Wt}break;case 3:var nr=K.stateNode.containerInfo;nr.nodeType===1?nr.textContent="":nr.nodeType===9&&nr.documentElement&&nr.removeChild(nr.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(Sr){an(K,K.return,Sr)}if(V=K.sibling,V!==null){V.return=K.return,Nr=V;break}Nr=K.return}return Mr=Pf,Pf=!1,Mr}function $i(V,K,ne){var oe=K.updateQueue;if(oe=oe!==null?oe.lastEffect:null,oe!==null){var _e=oe=oe.next;do{if((_e.tag&V)===V){var Re=_e.destroy;_e.destroy=void 0,Re!==void 0&&Pl(K,ne,Re)}_e=_e.next}while(_e!==oe)}}function Hs(V,K){if(K=K.updateQueue,K=K!==null?K.lastEffect:null,K!==null){var ne=K=K.next;do{if((ne.tag&V)===V){var oe=ne.create;ne.destroy=oe()}ne=ne.next}while(ne!==K)}}function Ll(V){var K=V.ref;if(K!==null){var ne=V.stateNode;switch(V.tag){case 5:V=ne;break;default:V=ne}typeof K=="function"?K(V):K.current=V}}function Lf(V){var K=V.alternate;K!==null&&(V.alternate=null,Lf(K)),V.child=null,V.deletions=null,V.sibling=null,V.tag===5&&(K=V.stateNode,K!==null&&(delete K[Gn],delete K[Pi],delete K[Yo],delete K[Uh],delete K[Wh])),V.stateNode=null,V.return=null,V.dependencies=null,V.memoizedProps=null,V.memoizedState=null,V.pendingProps=null,V.stateNode=null,V.updateQueue=null}function Df(V){return V.tag===5||V.tag===3||V.tag===4}function If(V){e:for(;;){for(;V.sibling===null;){if(V.return===null||Df(V.return))return null;V=V.return}for(V.sibling.return=V.return,V=V.sibling;V.tag!==5&&V.tag!==6&&V.tag!==18;){if(V.flags&2||V.child===null||V.tag===4)continue e;V.child.return=V,V=V.child}if(!(V.flags&2))return V.stateNode}}function Dl(V,K,ne){var oe=V.tag;if(oe===5||oe===6)V=V.stateNode,K?ne.nodeType===8?ne.parentNode.insertBefore(V,K):ne.insertBefore(V,K):(ne.nodeType===8?(K=ne.parentNode,K.insertBefore(V,ne)):(K=ne,K.appendChild(V)),ne=ne._reactRootContainer,ne!=null||K.onclick!==null||(K.onclick=xs));else if(oe!==4&&(V=V.child,V!==null))for(Dl(V,K,ne),V=V.sibling;V!==null;)Dl(V,K,ne),V=V.sibling}function Il(V,K,ne){var oe=V.tag;if(oe===5||oe===6)V=V.stateNode,K?ne.insertBefore(V,K):ne.appendChild(V);else if(oe!==4&&(V=V.child,V!==null))for(Il(V,K,ne),V=V.sibling;V!==null;)Il(V,K,ne),V=V.sibling}var _n=null,zn=!1;function va(V,K,ne){for(ne=ne.child;ne!==null;)Nf(V,K,ne),ne=ne.sibling}function Nf(V,K,ne){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(jn,ne)}catch{}switch(ne.tag){case 5:yn||ai(ne,K);case 6:var oe=_n,_e=zn;_n=null,va(V,K,ne),_n=oe,zn=_e,_n!==null&&(zn?(V=_n,ne=ne.stateNode,V.nodeType===8?V.parentNode.removeChild(ne):V.removeChild(ne)):_n.removeChild(ne.stateNode));break;case 18:_n!==null&&(zn?(V=_n,ne=ne.stateNode,V.nodeType===8?Go(V.parentNode,ne):V.nodeType===1&&Go(V,ne),wi(V)):Go(_n,ne.stateNode));break;case 4:oe=_n,_e=zn,_n=ne.stateNode.containerInfo,zn=!0,va(V,K,ne),_n=oe,zn=_e;break;case 0:case 11:case 14:case 15:if(!yn&&(oe=ne.updateQueue,oe!==null&&(oe=oe.lastEffect,oe!==null))){_e=oe=oe.next;do{var Re=_e,ct=Re.destroy;Re=Re.tag,ct!==void 0&&((Re&2)!==0||(Re&4)!==0)&&Pl(ne,K,ct),_e=_e.next}while(_e!==oe)}va(V,K,ne);break;case 1:if(!yn&&(ai(ne,K),oe=ne.stateNode,typeof oe.componentWillUnmount=="function"))try{oe.props=ne.memoizedProps,oe.state=ne.memoizedState,oe.componentWillUnmount()}catch(Rt){an(ne,K,Rt)}va(V,K,ne);break;case 21:va(V,K,ne);break;case 22:ne.mode&1?(yn=(oe=yn)||ne.memoizedState!==null,va(V,K,ne),yn=oe):va(V,K,ne);break;default:va(V,K,ne)}}function Mf(V){var K=V.updateQueue;if(K!==null){V.updateQueue=null;var ne=V.stateNode;ne===null&&(ne=V.stateNode=new rd),K.forEach(function(oe){var _e=hd.bind(null,V,oe);ne.has(oe)||(ne.add(oe),oe.then(_e,_e))})}}function Xn(V,K){var ne=K.deletions;if(ne!==null)for(var oe=0;oe<ne.length;oe++){var _e=ne[oe];try{var Re=V,ct=K,Rt=ct;e:for(;Rt!==null;){switch(Rt.tag){case 5:_n=Rt.stateNode,zn=!1;break e;case 3:_n=Rt.stateNode.containerInfo,zn=!0;break e;case 4:_n=Rt.stateNode.containerInfo,zn=!0;break e}Rt=Rt.return}if(_n===null)throw Error(L(160));Nf(Re,ct,_e),_n=null,zn=!1;var Ot=_e.alternate;Ot!==null&&(Ot.return=null),_e.return=null}catch(ir){an(_e,K,ir)}}if(K.subtreeFlags&12854)for(K=K.child;K!==null;)Of(K,V),K=K.sibling}function Of(V,K){var ne=V.alternate,oe=V.flags;switch(V.tag){case 0:case 11:case 14:case 15:if(Xn(K,V),qn(V),oe&4){try{$i(3,V,V.return),Hs(3,V)}catch(Or){an(V,V.return,Or)}try{$i(5,V,V.return)}catch(Or){an(V,V.return,Or)}}break;case 1:Xn(K,V),qn(V),oe&512&&ne!==null&&ai(ne,ne.return);break;case 5:if(Xn(K,V),qn(V),oe&512&&ne!==null&&ai(ne,ne.return),V.flags&32){var _e=V.stateNode;try{vr(_e,"")}catch(Or){an(V,V.return,Or)}}if(oe&4&&(_e=V.stateNode,_e!=null)){var Re=V.memoizedProps,ct=ne!==null?ne.memoizedProps:Re,Rt=V.type,Ot=V.updateQueue;if(V.updateQueue=null,Ot!==null)try{Rt==="input"&&Re.type==="radio"&&Re.name!=null&&Lt(_e,Re),$t(Rt,ct);var ir=$t(Rt,Re);for(ct=0;ct<Ot.length;ct+=2){var _r=Ot[ct],gr=Ot[ct+1];_r==="style"?zr(_e,gr):_r==="dangerouslySetInnerHTML"?Rr(_e,gr):_r==="children"?vr(_e,gr):xe(_e,_r,gr,ir)}switch(Rt){case"input":Ft(_e,Re);break;case"textarea":ar(_e,Re);break;case"select":var mr=_e._wrapperState.wasMultiple;_e._wrapperState.wasMultiple=!!Re.multiple;var Dr=Re.value;Dr!=null?Bt(_e,!!Re.multiple,Dr,!1):mr!==!!Re.multiple&&(Re.defaultValue!=null?Bt(_e,!!Re.multiple,Re.defaultValue,!0):Bt(_e,!!Re.multiple,Re.multiple?[]:"",!1))}_e[Pi]=Re}catch(Or){an(V,V.return,Or)}}break;case 6:if(Xn(K,V),qn(V),oe&4){if(V.stateNode===null)throw Error(L(162));_e=V.stateNode,Re=V.memoizedProps;try{_e.nodeValue=Re}catch(Or){an(V,V.return,Or)}}break;case 3:if(Xn(K,V),qn(V),oe&4&&ne!==null&&ne.memoizedState.isDehydrated)try{wi(K.containerInfo)}catch(Or){an(V,V.return,Or)}break;case 4:Xn(K,V),qn(V);break;case 13:Xn(K,V),qn(V),_e=V.child,_e.flags&8192&&(Re=_e.memoizedState!==null,_e.stateNode.isHidden=Re,!Re||_e.alternate!==null&&_e.alternate.memoizedState!==null||(Ol=xr())),oe&4&&Mf(V);break;case 22:if(_r=ne!==null&&ne.memoizedState!==null,V.mode&1?(yn=(ir=yn)||_r,Xn(K,V),yn=ir):Xn(K,V),qn(V),oe&8192){if(ir=V.memoizedState!==null,(V.stateNode.isHidden=ir)&&!_r&&(V.mode&1)!==0)for(Nr=V,_r=V.child;_r!==null;){for(gr=Nr=_r;Nr!==null;){switch(mr=Nr,Dr=mr.child,mr.tag){case 0:case 11:case 14:case 15:$i(4,mr,mr.return);break;case 1:ai(mr,mr.return);var Mr=mr.stateNode;if(typeof Mr.componentWillUnmount=="function"){oe=mr,ne=mr.return;try{K=oe,Mr.props=K.memoizedProps,Mr.state=K.memoizedState,Mr.componentWillUnmount()}catch(Or){an(oe,ne,Or)}}break;case 5:ai(mr,mr.return);break;case 22:if(mr.memoizedState!==null){Wf(gr);continue}}Dr!==null?(Dr.return=mr,Nr=Dr):Wf(gr)}_r=_r.sibling}e:for(_r=null,gr=V;;){if(gr.tag===5){if(_r===null){_r=gr;try{_e=gr.stateNode,ir?(Re=_e.style,typeof Re.setProperty=="function"?Re.setProperty("display","none","important"):Re.display="none"):(Rt=gr.stateNode,Ot=gr.memoizedProps.style,ct=Ot!=null&&Ot.hasOwnProperty("display")?Ot.display:null,Rt.style.display=Ir("display",ct))}catch(Or){an(V,V.return,Or)}}}else if(gr.tag===6){if(_r===null)try{gr.stateNode.nodeValue=ir?"":gr.memoizedProps}catch(Or){an(V,V.return,Or)}}else if((gr.tag!==22&&gr.tag!==23||gr.memoizedState===null||gr===V)&&gr.child!==null){gr.child.return=gr,gr=gr.child;continue}if(gr===V)break e;for(;gr.sibling===null;){if(gr.return===null||gr.return===V)break e;_r===gr&&(_r=null),gr=gr.return}_r===gr&&(_r=null),gr.sibling.return=gr.return,gr=gr.sibling}}break;case 19:Xn(K,V),qn(V),oe&4&&Mf(V);break;case 21:break;default:Xn(K,V),qn(V)}}function qn(V){var K=V.flags;if(K&2){try{e:{for(var ne=V.return;ne!==null;){if(Df(ne)){var oe=ne;break e}ne=ne.return}throw Error(L(160))}switch(oe.tag){case 5:var _e=oe.stateNode;oe.flags&32&&(vr(_e,""),oe.flags&=-33);var Re=If(V);Il(V,Re,_e);break;case 3:case 4:var ct=oe.stateNode.containerInfo,Rt=If(V);Dl(V,Rt,ct);break;default:throw Error(L(161))}}catch(Ot){an(V,V.return,Ot)}V.flags&=-3}K&4096&&(V.flags&=-4097)}function ad(V,K,ne){Nr=V,Bf(V)}function Bf(V,K,ne){for(var oe=(V.mode&1)!==0;Nr!==null;){var _e=Nr,Re=_e.child;if(_e.tag===22&&oe){var ct=_e.memoizedState!==null||Ws;if(!ct){var Rt=_e.alternate,Ot=Rt!==null&&Rt.memoizedState!==null||yn;Rt=Ws;var ir=yn;if(Ws=ct,(yn=Ot)&&!ir)for(Nr=_e;Nr!==null;)ct=Nr,Ot=ct.child,ct.tag===22&&ct.memoizedState!==null?Hf(_e):Ot!==null?(Ot.return=ct,Nr=Ot):Hf(_e);for(;Re!==null;)Nr=Re,Bf(Re),Re=Re.sibling;Nr=_e,Ws=Rt,yn=ir}Uf(V)}else(_e.subtreeFlags&8772)!==0&&Re!==null?(Re.return=_e,Nr=Re):Uf(V)}}function Uf(V){for(;Nr!==null;){var K=Nr;if((K.flags&8772)!==0){var ne=K.alternate;try{if((K.flags&8772)!==0)switch(K.tag){case 0:case 11:case 15:yn||Hs(5,K);break;case 1:var oe=K.stateNode;if(K.flags&4&&!yn)if(ne===null)oe.componentDidMount();else{var _e=K.elementType===K.type?ne.memoizedProps:$n(K.type,ne.memoizedProps);oe.componentDidUpdate(_e,ne.memoizedState,oe.__reactInternalSnapshotBeforeUpdate)}var Re=K.updateQueue;Re!==null&&Uu(K,Re,oe);break;case 3:var ct=K.updateQueue;if(ct!==null){if(ne=null,K.child!==null)switch(K.child.tag){case 5:ne=K.child.stateNode;break;case 1:ne=K.child.stateNode}Uu(K,ct,ne)}break;case 5:var Rt=K.stateNode;if(ne===null&&K.flags&4){ne=Rt;var Ot=K.memoizedProps;switch(K.type){case"button":case"input":case"select":case"textarea":Ot.autoFocus&&ne.focus();break;case"img":Ot.src&&(ne.src=Ot.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(K.memoizedState===null){var ir=K.alternate;if(ir!==null){var _r=ir.memoizedState;if(_r!==null){var gr=_r.dehydrated;gr!==null&&wi(gr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}yn||K.flags&512&&Ll(K)}catch(mr){an(K,K.return,mr)}}if(K===V){Nr=null;break}if(ne=K.sibling,ne!==null){ne.return=K.return,Nr=ne;break}Nr=K.return}}function Wf(V){for(;Nr!==null;){var K=Nr;if(K===V){Nr=null;break}var ne=K.sibling;if(ne!==null){ne.return=K.return,Nr=ne;break}Nr=K.return}}function Hf(V){for(;Nr!==null;){var K=Nr;try{switch(K.tag){case 0:case 11:case 15:var ne=K.return;try{Hs(4,K)}catch(Ot){an(K,ne,Ot)}break;case 1:var oe=K.stateNode;if(typeof oe.componentDidMount=="function"){var _e=K.return;try{oe.componentDidMount()}catch(Ot){an(K,_e,Ot)}}var Re=K.return;try{Ll(K)}catch(Ot){an(K,Re,Ot)}break;case 5:var ct=K.return;try{Ll(K)}catch(Ot){an(K,ct,Ot)}}}catch(Ot){an(K,K.return,Ot)}if(K===V){Nr=null;break}var Rt=K.sibling;if(Rt!==null){Rt.return=K.return,Nr=Rt;break}Nr=K.return}}var id=Math.ceil,$s=Le.ReactCurrentDispatcher,Nl=Le.ReactCurrentOwner,On=Le.ReactCurrentBatchConfig,jr=0,pn=null,cn=null,gn=0,Ln=0,ii=pa(0),fn=0,zi=null,Ia=0,zs=0,Ml=0,Xi=null,bn=null,Ol=0,si=1/0,aa=null,Xs=!1,Bl=null,wa=null,Vs=!1,ya=null,js=0,Vi=0,Ul=null,Gs=-1,Ys=0;function Sn(){return(jr&6)!==0?xr():Gs!==-1?Gs:Gs=xr()}function Ea(V){return(V.mode&1)===0?1:(jr&2)!==0&&gn!==0?gn&-gn:$h.transition!==null?(Ys===0&&(Ys=Dc()),Ys):(V=Yr,V!==0||(V=window.event,V=V===void 0?16:$c(V.type)),V)}function Vn(V,K,ne,oe){if(50<Vi)throw Vi=0,Ul=null,Error(L(185));mi(V,ne,oe),((jr&2)===0||V!==pn)&&(V===pn&&((jr&2)===0&&(zs|=ne),fn===4&&Sa(V,gn)),Cn(V,oe),ne===1&&jr===0&&(K.mode&1)===0&&(si=xr()+500,Es&&_a()))}function Cn(V,K){var ne=V.callbackNode;$0(V,K);var oe=ns(V,V===pn?gn:0);if(oe===0)ne!==null&&wr(ne),V.callbackNode=null,V.callbackPriority=0;else if(K=oe&-oe,V.callbackPriority!==K){if(ne!=null&&wr(ne),K===1)V.tag===0?Hh(zf.bind(null,V)):bu(zf.bind(null,V)),Oh(function(){(jr&6)===0&&_a()}),ne=null;else{switch(Ic(oe)){case 1:ne=qr;break;case 4:ne=Jr;break;case 16:ne=sn;break;case 536870912:ne=sa;break;default:ne=sn}ne=Jf(ne,$f.bind(null,V))}V.callbackPriority=K,V.callbackNode=ne}}function $f(V,K){if(Gs=-1,Ys=0,(jr&6)!==0)throw Error(L(327));var ne=V.callbackNode;if(oi()&&V.callbackNode!==ne)return null;var oe=ns(V,V===pn?gn:0);if(oe===0)return null;if((oe&30)!==0||(oe&V.expiredLanes)!==0||K)K=Ks(V,oe);else{K=oe;var _e=jr;jr|=2;var Re=Vf();(pn!==V||gn!==K)&&(aa=null,si=xr()+500,Ma(V,K));do try{ld();break}catch(Rt){Xf(V,Rt)}while(!0);nl(),$s.current=Re,jr=_e,cn!==null?K=0:(pn=null,gn=0,K=fn)}if(K!==0){if(K===2&&(_e=vo(V),_e!==0&&(oe=_e,K=Wl(V,_e))),K===1)throw ne=zi,Ma(V,0),Sa(V,oe),Cn(V,xr()),ne;if(K===6)Sa(V,oe);else{if(_e=V.current.alternate,(oe&30)===0&&!sd(_e)&&(K=Ks(V,oe),K===2&&(Re=vo(V),Re!==0&&(oe=Re,K=Wl(V,Re))),K===1))throw ne=zi,Ma(V,0),Sa(V,oe),Cn(V,xr()),ne;switch(V.finishedWork=_e,V.finishedLanes=oe,K){case 0:case 1:throw Error(L(345));case 2:Oa(V,bn,aa);break;case 3:if(Sa(V,oe),(oe&130023424)===oe&&(K=Ol+500-xr(),10<K)){if(ns(V,0)!==0)break;if(_e=V.suspendedLanes,(_e&oe)!==oe){Sn(),V.pingedLanes|=V.suspendedLanes&_e;break}V.timeoutHandle=jo(Oa.bind(null,V,bn,aa),K);break}Oa(V,bn,aa);break;case 4:if(Sa(V,oe),(oe&4194240)===oe)break;for(K=V.eventTimes,_e=-1;0<oe;){var ct=31-on(oe);Re=1<<ct,ct=K[ct],ct>_e&&(_e=ct),oe&=~Re}if(oe=_e,oe=xr()-oe,oe=(120>oe?120:480>oe?480:1080>oe?1080:1920>oe?1920:3e3>oe?3e3:4320>oe?4320:1960*id(oe/1960))-oe,10<oe){V.timeoutHandle=jo(Oa.bind(null,V,bn,aa),oe);break}Oa(V,bn,aa);break;case 5:Oa(V,bn,aa);break;default:throw Error(L(329))}}}return Cn(V,xr()),V.callbackNode===ne?$f.bind(null,V):null}function Wl(V,K){var ne=Xi;return V.current.memoizedState.isDehydrated&&(Ma(V,K).flags|=256),V=Ks(V,K),V!==2&&(K=bn,bn=ne,K!==null&&Hl(K)),V}function Hl(V){bn===null?bn=V:bn.push.apply(bn,V)}function sd(V){for(var K=V;;){if(K.flags&16384){var ne=K.updateQueue;if(ne!==null&&(ne=ne.stores,ne!==null))for(var oe=0;oe<ne.length;oe++){var _e=ne[oe],Re=_e.getSnapshot;_e=_e.value;try{if(!Wn(Re(),_e))return!1}catch{return!1}}}if(ne=K.child,K.subtreeFlags&16384&&ne!==null)ne.return=K,K=ne;else{if(K===V)break;for(;K.sibling===null;){if(K.return===null||K.return===V)return!0;K=K.return}K.sibling.return=K.return,K=K.sibling}}return!0}function Sa(V,K){for(K&=~Ml,K&=~zs,V.suspendedLanes|=K,V.pingedLanes&=~K,V=V.expirationTimes;0<K;){var ne=31-on(K),oe=1<<ne;V[ne]=-1,K&=~oe}}function zf(V){if((jr&6)!==0)throw Error(L(327));oi();var K=ns(V,0);if((K&1)===0)return Cn(V,xr()),null;var ne=Ks(V,K);if(V.tag!==0&&ne===2){var oe=vo(V);oe!==0&&(K=oe,ne=Wl(V,oe))}if(ne===1)throw ne=zi,Ma(V,0),Sa(V,K),Cn(V,xr()),ne;if(ne===6)throw Error(L(345));return V.finishedWork=V.current.alternate,V.finishedLanes=K,Oa(V,bn,aa),Cn(V,xr()),null}function $l(V,K){var ne=jr;jr|=1;try{return V(K)}finally{jr=ne,jr===0&&(si=xr()+500,Es&&_a())}}function Na(V){ya!==null&&ya.tag===0&&(jr&6)===0&&oi();var K=jr;jr|=1;var ne=On.transition,oe=Yr;try{if(On.transition=null,Yr=1,V)return V()}finally{Yr=oe,On.transition=ne,jr=K,(jr&6)===0&&_a()}}function zl(){Ln=ii.current,en(ii)}function Ma(V,K){V.finishedWork=null,V.finishedLanes=0;var ne=V.timeoutHandle;if(ne!==-1&&(V.timeoutHandle=-1,Mh(ne)),cn!==null)for(ne=cn.return;ne!==null;){var oe=ne;switch(Qo(oe),oe.tag){case 1:oe=oe.type.childContextTypes,oe!=null&&ws();break;case 3:ri(),en(kn),en(xn),fl();break;case 5:cl(oe);break;case 4:ri();break;case 13:en(rn);break;case 19:en(rn);break;case 10:al(oe.type._context);break;case 22:case 23:zl()}ne=ne.return}if(pn=V,cn=V=ka(V.current,null),gn=Ln=K,fn=0,zi=null,Ml=zs=Ia=0,bn=Xi=null,Pa!==null){for(K=0;K<Pa.length;K++)if(ne=Pa[K],oe=ne.interleaved,oe!==null){ne.interleaved=null;var _e=oe.next,Re=ne.pending;if(Re!==null){var ct=Re.next;Re.next=_e,oe.next=ct}ne.pending=oe}Pa=null}return V}function Xf(V,K){do{var ne=cn;try{if(nl(),Ls.current=Ms,Ds){for(var oe=nn.memoizedState;oe!==null;){var _e=oe.queue;_e!==null&&(_e.pending=null),oe=oe.next}Ds=!1}if(Da=0,dn=un=nn=null,Oi=!1,Bi=0,Nl.current=null,ne===null||ne.return===null){fn=1,zi=K,cn=null;break}e:{var Re=V,ct=ne.return,Rt=ne,Ot=K;if(K=gn,Rt.flags|=32768,Ot!==null&&typeof Ot=="object"&&typeof Ot.then=="function"){var ir=Ot,_r=Rt,gr=_r.tag;if((_r.mode&1)===0&&(gr===0||gr===11||gr===15)){var mr=_r.alternate;mr?(_r.updateQueue=mr.updateQueue,_r.memoizedState=mr.memoizedState,_r.lanes=mr.lanes):(_r.updateQueue=null,_r.memoizedState=null)}var Dr=mf(ct);if(Dr!==null){Dr.flags&=-257,_f(Dr,ct,Rt,Re,K),Dr.mode&1&&pf(Re,ir,K),K=Dr,Ot=ir;var Mr=K.updateQueue;if(Mr===null){var Or=new Set;Or.add(Ot),K.updateQueue=Or}else Mr.add(Ot);break e}else{if((K&1)===0){pf(Re,ir,K),Xl();break e}Ot=Error(L(426))}}else if(tn&&Rt.mode&1){var ln=mf(ct);if(ln!==null){(ln.flags&65536)===0&&(ln.flags|=256),_f(ln,ct,Rt,Re,K),tl(ni(Ot,Rt));break e}}Re=Ot=ni(Ot,Rt),fn!==4&&(fn=2),Xi===null?Xi=[Re]:Xi.push(Re),Re=ct;do{switch(Re.tag){case 3:Re.flags|=65536,K&=-K,Re.lanes|=K;var Jt=hf(Re,Ot,K);Bu(Re,Jt);break e;case 1:Rt=Ot;var Wt=Re.type,nr=Re.stateNode;if((Re.flags&128)===0&&(typeof Wt.getDerivedStateFromError=="function"||nr!==null&&typeof nr.componentDidCatch=="function"&&(wa===null||!wa.has(nr)))){Re.flags|=65536,K&=-K,Re.lanes|=K;var Sr=df(Re,Rt,K);Bu(Re,Sr);break e}}Re=Re.return}while(Re!==null)}Gf(ne)}catch(Br){K=Br,cn===ne&&ne!==null&&(cn=ne=ne.return);continue}break}while(!0)}function Vf(){var V=$s.current;return $s.current=Ms,V===null?Ms:V}function Xl(){(fn===0||fn===3||fn===2)&&(fn=4),pn===null||(Ia&268435455)===0&&(zs&268435455)===0||Sa(pn,gn)}function Ks(V,K){var ne=jr;jr|=2;var oe=Vf();(pn!==V||gn!==K)&&(aa=null,Ma(V,K));do try{od();break}catch(_e){Xf(V,_e)}while(!0);if(nl(),jr=ne,$s.current=oe,cn!==null)throw Error(L(261));return pn=null,gn=0,fn}function od(){for(;cn!==null;)jf(cn)}function ld(){for(;cn!==null&&!Lr();)jf(cn)}function jf(V){var K=qf(V.alternate,V,Ln);V.memoizedProps=V.pendingProps,K===null?Gf(V):cn=K,Nl.current=null}function Gf(V){var K=V;do{var ne=K.alternate;if(V=K.return,(K.flags&32768)===0){if(ne=ed(ne,K,Ln),ne!==null){cn=ne;return}}else{if(ne=td(ne,K),ne!==null){ne.flags&=32767,cn=ne;return}if(V!==null)V.flags|=32768,V.subtreeFlags=0,V.deletions=null;else{fn=6,cn=null;return}}if(K=K.sibling,K!==null){cn=K;return}cn=K=V}while(K!==null);fn===0&&(fn=5)}function Oa(V,K,ne){var oe=Yr,_e=On.transition;try{On.transition=null,Yr=1,cd(V,K,ne,oe)}finally{On.transition=_e,Yr=oe}return null}function cd(V,K,ne,oe){do oi();while(ya!==null);if((jr&6)!==0)throw Error(L(327));ne=V.finishedWork;var _e=V.finishedLanes;if(ne===null)return null;if(V.finishedWork=null,V.finishedLanes=0,ne===V.current)throw Error(L(177));V.callbackNode=null,V.callbackPriority=0;var Re=ne.lanes|ne.childLanes;if(z0(V,Re),V===pn&&(cn=pn=null,gn=0),(ne.subtreeFlags&2064)===0&&(ne.flags&2064)===0||Vs||(Vs=!0,Jf(sn,function(){return oi(),null})),Re=(ne.flags&15990)!==0,(ne.subtreeFlags&15990)!==0||Re){Re=On.transition,On.transition=null;var ct=Yr;Yr=1;var Rt=jr;jr|=4,Nl.current=null,nd(V,ne),Of(ne,V),Fh(Xo),ss=!!zo,Xo=zo=null,V.current=ne,ad(ne),Er(),jr=Rt,Yr=ct,On.transition=Re}else V.current=ne;if(Vs&&(Vs=!1,ya=V,js=_e),Re=V.pendingLanes,Re===0&&(wa=null),di(ne.stateNode),Cn(V,xr()),K!==null)for(oe=V.onRecoverableError,ne=0;ne<K.length;ne++)_e=K[ne],oe(_e.value,{componentStack:_e.stack,digest:_e.digest});if(Xs)throw Xs=!1,V=Bl,Bl=null,V;return(js&1)!==0&&V.tag!==0&&oi(),Re=V.pendingLanes,(Re&1)!==0?V===Ul?Vi++:(Vi=0,Ul=V):Vi=0,_a(),null}function oi(){if(ya!==null){var V=Ic(js),K=On.transition,ne=Yr;try{if(On.transition=null,Yr=16>V?16:V,ya===null)var oe=!1;else{if(V=ya,ya=null,js=0,(jr&6)!==0)throw Error(L(331));var _e=jr;for(jr|=4,Nr=V.current;Nr!==null;){var Re=Nr,ct=Re.child;if((Nr.flags&16)!==0){var Rt=Re.deletions;if(Rt!==null){for(var Ot=0;Ot<Rt.length;Ot++){var ir=Rt[Ot];for(Nr=ir;Nr!==null;){var _r=Nr;switch(_r.tag){case 0:case 11:case 15:$i(8,_r,Re)}var gr=_r.child;if(gr!==null)gr.return=_r,Nr=gr;else for(;Nr!==null;){_r=Nr;var mr=_r.sibling,Dr=_r.return;if(Lf(_r),_r===ir){Nr=null;break}if(mr!==null){mr.return=Dr,Nr=mr;break}Nr=Dr}}}var Mr=Re.alternate;if(Mr!==null){var Or=Mr.child;if(Or!==null){Mr.child=null;do{var ln=Or.sibling;Or.sibling=null,Or=ln}while(Or!==null)}}Nr=Re}}if((Re.subtreeFlags&2064)!==0&&ct!==null)ct.return=Re,Nr=ct;else e:for(;Nr!==null;){if(Re=Nr,(Re.flags&2048)!==0)switch(Re.tag){case 0:case 11:case 15:$i(9,Re,Re.return)}var Jt=Re.sibling;if(Jt!==null){Jt.return=Re.return,Nr=Jt;break e}Nr=Re.return}}var Wt=V.current;for(Nr=Wt;Nr!==null;){ct=Nr;var nr=ct.child;if((ct.subtreeFlags&2064)!==0&&nr!==null)nr.return=ct,Nr=nr;else e:for(ct=Wt;Nr!==null;){if(Rt=Nr,(Rt.flags&2048)!==0)try{switch(Rt.tag){case 0:case 11:case 15:Hs(9,Rt)}}catch(Br){an(Rt,Rt.return,Br)}if(Rt===ct){Nr=null;break e}var Sr=Rt.sibling;if(Sr!==null){Sr.return=Rt.return,Nr=Sr;break e}Nr=Rt.return}}if(jr=_e,_a(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(jn,V)}catch{}oe=!0}return oe}finally{Yr=ne,On.transition=K}}return!1}function Yf(V,K,ne){K=ni(ne,K),K=hf(V,K,1),V=xa(V,K,1),K=Sn(),V!==null&&(mi(V,1,K),Cn(V,K))}function an(V,K,ne){if(V.tag===3)Yf(V,V,ne);else for(;K!==null;){if(K.tag===3){Yf(K,V,ne);break}else if(K.tag===1){var oe=K.stateNode;if(typeof K.type.getDerivedStateFromError=="function"||typeof oe.componentDidCatch=="function"&&(wa===null||!wa.has(oe))){V=ni(ne,V),V=df(K,V,1),K=xa(K,V,1),V=Sn(),K!==null&&(mi(K,1,V),Cn(K,V));break}}K=K.return}}function ud(V,K,ne){var oe=V.pingCache;oe!==null&&oe.delete(K),K=Sn(),V.pingedLanes|=V.suspendedLanes&ne,pn===V&&(gn&ne)===ne&&(fn===4||fn===3&&(gn&130023424)===gn&&500>xr()-Ol?Ma(V,0):Ml|=ne),Cn(V,K)}function Kf(V,K){K===0&&((V.mode&1)===0?K=1:(K=rs,rs<<=1,(rs&130023424)===0&&(rs=4194304)));var ne=Sn();V=ta(V,K),V!==null&&(mi(V,K,ne),Cn(V,ne))}function fd(V){var K=V.memoizedState,ne=0;K!==null&&(ne=K.retryLane),Kf(V,ne)}function hd(V,K){var ne=0;switch(V.tag){case 13:var oe=V.stateNode,_e=V.memoizedState;_e!==null&&(ne=_e.retryLane);break;case 19:oe=V.stateNode;break;default:throw Error(L(314))}oe!==null&&oe.delete(K),Kf(V,ne)}var qf;qf=function(V,K,ne){if(V!==null)if(V.memoizedProps!==K.pendingProps||kn.current)Tn=!0;else{if((V.lanes&ne)===0&&(K.flags&128)===0)return Tn=!1,Zh(V,K,ne);Tn=(V.flags&131072)!==0}else Tn=!1,tn&&(K.flags&1048576)!==0&&Cu(K,ks,K.index);switch(K.lanes=0,K.tag){case 2:var oe=K.type;Us(V,K),V=K.pendingProps;var _e=Ka(K,xn.current);ti(K,ne),_e=pl(null,K,oe,V,_e,ne);var Re=ml();return K.flags|=1,typeof _e=="object"&&_e!==null&&typeof _e.render=="function"&&_e.$$typeof===void 0?(K.tag=1,K.memoizedState=null,K.updateQueue=null,An(oe)?(Re=!0,ys(K)):Re=!1,K.memoizedState=_e.state!==null&&_e.state!==void 0?_e.state:null,ol(K),_e.updater=Os,K.stateNode=_e,_e._reactInternals=K,yl(K,oe,V,ne),K=Al(null,K,oe,!0,Re,ne)):(K.tag=0,tn&&Re&&Jo(K),En(null,K,_e,ne),K=K.child),K;case 16:oe=K.elementType;e:{switch(Us(V,K),V=K.pendingProps,_e=oe._init,oe=_e(oe._payload),K.type=oe,_e=K.tag=pd(oe),V=$n(oe,V),_e){case 0:K=kl(null,K,oe,V,ne);break e;case 1:K=Ef(null,K,oe,V,ne);break e;case 11:K=gf(null,K,oe,V,ne);break e;case 14:K=xf(null,K,oe,$n(oe.type,V),ne);break e}throw Error(L(306,oe,""))}return K;case 0:return oe=K.type,_e=K.pendingProps,_e=K.elementType===oe?_e:$n(oe,_e),kl(V,K,oe,_e,ne);case 1:return oe=K.type,_e=K.pendingProps,_e=K.elementType===oe?_e:$n(oe,_e),Ef(V,K,oe,_e,ne);case 3:e:{if(Sf(K),V===null)throw Error(L(387));oe=K.pendingProps,Re=K.memoizedState,_e=Re.element,Ou(V,K),Rs(K,oe,null,ne);var ct=K.memoizedState;if(oe=ct.element,Re.isDehydrated)if(Re={element:oe,isDehydrated:!1,cache:ct.cache,pendingSuspenseBoundaries:ct.pendingSuspenseBoundaries,transitions:ct.transitions},K.updateQueue.baseState=Re,K.memoizedState=Re,K.flags&256){_e=ni(Error(L(423)),K),K=kf(V,K,oe,ne,_e);break e}else if(oe!==_e){_e=ni(Error(L(424)),K),K=kf(V,K,oe,ne,_e);break e}else for(Pn=da(K.stateNode.containerInfo.firstChild),Rn=K,tn=!0,Hn=null,ne=Nu(K,null,oe,ne),K.child=ne;ne;)ne.flags=ne.flags&-3|4096,ne=ne.sibling;else{if(Qa(),oe===_e){K=na(V,K,ne);break e}En(V,K,oe,ne)}K=K.child}return K;case 5:return Wu(K),V===null&&el(K),oe=K.type,_e=K.pendingProps,Re=V!==null?V.memoizedProps:null,ct=_e.children,Vo(oe,_e)?ct=null:Re!==null&&Vo(oe,Re)&&(K.flags|=32),yf(V,K),En(V,K,ct,ne),K.child;case 6:return V===null&&el(K),null;case 13:return Af(V,K,ne);case 4:return ll(K,K.stateNode.containerInfo),oe=K.pendingProps,V===null?K.child=Za(K,null,oe,ne):En(V,K,oe,ne),K.child;case 11:return oe=K.type,_e=K.pendingProps,_e=K.elementType===oe?_e:$n(oe,_e),gf(V,K,oe,_e,ne);case 7:return En(V,K,K.pendingProps,ne),K.child;case 8:return En(V,K,K.pendingProps.children,ne),K.child;case 12:return En(V,K,K.pendingProps.children,ne),K.child;case 10:e:{if(oe=K.type._context,_e=K.pendingProps,Re=K.memoizedProps,ct=_e.value,Qr(bs,oe._currentValue),oe._currentValue=ct,Re!==null)if(Wn(Re.value,ct)){if(Re.children===_e.children&&!kn.current){K=na(V,K,ne);break e}}else for(Re=K.child,Re!==null&&(Re.return=K);Re!==null;){var Rt=Re.dependencies;if(Rt!==null){ct=Re.child;for(var Ot=Rt.firstContext;Ot!==null;){if(Ot.context===oe){if(Re.tag===1){Ot=ra(-1,ne&-ne),Ot.tag=2;var ir=Re.updateQueue;if(ir!==null){ir=ir.shared;var _r=ir.pending;_r===null?Ot.next=Ot:(Ot.next=_r.next,_r.next=Ot),ir.pending=Ot}}Re.lanes|=ne,Ot=Re.alternate,Ot!==null&&(Ot.lanes|=ne),il(Re.return,ne,K),Rt.lanes|=ne;break}Ot=Ot.next}}else if(Re.tag===10)ct=Re.type===K.type?null:Re.child;else if(Re.tag===18){if(ct=Re.return,ct===null)throw Error(L(341));ct.lanes|=ne,Rt=ct.alternate,Rt!==null&&(Rt.lanes|=ne),il(ct,ne,K),ct=Re.sibling}else ct=Re.child;if(ct!==null)ct.return=Re;else for(ct=Re;ct!==null;){if(ct===K){ct=null;break}if(Re=ct.sibling,Re!==null){Re.return=ct.return,ct=Re;break}ct=ct.return}Re=ct}En(V,K,_e.children,ne),K=K.child}return K;case 9:return _e=K.type,oe=K.pendingProps.children,ti(K,ne),_e=Nn(_e),oe=oe(_e),K.flags|=1,En(V,K,oe,ne),K.child;case 14:return oe=K.type,_e=$n(oe,K.pendingProps),_e=$n(oe.type,_e),xf(V,K,oe,_e,ne);case 15:return vf(V,K,K.type,K.pendingProps,ne);case 17:return oe=K.type,_e=K.pendingProps,_e=K.elementType===oe?_e:$n(oe,_e),Us(V,K),K.tag=1,An(oe)?(V=!0,ys(K)):V=!1,ti(K,ne),uf(K,oe,_e),yl(K,oe,_e,ne),Al(null,K,oe,!0,V,ne);case 19:return bf(V,K,ne);case 22:return wf(V,K,ne)}throw Error(L(156,K.tag))};function Jf(V,K){return pr(V,K)}function dd(V,K,ne,oe){this.tag=V,this.key=ne,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=K,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=oe,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(V,K,ne,oe){return new dd(V,K,ne,oe)}function Vl(V){return V=V.prototype,!(!V||!V.isReactComponent)}function pd(V){if(typeof V=="function")return Vl(V)?1:0;if(V!=null){if(V=V.$$typeof,V===De)return 11;if(V===ft)return 14}return 2}function ka(V,K){var ne=V.alternate;return ne===null?(ne=Bn(V.tag,K,V.key,V.mode),ne.elementType=V.elementType,ne.type=V.type,ne.stateNode=V.stateNode,ne.alternate=V,V.alternate=ne):(ne.pendingProps=K,ne.type=V.type,ne.flags=0,ne.subtreeFlags=0,ne.deletions=null),ne.flags=V.flags&14680064,ne.childLanes=V.childLanes,ne.lanes=V.lanes,ne.child=V.child,ne.memoizedProps=V.memoizedProps,ne.memoizedState=V.memoizedState,ne.updateQueue=V.updateQueue,K=V.dependencies,ne.dependencies=K===null?null:{lanes:K.lanes,firstContext:K.firstContext},ne.sibling=V.sibling,ne.index=V.index,ne.ref=V.ref,ne}function qs(V,K,ne,oe,_e,Re){var ct=2;if(oe=V,typeof V=="function")Vl(V)&&(ct=1);else if(typeof V=="string")ct=5;else e:switch(V){case ge:return Ba(ne.children,_e,Re,K);case Ce:ct=8,_e|=8;break;case be:return V=Bn(12,ne,K,_e|2),V.elementType=be,V.lanes=Re,V;case lt:return V=Bn(13,ne,K,_e),V.elementType=lt,V.lanes=Re,V;case Ct:return V=Bn(19,ne,K,_e),V.elementType=Ct,V.lanes=Re,V;case gt:return Js(ne,_e,Re,K);default:if(typeof V=="object"&&V!==null)switch(V.$$typeof){case nt:ct=10;break e;case Ae:ct=9;break e;case De:ct=11;break e;case ft:ct=14;break e;case Et:ct=16,oe=null;break e}throw Error(L(130,V==null?V:typeof V,""))}return K=Bn(ct,ne,K,_e),K.elementType=V,K.type=oe,K.lanes=Re,K}function Ba(V,K,ne,oe){return V=Bn(7,V,oe,K),V.lanes=ne,V}function Js(V,K,ne,oe){return V=Bn(22,V,oe,K),V.elementType=gt,V.lanes=ne,V.stateNode={isHidden:!1},V}function jl(V,K,ne){return V=Bn(6,V,null,K),V.lanes=ne,V}function Gl(V,K,ne){return K=Bn(4,V.children!==null?V.children:[],V.key,K),K.lanes=ne,K.stateNode={containerInfo:V.containerInfo,pendingChildren:null,implementation:V.implementation},K}function md(V,K,ne,oe,_e){this.tag=K,this.containerInfo=V,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wo(0),this.expirationTimes=wo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wo(0),this.identifierPrefix=oe,this.onRecoverableError=_e,this.mutableSourceEagerHydrationData=null}function Yl(V,K,ne,oe,_e,Re,ct,Rt,Ot){return V=new md(V,K,ne,Rt,Ot),K===1?(K=1,Re===!0&&(K|=8)):K=0,Re=Bn(3,null,null,K),V.current=Re,Re.stateNode=V,Re.memoizedState={element:oe,isDehydrated:ne,cache:null,transitions:null,pendingSuspenseBoundaries:null},ol(Re),V}function _d(V,K,ne){var oe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Te,key:oe==null?null:""+oe,children:V,containerInfo:K,implementation:ne}}function Qf(V){if(!V)return ma;V=V._reactInternals;e:{if(yt(V)!==V||V.tag!==1)throw Error(L(170));var K=V;do{switch(K.tag){case 3:K=K.stateNode.context;break e;case 1:if(An(K.type)){K=K.stateNode.__reactInternalMemoizedMergedChildContext;break e}}K=K.return}while(K!==null);throw Error(L(171))}if(V.tag===1){var ne=V.type;if(An(ne))return Au(V,ne,K)}return K}function Zf(V,K,ne,oe,_e,Re,ct,Rt,Ot){return V=Yl(ne,oe,!0,V,_e,Re,ct,Rt,Ot),V.context=Qf(null),ne=V.current,oe=Sn(),_e=Ea(ne),Re=ra(oe,_e),Re.callback=K??null,xa(ne,Re,_e),V.current.lanes=_e,mi(V,_e,oe),Cn(V,oe),V}function Qs(V,K,ne,oe){var _e=K.current,Re=Sn(),ct=Ea(_e);return ne=Qf(ne),K.context===null?K.context=ne:K.pendingContext=ne,K=ra(Re,ct),K.payload={element:V},oe=oe===void 0?null:oe,oe!==null&&(K.callback=oe),V=xa(_e,K,ct),V!==null&&(Vn(V,_e,ct,Re),Fs(V,_e,ct)),ct}function Zs(V){if(V=V.current,!V.child)return null;switch(V.child.tag){case 5:return V.child.stateNode;default:return V.child.stateNode}}function e0(V,K){if(V=V.memoizedState,V!==null&&V.dehydrated!==null){var ne=V.retryLane;V.retryLane=ne!==0&&ne<K?ne:K}}function Kl(V,K){e0(V,K),(V=V.alternate)&&e0(V,K)}function gd(){return null}var t0=typeof reportError=="function"?reportError:function(V){console.error(V)};function ql(V){this._internalRoot=V}eo.prototype.render=ql.prototype.render=function(V){var K=this._internalRoot;if(K===null)throw Error(L(409));Qs(V,K,null,null)},eo.prototype.unmount=ql.prototype.unmount=function(){var V=this._internalRoot;if(V!==null){this._internalRoot=null;var K=V.containerInfo;Na(function(){Qs(null,V,null,null)}),K[Jn]=null}};function eo(V){this._internalRoot=V}eo.prototype.unstable_scheduleHydration=function(V){if(V){var K=Oc();V={blockedOn:null,target:V,priority:K};for(var ne=0;ne<ua.length&&K!==0&&K<ua[ne].priority;ne++);ua.splice(ne,0,V),ne===0&&Wc(V)}};function Jl(V){return!(!V||V.nodeType!==1&&V.nodeType!==9&&V.nodeType!==11)}function to(V){return!(!V||V.nodeType!==1&&V.nodeType!==9&&V.nodeType!==11&&(V.nodeType!==8||V.nodeValue!==" react-mount-point-unstable "))}function r0(){}function xd(V,K,ne,oe,_e){if(_e){if(typeof oe=="function"){var Re=oe;oe=function(){var ir=Zs(ct);Re.call(ir)}}var ct=Zf(K,oe,V,0,null,!1,!1,"",r0);return V._reactRootContainer=ct,V[Jn]=ct.current,Fi(V.nodeType===8?V.parentNode:V),Na(),ct}for(;_e=V.lastChild;)V.removeChild(_e);if(typeof oe=="function"){var Rt=oe;oe=function(){var ir=Zs(Ot);Rt.call(ir)}}var Ot=Yl(V,0,!1,null,null,!1,!1,"",r0);return V._reactRootContainer=Ot,V[Jn]=Ot.current,Fi(V.nodeType===8?V.parentNode:V),Na(function(){Qs(K,Ot,ne,oe)}),Ot}function ro(V,K,ne,oe,_e){var Re=ne._reactRootContainer;if(Re){var ct=Re;if(typeof _e=="function"){var Rt=_e;_e=function(){var Ot=Zs(ct);Rt.call(Ot)}}Qs(K,ct,V,_e)}else ct=xd(ne,K,V,_e,oe);return Zs(ct)}Nc=function(V){switch(V.tag){case 3:var K=V.stateNode;if(K.current.memoizedState.isDehydrated){var ne=pi(K.pendingLanes);ne!==0&&(yo(K,ne|1),Cn(K,xr()),(jr&6)===0&&(si=xr()+500,_a()))}break;case 13:Na(function(){var oe=ta(V,1);if(oe!==null){var _e=Sn();Vn(oe,V,1,_e)}}),Kl(V,1)}},Eo=function(V){if(V.tag===13){var K=ta(V,134217728);if(K!==null){var ne=Sn();Vn(K,V,134217728,ne)}Kl(V,134217728)}},Mc=function(V){if(V.tag===13){var K=Ea(V),ne=ta(V,K);if(ne!==null){var oe=Sn();Vn(ne,V,K,oe)}Kl(V,K)}},Oc=function(){return Yr},Bc=function(V,K){var ne=Yr;try{return Yr=V,K()}finally{Yr=ne}},Ur=function(V,K,ne){switch(K){case"input":if(Ft(V,ne),K=ne.name,ne.type==="radio"&&K!=null){for(ne=V;ne.parentNode;)ne=ne.parentNode;for(ne=ne.querySelectorAll("input[name="+JSON.stringify(""+K)+'][type="radio"]'),K=0;K<ne.length;K++){var oe=ne[K];if(oe!==V&&oe.form===V.form){var _e=vs(oe);if(!_e)throw Error(L(90));it(oe),Ft(oe,_e)}}}break;case"textarea":ar(V,ne);break;case"select":K=ne.value,K!=null&&Bt(V,!!ne.multiple,K,!1)}},yr=$l,St=Na;var vd={usingClientEntryPoint:!1,Events:[Li,Ga,vs,Cr,Fr,$l]},ji={findFiberByHostInstance:ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wd={bundleType:ji.bundleType,version:ji.version,rendererPackageName:ji.rendererPackageName,rendererConfig:ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Le.ReactCurrentDispatcher,findHostInstanceByFiber:function(V){return V=jt(V),V===null?null:V.stateNode},findFiberByHostInstance:ji.findFiberByHostInstance||gd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var no=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!no.isDisabled&&no.supportsFiber)try{jn=no.inject(wd),hn=no}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vd,reactDom_production_min.createPortal=function(V,K){var ne=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jl(K))throw Error(L(200));return _d(V,K,null,ne)},reactDom_production_min.createRoot=function(V,K){if(!Jl(V))throw Error(L(299));var ne=!1,oe="",_e=t0;return K!=null&&(K.unstable_strictMode===!0&&(ne=!0),K.identifierPrefix!==void 0&&(oe=K.identifierPrefix),K.onRecoverableError!==void 0&&(_e=K.onRecoverableError)),K=Yl(V,1,!1,null,null,ne,!1,oe,_e),V[Jn]=K.current,Fi(V.nodeType===8?V.parentNode:V),new ql(K)},reactDom_production_min.findDOMNode=function(V){if(V==null)return null;if(V.nodeType===1)return V;var K=V._reactInternals;if(K===void 0)throw typeof V.render=="function"?Error(L(188)):(V=Object.keys(V).join(","),Error(L(268,V)));return V=jt(K),V=V===null?null:V.stateNode,V},reactDom_production_min.flushSync=function(V){return Na(V)},reactDom_production_min.hydrate=function(V,K,ne){if(!to(K))throw Error(L(200));return ro(null,V,K,!0,ne)},reactDom_production_min.hydrateRoot=function(V,K,ne){if(!Jl(V))throw Error(L(405));var oe=ne!=null&&ne.hydratedSources||null,_e=!1,Re="",ct=t0;if(ne!=null&&(ne.unstable_strictMode===!0&&(_e=!0),ne.identifierPrefix!==void 0&&(Re=ne.identifierPrefix),ne.onRecoverableError!==void 0&&(ct=ne.onRecoverableError)),K=Zf(K,null,V,1,ne??null,_e,!1,Re,ct),V[Jn]=K.current,Fi(V),oe)for(V=0;V<oe.length;V++)ne=oe[V],_e=ne._getVersion,_e=_e(ne._source),K.mutableSourceEagerHydrationData==null?K.mutableSourceEagerHydrationData=[ne,_e]:K.mutableSourceEagerHydrationData.push(ne,_e);return new eo(K)},reactDom_production_min.render=function(V,K,ne){if(!to(K))throw Error(L(200));return ro(null,V,K,!1,ne)},reactDom_production_min.unmountComponentAtNode=function(V){if(!to(V))throw Error(L(40));return V._reactRootContainer?(Na(function(){ro(null,null,V,!1,function(){V._reactRootContainer=null,V[Jn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=$l,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(V,K,ne,oe){if(!to(ne))throw Error(L(200));if(V==null||V._reactInternals===void 0)throw Error(L(38));return ro(V,K,ne,!1,oe)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(A){console.error(A)}}return g(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var g=requireReactDom();return client.createRoot=g.createRoot,client.hydrateRoot=g.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);var dist={},hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.parse=J,dist.serialize=se;const g=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,A=/^[\u0021-\u003A\u003C-\u007E]*$/,L=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,B=/^[\u0020-\u003A\u003D-\u007E]*$/,W=Object.prototype.toString,q=(()=>{const pe=function(){};return pe.prototype=Object.create(null),pe})();function J(pe,he){const ue=new q,ce=pe.length;if(ce<2)return ue;const fe=(he==null?void 0:he.decode)||ie;let me=0;do{const ke=pe.indexOf("=",me);if(ke===-1)break;const xe=pe.indexOf(";",me),Le=xe===-1?ce:xe;if(ke>Le){me=pe.lastIndexOf(";",ke-1)+1;continue}const Se=re(pe,me,ke),Te=ae(pe,ke,Se),ge=pe.slice(Se,Te);if(ue[ge]===void 0){let Ce=re(pe,ke+1,Le),be=ae(pe,Le,Ce);const nt=fe(pe.slice(Ce,be));ue[ge]=nt}me=Le+1}while(me<ce);return ue}function re(pe,he,ue){do{const ce=pe.charCodeAt(he);if(ce!==32&&ce!==9)return he}while(++he<ue);return ue}function ae(pe,he,ue){for(;he>ue;){const ce=pe.charCodeAt(--he);if(ce!==32&&ce!==9)return he+1}return ue}function se(pe,he,ue){const ce=(ue==null?void 0:ue.encode)||encodeURIComponent;if(!g.test(pe))throw new TypeError(`argument name is invalid: ${pe}`);const fe=ce(he);if(!A.test(fe))throw new TypeError(`argument val is invalid: ${he}`);let me=pe+"="+fe;if(!ue)return me;if(ue.maxAge!==void 0){if(!Number.isInteger(ue.maxAge))throw new TypeError(`option maxAge is invalid: ${ue.maxAge}`);me+="; Max-Age="+ue.maxAge}if(ue.domain){if(!L.test(ue.domain))throw new TypeError(`option domain is invalid: ${ue.domain}`);me+="; Domain="+ue.domain}if(ue.path){if(!B.test(ue.path))throw new TypeError(`option path is invalid: ${ue.path}`);me+="; Path="+ue.path}if(ue.expires){if(!le(ue.expires)||!Number.isFinite(ue.expires.valueOf()))throw new TypeError(`option expires is invalid: ${ue.expires}`);me+="; Expires="+ue.expires.toUTCString()}if(ue.httpOnly&&(me+="; HttpOnly"),ue.secure&&(me+="; Secure"),ue.partitioned&&(me+="; Partitioned"),ue.priority)switch(typeof ue.priority=="string"?ue.priority.toLowerCase():void 0){case"low":me+="; Priority=Low";break;case"medium":me+="; Priority=Medium";break;case"high":me+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${ue.priority}`)}if(ue.sameSite)switch(typeof ue.sameSite=="string"?ue.sameSite.toLowerCase():ue.sameSite){case!0:case"strict":me+="; SameSite=Strict";break;case"lax":me+="; SameSite=Lax";break;case"none":me+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${ue.sameSite}`)}return me}function ie(pe){if(pe.indexOf("%")===-1)return pe;try{return decodeURIComponent(pe)}catch{return pe}}function le(pe){return W.call(pe)==="[object Date]"}return dist}requireDist();var PopStateEventType="popstate";function createBrowserHistory(g={}){function A(B,W){let{pathname:q,search:J,hash:re}=B.location;return createLocation("",{pathname:q,search:J,hash:re},W.state&&W.state.usr||null,W.state&&W.state.key||"default")}function L(B,W){return typeof W=="string"?W:createPath(W)}return getUrlBasedHistory(A,L,null,g)}function invariant(g,A){if(g===!1||g===null||typeof g>"u")throw new Error(A)}function warning(g,A){if(!g){typeof console<"u"&&console.warn(A);try{throw new Error(A)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(g,A){return{usr:g.state,key:g.key,idx:A}}function createLocation(g,A,L=null,B){return{pathname:typeof g=="string"?g:g.pathname,search:"",hash:"",...typeof A=="string"?parsePath(A):A,state:L,key:A&&A.key||B||createKey()}}function createPath({pathname:g="/",search:A="",hash:L=""}){return A&&A!=="?"&&(g+=A.charAt(0)==="?"?A:"?"+A),L&&L!=="#"&&(g+=L.charAt(0)==="#"?L:"#"+L),g}function parsePath(g){let A={};if(g){let L=g.indexOf("#");L>=0&&(A.hash=g.substring(L),g=g.substring(0,L));let B=g.indexOf("?");B>=0&&(A.search=g.substring(B),g=g.substring(0,B)),g&&(A.pathname=g)}return A}function getUrlBasedHistory(g,A,L,B={}){let{window:W=document.defaultView,v5Compat:q=!1}=B,J=W.history,re="POP",ae=null,se=ie();se==null&&(se=0,J.replaceState({...J.state,idx:se},""));function ie(){return(J.state||{idx:null}).idx}function le(){re="POP";let fe=ie(),me=fe==null?null:fe-se;se=fe,ae&&ae({action:re,location:ce.location,delta:me})}function pe(fe,me){re="PUSH";let ke=createLocation(ce.location,fe,me);se=ie()+1;let xe=getHistoryState(ke,se),Le=ce.createHref(ke);try{J.pushState(xe,"",Le)}catch(Se){if(Se instanceof DOMException&&Se.name==="DataCloneError")throw Se;W.location.assign(Le)}q&&ae&&ae({action:re,location:ce.location,delta:1})}function he(fe,me){re="REPLACE";let ke=createLocation(ce.location,fe,me);se=ie();let xe=getHistoryState(ke,se),Le=ce.createHref(ke);J.replaceState(xe,"",Le),q&&ae&&ae({action:re,location:ce.location,delta:0})}function ue(fe){let me=W.location.origin!=="null"?W.location.origin:W.location.href,ke=typeof fe=="string"?fe:createPath(fe);return ke=ke.replace(/ $/,"%20"),invariant(me,`No window.location.(origin|href) available to create URL for href: ${ke}`),new URL(ke,me)}let ce={get action(){return re},get location(){return g(W,J)},listen(fe){if(ae)throw new Error("A history only accepts one active listener");return W.addEventListener(PopStateEventType,le),ae=fe,()=>{W.removeEventListener(PopStateEventType,le),ae=null}},createHref(fe){return A(W,fe)},createURL:ue,encodeLocation(fe){let me=ue(fe);return{pathname:me.pathname,search:me.search,hash:me.hash}},push:pe,replace:he,go(fe){return J.go(fe)}};return ce}function matchRoutes(g,A,L="/"){return matchRoutesImpl(g,A,L,!1)}function matchRoutesImpl(g,A,L,B){let W=typeof A=="string"?parsePath(A):A,q=stripBasename(W.pathname||"/",L);if(q==null)return null;let J=flattenRoutes(g);rankRouteBranches(J);let re=null;for(let ae=0;re==null&&ae<J.length;++ae){let se=decodePath(q);re=matchRouteBranch(J[ae],se,B)}return re}function flattenRoutes(g,A=[],L=[],B=""){let W=(q,J,re)=>{let ae={relativePath:re===void 0?q.path||"":re,caseSensitive:q.caseSensitive===!0,childrenIndex:J,route:q};ae.relativePath.startsWith("/")&&(invariant(ae.relativePath.startsWith(B),`Absolute route path "${ae.relativePath}" nested under path "${B}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),ae.relativePath=ae.relativePath.slice(B.length));let se=joinPaths([B,ae.relativePath]),ie=L.concat(ae);q.children&&q.children.length>0&&(invariant(q.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${se}".`),flattenRoutes(q.children,A,ie,se)),!(q.path==null&&!q.index)&&A.push({path:se,score:computeScore(se,q.index),routesMeta:ie})};return g.forEach((q,J)=>{var re;if(q.path===""||!((re=q.path)!=null&&re.includes("?")))W(q,J);else for(let ae of explodeOptionalSegments(q.path))W(q,J,ae)}),A}function explodeOptionalSegments(g){let A=g.split("/");if(A.length===0)return[];let[L,...B]=A,W=L.endsWith("?"),q=L.replace(/\?$/,"");if(B.length===0)return W?[q,""]:[q];let J=explodeOptionalSegments(B.join("/")),re=[];return re.push(...J.map(ae=>ae===""?q:[q,ae].join("/"))),W&&re.push(...J),re.map(ae=>g.startsWith("/")&&ae===""?"/":ae)}function rankRouteBranches(g){g.sort((A,L)=>A.score!==L.score?L.score-A.score:compareIndexes(A.routesMeta.map(B=>B.childrenIndex),L.routesMeta.map(B=>B.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=g=>g==="*";function computeScore(g,A){let L=g.split("/"),B=L.length;return L.some(isSplat)&&(B+=splatPenalty),A&&(B+=indexRouteValue),L.filter(W=>!isSplat(W)).reduce((W,q)=>W+(paramRe.test(q)?dynamicSegmentValue:q===""?emptySegmentValue:staticSegmentValue),B)}function compareIndexes(g,A){return g.length===A.length&&g.slice(0,-1).every((B,W)=>B===A[W])?g[g.length-1]-A[A.length-1]:0}function matchRouteBranch(g,A,L=!1){let{routesMeta:B}=g,W={},q="/",J=[];for(let re=0;re<B.length;++re){let ae=B[re],se=re===B.length-1,ie=q==="/"?A:A.slice(q.length)||"/",le=matchPath({path:ae.relativePath,caseSensitive:ae.caseSensitive,end:se},ie),pe=ae.route;if(!le&&se&&L&&!B[B.length-1].route.index&&(le=matchPath({path:ae.relativePath,caseSensitive:ae.caseSensitive,end:!1},ie)),!le)return null;Object.assign(W,le.params),J.push({params:W,pathname:joinPaths([q,le.pathname]),pathnameBase:normalizePathname(joinPaths([q,le.pathnameBase])),route:pe}),le.pathnameBase!=="/"&&(q=joinPaths([q,le.pathnameBase]))}return J}function matchPath(g,A){typeof g=="string"&&(g={path:g,caseSensitive:!1,end:!0});let[L,B]=compilePath(g.path,g.caseSensitive,g.end),W=A.match(L);if(!W)return null;let q=W[0],J=q.replace(/(.)\/+$/,"$1"),re=W.slice(1);return{params:B.reduce((se,{paramName:ie,isOptional:le},pe)=>{if(ie==="*"){let ue=re[pe]||"";J=q.slice(0,q.length-ue.length).replace(/(.)\/+$/,"$1")}const he=re[pe];return le&&!he?se[ie]=void 0:se[ie]=(he||"").replace(/%2F/g,"/"),se},{}),pathname:q,pathnameBase:J,pattern:g}}function compilePath(g,A=!1,L=!0){warning(g==="*"||!g.endsWith("*")||g.endsWith("/*"),`Route path "${g}" will be treated as if it were "${g.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${g.replace(/\*$/,"/*")}".`);let B=[],W="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(J,re,ae)=>(B.push({paramName:re,isOptional:ae!=null}),ae?"/?([^\\/]+)?":"/([^\\/]+)"));return g.endsWith("*")?(B.push({paramName:"*"}),W+=g==="*"||g==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):L?W+="\\/*$":g!==""&&g!=="/"&&(W+="(?:(?=\\/|$))"),[new RegExp(W,A?void 0:"i"),B]}function decodePath(g){try{return g.split("/").map(A=>decodeURIComponent(A).replace(/\//g,"%2F")).join("/")}catch(A){return warning(!1,`The URL path "${g}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${A}).`),g}}function stripBasename(g,A){if(A==="/")return g;if(!g.toLowerCase().startsWith(A.toLowerCase()))return null;let L=A.endsWith("/")?A.length-1:A.length,B=g.charAt(L);return B&&B!=="/"?null:g.slice(L)||"/"}function resolvePath(g,A="/"){let{pathname:L,search:B="",hash:W=""}=typeof g=="string"?parsePath(g):g;return{pathname:L?L.startsWith("/")?L:resolvePathname(L,A):A,search:normalizeSearch(B),hash:normalizeHash(W)}}function resolvePathname(g,A){let L=A.replace(/\/+$/,"").split("/");return g.split("/").forEach(W=>{W===".."?L.length>1&&L.pop():W!=="."&&L.push(W)}),L.length>1?L.join("/"):"/"}function getInvalidPathError(g,A,L,B){return`Cannot include a '${g}' character in a manually specified \`to.${A}\` field [${JSON.stringify(B)}].  Please separate it out to the \`to.${L}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(g){return g.filter((A,L)=>L===0||A.route.path&&A.route.path.length>0)}function getResolveToMatches(g){let A=getPathContributingMatches(g);return A.map((L,B)=>B===A.length-1?L.pathname:L.pathnameBase)}function resolveTo(g,A,L,B=!1){let W;typeof g=="string"?W=parsePath(g):(W={...g},invariant(!W.pathname||!W.pathname.includes("?"),getInvalidPathError("?","pathname","search",W)),invariant(!W.pathname||!W.pathname.includes("#"),getInvalidPathError("#","pathname","hash",W)),invariant(!W.search||!W.search.includes("#"),getInvalidPathError("#","search","hash",W)));let q=g===""||W.pathname==="",J=q?"/":W.pathname,re;if(J==null)re=L;else{let le=A.length-1;if(!B&&J.startsWith("..")){let pe=J.split("/");for(;pe[0]==="..";)pe.shift(),le-=1;W.pathname=pe.join("/")}re=le>=0?A[le]:"/"}let ae=resolvePath(W,re),se=J&&J!=="/"&&J.endsWith("/"),ie=(q||J===".")&&L.endsWith("/");return!ae.pathname.endsWith("/")&&(se||ie)&&(ae.pathname+="/"),ae}var joinPaths=g=>g.join("/").replace(/\/\/+/g,"/"),normalizePathname=g=>g.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=g=>!g||g==="?"?"":g.startsWith("?")?g:"?"+g,normalizeHash=g=>!g||g==="#"?"":g.startsWith("#")?g:"#"+g;function isRouteErrorResponse(g){return g!=null&&typeof g.status=="number"&&typeof g.statusText=="string"&&typeof g.internal=="boolean"&&"data"in g}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(g,{relative:A}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:L,navigator:B}=reactExports.useContext(NavigationContext),{hash:W,pathname:q,search:J}=useResolvedPath(g,{relative:A}),re=q;return L!=="/"&&(re=q==="/"?L:joinPaths([L,q])),B.createHref({pathname:re,search:J,hash:W})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(g){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(g)}function useNavigate(){let{isDataRoute:g}=reactExports.useContext(RouteContext);return g?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let g=reactExports.useContext(DataRouterContext),{basename:A,navigator:L}=reactExports.useContext(NavigationContext),{matches:B}=reactExports.useContext(RouteContext),{pathname:W}=useLocation(),q=JSON.stringify(getResolveToMatches(B)),J=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{J.current=!0}),reactExports.useCallback((ae,se={})=>{if(warning(J.current,navigateEffectWarning),!J.current)return;if(typeof ae=="number"){L.go(ae);return}let ie=resolveTo(ae,JSON.parse(q),W,se.relative==="path");g==null&&A!=="/"&&(ie.pathname=ie.pathname==="/"?A:joinPaths([A,ie.pathname])),(se.replace?L.replace:L.push)(ie,se.state,se)},[A,L,q,W,g])}reactExports.createContext(null);function useResolvedPath(g,{relative:A}={}){let{matches:L}=reactExports.useContext(RouteContext),{pathname:B}=useLocation(),W=JSON.stringify(getResolveToMatches(L));return reactExports.useMemo(()=>resolveTo(g,JSON.parse(W),B,A==="path"),[g,W,B,A])}function useRoutes(g,A){return useRoutesImpl(g,A)}function useRoutesImpl(g,A,L,B){var ke;invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:W,static:q}=reactExports.useContext(NavigationContext),{matches:J}=reactExports.useContext(RouteContext),re=J[J.length-1],ae=re?re.params:{},se=re?re.pathname:"/",ie=re?re.pathnameBase:"/",le=re&&re.route;{let xe=le&&le.path||"";warningOnce(se,!le||xe.endsWith("*")||xe.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${se}" (under <Route path="${xe}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${xe}"> to <Route path="${xe==="/"?"*":`${xe}/*`}">.`)}let pe=useLocation(),he;if(A){let xe=typeof A=="string"?parsePath(A):A;invariant(ie==="/"||((ke=xe.pathname)==null?void 0:ke.startsWith(ie)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ie}" but pathname "${xe.pathname}" was given in the \`location\` prop.`),he=xe}else he=pe;let ue=he.pathname||"/",ce=ue;if(ie!=="/"){let xe=ie.replace(/^\//,"").split("/");ce="/"+ue.replace(/^\//,"").split("/").slice(xe.length).join("/")}let fe=!q&&L&&L.matches&&L.matches.length>0?L.matches:matchRoutes(g,{pathname:ce});warning(le||fe!=null,`No routes matched location "${he.pathname}${he.search}${he.hash}" `),warning(fe==null||fe[fe.length-1].route.element!==void 0||fe[fe.length-1].route.Component!==void 0||fe[fe.length-1].route.lazy!==void 0,`Matched leaf route at location "${he.pathname}${he.search}${he.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let me=_renderMatches(fe&&fe.map(xe=>Object.assign({},xe,{params:Object.assign({},ae,xe.params),pathname:joinPaths([ie,W.encodeLocation?W.encodeLocation(xe.pathname).pathname:xe.pathname]),pathnameBase:xe.pathnameBase==="/"?ie:joinPaths([ie,W.encodeLocation?W.encodeLocation(xe.pathnameBase).pathname:xe.pathnameBase])})),J,L,B);return A&&me?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...he},navigationType:"POP"}},me):me}function DefaultErrorComponent(){let g=useRouteError(),A=isRouteErrorResponse(g)?`${g.status} ${g.statusText}`:g instanceof Error?g.message:JSON.stringify(g),L=g instanceof Error?g.stack:null,B="rgba(200,200,200, 0.5)",W={padding:"0.5rem",backgroundColor:B},q={padding:"2px 4px",backgroundColor:B},J=null;return console.error("Error handled by React Router default ErrorBoundary:",g),J=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:q},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:q},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},A),L?reactExports.createElement("pre",{style:W},L):null,J)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(g){super(g),this.state={location:g.location,revalidation:g.revalidation,error:g.error}}static getDerivedStateFromError(g){return{error:g}}static getDerivedStateFromProps(g,A){return A.location!==g.location||A.revalidation!=="idle"&&g.revalidation==="idle"?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:g.error!==void 0?g.error:A.error,location:A.location,revalidation:g.revalidation||A.revalidation}}componentDidCatch(g,A){console.error("React Router caught the following error during render",g,A)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:g,match:A,children:L}){let B=reactExports.useContext(DataRouterContext);return B&&B.static&&B.staticContext&&(A.route.errorElement||A.route.ErrorBoundary)&&(B.staticContext._deepestRenderedBoundaryId=A.route.id),reactExports.createElement(RouteContext.Provider,{value:g},L)}function _renderMatches(g,A=[],L=null,B=null){if(g==null){if(!L)return null;if(L.errors)g=L.matches;else if(A.length===0&&!L.initialized&&L.matches.length>0)g=L.matches;else return null}let W=g,q=L==null?void 0:L.errors;if(q!=null){let ae=W.findIndex(se=>se.route.id&&(q==null?void 0:q[se.route.id])!==void 0);invariant(ae>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(q).join(",")}`),W=W.slice(0,Math.min(W.length,ae+1))}let J=!1,re=-1;if(L)for(let ae=0;ae<W.length;ae++){let se=W[ae];if((se.route.HydrateFallback||se.route.hydrateFallbackElement)&&(re=ae),se.route.id){let{loaderData:ie,errors:le}=L,pe=se.route.loader&&!ie.hasOwnProperty(se.route.id)&&(!le||le[se.route.id]===void 0);if(se.route.lazy||pe){J=!0,re>=0?W=W.slice(0,re+1):W=[W[0]];break}}}return W.reduceRight((ae,se,ie)=>{let le,pe=!1,he=null,ue=null;L&&(le=q&&se.route.id?q[se.route.id]:void 0,he=se.route.errorElement||defaultErrorElement,J&&(re<0&&ie===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),pe=!0,ue=null):re===ie&&(pe=!0,ue=se.route.hydrateFallbackElement||null)));let ce=A.concat(W.slice(0,ie+1)),fe=()=>{let me;return le?me=he:pe?me=ue:se.route.Component?me=reactExports.createElement(se.route.Component,null):se.route.element?me=se.route.element:me=ae,reactExports.createElement(RenderedRoute,{match:se,routeContext:{outlet:ae,matches:ce,isDataRoute:L!=null},children:me})};return L&&(se.route.ErrorBoundary||se.route.errorElement||ie===0)?reactExports.createElement(RenderErrorBoundary,{location:L.location,revalidation:L.revalidation,component:he,error:le,children:fe(),routeContext:{outlet:null,matches:ce,isDataRoute:!0}}):fe()},null)}function getDataRouterConsoleError(g){return`${g} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(g){let A=reactExports.useContext(DataRouterContext);return invariant(A,getDataRouterConsoleError(g)),A}function useDataRouterState(g){let A=reactExports.useContext(DataRouterStateContext);return invariant(A,getDataRouterConsoleError(g)),A}function useRouteContext(g){let A=reactExports.useContext(RouteContext);return invariant(A,getDataRouterConsoleError(g)),A}function useCurrentRouteId(g){let A=useRouteContext(g),L=A.matches[A.matches.length-1];return invariant(L.route.id,`${g} can only be used on routes that contain a unique "id"`),L.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var B;let g=reactExports.useContext(RouteErrorContext),A=useDataRouterState("useRouteError"),L=useCurrentRouteId("useRouteError");return g!==void 0?g:(B=A.errors)==null?void 0:B[L]}function useNavigateStable(){let{router:g}=useDataRouterContext("useNavigate"),A=useCurrentRouteId("useNavigate"),L=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{L.current=!0}),reactExports.useCallback(async(W,q={})=>{warning(L.current,navigateEffectWarning),L.current&&(typeof W=="number"?g.navigate(W):await g.navigate(W,{fromRouteId:A,...q}))},[g,A])}var alreadyWarned={};function warningOnce(g,A,L){!A&&!alreadyWarned[g]&&(alreadyWarned[g]=!0,warning(!1,L))}reactExports.memo(DataRoutes);function DataRoutes({routes:g,future:A,state:L}){return useRoutesImpl(g,void 0,L,A)}function Route(g){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:g="/",children:A=null,location:L,navigationType:B="POP",navigator:W,static:q=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let J=g.replace(/^\/*/,"/"),re=reactExports.useMemo(()=>({basename:J,navigator:W,static:q,future:{}}),[J,W,q]);typeof L=="string"&&(L=parsePath(L));let{pathname:ae="/",search:se="",hash:ie="",state:le=null,key:pe="default"}=L,he=reactExports.useMemo(()=>{let ue=stripBasename(ae,J);return ue==null?null:{location:{pathname:ue,search:se,hash:ie,state:le,key:pe},navigationType:B}},[J,ae,se,ie,le,pe,B]);return warning(he!=null,`<Router basename="${J}"> is not able to match the URL "${ae}${se}${ie}" because it does not start with the basename, so the <Router> won't render anything.`),he==null?null:reactExports.createElement(NavigationContext.Provider,{value:re},reactExports.createElement(LocationContext.Provider,{children:A,value:he}))}function Routes({children:g,location:A}){return useRoutes(createRoutesFromChildren(g),A)}function createRoutesFromChildren(g,A=[]){let L=[];return reactExports.Children.forEach(g,(B,W)=>{if(!reactExports.isValidElement(B))return;let q=[...A,W];if(B.type===reactExports.Fragment){L.push.apply(L,createRoutesFromChildren(B.props.children,q));return}invariant(B.type===Route,`[${typeof B.type=="string"?B.type:B.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!B.props.index||!B.props.children,"An index route cannot have child routes.");let J={id:B.props.id||q.join("-"),caseSensitive:B.props.caseSensitive,element:B.props.element,Component:B.props.Component,index:B.props.index,path:B.props.path,loader:B.props.loader,action:B.props.action,hydrateFallbackElement:B.props.hydrateFallbackElement,HydrateFallback:B.props.HydrateFallback,errorElement:B.props.errorElement,ErrorBoundary:B.props.ErrorBoundary,hasErrorBoundary:B.props.hasErrorBoundary===!0||B.props.ErrorBoundary!=null||B.props.errorElement!=null,shouldRevalidate:B.props.shouldRevalidate,handle:B.props.handle,lazy:B.props.lazy};B.props.children&&(J.children=createRoutesFromChildren(B.props.children,q)),L.push(J)}),L}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(g){return g!=null&&typeof g.tagName=="string"}function isButtonElement(g){return isHtmlElement(g)&&g.tagName.toLowerCase()==="button"}function isFormElement(g){return isHtmlElement(g)&&g.tagName.toLowerCase()==="form"}function isInputElement(g){return isHtmlElement(g)&&g.tagName.toLowerCase()==="input"}function isModifiedEvent(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}function shouldProcessLinkClick(g,A){return g.button===0&&(!A||A==="_self")&&!isModifiedEvent(g)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(g){return g!=null&&!supportedFormEncTypes.has(g)?(warning(!1,`"${g}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):g}function getFormSubmissionInfo(g,A){let L,B,W,q,J;if(isFormElement(g)){let re=g.getAttribute("action");B=re?stripBasename(re,A):null,L=g.getAttribute("method")||defaultMethod,W=getFormEncType(g.getAttribute("enctype"))||defaultEncType,q=new FormData(g)}else if(isButtonElement(g)||isInputElement(g)&&(g.type==="submit"||g.type==="image")){let re=g.form;if(re==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let ae=g.getAttribute("formaction")||re.getAttribute("action");if(B=ae?stripBasename(ae,A):null,L=g.getAttribute("formmethod")||re.getAttribute("method")||defaultMethod,W=getFormEncType(g.getAttribute("formenctype"))||getFormEncType(re.getAttribute("enctype"))||defaultEncType,q=new FormData(re,g),!isFormDataSubmitterSupported()){let{name:se,type:ie,value:le}=g;if(ie==="image"){let pe=se?`${se}.`:"";q.append(`${pe}x`,"0"),q.append(`${pe}y`,"0")}else se&&q.append(se,le)}}else{if(isHtmlElement(g))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');L=defaultMethod,B=null,W=defaultEncType,J=g}return q&&W==="text/plain"&&(J=q,q=void 0),{action:B,method:L.toLowerCase(),encType:W,formData:q,body:J}}function invariant2(g,A){if(g===!1||g===null||typeof g>"u")throw new Error(A)}async function loadRouteModule(g,A){if(g.id in A)return A[g.id];try{let L=await import(g.module);return A[g.id]=L,L}catch(L){return console.error(`Error loading route module \`${g.module}\`, reloading page...`),console.error(L),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(g){return g==null?!1:g.href==null?g.rel==="preload"&&typeof g.imageSrcSet=="string"&&typeof g.imageSizes=="string":typeof g.rel=="string"&&typeof g.href=="string"}async function getKeyedPrefetchLinks(g,A,L){let B=await Promise.all(g.map(async W=>{let q=A.routes[W.route.id];if(q){let J=await loadRouteModule(q,L);return J.links?J.links():[]}return[]}));return dedupeLinkDescriptors(B.flat(1).filter(isHtmlLinkDescriptor).filter(W=>W.rel==="stylesheet"||W.rel==="preload").map(W=>W.rel==="stylesheet"?{...W,rel:"prefetch",as:"style"}:{...W,rel:"prefetch"}))}function getNewMatchesForLinks(g,A,L,B,W,q){let J=(ae,se)=>L[se]?ae.route.id!==L[se].route.id:!0,re=(ae,se)=>{var ie;return L[se].pathname!==ae.pathname||((ie=L[se].route.path)==null?void 0:ie.endsWith("*"))&&L[se].params["*"]!==ae.params["*"]};return q==="assets"?A.filter((ae,se)=>J(ae,se)||re(ae,se)):q==="data"?A.filter((ae,se)=>{var le;let ie=B.routes[ae.route.id];if(!ie||!ie.hasLoader)return!1;if(J(ae,se)||re(ae,se))return!0;if(ae.route.shouldRevalidate){let pe=ae.route.shouldRevalidate({currentUrl:new URL(W.pathname+W.search+W.hash,window.origin),currentParams:((le=L[0])==null?void 0:le.params)||{},nextUrl:new URL(g,window.origin),nextParams:ae.params,defaultShouldRevalidate:!0});if(typeof pe=="boolean")return pe}return!0}):[]}function getModuleLinkHrefs(g,A,{includeHydrateFallback:L}={}){return dedupeHrefs(g.map(B=>{let W=A.routes[B.route.id];if(!W)return[];let q=[W.module];return W.clientActionModule&&(q=q.concat(W.clientActionModule)),W.clientLoaderModule&&(q=q.concat(W.clientLoaderModule)),L&&W.hydrateFallbackModule&&(q=q.concat(W.hydrateFallbackModule)),W.imports&&(q=q.concat(W.imports)),q}).flat(1))}function dedupeHrefs(g){return[...new Set(g)]}function sortKeys(g){let A={},L=Object.keys(g).sort();for(let B of L)A[B]=g[B];return A}function dedupeLinkDescriptors(g,A){let L=new Set;return new Set(A),g.reduce((B,W)=>{let q=JSON.stringify(sortKeys(W));return L.has(q)||(L.add(q),B.push({key:q,link:W})),B},[])}var NO_BODY_STATUS_CODES=new Set([100,101,204,205]);function singleFetchUrl(g,A){let L=typeof g=="string"?new URL(g,typeof window>"u"?"server://singlefetch/":window.location.origin):g;return L.pathname==="/"?L.pathname="_root.data":A&&stripBasename(L.pathname,A)==="/"?L.pathname=`${A.replace(/\/$/,"")}/_root.data`:L.pathname=`${L.pathname.replace(/\/$/,"")}.data`,L}function useDataRouterContext2(){let g=reactExports.useContext(DataRouterContext);return invariant2(g,"You must render this element inside a <DataRouterContext.Provider> element"),g}function useDataRouterStateContext(){let g=reactExports.useContext(DataRouterStateContext);return invariant2(g,"You must render this element inside a <DataRouterStateContext.Provider> element"),g}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let g=reactExports.useContext(FrameworkContext);return invariant2(g,"You must render this element inside a <HydratedRouter> element"),g}function usePrefetchBehavior(g,A){let L=reactExports.useContext(FrameworkContext),[B,W]=reactExports.useState(!1),[q,J]=reactExports.useState(!1),{onFocus:re,onBlur:ae,onMouseEnter:se,onMouseLeave:ie,onTouchStart:le}=A,pe=reactExports.useRef(null);reactExports.useEffect(()=>{if(g==="render"&&J(!0),g==="viewport"){let ce=me=>{me.forEach(ke=>{J(ke.isIntersecting)})},fe=new IntersectionObserver(ce,{threshold:.5});return pe.current&&fe.observe(pe.current),()=>{fe.disconnect()}}},[g]),reactExports.useEffect(()=>{if(B){let ce=setTimeout(()=>{J(!0)},100);return()=>{clearTimeout(ce)}}},[B]);let he=()=>{W(!0)},ue=()=>{W(!1),J(!1)};return L?g!=="intent"?[q,pe,{}]:[q,pe,{onFocus:composeEventHandlers(re,he),onBlur:composeEventHandlers(ae,ue),onMouseEnter:composeEventHandlers(se,he),onMouseLeave:composeEventHandlers(ie,ue),onTouchStart:composeEventHandlers(le,he)}]:[!1,pe,{}]}function composeEventHandlers(g,A){return L=>{g&&g(L),L.defaultPrevented||A(L)}}function PrefetchPageLinks({page:g,...A}){let{router:L}=useDataRouterContext2(),B=reactExports.useMemo(()=>matchRoutes(L.routes,g,L.basename),[L.routes,g,L.basename]);return B?reactExports.createElement(PrefetchPageLinksImpl,{page:g,matches:B,...A}):null}function useKeyedPrefetchLinks(g){let{manifest:A,routeModules:L}=useFrameworkContext(),[B,W]=reactExports.useState([]);return reactExports.useEffect(()=>{let q=!1;return getKeyedPrefetchLinks(g,A,L).then(J=>{q||W(J)}),()=>{q=!0}},[g,A,L]),B}function PrefetchPageLinksImpl({page:g,matches:A,...L}){let B=useLocation(),{manifest:W,routeModules:q}=useFrameworkContext(),{basename:J}=useDataRouterContext2(),{loaderData:re,matches:ae}=useDataRouterStateContext(),se=reactExports.useMemo(()=>getNewMatchesForLinks(g,A,ae,W,B,"data"),[g,A,ae,W,B]),ie=reactExports.useMemo(()=>getNewMatchesForLinks(g,A,ae,W,B,"assets"),[g,A,ae,W,B]),le=reactExports.useMemo(()=>{if(g===B.pathname+B.search+B.hash)return[];let ue=new Set,ce=!1;if(A.forEach(me=>{var xe;let ke=W.routes[me.route.id];!ke||!ke.hasLoader||(!se.some(Le=>Le.route.id===me.route.id)&&me.route.id in re&&((xe=q[me.route.id])!=null&&xe.shouldRevalidate)||ke.hasClientLoader?ce=!0:ue.add(me.route.id))}),ue.size===0)return[];let fe=singleFetchUrl(g,J);return ce&&ue.size>0&&fe.searchParams.set("_routes",A.filter(me=>ue.has(me.route.id)).map(me=>me.route.id).join(",")),[fe.pathname+fe.search]},[J,re,B,W,se,A,g,q]),pe=reactExports.useMemo(()=>getModuleLinkHrefs(ie,W),[ie,W]),he=useKeyedPrefetchLinks(ie);return reactExports.createElement(reactExports.Fragment,null,le.map(ue=>reactExports.createElement("link",{key:ue,rel:"prefetch",as:"fetch",href:ue,...L})),pe.map(ue=>reactExports.createElement("link",{key:ue,rel:"modulepreload",href:ue,...L})),he.map(({key:ue,link:ce})=>reactExports.createElement("link",{key:ue,...ce})))}function mergeRefs(...g){return A=>{g.forEach(L=>{typeof L=="function"?L(A):L!=null&&(L.current=A)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.5.2")}catch{}function BrowserRouter({basename:g,children:A,window:L}){let B=reactExports.useRef();B.current==null&&(B.current=createBrowserHistory({window:L,v5Compat:!0}));let W=B.current,[q,J]=reactExports.useState({action:W.action,location:W.location}),re=reactExports.useCallback(ae=>{reactExports.startTransition(()=>J(ae))},[J]);return reactExports.useLayoutEffect(()=>W.listen(re),[W,re]),reactExports.createElement(Router,{basename:g,children:A,location:q.location,navigationType:q.action,navigator:W})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:A,discover:L="render",prefetch:B="none",relative:W,reloadDocument:q,replace:J,state:re,target:ae,to:se,preventScrollReset:ie,viewTransition:le,...pe},he){let{basename:ue}=reactExports.useContext(NavigationContext),ce=typeof se=="string"&&ABSOLUTE_URL_REGEX2.test(se),fe,me=!1;if(typeof se=="string"&&ce&&(fe=se,isBrowser))try{let be=new URL(window.location.href),nt=se.startsWith("//")?new URL(be.protocol+se):new URL(se),Ae=stripBasename(nt.pathname,ue);nt.origin===be.origin&&Ae!=null?se=Ae+nt.search+nt.hash:me=!0}catch{warning(!1,`<Link to="${se}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ke=useHref(se,{relative:W}),[xe,Le,Se]=usePrefetchBehavior(B,pe),Te=useLinkClickHandler(se,{replace:J,state:re,target:ae,preventScrollReset:ie,relative:W,viewTransition:le});function ge(be){A&&A(be),be.defaultPrevented||Te(be)}let Ce=reactExports.createElement("a",{...pe,...Se,href:fe||ke,onClick:me||q?A:ge,ref:mergeRefs(he,Le),target:ae,"data-discover":!ce&&L==="render"?"true":void 0});return xe&&!ce?reactExports.createElement(reactExports.Fragment,null,Ce,reactExports.createElement(PrefetchPageLinks,{page:ke})):Ce});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":A="page",caseSensitive:L=!1,className:B="",end:W=!1,style:q,to:J,viewTransition:re,children:ae,...se},ie){let le=useResolvedPath(J,{relative:se.relative}),pe=useLocation(),he=reactExports.useContext(DataRouterStateContext),{navigator:ue,basename:ce}=reactExports.useContext(NavigationContext),fe=he!=null&&useViewTransitionState(le)&&re===!0,me=ue.encodeLocation?ue.encodeLocation(le).pathname:le.pathname,ke=pe.pathname,xe=he&&he.navigation&&he.navigation.location?he.navigation.location.pathname:null;L||(ke=ke.toLowerCase(),xe=xe?xe.toLowerCase():null,me=me.toLowerCase()),xe&&ce&&(xe=stripBasename(xe,ce)||xe);const Le=me!=="/"&&me.endsWith("/")?me.length-1:me.length;let Se=ke===me||!W&&ke.startsWith(me)&&ke.charAt(Le)==="/",Te=xe!=null&&(xe===me||!W&&xe.startsWith(me)&&xe.charAt(me.length)==="/"),ge={isActive:Se,isPending:Te,isTransitioning:fe},Ce=Se?A:void 0,be;typeof B=="function"?be=B(ge):be=[B,Se?"active":null,Te?"pending":null,fe?"transitioning":null].filter(Boolean).join(" ");let nt=typeof q=="function"?q(ge):q;return reactExports.createElement(Link,{...se,"aria-current":Ce,className:be,ref:ie,style:nt,to:J,viewTransition:re},typeof ae=="function"?ae(ge):ae)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:g="render",fetcherKey:A,navigate:L,reloadDocument:B,replace:W,state:q,method:J=defaultMethod,action:re,onSubmit:ae,relative:se,preventScrollReset:ie,viewTransition:le,...pe},he)=>{let ue=useSubmit(),ce=useFormAction(re,{relative:se}),fe=J.toLowerCase()==="get"?"get":"post",me=typeof re=="string"&&ABSOLUTE_URL_REGEX2.test(re),ke=xe=>{if(ae&&ae(xe),xe.defaultPrevented)return;xe.preventDefault();let Le=xe.nativeEvent.submitter,Se=(Le==null?void 0:Le.getAttribute("formmethod"))||J;ue(Le||xe.currentTarget,{fetcherKey:A,method:Se,navigate:L,replace:W,state:q,relative:se,preventScrollReset:ie,viewTransition:le})};return reactExports.createElement("form",{ref:he,method:fe,action:ce,onSubmit:B?ae:ke,...pe,"data-discover":!me&&g==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(g){return`${g} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(g){let A=reactExports.useContext(DataRouterContext);return invariant(A,getDataRouterConsoleError2(g)),A}function useLinkClickHandler(g,{target:A,replace:L,state:B,preventScrollReset:W,relative:q,viewTransition:J}={}){let re=useNavigate(),ae=useLocation(),se=useResolvedPath(g,{relative:q});return reactExports.useCallback(ie=>{if(shouldProcessLinkClick(ie,A)){ie.preventDefault();let le=L!==void 0?L:createPath(ae)===createPath(se);re(g,{replace:le,state:B,preventScrollReset:W,relative:q,viewTransition:J})}},[ae,re,se,L,B,A,g,W,q,J])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:g}=useDataRouterContext3("useSubmit"),{basename:A}=reactExports.useContext(NavigationContext),L=useRouteId();return reactExports.useCallback(async(B,W={})=>{let{action:q,method:J,encType:re,formData:ae,body:se}=getFormSubmissionInfo(B,A);if(W.navigate===!1){let ie=W.fetcherKey||getUniqueFetcherId();await g.fetch(ie,L,W.action||q,{preventScrollReset:W.preventScrollReset,formData:ae,body:se,formMethod:W.method||J,formEncType:W.encType||re,flushSync:W.flushSync})}else await g.navigate(W.action||q,{preventScrollReset:W.preventScrollReset,formData:ae,body:se,formMethod:W.method||J,formEncType:W.encType||re,replace:W.replace,state:W.state,fromRouteId:L,flushSync:W.flushSync,viewTransition:W.viewTransition})},[g,A,L])}function useFormAction(g,{relative:A}={}){let{basename:L}=reactExports.useContext(NavigationContext),B=reactExports.useContext(RouteContext);invariant(B,"useFormAction must be used inside a RouteContext");let[W]=B.matches.slice(-1),q={...useResolvedPath(g||".",{relative:A})},J=useLocation();if(g==null){q.search=J.search;let re=new URLSearchParams(q.search),ae=re.getAll("index");if(ae.some(ie=>ie==="")){re.delete("index"),ae.filter(le=>le).forEach(le=>re.append("index",le));let ie=re.toString();q.search=ie?`?${ie}`:""}}return(!g||g===".")&&W.route.index&&(q.search=q.search?q.search.replace(/^\?/,"?index&"):"?index"),L!=="/"&&(q.pathname=q.pathname==="/"?L:joinPaths([L,q.pathname])),createPath(q)}function useViewTransitionState(g,A={}){let L=reactExports.useContext(ViewTransitionContext);invariant(L!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:B}=useDataRouterContext3("useViewTransitionState"),W=useResolvedPath(g,{relative:A.relative});if(!L.isTransitioning)return!1;let q=stripBasename(L.currentLocation.pathname,B)||L.currentLocation.pathname,J=stripBasename(L.nextLocation.pathname,B)||L.nextLocation.pathname;return matchPath(W.pathname,J)!=null||matchPath(W.pathname,q)!=null}new TextEncoder;[...NO_BODY_STATUS_CODES];var reactDomExports=requireReactDom();/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=g=>g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(g,A)=>{const L=reactExports.forwardRef(({color:B="currentColor",size:W=24,strokeWidth:q=2,absoluteStrokeWidth:J,className:re="",children:ae,...se},ie)=>reactExports.createElement("svg",{ref:ie,...defaultAttributes,width:W,height:W,stroke:B,strokeWidth:J?Number(q)*24/Number(W):q,className:["lucide",`lucide-${toKebabCase(g)}`,re].join(" "),...se},[...A.map(([le,pe])=>reactExports.createElement(le,pe)),...(Array.isArray(ae)?ae:[ae])||[]]));return L.displayName=`${g}`,L};/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BookOpen=createLucideIcon("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lock=createLucideIcon("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pen=createLucideIcon("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pencil=createLucideIcon("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const School=createLucideIcon("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash2=createLucideIcon("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const User=createLucideIcon("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X$1=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function TelaInicial(){const g=useNavigate(),[A,L]=reactExports.useState(""),[B,W]=reactExports.useState(""),[q,J]=reactExports.useState(""),re=ae=>{ae.preventDefault(),g("/principal")};return React.createElement("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-r from-blue-400 to-indigo-600"},React.createElement("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md"},React.createElement("img",{src:"/LOGO_EDUCA_MELHOR.jpeg",alt:"Logo Educa.Melhor",className:"h-24 w-auto mx-auto mb-6"}),React.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center"},"Login Plataforma Educa.Melhor"),React.createElement("form",{onSubmit:re,className:"space-y-4"},React.createElement("div",null,React.createElement("label",{className:"block text-gray-700 mb-1"},"Escola"),React.createElement("div",{className:"flex items-center border border-gray-300 rounded"},React.createElement(School,{className:"ml-2 text-gray-500"}),React.createElement("select",{className:"w-full px-3 py-2 focus:outline-none",value:A,onChange:ae=>L(ae.target.value)},React.createElement("option",{value:"",disabled:!0},"Selecione sua escola"),React.createElement("option",{value:"escola1"},"Escola A"),React.createElement("option",{value:"escola2"},"Escola B")))),React.createElement("div",null,React.createElement("label",{className:"block text-gray-700 mb-1"},"Usuário"),React.createElement("div",{className:"flex items-center border border-gray-300 rounded"},React.createElement(User,{className:"ml-2 text-gray-500"}),React.createElement("input",{type:"text",className:"w-full px-3 py-2 focus:outline-none",placeholder:"Digite seu usuário",value:B,onChange:ae=>W(ae.target.value)}))),React.createElement("div",null,React.createElement("label",{className:"block text-gray-700 mb-1"},"Senha"),React.createElement("div",{className:"flex items-center border border-gray-300 rounded"},React.createElement(Lock,{className:"ml-2 text-gray-500"}),React.createElement("input",{type:"password",className:"w-full px-3 py-2 focus:outline-none",placeholder:"Digite sua senha",value:q,onChange:ae=>J(ae.target.value)}))),React.createElement("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700 transition"},"Entrar"))))}var i$3=Object.defineProperty,d$5=(g,A,L)=>A in g?i$3(g,A,{enumerable:!0,configurable:!0,writable:!0,value:L}):g[A]=L,r$3=(g,A,L)=>(d$5(g,typeof A!="symbol"?A+"":A,L),L);let o$5=class{constructor(){r$3(this,"current",this.detect()),r$3(this,"handoffState","pending"),r$3(this,"currentId",0)}set(A){this.current!==A&&(this.handoffState="pending",this.currentId=0,this.current=A)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},s$7=new o$5,l$4=(g,A)=>{s$7.isServer?reactExports.useEffect(g,A):reactExports.useLayoutEffect(g,A)};function s$6(g){let A=reactExports.useRef(g);return l$4(()=>{A.current=g},[g]),A}let o$4=function(g){let A=s$6(g);return React.useCallback((...L)=>A.current(...L),[A])};function t$6(g){typeof queueMicrotask=="function"?queueMicrotask(g):Promise.resolve().then(g).catch(A=>setTimeout(()=>{throw A}))}function o$3(){let g=[],A={addEventListener(L,B,W,q){return L.addEventListener(B,W,q),A.add(()=>L.removeEventListener(B,W,q))},requestAnimationFrame(...L){let B=requestAnimationFrame(...L);return A.add(()=>cancelAnimationFrame(B))},nextFrame(...L){return A.requestAnimationFrame(()=>A.requestAnimationFrame(...L))},setTimeout(...L){let B=setTimeout(...L);return A.add(()=>clearTimeout(B))},microTask(...L){let B={current:!0};return t$6(()=>{B.current&&L[0]()}),A.add(()=>{B.current=!1})},style(L,B,W){let q=L.style.getPropertyValue(B);return Object.assign(L.style,{[B]:W}),this.add(()=>{Object.assign(L.style,{[B]:q})})},group(L){let B=o$3();return L(B),this.add(()=>B.dispose())},add(L){return g.push(L),()=>{let B=g.indexOf(L);if(B>=0)for(let W of g.splice(B,1))W()}},dispose(){for(let L of g.splice(0))L()}};return A}function p$3(){let[g]=reactExports.useState(o$3);return reactExports.useEffect(()=>()=>g.dispose(),[g]),g}function s$5(){let g=typeof document>"u";return"useSyncExternalStore"in e$1?(A=>A.useSyncExternalStore)(e$1)(()=>()=>{},()=>!1,()=>!g):!1}function l$3(){let g=s$5(),[A,L]=reactExports.useState(s$7.isHandoffComplete);return A&&s$7.isHandoffComplete===!1&&L(!1),reactExports.useEffect(()=>{A!==!0&&L(!0)},[A]),reactExports.useEffect(()=>s$7.handoff(),[]),g?!1:A}var o$2;let I$4=(o$2=React.useId)!=null?o$2:function(){let g=l$3(),[A,L]=React.useState(g?()=>s$7.nextId():null);return l$4(()=>{A===null&&L(s$7.nextId())},[A]),A!=null?""+A:void 0};function u$5(g,A,...L){if(g in A){let W=A[g];return typeof W=="function"?W(...L):W}let B=new Error(`Tried to handle "${g}" but there is no handler defined. Only defined handlers are: ${Object.keys(A).map(W=>`"${W}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(B,u$5),B}function o$1(g){return s$7.isServer?null:g instanceof Node?g.ownerDocument:g!=null&&g.hasOwnProperty("current")&&g.current instanceof Node?g.current.ownerDocument:document}let c$3=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(g=>`${g}:not([tabindex='-1'])`).join(",");var M=(g=>(g[g.First=1]="First",g[g.Previous=2]="Previous",g[g.Next=4]="Next",g[g.Last=8]="Last",g[g.WrapAround=16]="WrapAround",g[g.NoScroll=32]="NoScroll",g))(M||{}),N$2=(g=>(g[g.Error=0]="Error",g[g.Overflow=1]="Overflow",g[g.Success=2]="Success",g[g.Underflow=3]="Underflow",g))(N$2||{}),F$2=(g=>(g[g.Previous=-1]="Previous",g[g.Next=1]="Next",g))(F$2||{});function f$4(g=document.body){return g==null?[]:Array.from(g.querySelectorAll(c$3)).sort((A,L)=>Math.sign((A.tabIndex||Number.MAX_SAFE_INTEGER)-(L.tabIndex||Number.MAX_SAFE_INTEGER)))}var T$1=(g=>(g[g.Strict=0]="Strict",g[g.Loose=1]="Loose",g))(T$1||{});function h$2(g,A=0){var L;return g===((L=o$1(g))==null?void 0:L.body)?!1:u$5(A,{0(){return g.matches(c$3)},1(){let B=g;for(;B!==null;){if(B.matches(c$3))return!0;B=B.parentElement}return!1}})}var w$1=(g=>(g[g.Keyboard=0]="Keyboard",g[g.Mouse=1]="Mouse",g))(w$1||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",g=>{g.metaKey||g.altKey||g.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",g=>{g.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:g.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function y$3(g){g==null||g.focus({preventScroll:!0})}let S$4=["textarea","input"].join(",");function H(g){var A,L;return(L=(A=g==null?void 0:g.matches)==null?void 0:A.call(g,S$4))!=null?L:!1}function I$3(g,A=L=>L){return g.slice().sort((L,B)=>{let W=A(L),q=A(B);if(W===null||q===null)return 0;let J=W.compareDocumentPosition(q);return J&Node.DOCUMENT_POSITION_FOLLOWING?-1:J&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function O$1(g,A,{sorted:L=!0,relativeTo:B=null,skipElements:W=[]}={}){let q=Array.isArray(g)?g.length>0?g[0].ownerDocument:document:g.ownerDocument,J=Array.isArray(g)?L?I$3(g):g:f$4(g);W.length>0&&J.length>1&&(J=J.filter(he=>!W.includes(he))),B=B??q.activeElement;let re=(()=>{if(A&5)return 1;if(A&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),ae=(()=>{if(A&1)return 0;if(A&2)return Math.max(0,J.indexOf(B))-1;if(A&4)return Math.max(0,J.indexOf(B))+1;if(A&8)return J.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),se=A&32?{preventScroll:!0}:{},ie=0,le=J.length,pe;do{if(ie>=le||ie+le<=0)return 0;let he=ae+ie;if(A&16)he=(he+le)%le;else{if(he<0)return 3;if(he>=le)return 1}pe=J[he],pe==null||pe.focus(se),ie+=re}while(pe!==q.activeElement);return A&6&&H(pe)&&pe.select(),2}function t$5(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function i$2(){return/Android/gi.test(window.navigator.userAgent)}function n$3(){return t$5()||i$2()}function d$4(g,A,L){let B=s$6(A);reactExports.useEffect(()=>{function W(q){B.current(q)}return document.addEventListener(g,W,L),()=>document.removeEventListener(g,W,L)},[g,L])}function s$4(g,A,L){let B=s$6(A);reactExports.useEffect(()=>{function W(q){B.current(q)}return window.addEventListener(g,W,L),()=>window.removeEventListener(g,W,L)},[g,L])}function y$2(g,A,L=!0){let B=reactExports.useRef(!1);reactExports.useEffect(()=>{requestAnimationFrame(()=>{B.current=L})},[L]);function W(J,re){if(!B.current||J.defaultPrevented)return;let ae=re(J);if(ae===null||!ae.getRootNode().contains(ae)||!ae.isConnected)return;let se=function ie(le){return typeof le=="function"?ie(le()):Array.isArray(le)||le instanceof Set?le:[le]}(g);for(let ie of se){if(ie===null)continue;let le=ie instanceof HTMLElement?ie:ie.current;if(le!=null&&le.contains(ae)||J.composed&&J.composedPath().includes(le))return}return!h$2(ae,T$1.Loose)&&ae.tabIndex!==-1&&J.preventDefault(),A(J,ae)}let q=reactExports.useRef(null);d$4("pointerdown",J=>{var re,ae;B.current&&(q.current=((ae=(re=J.composedPath)==null?void 0:re.call(J))==null?void 0:ae[0])||J.target)},!0),d$4("mousedown",J=>{var re,ae;B.current&&(q.current=((ae=(re=J.composedPath)==null?void 0:re.call(J))==null?void 0:ae[0])||J.target)},!0),d$4("click",J=>{n$3()||q.current&&(W(J,()=>q.current),q.current=null)},!0),d$4("touchend",J=>W(J,()=>J.target instanceof HTMLElement?J.target:null),!0),s$4("blur",J=>W(J,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function n$2(...g){return reactExports.useMemo(()=>o$1(...g),[...g])}let u$4=Symbol();function T(g,A=!0){return Object.assign(g,{[u$4]:A})}function y$1(...g){let A=reactExports.useRef(g);reactExports.useEffect(()=>{A.current=g},[g]);let L=o$4(B=>{for(let W of A.current)W!=null&&(typeof W=="function"?W(B):W.current=B)});return g.every(B=>B==null||(B==null?void 0:B[u$4]))?void 0:L}function m$2(g,A){let L=reactExports.useRef([]),B=o$4(g);reactExports.useEffect(()=>{let W=[...L.current];for(let[q,J]of A.entries())if(L.current[q]!==J){let re=B(A,W);return L.current=A,re}},[B,...A])}function t$4(...g){return Array.from(new Set(g.flatMap(A=>typeof A=="string"?A.split(" "):[]))).filter(Boolean).join(" ")}var O=(g=>(g[g.None=0]="None",g[g.RenderStrategy=1]="RenderStrategy",g[g.Static=2]="Static",g))(O||{}),v=(g=>(g[g.Unmount=0]="Unmount",g[g.Hidden=1]="Hidden",g))(v||{});function C({ourProps:g,theirProps:A,slot:L,defaultTag:B,features:W,visible:q=!0,name:J,mergeRefs:re}){re=re??k;let ae=R(A,g);if(q)return m$1(ae,L,B,J,re);let se=W??0;if(se&2){let{static:ie=!1,...le}=ae;if(ie)return m$1(le,L,B,J,re)}if(se&1){let{unmount:ie=!0,...le}=ae;return u$5(ie?0:1,{0(){return null},1(){return m$1({...le,hidden:!0,style:{display:"none"}},L,B,J,re)}})}return m$1(ae,L,B,J,re)}function m$1(g,A={},L,B,W){let{as:q=L,children:J,refName:re="ref",...ae}=F$1(g,["unmount","static"]),se=g.ref!==void 0?{[re]:g.ref}:{},ie=typeof J=="function"?J(A):J;"className"in ae&&ae.className&&typeof ae.className=="function"&&(ae.className=ae.className(A));let le={};if(A){let pe=!1,he=[];for(let[ue,ce]of Object.entries(A))typeof ce=="boolean"&&(pe=!0),ce===!0&&he.push(ue);pe&&(le["data-headlessui-state"]=he.join(" "))}if(q===reactExports.Fragment&&Object.keys(x$1(ae)).length>0){if(!reactExports.isValidElement(ie)||Array.isArray(ie)&&ie.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${B} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(ae).map(ce=>`  - ${ce}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(ce=>`  - ${ce}`).join(`
`)].join(`
`));let pe=ie.props,he=typeof(pe==null?void 0:pe.className)=="function"?(...ce)=>t$4(pe==null?void 0:pe.className(...ce),ae.className):t$4(pe==null?void 0:pe.className,ae.className),ue=he?{className:he}:{};return reactExports.cloneElement(ie,Object.assign({},R(ie.props,x$1(F$1(ae,["ref"]))),le,se,{ref:W(ie.ref,se.ref)},ue))}return reactExports.createElement(q,Object.assign({},F$1(ae,["ref"]),q!==reactExports.Fragment&&se,q!==reactExports.Fragment&&le),ie)}function k(...g){return g.every(A=>A==null)?void 0:A=>{for(let L of g)L!=null&&(typeof L=="function"?L(A):L.current=A)}}function R(...g){if(g.length===0)return{};if(g.length===1)return g[0];let A={},L={};for(let B of g)for(let W in B)W.startsWith("on")&&typeof B[W]=="function"?(L[W]!=null||(L[W]=[]),L[W].push(B[W])):A[W]=B[W];if(A.disabled||A["aria-disabled"])return Object.assign(A,Object.fromEntries(Object.keys(L).map(B=>[B,void 0])));for(let B in L)Object.assign(A,{[B](W,...q){let J=L[B];for(let re of J){if((W instanceof Event||(W==null?void 0:W.nativeEvent)instanceof Event)&&W.defaultPrevented)return;re(W,...q)}}});return A}function U$1(g){var A;return Object.assign(reactExports.forwardRef(g),{displayName:(A=g.displayName)!=null?A:g.name})}function x$1(g){let A=Object.assign({},g);for(let L in A)A[L]===void 0&&delete A[L];return A}function F$1(g,A=[]){let L=Object.assign({},g);for(let B of A)B in L&&delete L[B];return L}let p$2="div";var s$3=(g=>(g[g.None=1]="None",g[g.Focusable=2]="Focusable",g[g.Hidden=4]="Hidden",g))(s$3||{});function l$2(g,A){var L;let{features:B=1,...W}=g,q={ref:A,"aria-hidden":(B&2)===2?!0:(L=W["aria-hidden"])!=null?L:void 0,hidden:(B&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(B&4)===4&&(B&2)!==2&&{display:"none"}}};return C({ourProps:q,theirProps:W,slot:{},defaultTag:p$2,name:"Hidden"})}let u$3=U$1(l$2),n$1=reactExports.createContext(null);n$1.displayName="OpenClosedContext";var d$3=(g=>(g[g.Open=1]="Open",g[g.Closed=2]="Closed",g[g.Closing=4]="Closing",g[g.Opening=8]="Opening",g))(d$3||{});function u$2(){return reactExports.useContext(n$1)}function t$3(g){function A(){document.readyState!=="loading"&&(g(),document.removeEventListener("DOMContentLoaded",A))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",A),A())}let t$2=[];t$3(()=>{function g(A){A.target instanceof HTMLElement&&A.target!==document.body&&t$2[0]!==A.target&&(t$2.unshift(A.target),t$2=t$2.filter(L=>L!=null&&L.isConnected),t$2.splice(10))}window.addEventListener("click",g,{capture:!0}),window.addEventListener("mousedown",g,{capture:!0}),window.addEventListener("focus",g,{capture:!0}),document.body.addEventListener("click",g,{capture:!0}),document.body.addEventListener("mousedown",g,{capture:!0}),document.body.addEventListener("focus",g,{capture:!0})});function r$2(g){let A=g.parentElement,L=null;for(;A&&!(A instanceof HTMLFieldSetElement);)A instanceof HTMLLegendElement&&(L=A),A=A.parentElement;let B=(A==null?void 0:A.getAttribute("disabled"))==="";return B&&i$1(L)?!1:B}function i$1(g){if(!g)return!1;let A=g.previousElementSibling;for(;A!==null;){if(A instanceof HTMLLegendElement)return!1;A=A.previousElementSibling}return!0}var o=(g=>(g.Space=" ",g.Enter="Enter",g.Escape="Escape",g.Backspace="Backspace",g.Delete="Delete",g.ArrowLeft="ArrowLeft",g.ArrowUp="ArrowUp",g.ArrowRight="ArrowRight",g.ArrowDown="ArrowDown",g.Home="Home",g.End="End",g.PageUp="PageUp",g.PageDown="PageDown",g.Tab="Tab",g))(o||{});function E(g,A,L,B){let W=s$6(L);reactExports.useEffect(()=>{g=g??window;function q(J){W.current(J)}return g.addEventListener(A,q,B),()=>g.removeEventListener(A,q,B)},[g,A,B])}function f$3(){let g=reactExports.useRef(!1);return l$4(()=>(g.current=!0,()=>{g.current=!1}),[]),g}function c$2(g){let A=o$4(g),L=reactExports.useRef(!1);reactExports.useEffect(()=>(L.current=!1,()=>{L.current=!0,t$6(()=>{L.current&&A()})}),[A])}var s$2=(g=>(g[g.Forwards=0]="Forwards",g[g.Backwards=1]="Backwards",g))(s$2||{});function n(){let g=reactExports.useRef(0);return s$4("keydown",A=>{A.key==="Tab"&&(g.current=A.shiftKey?1:0)},!0),g}function P(g){if(!g)return new Set;if(typeof g=="function")return new Set(g());let A=new Set;for(let L of g.current)L.current instanceof HTMLElement&&A.add(L.current);return A}let X="div";var _$1=(g=>(g[g.None=1]="None",g[g.InitialFocus=2]="InitialFocus",g[g.TabLock=4]="TabLock",g[g.FocusLock=8]="FocusLock",g[g.RestoreFocus=16]="RestoreFocus",g[g.All=30]="All",g))(_$1||{});function z(g,A){let L=reactExports.useRef(null),B=y$1(L,A),{initialFocus:W,containers:q,features:J=30,...re}=g;l$3()||(J=1);let ae=n$2(L);Y({ownerDocument:ae},!!(J&16));let se=Z({ownerDocument:ae,container:L,initialFocus:W},!!(J&2));$$1({ownerDocument:ae,container:L,containers:q,previousActiveElement:se},!!(J&8));let ie=n(),le=o$4(ce=>{let fe=L.current;fe&&(me=>me())(()=>{u$5(ie.current,{[s$2.Forwards]:()=>{O$1(fe,M.First,{skipElements:[ce.relatedTarget]})},[s$2.Backwards]:()=>{O$1(fe,M.Last,{skipElements:[ce.relatedTarget]})}})})}),pe=p$3(),he=reactExports.useRef(!1),ue={ref:B,onKeyDown(ce){ce.key=="Tab"&&(he.current=!0,pe.requestAnimationFrame(()=>{he.current=!1}))},onBlur(ce){let fe=P(q);L.current instanceof HTMLElement&&fe.add(L.current);let me=ce.relatedTarget;me instanceof HTMLElement&&me.dataset.headlessuiFocusGuard!=="true"&&(S$3(fe,me)||(he.current?O$1(L.current,u$5(ie.current,{[s$2.Forwards]:()=>M.Next,[s$2.Backwards]:()=>M.Previous})|M.WrapAround,{relativeTo:ce.target}):ce.target instanceof HTMLElement&&y$3(ce.target)))}};return React.createElement(React.Fragment,null,!!(J&4)&&React.createElement(u$3,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:le,features:s$3.Focusable}),C({ourProps:ue,theirProps:re,defaultTag:X,name:"FocusTrap"}),!!(J&4)&&React.createElement(u$3,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:le,features:s$3.Focusable}))}let D$1=U$1(z),de=Object.assign(D$1,{features:_$1});function Q(g=!0){let A=reactExports.useRef(t$2.slice());return m$2(([L],[B])=>{B===!0&&L===!1&&t$6(()=>{A.current.splice(0)}),B===!1&&L===!0&&(A.current=t$2.slice())},[g,t$2,A]),o$4(()=>{var L;return(L=A.current.find(B=>B!=null&&B.isConnected))!=null?L:null})}function Y({ownerDocument:g},A){let L=Q(A);m$2(()=>{A||(g==null?void 0:g.activeElement)===(g==null?void 0:g.body)&&y$3(L())},[A]),c$2(()=>{A&&y$3(L())})}function Z({ownerDocument:g,container:A,initialFocus:L},B){let W=reactExports.useRef(null),q=f$3();return m$2(()=>{if(!B)return;let J=A.current;J&&t$6(()=>{if(!q.current)return;let re=g==null?void 0:g.activeElement;if(L!=null&&L.current){if((L==null?void 0:L.current)===re){W.current=re;return}}else if(J.contains(re)){W.current=re;return}L!=null&&L.current?y$3(L.current):O$1(J,M.First)===N$2.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),W.current=g==null?void 0:g.activeElement})},[B]),W}function $$1({ownerDocument:g,container:A,containers:L,previousActiveElement:B},W){let q=f$3();E(g==null?void 0:g.defaultView,"focus",J=>{if(!W||!q.current)return;let re=P(L);A.current instanceof HTMLElement&&re.add(A.current);let ae=B.current;if(!ae)return;let se=J.target;se&&se instanceof HTMLElement?S$3(re,se)?(B.current=se,y$3(se)):(J.preventDefault(),J.stopPropagation(),y$3(ae)):y$3(B.current)},!0)}function S$3(g,A){for(let L of g)if(L.contains(A))return!0;return!1}let e=reactExports.createContext(!1);function a$4(){return reactExports.useContext(e)}function l$1(g){return React.createElement(e.Provider,{value:g.force},g.children)}function F(g){let A=a$4(),L=reactExports.useContext(_),B=n$2(g),[W,q]=reactExports.useState(()=>{if(!A&&L!==null||s$7.isServer)return null;let J=B==null?void 0:B.getElementById("headlessui-portal-root");if(J)return J;if(B===null)return null;let re=B.createElement("div");return re.setAttribute("id","headlessui-portal-root"),B.body.appendChild(re)});return reactExports.useEffect(()=>{W!==null&&(B!=null&&B.body.contains(W)||B==null||B.body.appendChild(W))},[W,B]),reactExports.useEffect(()=>{A||L!==null&&q(L.current)},[L,q,A]),W}let U=reactExports.Fragment;function N$1(g,A){let L=g,B=reactExports.useRef(null),W=y$1(T(ie=>{B.current=ie}),A),q=n$2(B),J=F(B),[re]=reactExports.useState(()=>{var ie;return s$7.isServer?null:(ie=q==null?void 0:q.createElement("div"))!=null?ie:null}),ae=reactExports.useContext(f$2),se=l$3();return l$4(()=>{!J||!re||J.contains(re)||(re.setAttribute("data-headlessui-portal",""),J.appendChild(re))},[J,re]),l$4(()=>{if(re&&ae)return ae.register(re)},[ae,re]),c$2(()=>{var ie;!J||!re||(re instanceof Node&&J.contains(re)&&J.removeChild(re),J.childNodes.length<=0&&((ie=J.parentElement)==null||ie.removeChild(J)))}),se?!J||!re?null:reactDomExports.createPortal(C({ourProps:{ref:W},theirProps:L,defaultTag:U,name:"Portal"}),re):null}let S$2=reactExports.Fragment,_=reactExports.createContext(null);function j(g,A){let{target:L,...B}=g,W={ref:y$1(A)};return React.createElement(_.Provider,{value:L},C({ourProps:W,theirProps:B,defaultTag:S$2,name:"Popover.Group"}))}let f$2=reactExports.createContext(null);function ee(){let g=reactExports.useContext(f$2),A=reactExports.useRef([]),L=o$4(q=>(A.current.push(q),g&&g.register(q),()=>B(q))),B=o$4(q=>{let J=A.current.indexOf(q);J!==-1&&A.current.splice(J,1),g&&g.unregister(q)}),W=reactExports.useMemo(()=>({register:L,unregister:B,portals:A}),[L,B,A]);return[A,reactExports.useMemo(()=>function({children:q}){return React.createElement(f$2.Provider,{value:W},q)},[W])]}let D=U$1(N$1),I$2=U$1(j),te=Object.assign(D,{Group:I$2});function i(g,A){return g===A&&(g!==0||1/g===1/A)||g!==g&&A!==A}const d$2=typeof Object.is=="function"?Object.is:i,{useState:u$1,useEffect:h$1,useLayoutEffect:f$1,useDebugValue:p$1}=e$1;function y(g,A,L){const B=A(),[{inst:W},q]=u$1({inst:{value:B,getSnapshot:A}});return f$1(()=>{W.value=B,W.getSnapshot=A,r$1(W)&&q({inst:W})},[g,B,A]),h$1(()=>(r$1(W)&&q({inst:W}),g(()=>{r$1(W)&&q({inst:W})})),[g]),p$1(B),B}function r$1(g){const A=g.getSnapshot,L=g.value;try{const B=A();return!d$2(L,B)}catch{return!0}}function t$1(g,A,L){return A()}const r=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",s$1=!r,c$1=s$1?t$1:y,a$3="useSyncExternalStore"in e$1?(g=>g.useSyncExternalStore)(e$1):c$1;function S$1(g){return a$3(g.subscribe,g.getSnapshot,g.getSnapshot)}function a$2(g,A){let L=g(),B=new Set;return{getSnapshot(){return L},subscribe(W){return B.add(W),()=>B.delete(W)},dispatch(W,...q){let J=A[W].call(L,...q);J&&(L=J,B.forEach(re=>re()))}}}function c(){let g;return{before({doc:A}){var L;let B=A.documentElement;g=((L=A.defaultView)!=null?L:window).innerWidth-B.clientWidth},after({doc:A,d:L}){let B=A.documentElement,W=B.clientWidth-B.offsetWidth,q=g-W;L.style(B,"paddingRight",`${q}px`)}}}function d$1(){return t$5()?{before({doc:g,d:A,meta:L}){function B(W){return L.containers.flatMap(q=>q()).some(q=>q.contains(W))}A.microTask(()=>{var W;if(window.getComputedStyle(g.documentElement).scrollBehavior!=="auto"){let re=o$3();re.style(g.documentElement,"scrollBehavior","auto"),A.add(()=>A.microTask(()=>re.dispose()))}let q=(W=window.scrollY)!=null?W:window.pageYOffset,J=null;A.addEventListener(g,"click",re=>{if(re.target instanceof HTMLElement)try{let ae=re.target.closest("a");if(!ae)return;let{hash:se}=new URL(ae.href),ie=g.querySelector(se);ie&&!B(ie)&&(J=ie)}catch{}},!0),A.addEventListener(g,"touchstart",re=>{if(re.target instanceof HTMLElement)if(B(re.target)){let ae=re.target;for(;ae.parentElement&&B(ae.parentElement);)ae=ae.parentElement;A.style(ae,"overscrollBehavior","contain")}else A.style(re.target,"touchAction","none")}),A.addEventListener(g,"touchmove",re=>{if(re.target instanceof HTMLElement)if(B(re.target)){let ae=re.target;for(;ae.parentElement&&ae.dataset.headlessuiPortal!==""&&!(ae.scrollHeight>ae.clientHeight||ae.scrollWidth>ae.clientWidth);)ae=ae.parentElement;ae.dataset.headlessuiPortal===""&&re.preventDefault()}else re.preventDefault()},{passive:!1}),A.add(()=>{var re;let ae=(re=window.scrollY)!=null?re:window.pageYOffset;q!==ae&&window.scrollTo(0,q),J&&J.isConnected&&(J.scrollIntoView({block:"nearest"}),J=null)})})}}:{}}function l(){return{before({doc:g,d:A}){A.style(g.documentElement,"overflow","hidden")}}}function m(g){let A={};for(let L of g)Object.assign(A,L(A));return A}let a$1=a$2(()=>new Map,{PUSH(g,A){var L;let B=(L=this.get(g))!=null?L:{doc:g,count:0,d:o$3(),meta:new Set};return B.count++,B.meta.add(A),this.set(g,B),this},POP(g,A){let L=this.get(g);return L&&(L.count--,L.meta.delete(A)),this},SCROLL_PREVENT({doc:g,d:A,meta:L}){let B={doc:g,d:A,meta:m(L)},W=[d$1(),c(),l()];W.forEach(({before:q})=>q==null?void 0:q(B)),W.forEach(({after:q})=>q==null?void 0:q(B))},SCROLL_ALLOW({d:g}){g.dispose()},TEARDOWN({doc:g}){this.delete(g)}});a$1.subscribe(()=>{let g=a$1.getSnapshot(),A=new Map;for(let[L]of g)A.set(L,L.documentElement.style.overflow);for(let L of g.values()){let B=A.get(L.doc)==="hidden",W=L.count!==0;(W&&!B||!W&&B)&&a$1.dispatch(L.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",L),L.count===0&&a$1.dispatch("TEARDOWN",L)}});function p(g,A,L){let B=S$1(a$1),W=g?B.get(g):void 0,q=W?W.count>0:!1;return l$4(()=>{if(!(!g||!A))return a$1.dispatch("PUSH",g,L),()=>a$1.dispatch("POP",g,L)},[A,g]),q}let u=new Map,t=new Map;function b$2(g,A=!0){l$4(()=>{var L;if(!A)return;let B=typeof g=="function"?g():g.current;if(!B)return;function W(){var J;if(!B)return;let re=(J=t.get(B))!=null?J:1;if(re===1?t.delete(B):t.set(B,re-1),re!==1)return;let ae=u.get(B);ae&&(ae["aria-hidden"]===null?B.removeAttribute("aria-hidden"):B.setAttribute("aria-hidden",ae["aria-hidden"]),B.inert=ae.inert,u.delete(B))}let q=(L=t.get(B))!=null?L:0;return t.set(B,q+1),q!==0||(u.set(B,{"aria-hidden":B.getAttribute("aria-hidden"),inert:B.inert}),B.setAttribute("aria-hidden","true"),B.inert=!0),W},[g,A])}function N({defaultContainers:g=[],portals:A,mainTreeNodeRef:L}={}){var B;let W=reactExports.useRef((B=L==null?void 0:L.current)!=null?B:null),q=n$2(W),J=o$4(()=>{var re,ae,se;let ie=[];for(let le of g)le!==null&&(le instanceof HTMLElement?ie.push(le):"current"in le&&le.current instanceof HTMLElement&&ie.push(le.current));if(A!=null&&A.current)for(let le of A.current)ie.push(le);for(let le of(re=q==null?void 0:q.querySelectorAll("html > *, body > *"))!=null?re:[])le!==document.body&&le!==document.head&&le instanceof HTMLElement&&le.id!=="headlessui-portal-root"&&(le.contains(W.current)||le.contains((se=(ae=W.current)==null?void 0:ae.getRootNode())==null?void 0:se.host)||ie.some(pe=>le.contains(pe))||ie.push(le));return ie});return{resolveContainers:J,contains:o$4(re=>J().some(ae=>ae.contains(re))),mainTreeNodeRef:W,MainTreeNode:reactExports.useMemo(()=>function(){return L!=null?null:React.createElement(u$3,{features:s$3.Hidden,ref:W})},[W,L])}}let a=reactExports.createContext(()=>{});a.displayName="StackContext";var s=(g=>(g[g.Add=0]="Add",g[g.Remove=1]="Remove",g))(s||{});function x(){return reactExports.useContext(a)}function b$1({children:g,onUpdate:A,type:L,element:B,enabled:W}){let q=x(),J=o$4((...re)=>{A==null||A(...re),q(...re)});return l$4(()=>{let re=W===void 0||W===!0;return re&&J(0,L,B),()=>{re&&J(1,L,B)}},[J,L,B,W]),React.createElement(a.Provider,{value:J},g)}let d=reactExports.createContext(null);function f(){let g=reactExports.useContext(d);if(g===null){let A=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(A,f),A}return g}function w(){let[g,A]=reactExports.useState([]);return[g.length>0?g.join(" "):void 0,reactExports.useMemo(()=>function(L){let B=o$4(q=>(A(J=>[...J,q]),()=>A(J=>{let re=J.slice(),ae=re.indexOf(q);return ae!==-1&&re.splice(ae,1),re}))),W=reactExports.useMemo(()=>({register:B,slot:L.slot,name:L.name,props:L.props}),[B,L.slot,L.name,L.props]);return React.createElement(d.Provider,{value:W},L.children)},[A])]}let I$1="p";function S(g,A){let L=I$4(),{id:B=`headlessui-description-${L}`,...W}=g,q=f(),J=y$1(A);l$4(()=>q.register(B),[B,q.register]);let re={ref:J,...q.props,id:B};return C({ourProps:re,theirProps:W,slot:q.slot||{},defaultTag:I$1,name:q.name||"Description"})}let h=U$1(S),G=Object.assign(h,{});var Me=(g=>(g[g.Open=0]="Open",g[g.Closed=1]="Closed",g))(Me||{}),we=(g=>(g[g.SetTitleId=0]="SetTitleId",g))(we||{});let He={0(g,A){return g.titleId===A.id?g:{...g,titleId:A.id}}},I=reactExports.createContext(null);I.displayName="DialogContext";function b(g){let A=reactExports.useContext(I);if(A===null){let L=new Error(`<${g} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(L,b),L}return A}function Be(g,A,L=()=>[document.body]){p(g,A,B=>{var W;return{containers:[...(W=B.containers)!=null?W:[],L]}})}function Ge(g,A){return u$5(A.type,He,g,A)}let Ne="div",Ue=O.RenderStrategy|O.Static;function We(g,A){let L=I$4(),{id:B=`headlessui-dialog-${L}`,open:W,onClose:q,initialFocus:J,role:re="dialog",__demoMode:ae=!1,...se}=g,[ie,le]=reactExports.useState(0),pe=reactExports.useRef(!1);re=function(){return re==="dialog"||re==="alertdialog"?re:(pe.current||(pe.current=!0,console.warn(`Invalid role [${re}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let he=u$2();W===void 0&&he!==null&&(W=(he&d$3.Open)===d$3.Open);let ue=reactExports.useRef(null),ce=y$1(ue,A),fe=n$2(ue),me=g.hasOwnProperty("open")||he!==null,ke=g.hasOwnProperty("onClose");if(!me&&!ke)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!me)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!ke)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof W!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${W}`);if(typeof q!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${q}`);let xe=W?0:1,[Le,Se]=reactExports.useReducer(Ge,{titleId:null,descriptionId:null,panelRef:reactExports.createRef()}),Te=o$4(()=>q(!1)),ge=o$4(It=>Se({type:0,id:It})),Ce=l$3()?ae?!1:xe===0:!1,be=ie>1,nt=reactExports.useContext(I)!==null,[Ae,De]=ee(),lt={get current(){var It;return(It=Le.panelRef.current)!=null?It:ue.current}},{resolveContainers:Ct,mainTreeNodeRef:ft,MainTreeNode:Et}=N({portals:Ae,defaultContainers:[lt]}),gt=be?"parent":"leaf",bt=he!==null?(he&d$3.Closing)===d$3.Closing:!1,Ie=nt||bt?!1:Ce,pt=reactExports.useCallback(()=>{var It,it;return(it=Array.from((It=fe==null?void 0:fe.querySelectorAll("body > *"))!=null?It:[]).find(Vt=>Vt.id==="headlessui-portal-root"?!1:Vt.contains(ft.current)&&Vt instanceof HTMLElement))!=null?it:null},[ft]);b$2(pt,Ie);let at=be?!0:Ce,Ee=reactExports.useCallback(()=>{var It,it;return(it=Array.from((It=fe==null?void 0:fe.querySelectorAll("[data-headlessui-portal]"))!=null?It:[]).find(Vt=>Vt.contains(ft.current)&&Vt instanceof HTMLElement))!=null?it:null},[ft]);b$2(Ee,at),y$2(Ct,It=>{It.preventDefault(),Te()},!(!Ce||be));let ve=!(be||xe!==0);E(fe==null?void 0:fe.defaultView,"keydown",It=>{ve&&(It.defaultPrevented||It.key===o.Escape&&(It.preventDefault(),It.stopPropagation(),Te()))}),Be(fe,!(bt||xe!==0||nt),Ct),reactExports.useEffect(()=>{if(xe!==0||!ue.current)return;let It=new ResizeObserver(it=>{for(let Vt of it){let Yt=Vt.target.getBoundingClientRect();Yt.x===0&&Yt.y===0&&Yt.width===0&&Yt.height===0&&Te()}});return It.observe(ue.current),()=>It.disconnect()},[xe,ue,Te]);let[rt,st]=w(),ot=reactExports.useMemo(()=>[{dialogState:xe,close:Te,setTitleId:ge},Le],[xe,Le,Te,ge]),mt=reactExports.useMemo(()=>({open:xe===0}),[xe]),At={ref:ce,id:B,role:re,"aria-modal":xe===0?!0:void 0,"aria-labelledby":Le.titleId,"aria-describedby":rt};return React.createElement(b$1,{type:"Dialog",enabled:xe===0,element:ue,onUpdate:o$4((It,it)=>{it==="Dialog"&&u$5(It,{[s.Add]:()=>le(Vt=>Vt+1),[s.Remove]:()=>le(Vt=>Vt-1)})})},React.createElement(l$1,{force:!0},React.createElement(te,null,React.createElement(I.Provider,{value:ot},React.createElement(te.Group,{target:ue},React.createElement(l$1,{force:!1},React.createElement(st,{slot:mt,name:"Dialog.Description"},React.createElement(de,{initialFocus:J,containers:Ct,features:Ce?u$5(gt,{parent:de.features.RestoreFocus,leaf:de.features.All&~de.features.FocusLock}):de.features.None},React.createElement(De,null,C({ourProps:At,theirProps:se,slot:mt,defaultTag:Ne,features:Ue,visible:xe===0,name:"Dialog"}))))))))),React.createElement(Et,null))}let $e="div";function Ye(g,A){let L=I$4(),{id:B=`headlessui-dialog-overlay-${L}`,...W}=g,[{dialogState:q,close:J}]=b("Dialog.Overlay"),re=y$1(A),ae=o$4(ie=>{if(ie.target===ie.currentTarget){if(r$2(ie.currentTarget))return ie.preventDefault();ie.preventDefault(),ie.stopPropagation(),J()}}),se=reactExports.useMemo(()=>({open:q===0}),[q]);return C({ourProps:{ref:re,id:B,"aria-hidden":!0,onClick:ae},theirProps:W,slot:se,defaultTag:$e,name:"Dialog.Overlay"})}let je="div";function Je(g,A){let L=I$4(),{id:B=`headlessui-dialog-backdrop-${L}`,...W}=g,[{dialogState:q},J]=b("Dialog.Backdrop"),re=y$1(A);reactExports.useEffect(()=>{if(J.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[J.panelRef]);let ae=reactExports.useMemo(()=>({open:q===0}),[q]);return React.createElement(l$1,{force:!0},React.createElement(te,null,C({ourProps:{ref:re,id:B,"aria-hidden":!0},theirProps:W,slot:ae,defaultTag:je,name:"Dialog.Backdrop"})))}let Xe="div";function Ke(g,A){let L=I$4(),{id:B=`headlessui-dialog-panel-${L}`,...W}=g,[{dialogState:q},J]=b("Dialog.Panel"),re=y$1(A,J.panelRef),ae=reactExports.useMemo(()=>({open:q===0}),[q]),se=o$4(ie=>{ie.stopPropagation()});return C({ourProps:{ref:re,id:B,onClick:se},theirProps:W,slot:ae,defaultTag:Xe,name:"Dialog.Panel"})}let Ve="h2";function qe(g,A){let L=I$4(),{id:B=`headlessui-dialog-title-${L}`,...W}=g,[{dialogState:q,setTitleId:J}]=b("Dialog.Title"),re=y$1(A);reactExports.useEffect(()=>(J(B),()=>J(null)),[B,J]);let ae=reactExports.useMemo(()=>({open:q===0}),[q]);return C({ourProps:{ref:re,id:B},theirProps:W,slot:ae,defaultTag:Ve,name:"Dialog.Title"})}let ze=U$1(We),Qe=U$1(Je),Ze=U$1(Ke),et=U$1(Ye),tt=U$1(qe),_t=Object.assign(ze,{Backdrop:Qe,Panel:Ze,Overlay:et,Title:tt,Description:G});function ModalAdicionarAluno({onSave:g,onClose:A,alunoParaEditar:L}){const[B,W]=reactExports.useState(""),[q,J]=reactExports.useState(""),[re,ae]=reactExports.useState(""),[se,ie]=reactExports.useState(""),[le,pe]=reactExports.useState(""),[he,ue]=reactExports.useState("");reactExports.useEffect(()=>{L?(W(L.codigo),J(L.nome),ae(L.nascimento),ie(L.sexo),pe(L.turma),ue(L.turno||"")):(W(""),J(""),ae(""),ie(""),pe(""),ue(""))},[L]);const ce=()=>{if(!B||!q||!re||!se||!le||!he){alert("Preencha todos os campos!");return}g({codigo:B,nome:q,nascimento:re,sexo:se,turma:le,turno:he})};return React.createElement(_t,{open:!0,onClose:A,className:"relative z-50"},React.createElement("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),React.createElement("div",{className:"fixed inset-0 flex items-center justify-center p-4"},React.createElement(_t.Panel,{className:"w-full max-w-md rounded-lg bg-white p-6 space-y-4 shadow-lg"},React.createElement("div",{className:"flex justify-between items-center"},React.createElement(_t.Title,{className:"text-lg font-bold"},L?"✏️ Editar Estudante":"➕ Adicionar Estudante"),React.createElement("button",{onClick:A},React.createElement(X$1,{className:"w-5 h-5"}))),React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",placeholder:"Código",value:B,onChange:fe=>W(fe.target.value),className:"w-full border p-2 rounded"}),React.createElement("input",{type:"text",placeholder:"Nome",value:q,onChange:fe=>J(fe.target.value),className:"w-full border p-2 rounded"}),React.createElement("input",{type:"text",placeholder:"Data de Nascimento (dd/mm/aaaa)",value:re,onChange:fe=>ae(fe.target.value),className:"w-full border p-2 rounded"}),React.createElement("input",{type:"text",placeholder:"Sexo (M/F)",value:se,onChange:fe=>ie(fe.target.value),className:"w-full border p-2 rounded"}),React.createElement("input",{type:"text",placeholder:"Turma",value:le,onChange:fe=>pe(fe.target.value),className:"w-full border p-2 rounded"}),React.createElement("input",{type:"text",placeholder:"Turno",value:he,onChange:fe=>ue(fe.target.value),className:"w-full border p-2 rounded"})),React.createElement("div",{className:"flex justify-end gap-2"},React.createElement("button",{onClick:A,className:"px-4 py-2 bg-gray-400 text-white rounded hover:bg-gray-500"},"Cancelar"),React.createElement("button",{onClick:ce,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},L?"Salvar Alterações":"Adicionar")))))}function commonjsRequire(g){throw new Error('Could not dynamically require "'+g+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(A,L){module.exports=A.pdfjsLib=L()})(globalThis,()=>(()=>{var __webpack_modules__=[,(g,A)=>{var zr;Object.defineProperty(A,"__esModule",{value:!0}),A.VerbosityLevel=A.Util=A.UnknownErrorException=A.UnexpectedResponseException=A.TextRenderingMode=A.RenderingIntentFlag=A.PromiseCapability=A.PermissionFlag=A.PasswordResponses=A.PasswordException=A.PageActionEventType=A.OPS=A.MissingPDFException=A.MAX_IMAGE_SIZE_TO_CACHE=A.LINE_FACTOR=A.LINE_DESCENT_FACTOR=A.InvalidPDFException=A.ImageKind=A.IDENTITY_MATRIX=A.FormatError=A.FeatureTest=A.FONT_IDENTITY_MATRIX=A.DocumentActionEventType=A.CMapCompressionType=A.BaseException=A.BASELINE_FACTOR=A.AnnotationType=A.AnnotationReplyType=A.AnnotationPrefix=A.AnnotationMode=A.AnnotationFlag=A.AnnotationFieldFlag=A.AnnotationEditorType=A.AnnotationEditorPrefix=A.AnnotationEditorParamsType=A.AnnotationBorderStyleType=A.AnnotationActionEventType=A.AbortException=void 0,A.assert=Ie,A.bytesToString=It,A.createValidAbsoluteUrl=at,A.getModificationDate=ur,A.getUuid=br,A.getVerbosityLevel=ft,A.info=Et,A.isArrayBuffer=Nt,A.isArrayEqual=fr,A.isNodeJS=void 0,A.normalizeUnicode=dr,A.objectFromMap=Zt,A.objectSize=Yt,A.setVerbosityLevel=Ct,A.shadow=Ee,A.string32=Vt,A.stringToBytes=it,A.stringToPDFString=Qt,A.stringToUTF8String=or,A.unreachable=bt,A.utf8StringToString=ar,A.warn=gt;const L=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");A.isNodeJS=L;const B=[1,0,0,1,0,0];A.IDENTITY_MATRIX=B;const W=[.001,0,0,.001,0,0];A.FONT_IDENTITY_MATRIX=W;const q=1e7;A.MAX_IMAGE_SIZE_TO_CACHE=q;const J=1.35;A.LINE_FACTOR=J;const re=.35;A.LINE_DESCENT_FACTOR=re;const ae=re/J;A.BASELINE_FACTOR=ae;const se={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};A.RenderingIntentFlag=se;const ie={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};A.AnnotationMode=ie;const le="pdfjs_internal_editor_";A.AnnotationEditorPrefix=le;const pe={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};A.AnnotationEditorType=pe;const he={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};A.AnnotationEditorParamsType=he;const ue={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};A.PermissionFlag=ue;const ce={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};A.TextRenderingMode=ce;const fe={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};A.ImageKind=fe;const me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};A.AnnotationType=me;const ke={GROUP:"Group",REPLY:"R"};A.AnnotationReplyType=ke;const xe={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};A.AnnotationFlag=xe;const Le={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};A.AnnotationFieldFlag=Le;const Se={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};A.AnnotationBorderStyleType=Se;const Te={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};A.AnnotationActionEventType=Te;const ge={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};A.DocumentActionEventType=ge;const Ce={O:"PageOpen",C:"PageClose"};A.PageActionEventType=Ce;const be={ERRORS:0,WARNINGS:1,INFOS:5};A.VerbosityLevel=be;const nt={NONE:0,BINARY:1};A.CMapCompressionType=nt;const Ae={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};A.OPS=Ae;const De={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};A.PasswordResponses=De;let lt=be.WARNINGS;function Ct(lr){Number.isInteger(lr)&&(lt=lr)}function ft(){return lt}function Et(lr){lt>=be.INFOS&&console.log(`Info: ${lr}`)}function gt(lr){lt>=be.WARNINGS&&console.log(`Warning: ${lr}`)}function bt(lr){throw new Error(lr)}function Ie(lr,Ht){lr||bt(Ht)}function pt(lr){switch(lr==null?void 0:lr.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function at(lr,Ht=null,$t=null){if(!lr)return null;try{if($t&&typeof lr=="string"){if($t.addDefaultProtocol&&lr.startsWith("www.")){const Wr=lr.match(/\./g);(Wr==null?void 0:Wr.length)>=2&&(lr=`http://${lr}`)}if($t.tryConvertEncoding)try{lr=or(lr)}catch{}}const kr=Ht?new URL(lr,Ht):new URL(lr);if(pt(kr))return kr}catch{}return null}function Ee(lr,Ht,$t,kr=!1){return Object.defineProperty(lr,Ht,{value:$t,enumerable:!kr,configurable:!0,writable:!1}),$t}const ye=function(){function Ht($t,kr){this.constructor===Ht&&bt("Cannot initialize BaseException."),this.message=$t,this.name=kr}return Ht.prototype=new Error,Ht.constructor=Ht,Ht}();A.BaseException=ye;class ve extends ye{constructor(Ht,$t){super(Ht,"PasswordException"),this.code=$t}}A.PasswordException=ve;class Pe extends ye{constructor(Ht,$t){super(Ht,"UnknownErrorException"),this.details=$t}}A.UnknownErrorException=Pe;class rt extends ye{constructor(Ht){super(Ht,"InvalidPDFException")}}A.InvalidPDFException=rt;class st extends ye{constructor(Ht){super(Ht,"MissingPDFException")}}A.MissingPDFException=st;class ot extends ye{constructor(Ht,$t){super(Ht,"UnexpectedResponseException"),this.status=$t}}A.UnexpectedResponseException=ot;class mt extends ye{constructor(Ht){super(Ht,"FormatError")}}A.FormatError=mt;class At extends ye{constructor(Ht){super(Ht,"AbortException")}}A.AbortException=At;function It(lr){(typeof lr!="object"||(lr==null?void 0:lr.length)===void 0)&&bt("Invalid argument for bytesToString");const Ht=lr.length,$t=8192;if(Ht<$t)return String.fromCharCode.apply(null,lr);const kr=[];for(let Wr=0;Wr<Ht;Wr+=$t){const Ur=Math.min(Wr+$t,Ht),Tt=lr.subarray(Wr,Ur);kr.push(String.fromCharCode.apply(null,Tt))}return kr.join("")}function it(lr){typeof lr!="string"&&bt("Invalid argument for stringToBytes");const Ht=lr.length,$t=new Uint8Array(Ht);for(let kr=0;kr<Ht;++kr)$t[kr]=lr.charCodeAt(kr)&255;return $t}function Vt(lr){return String.fromCharCode(lr>>24&255,lr>>16&255,lr>>8&255,lr&255)}function Yt(lr){return Object.keys(lr).length}function Zt(lr){const Ht=Object.create(null);for(const[$t,kr]of lr)Ht[$t]=kr;return Ht}function Lt(){const lr=new Uint8Array(4);return lr[0]=1,new Uint32Array(lr.buffer,0,1)[0]===1}function Ft(){try{return new Function(""),!0}catch{return!1}}class ht{static get isLittleEndian(){return Ee(this,"isLittleEndian",Lt())}static get isEvalSupported(){return Ee(this,"isEvalSupported",Ft())}static get isOffscreenCanvasSupported(){return Ee(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Ee(this,"platform",{isWin:!1,isMac:!1}):Ee(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Ht,$t;return Ee(this,"isCSSRoundSupported",($t=(Ht=globalThis.CSS)==null?void 0:Ht.supports)==null?void 0:$t.call(Ht,"width: round(1.5px, 1px)"))}}A.FeatureTest=ht;const kt=[...Array(256).keys()].map(lr=>lr.toString(16).padStart(2,"0"));class Dt{static makeHexColor(Ht,$t,kr){return`#${kt[Ht]}${kt[$t]}${kt[kr]}`}static scaleMinMax(Ht,$t){let kr;Ht[0]?(Ht[0]<0&&(kr=$t[0],$t[0]=$t[1],$t[1]=kr),$t[0]*=Ht[0],$t[1]*=Ht[0],Ht[3]<0&&(kr=$t[2],$t[2]=$t[3],$t[3]=kr),$t[2]*=Ht[3],$t[3]*=Ht[3]):(kr=$t[0],$t[0]=$t[2],$t[2]=kr,kr=$t[1],$t[1]=$t[3],$t[3]=kr,Ht[1]<0&&(kr=$t[2],$t[2]=$t[3],$t[3]=kr),$t[2]*=Ht[1],$t[3]*=Ht[1],Ht[2]<0&&(kr=$t[0],$t[0]=$t[1],$t[1]=kr),$t[0]*=Ht[2],$t[1]*=Ht[2]),$t[0]+=Ht[4],$t[1]+=Ht[4],$t[2]+=Ht[5],$t[3]+=Ht[5]}static transform(Ht,$t){return[Ht[0]*$t[0]+Ht[2]*$t[1],Ht[1]*$t[0]+Ht[3]*$t[1],Ht[0]*$t[2]+Ht[2]*$t[3],Ht[1]*$t[2]+Ht[3]*$t[3],Ht[0]*$t[4]+Ht[2]*$t[5]+Ht[4],Ht[1]*$t[4]+Ht[3]*$t[5]+Ht[5]]}static applyTransform(Ht,$t){const kr=Ht[0]*$t[0]+Ht[1]*$t[2]+$t[4],Wr=Ht[0]*$t[1]+Ht[1]*$t[3]+$t[5];return[kr,Wr]}static applyInverseTransform(Ht,$t){const kr=$t[0]*$t[3]-$t[1]*$t[2],Wr=(Ht[0]*$t[3]-Ht[1]*$t[2]+$t[2]*$t[5]-$t[4]*$t[3])/kr,Ur=(-Ht[0]*$t[1]+Ht[1]*$t[0]+$t[4]*$t[1]-$t[5]*$t[0])/kr;return[Wr,Ur]}static getAxialAlignedBoundingBox(Ht,$t){const kr=this.applyTransform(Ht,$t),Wr=this.applyTransform(Ht.slice(2,4),$t),Ur=this.applyTransform([Ht[0],Ht[3]],$t),Tt=this.applyTransform([Ht[2],Ht[1]],$t);return[Math.min(kr[0],Wr[0],Ur[0],Tt[0]),Math.min(kr[1],Wr[1],Ur[1],Tt[1]),Math.max(kr[0],Wr[0],Ur[0],Tt[0]),Math.max(kr[1],Wr[1],Ur[1],Tt[1])]}static inverseTransform(Ht){const $t=Ht[0]*Ht[3]-Ht[1]*Ht[2];return[Ht[3]/$t,-Ht[1]/$t,-Ht[2]/$t,Ht[0]/$t,(Ht[2]*Ht[5]-Ht[4]*Ht[3])/$t,(Ht[4]*Ht[1]-Ht[5]*Ht[0])/$t]}static singularValueDecompose2dScale(Ht){const $t=[Ht[0],Ht[2],Ht[1],Ht[3]],kr=Ht[0]*$t[0]+Ht[1]*$t[2],Wr=Ht[0]*$t[1]+Ht[1]*$t[3],Ur=Ht[2]*$t[0]+Ht[3]*$t[2],Tt=Ht[2]*$t[1]+Ht[3]*$t[3],rr=(kr+Tt)/2,hr=Math.sqrt((kr+Tt)**2-4*(kr*Tt-Ur*Wr))/2,Cr=rr+hr||1,Fr=rr-hr||1;return[Math.sqrt(Cr),Math.sqrt(Fr)]}static normalizeRect(Ht){const $t=Ht.slice(0);return Ht[0]>Ht[2]&&($t[0]=Ht[2],$t[2]=Ht[0]),Ht[1]>Ht[3]&&($t[1]=Ht[3],$t[3]=Ht[1]),$t}static intersect(Ht,$t){const kr=Math.max(Math.min(Ht[0],Ht[2]),Math.min($t[0],$t[2])),Wr=Math.min(Math.max(Ht[0],Ht[2]),Math.max($t[0],$t[2]));if(kr>Wr)return null;const Ur=Math.max(Math.min(Ht[1],Ht[3]),Math.min($t[1],$t[3])),Tt=Math.min(Math.max(Ht[1],Ht[3]),Math.max($t[1],$t[3]));return Ur>Tt?null:[kr,Ur,Wr,Tt]}static bezierBoundingBox(Ht,$t,kr,Wr,Ur,Tt,rr,hr){const Cr=[],Fr=[[],[]];let yr,St,xt,Pt,Gt,qt,sr,cr;for(let vt=0;vt<2;++vt){if(vt===0?(St=6*Ht-12*kr+6*Ur,yr=-3*Ht+9*kr-9*Ur+3*rr,xt=3*kr-3*Ht):(St=6*$t-12*Wr+6*Tt,yr=-3*$t+9*Wr-9*Tt+3*hr,xt=3*Wr-3*$t),Math.abs(yr)<1e-12){if(Math.abs(St)<1e-12)continue;Pt=-xt/St,0<Pt&&Pt<1&&Cr.push(Pt);continue}sr=St*St-4*xt*yr,cr=Math.sqrt(sr),!(sr<0)&&(Gt=(-St+cr)/(2*yr),0<Gt&&Gt<1&&Cr.push(Gt),qt=(-St-cr)/(2*yr),0<qt&&qt<1&&Cr.push(qt))}let Tr=Cr.length,Ar;const Oe=Tr;for(;Tr--;)Pt=Cr[Tr],Ar=1-Pt,Fr[0][Tr]=Ar*Ar*Ar*Ht+3*Ar*Ar*Pt*kr+3*Ar*Pt*Pt*Ur+Pt*Pt*Pt*rr,Fr[1][Tr]=Ar*Ar*Ar*$t+3*Ar*Ar*Pt*Wr+3*Ar*Pt*Pt*Tt+Pt*Pt*Pt*hr;return Fr[0][Oe]=Ht,Fr[1][Oe]=$t,Fr[0][Oe+1]=rr,Fr[1][Oe+1]=hr,Fr[0].length=Fr[1].length=Oe+2,[Math.min(...Fr[0]),Math.min(...Fr[1]),Math.max(...Fr[0]),Math.max(...Fr[1])]}}A.Util=Dt;const Bt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Qt(lr){if(lr[0]>="ï"){let $t;if(lr[0]==="þ"&&lr[1]==="ÿ"?$t="utf-16be":lr[0]==="ÿ"&&lr[1]==="þ"?$t="utf-16le":lr[0]==="ï"&&lr[1]==="»"&&lr[2]==="¿"&&($t="utf-8"),$t)try{const kr=new TextDecoder($t,{fatal:!0}),Wr=it(lr);return kr.decode(Wr)}catch(kr){gt(`stringToPDFString: "${kr}".`)}}const Ht=[];for(let $t=0,kr=lr.length;$t<kr;$t++){const Wr=Bt[lr.charCodeAt($t)];Ht.push(Wr?String.fromCharCode(Wr):lr.charAt($t))}return Ht.join("")}function or(lr){return decodeURIComponent(escape(lr))}function ar(lr){return unescape(encodeURIComponent(lr))}function Nt(lr){return typeof lr=="object"&&(lr==null?void 0:lr.byteLength)!==void 0}function fr(lr,Ht){if(lr.length!==Ht.length)return!1;for(let $t=0,kr=lr.length;$t<kr;$t++)if(lr[$t]!==Ht[$t])return!1;return!0}function ur(lr=new Date){return[lr.getUTCFullYear().toString(),(lr.getUTCMonth()+1).toString().padStart(2,"0"),lr.getUTCDate().toString().padStart(2,"0"),lr.getUTCHours().toString().padStart(2,"0"),lr.getUTCMinutes().toString().padStart(2,"0"),lr.getUTCSeconds().toString().padStart(2,"0")].join("")}class Pr{constructor(){zt(this,zr,!1);this.promise=new Promise((Ht,$t)=>{this.resolve=kr=>{Xt(this,zr,!0),Ht(kr)},this.reject=kr=>{Xt(this,zr,!0),$t(kr)}})}get settled(){return Fe(this,zr)}}zr=new WeakMap,A.PromiseCapability=Pr;let Rr=null,vr=null;function dr(lr){return Rr||(Rr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vr=new Map([["ﬅ","ſt"]])),lr.replaceAll(Rr,(Ht,$t,kr)=>$t?$t.normalize("NFKC"):vr.get(kr))}function br(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const lr=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(lr);else for(let Ht=0;Ht<32;Ht++)lr[Ht]=Math.floor(Math.random()*255);return It(lr)}const Ir="pdfjs_internal_id_";A.AnnotationPrefix=Ir},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var g,L,B,W,li,ao,re,ae,se,ie,le,pe,he,ue,ce,io,me,ke,Zl,Le,Se;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(ge){if(typeof ge=="string"||ge instanceof URL?ge={url:ge}:(0,_util.isArrayBuffer)(ge)&&(ge={data:ge}),typeof ge!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!ge.url&&!ge.data&&!ge.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const Ce=new PDFDocumentLoadingTask,{docId:be}=Ce,nt=ge.url?getUrlProp(ge.url):null,Ae=ge.data?getDataProp(ge.data):null,De=ge.httpHeaders||null,lt=ge.withCredentials===!0,Ct=ge.password??null,ft=ge.range instanceof PDFDataRangeTransport?ge.range:null,Et=Number.isInteger(ge.rangeChunkSize)&&ge.rangeChunkSize>0?ge.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let gt=ge.worker instanceof PDFWorker?ge.worker:null;const bt=ge.verbosity,Ie=typeof ge.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(ge.docBaseUrl)?ge.docBaseUrl:null,pt=typeof ge.cMapUrl=="string"?ge.cMapUrl:null,at=ge.cMapPacked!==!1,Ee=ge.CMapReaderFactory||DefaultCMapReaderFactory,ye=typeof ge.standardFontDataUrl=="string"?ge.standardFontDataUrl:null,ve=ge.StandardFontDataFactory||DefaultStandardFontDataFactory,Pe=ge.stopAtErrors!==!0,rt=Number.isInteger(ge.maxImageSize)&&ge.maxImageSize>-1?ge.maxImageSize:-1,st=ge.isEvalSupported!==!1,ot=typeof ge.isOffscreenCanvasSupported=="boolean"?ge.isOffscreenCanvasSupported:!_util.isNodeJS,mt=Number.isInteger(ge.canvasMaxAreaInBytes)?ge.canvasMaxAreaInBytes:-1,At=typeof ge.disableFontFace=="boolean"?ge.disableFontFace:_util.isNodeJS,It=ge.fontExtraProperties===!0,it=ge.enableXfa===!0,Vt=ge.ownerDocument||globalThis.document,Yt=ge.disableRange===!0,Zt=ge.disableStream===!0,Lt=ge.disableAutoFetch===!0,Ft=ge.pdfBug===!0,ht=ft?ft.length:ge.length??NaN,kt=typeof ge.useSystemFonts=="boolean"?ge.useSystemFonts:!_util.isNodeJS&&!At,Dt=typeof ge.useWorkerFetch=="boolean"?ge.useWorkerFetch:Ee===_display_utils.DOMCMapReaderFactory&&ve===_display_utils.DOMStandardFontDataFactory&&pt&&ye&&(0,_display_utils.isValidFetchUrl)(pt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ye,document.baseURI),Bt=ge.canvasFactory||new DefaultCanvasFactory({ownerDocument:Vt}),Qt=ge.filterFactory||new DefaultFilterFactory({docId:be,ownerDocument:Vt}),or=null;(0,_util.setVerbosityLevel)(bt);const ar={canvasFactory:Bt,filterFactory:Qt};if(Dt||(ar.cMapReaderFactory=new Ee({baseUrl:pt,isCompressed:at}),ar.standardFontDataFactory=new ve({baseUrl:ye})),!gt){const ur={verbosity:bt,port:_worker_options.GlobalWorkerOptions.workerPort};gt=ur.port?PDFWorker.fromPort(ur):new PDFWorker(ur),Ce._worker=gt}const Nt={docId:be,apiVersion:"3.11.174",data:Ae,password:Ct,disableAutoFetch:Lt,rangeChunkSize:Et,length:ht,docBaseUrl:Ie,enableXfa:it,evaluatorOptions:{maxImageSize:rt,disableFontFace:At,ignoreErrors:Pe,isEvalSupported:st,isOffscreenCanvasSupported:ot,canvasMaxAreaInBytes:mt,fontExtraProperties:It,useSystemFonts:kt,cMapUrl:Dt?pt:null,standardFontDataUrl:Dt?ye:null}},fr={ignoreErrors:Pe,isEvalSupported:st,disableFontFace:At,fontExtraProperties:It,enableXfa:it,ownerDocument:Vt,disableAutoFetch:Lt,pdfBug:Ft,styleElement:or};return gt.promise.then(function(){if(Ce.destroyed)throw new Error("Loading aborted");const ur=_fetchDocument(gt,Nt),Pr=new Promise(function(Rr){let vr;ft?vr=new _transport_stream.PDFDataTransportStream({length:ht,initialData:ft.initialData,progressiveDone:ft.progressiveDone,contentDispositionFilename:ft.contentDispositionFilename,disableRange:Yt,disableStream:Zt},ft):Ae||(vr=(br=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(br):(0,_display_utils.isValidFetchUrl)(br.url)?new _displayFetch_stream.PDFFetchStream(br):new _displayNetwork.PDFNetworkStream(br))({url:nt,length:ht,httpHeaders:De,withCredentials:lt,rangeChunkSize:Et,disableRange:Yt,disableStream:Zt})),Rr(vr)});return Promise.all([ur,Pr]).then(function([Rr,vr]){if(Ce.destroyed)throw new Error("Loading aborted");const dr=new _message_handler.MessageHandler(be,Rr,gt.port),br=new WorkerTransport(dr,Ce,vr,fr,ar);Ce._transport=br,dr.send("Ready",null)})}).catch(Ce._capability.reject),Ce}async function _fetchDocument(ge,Ce){if(ge.destroyed)throw new Error("Worker was destroyed");const be=await ge.messageHandler.sendWithPromise("GetDocRequest",Ce,Ce.data?[Ce.data.buffer]:null);if(ge.destroyed)throw new Error("Worker was destroyed");return be}function getUrlProp(ge){if(ge instanceof URL)return ge.href;try{return new URL(ge,window.location).href}catch{if(_util.isNodeJS&&typeof ge=="string")return ge}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(ge){if(_util.isNodeJS&&typeof Buffer<"u"&&ge instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(ge instanceof Uint8Array&&ge.byteLength===ge.buffer.byteLength)return ge;if(typeof ge=="string")return(0,_util.stringToBytes)(ge);if(typeof ge=="object"&&!isNaN(ge==null?void 0:ge.length)||(0,_util.isArrayBuffer)(ge))return new Uint8Array(ge);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const A=class A{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Gi(A,g)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var Ce,be,nt;this.destroyed=!0;try{(Ce=this._worker)!=null&&Ce.port&&(this._worker._pendingDestroy=!0),await((be=this._transport)==null?void 0:be.destroy())}catch(Ae){throw(nt=this._worker)!=null&&nt.port&&delete this._worker._pendingDestroy,Ae}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};g=new WeakMap,zt(A,g,0);let PDFDocumentLoadingTask=A;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(Ce,be,nt=!1,Ae=null){this.length=Ce,this.initialData=be,this.progressiveDone=nt,this.contentDispositionFilename=Ae,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(Ce){this._rangeListeners.push(Ce)}addProgressListener(Ce){this._progressListeners.push(Ce)}addProgressiveReadListener(Ce){this._progressiveReadListeners.push(Ce)}addProgressiveDoneListener(Ce){this._progressiveDoneListeners.push(Ce)}onDataRange(Ce,be){for(const nt of this._rangeListeners)nt(Ce,be)}onDataProgress(Ce,be){this._readyCapability.promise.then(()=>{for(const nt of this._progressListeners)nt(Ce,be)})}onDataProgressiveRead(Ce){this._readyCapability.promise.then(()=>{for(const be of this._progressiveReadListeners)be(Ce)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const Ce of this._progressiveDoneListeners)Ce()})}transportReady(){this._readyCapability.resolve()}requestDataRange(Ce,be){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(Ce,be){this._pdfInfo=Ce,this._transport=be,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(nt=>{if(!nt)return nt;const Ae=[];for(const De in nt)Ae.push(...nt[De]);return Ae}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(Ce){return this._transport.getPage(Ce)}getPageIndex(Ce){return this._transport.getPageIndex(Ce)}getDestinations(){return this._transport.getDestinations()}getDestination(Ce){return this._transport.getDestination(Ce)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(Ce=!1){return this._transport.startCleanup(Ce||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(Ce,be,nt,Ae=!1){zt(this,W);zt(this,L,null);zt(this,B,!1);this._pageIndex=Ce,this._pageInfo=be,this._transport=nt,this._stats=Ae?new _display_utils.StatTimer:null,this._pdfBug=Ae,this.commonObjs=nt.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:Ce,rotation:be=this.rotate,offsetX:nt=0,offsetY:Ae=0,dontFlip:De=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:Ce,rotation:be,offsetX:nt,offsetY:Ae,dontFlip:De})}getAnnotations({intent:Ce="display"}={}){const be=this._transport.getRenderingIntent(Ce);return this._transport.getAnnotations(this._pageIndex,be.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var Ce;return((Ce=this._transport._htmlForXfa)==null?void 0:Ce.children[this._pageIndex])||null}render({canvasContext:Ce,viewport:be,intent:nt="display",annotationMode:Ae=_util.AnnotationMode.ENABLE,transform:De=null,background:lt=null,optionalContentConfigPromise:Ct=null,annotationCanvasMap:ft=null,pageColors:Et=null,printAnnotationStorage:gt=null}){var ve,Pe;(ve=this._stats)==null||ve.time("Overall");const bt=this._transport.getRenderingIntent(nt,Ae,gt);Xt(this,B,!1),Mt(this,W,ao).call(this),Ct||(Ct=this._transport.getOptionalContentConfig());let Ie=this._intentStates.get(bt.cacheKey);Ie||(Ie=Object.create(null),this._intentStates.set(bt.cacheKey,Ie)),Ie.streamReaderCancelTimeout&&(clearTimeout(Ie.streamReaderCancelTimeout),Ie.streamReaderCancelTimeout=null);const pt=!!(bt.renderingIntent&_util.RenderingIntentFlag.PRINT);Ie.displayReadyCapability||(Ie.displayReadyCapability=new _util.PromiseCapability,Ie.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Pe=this._stats)==null||Pe.time("Page Request"),this._pumpOperatorList(bt));const at=rt=>{var st,ot;Ie.renderTasks.delete(Ee),(this._maybeCleanupAfterRender||pt)&&Xt(this,B,!0),Mt(this,W,li).call(this,!pt),rt?(Ee.capability.reject(rt),this._abortOperatorList({intentState:Ie,reason:rt instanceof Error?rt:new Error(rt)})):Ee.capability.resolve(),(st=this._stats)==null||st.timeEnd("Rendering"),(ot=this._stats)==null||ot.timeEnd("Overall")},Ee=new InternalRenderTask({callback:at,params:{canvasContext:Ce,viewport:be,transform:De,background:lt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:ft,operatorList:Ie.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!pt,pdfBug:this._pdfBug,pageColors:Et});(Ie.renderTasks||(Ie.renderTasks=new Set)).add(Ee);const ye=Ee.task;return Promise.all([Ie.displayReadyCapability.promise,Ct]).then(([rt,st])=>{var ot;if(this.destroyed){at();return}(ot=this._stats)==null||ot.time("Rendering"),Ee.initializeGraphics({transparency:rt,optionalContentConfig:st}),Ee.operatorListChanged()}).catch(at),ye}getOperatorList({intent:Ce="display",annotationMode:be=_util.AnnotationMode.ENABLE,printAnnotationStorage:nt=null}={}){var ft;function Ae(){lt.operatorList.lastChunk&&(lt.opListReadCapability.resolve(lt.operatorList),lt.renderTasks.delete(Ct))}const De=this._transport.getRenderingIntent(Ce,be,nt,!0);let lt=this._intentStates.get(De.cacheKey);lt||(lt=Object.create(null),this._intentStates.set(De.cacheKey,lt));let Ct;return lt.opListReadCapability||(Ct=Object.create(null),Ct.operatorListChanged=Ae,lt.opListReadCapability=new _util.PromiseCapability,(lt.renderTasks||(lt.renderTasks=new Set)).add(Ct),lt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ft=this._stats)==null||ft.time("Page Request"),this._pumpOperatorList(De)),lt.opListReadCapability.promise}streamTextContent({includeMarkedContent:Ce=!1,disableNormalization:be=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:Ce===!0,disableNormalization:be===!0},{highWaterMark:100,size(Ae){return Ae.items.length}})}getTextContent(Ce={}){if(this._transport._htmlForXfa)return this.getXfa().then(nt=>_xfa_text.XfaText.textContent(nt));const be=this.streamTextContent(Ce);return new Promise(function(nt,Ae){function De(){lt.read().then(function({value:ft,done:Et}){if(Et){nt(Ct);return}Object.assign(Ct.styles,ft.styles),Ct.items.push(...ft.items),De()},Ae)}const lt=be.getReader(),Ct={items:[],styles:Object.create(null)};De()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const Ce=[];for(const be of this._intentStates.values())if(this._abortOperatorList({intentState:be,reason:new Error("Page was destroyed."),force:!0}),!be.opListReadCapability)for(const nt of be.renderTasks)Ce.push(nt.completed),nt.cancel();return this.objs.clear(),Xt(this,B,!1),Mt(this,W,ao).call(this),Promise.all(Ce)}cleanup(Ce=!1){Xt(this,B,!0);const be=Mt(this,W,li).call(this,!1);return Ce&&be&&this._stats&&(this._stats=new _display_utils.StatTimer),be}_startRenderPage(Ce,be){var Ae,De;const nt=this._intentStates.get(be);nt&&((Ae=this._stats)==null||Ae.timeEnd("Page Request"),(De=nt.displayReadyCapability)==null||De.resolve(Ce))}_renderPageChunk(Ce,be){for(let nt=0,Ae=Ce.length;nt<Ae;nt++)be.operatorList.fnArray.push(Ce.fnArray[nt]),be.operatorList.argsArray.push(Ce.argsArray[nt]);be.operatorList.lastChunk=Ce.lastChunk,be.operatorList.separateAnnots=Ce.separateAnnots;for(const nt of be.renderTasks)nt.operatorListChanged();Ce.lastChunk&&Mt(this,W,li).call(this,!0)}_pumpOperatorList({renderingIntent:Ce,cacheKey:be,annotationStorageSerializable:nt}){const{map:Ae,transfers:De}=nt,Ct=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:Ce,cacheKey:be,annotationStorage:Ae},De).getReader(),ft=this._intentStates.get(be);ft.streamReader=Ct;const Et=()=>{Ct.read().then(({value:gt,done:bt})=>{if(bt){ft.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(gt,ft),Et())},gt=>{if(ft.streamReader=null,!this._transport.destroyed){if(ft.operatorList){ft.operatorList.lastChunk=!0;for(const bt of ft.renderTasks)bt.operatorListChanged();Mt(this,W,li).call(this,!0)}if(ft.displayReadyCapability)ft.displayReadyCapability.reject(gt);else if(ft.opListReadCapability)ft.opListReadCapability.reject(gt);else throw gt}})};Et()}_abortOperatorList({intentState:Ce,reason:be,force:nt=!1}){if(Ce.streamReader){if(Ce.streamReaderCancelTimeout&&(clearTimeout(Ce.streamReaderCancelTimeout),Ce.streamReaderCancelTimeout=null),!nt){if(Ce.renderTasks.size>0)return;if(be instanceof _display_utils.RenderingCancelledException){let Ae=RENDERING_CANCELLED_TIMEOUT;be.extraDelay>0&&be.extraDelay<1e3&&(Ae+=be.extraDelay),Ce.streamReaderCancelTimeout=setTimeout(()=>{Ce.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:Ce,reason:be,force:!0})},Ae);return}}if(Ce.streamReader.cancel(new _util.AbortException(be.message)).catch(()=>{}),Ce.streamReader=null,!this._transport.destroyed){for(const[Ae,De]of this._intentStates)if(De===Ce){this._intentStates.delete(Ae);break}this.cleanup()}}}get stats(){return this._stats}}L=new WeakMap,B=new WeakMap,W=new WeakSet,li=function(Ce=!1){if(Mt(this,W,ao).call(this),!Fe(this,B)||this.destroyed)return!1;if(Ce)return Xt(this,L,setTimeout(()=>{Xt(this,L,null),Mt(this,W,li).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:be,operatorList:nt}of this._intentStates.values())if(be.size>0||!nt.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Xt(this,B,!1),!0},ao=function(){Fe(this,L)&&(clearTimeout(Fe(this,L)),Xt(this,L,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){zt(this,re,new Set);zt(this,ae,Promise.resolve())}postMessage(Ce,be){const nt={data:structuredClone(Ce,be?{transfer:be}:null)};Fe(this,ae).then(()=>{for(const Ae of Fe(this,re))Ae.call(this,nt)})}addEventListener(Ce,be){Fe(this,re).add(be)}removeEventListener(Ce,be){Fe(this,re).delete(be)}terminate(){Fe(this,re).clear()}}re=new WeakMap,ae=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const ge=(se=document==null?void 0:document.currentScript)==null?void 0:se.src;ge&&(PDFWorkerUtil.fallbackWorkerSrc=ge.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(ge,Ce){let be;try{if(be=new URL(ge),!be.origin||be.origin==="null")return!1}catch{return!1}const nt=new URL(Ce,be);return be.origin===nt.origin},PDFWorkerUtil.createCDNWrapper=function(ge){const Ce=`importScripts("${ge}");`;return URL.createObjectURL(new Blob([Ce]))}}const _PDFWorker=class _PDFWorker{constructor({name:ge=null,port:Ce=null,verbosity:be=(0,_util.getVerbosityLevel)()}={}){var nt;if(this.name=ge,this.destroyed=!1,this.verbosity=be,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,Ce){if((nt=Fe(_PDFWorker,ie))!=null&&nt.has(Ce))throw new Error("Cannot use more than one PDFWorker per port.");(Fe(_PDFWorker,ie)||Xt(_PDFWorker,ie,new WeakMap)).set(Ce,this),this._initializeFromPort(Ce);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(ge){this._port=ge,this._messageHandler=new _message_handler.MessageHandler("main","worker",ge),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:ge}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,ge)||(ge=PDFWorkerUtil.createCDNWrapper(new URL(ge,window.location).href));const Ce=new Worker(ge),be=new _message_handler.MessageHandler("main","worker",Ce),nt=()=>{Ce.removeEventListener("error",Ae),be.destroy(),Ce.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Ae=()=>{this._webWorker||nt()};Ce.addEventListener("error",Ae),be.on("test",lt=>{if(Ce.removeEventListener("error",Ae),this.destroyed){nt();return}lt?(this._messageHandler=be,this._port=Ce,this._webWorker=Ce,this._readyCapability.resolve(),be.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),be.destroy(),Ce.terminate())}),be.on("ready",lt=>{if(Ce.removeEventListener("error",Ae),this.destroyed){nt();return}try{De()}catch{this._setupFakeWorker()}});const De=()=>{const lt=new Uint8Array;be.send("test",lt,[lt.buffer])};De();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(ge=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const Ce=new LoopbackPort;this._port=Ce;const be=`fake${PDFWorkerUtil.fakeWorkerId++}`,nt=new _message_handler.MessageHandler(be+"_worker",be,Ce);ge.setup(nt,Ce);const Ae=new _message_handler.MessageHandler(be,be+"_worker",Ce);this._messageHandler=Ae,this._readyCapability.resolve(),Ae.send("configure",{verbosity:this.verbosity})}).catch(ge=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${ge.message}".`))})}destroy(){var ge;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(ge=Fe(_PDFWorker,ie))==null||ge.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(ge){var be;if(!(ge!=null&&ge.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const Ce=(be=Fe(this,ie))==null?void 0:be.get(ge.port);if(Ce){if(Ce._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return Ce}return new _PDFWorker(ge)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var ge;try{return((ge=globalThis.pdfjsWorker)==null?void 0:ge.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};ie=new WeakMap,zt(_PDFWorker,ie);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(Ce,be,nt,Ae,De){zt(this,ce);zt(this,le,new Map);zt(this,pe,new Map);zt(this,he,new Map);zt(this,ue,null);this.messageHandler=Ce,this.loadingTask=be,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Ae.ownerDocument,styleElement:Ae.styleElement}),this._params=Ae,this.canvasFactory=De.canvasFactory,this.filterFactory=De.filterFactory,this.cMapReaderFactory=De.cMapReaderFactory,this.standardFontDataFactory=De.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=nt,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(Ce,be=_util.AnnotationMode.ENABLE,nt=null,Ae=!1){let De=_util.RenderingIntentFlag.DISPLAY,lt=_annotation_storage.SerializableEmpty;switch(Ce){case"any":De=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":De=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${Ce}`)}switch(be){case _util.AnnotationMode.DISABLE:De+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:De+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:De+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,lt=(De&_util.RenderingIntentFlag.PRINT&&nt instanceof _annotation_storage.PrintAnnotationStorage?nt:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${be}`)}return Ae&&(De+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:De,cacheKey:`${De}_${lt.hash}`,annotationStorageSerializable:lt}}destroy(){var nt;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(nt=Fe(this,ue))==null||nt.reject(new Error("Worker was destroyed during onPassword callback"));const Ce=[];for(const Ae of Fe(this,pe).values())Ce.push(Ae._destroy());Fe(this,pe).clear(),Fe(this,he).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const be=this.messageHandler.sendWithPromise("Terminate",null);return Ce.push(be),Promise.all(Ce).then(()=>{var Ae;this.commonObjs.clear(),this.fontLoader.clear(),Fe(this,le).clear(),this.filterFactory.destroy(),(Ae=this._networkStream)==null||Ae.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:Ce,loadingTask:be}=this;Ce.on("GetReader",(nt,Ae)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=De=>{this._lastProgress={loaded:De.loaded,total:De.total}},Ae.onPull=()=>{this._fullReader.read().then(function({value:De,done:lt}){if(lt){Ae.close();return}(0,_util.assert)(De instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Ae.enqueue(new Uint8Array(De),1,[De])}).catch(De=>{Ae.error(De)})},Ae.onCancel=De=>{this._fullReader.cancel(De),Ae.ready.catch(lt=>{if(!this.destroyed)throw lt})}}),Ce.on("ReaderHeadersReady",nt=>{const Ae=new _util.PromiseCapability,De=this._fullReader;return De.headersReady.then(()=>{var lt;(!De.isStreamingSupported||!De.isRangeSupported)&&(this._lastProgress&&((lt=be.onProgress)==null||lt.call(be,this._lastProgress)),De.onProgress=Ct=>{var ft;(ft=be.onProgress)==null||ft.call(be,{loaded:Ct.loaded,total:Ct.total})}),Ae.resolve({isStreamingSupported:De.isStreamingSupported,isRangeSupported:De.isRangeSupported,contentLength:De.contentLength})},Ae.reject),Ae.promise}),Ce.on("GetRangeReader",(nt,Ae)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const De=this._networkStream.getRangeReader(nt.begin,nt.end);if(!De){Ae.close();return}Ae.onPull=()=>{De.read().then(function({value:lt,done:Ct}){if(Ct){Ae.close();return}(0,_util.assert)(lt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Ae.enqueue(new Uint8Array(lt),1,[lt])}).catch(lt=>{Ae.error(lt)})},Ae.onCancel=lt=>{De.cancel(lt),Ae.ready.catch(Ct=>{if(!this.destroyed)throw Ct})}}),Ce.on("GetDoc",({pdfInfo:nt})=>{this._numPages=nt.numPages,this._htmlForXfa=nt.htmlForXfa,delete nt.htmlForXfa,be._capability.resolve(new PDFDocumentProxy(nt,this))}),Ce.on("DocException",function(nt){let Ae;switch(nt.name){case"PasswordException":Ae=new _util.PasswordException(nt.message,nt.code);break;case"InvalidPDFException":Ae=new _util.InvalidPDFException(nt.message);break;case"MissingPDFException":Ae=new _util.MissingPDFException(nt.message);break;case"UnexpectedResponseException":Ae=new _util.UnexpectedResponseException(nt.message,nt.status);break;case"UnknownErrorException":Ae=new _util.UnknownErrorException(nt.message,nt.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}be._capability.reject(Ae)}),Ce.on("PasswordRequest",nt=>{if(Xt(this,ue,new _util.PromiseCapability),be.onPassword){const Ae=De=>{De instanceof Error?Fe(this,ue).reject(De):Fe(this,ue).resolve({password:De})};try{be.onPassword(Ae,nt.code)}catch(De){Fe(this,ue).reject(De)}}else Fe(this,ue).reject(new _util.PasswordException(nt.message,nt.code));return Fe(this,ue).promise}),Ce.on("DataLoaded",nt=>{var Ae;(Ae=be.onProgress)==null||Ae.call(be,{loaded:nt.length,total:nt.length}),this.downloadInfoCapability.resolve(nt)}),Ce.on("StartRenderPage",nt=>{if(this.destroyed)return;Fe(this,pe).get(nt.pageIndex)._startRenderPage(nt.transparency,nt.cacheKey)}),Ce.on("commonobj",([nt,Ae,De])=>{var lt;if(!this.destroyed&&!this.commonObjs.has(nt))switch(Ae){case"Font":const Ct=this._params;if("error"in De){const gt=De.error;(0,_util.warn)(`Error during font loading: ${gt}`),this.commonObjs.resolve(nt,gt);break}const ft=Ct.pdfBug&&((lt=globalThis.FontInspector)!=null&&lt.enabled)?(gt,bt)=>globalThis.FontInspector.fontAdded(gt,bt):null,Et=new _font_loader.FontFaceObject(De,{isEvalSupported:Ct.isEvalSupported,disableFontFace:Ct.disableFontFace,ignoreErrors:Ct.ignoreErrors,inspectFont:ft});this.fontLoader.bind(Et).catch(gt=>Ce.sendWithPromise("FontFallback",{id:nt})).finally(()=>{!Ct.fontExtraProperties&&Et.data&&(Et.data=null),this.commonObjs.resolve(nt,Et)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(nt,De);break;default:throw new Error(`Got unknown common object type ${Ae}`)}}),Ce.on("obj",([nt,Ae,De,lt])=>{var ft;if(this.destroyed)return;const Ct=Fe(this,pe).get(Ae);if(!Ct.objs.has(nt))switch(De){case"Image":if(Ct.objs.resolve(nt,lt),lt){let Et;if(lt.bitmap){const{width:gt,height:bt}=lt;Et=gt*bt*4}else Et=((ft=lt.data)==null?void 0:ft.length)||0;Et>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Ct._maybeCleanupAfterRender=!0)}break;case"Pattern":Ct.objs.resolve(nt,lt);break;default:throw new Error(`Got unknown object type ${De}`)}}),Ce.on("DocProgress",nt=>{var Ae;this.destroyed||(Ae=be.onProgress)==null||Ae.call(be,{loaded:nt.loaded,total:nt.total})}),Ce.on("FetchBuiltInCMap",nt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(nt):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),Ce.on("FetchStandardFontData",nt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(nt):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var nt;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:Ce,transfers:be}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:Ce,filename:((nt=this._fullReader)==null?void 0:nt.filename)??null},be).finally(()=>{this.annotationStorage.resetModified()})}getPage(Ce){if(!Number.isInteger(Ce)||Ce<=0||Ce>this._numPages)return Promise.reject(new Error("Invalid page request."));const be=Ce-1,nt=Fe(this,he).get(be);if(nt)return nt;const Ae=this.messageHandler.sendWithPromise("GetPage",{pageIndex:be}).then(De=>{if(this.destroyed)throw new Error("Transport destroyed");const lt=new PDFPageProxy(be,De,this,this._params.pdfBug);return Fe(this,pe).set(be,lt),lt});return Fe(this,he).set(be,Ae),Ae}getPageIndex(Ce){return typeof Ce!="object"||Ce===null||!Number.isInteger(Ce.num)||Ce.num<0||!Number.isInteger(Ce.gen)||Ce.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:Ce.num,gen:Ce.gen})}getAnnotations(Ce,be){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:Ce,intent:be})}getFieldObjects(){return Mt(this,ce,io).call(this,"GetFieldObjects")}hasJSActions(){return Mt(this,ce,io).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(Ce){return typeof Ce!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:Ce})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Mt(this,ce,io).call(this,"GetDocJSActions")}getPageJSActions(Ce){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:Ce})}getStructTree(Ce){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:Ce})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(Ce=>new _optional_content_config.OptionalContentConfig(Ce))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const Ce="GetMetadata",be=Fe(this,le).get(Ce);if(be)return be;const nt=this.messageHandler.sendWithPromise(Ce,null).then(Ae=>{var De,lt;return{info:Ae[0],metadata:Ae[1]?new _metadata.Metadata(Ae[1]):null,contentDispositionFilename:((De=this._fullReader)==null?void 0:De.filename)??null,contentLength:((lt=this._fullReader)==null?void 0:lt.contentLength)??null}});return Fe(this,le).set(Ce,nt),nt}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(Ce=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const be of Fe(this,pe).values())if(!be.cleanup())throw new Error(`startCleanup: Page ${be.pageNumber} is currently rendering.`);this.commonObjs.clear(),Ce||this.fontLoader.clear(),Fe(this,le).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:Ce,enableXfa:be}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:Ce,enableXfa:be})}}le=new WeakMap,pe=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakSet,io=function(Ce,be=null){const nt=Fe(this,le).get(Ce);if(nt)return nt;const Ae=this.messageHandler.sendWithPromise(Ce,be);return Fe(this,le).set(Ce,Ae),Ae};class PDFObjects{constructor(){zt(this,ke);zt(this,me,Object.create(null))}get(Ce,be=null){if(be){const Ae=Mt(this,ke,Zl).call(this,Ce);return Ae.capability.promise.then(()=>be(Ae.data)),null}const nt=Fe(this,me)[Ce];if(!(nt!=null&&nt.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${Ce}.`);return nt.data}has(Ce){const be=Fe(this,me)[Ce];return(be==null?void 0:be.capability.settled)||!1}resolve(Ce,be=null){const nt=Mt(this,ke,Zl).call(this,Ce);nt.data=be,nt.capability.resolve()}clear(){var Ce;for(const be in Fe(this,me)){const{data:nt}=Fe(this,me)[be];(Ce=nt==null?void 0:nt.bitmap)==null||Ce.close()}Xt(this,me,Object.create(null))}}me=new WeakMap,ke=new WeakSet,Zl=function(Ce){var be;return(be=Fe(this,me))[Ce]||(be[Ce]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(Ce){zt(this,Le,null);Xt(this,Le,Ce),this.onContinue=null}get promise(){return Fe(this,Le).capability.promise}cancel(Ce=0){Fe(this,Le).cancel(null,Ce)}get separateAnnots(){const{separateAnnots:Ce}=Fe(this,Le).operatorList;if(!Ce)return!1;const{annotationCanvasMap:be}=Fe(this,Le);return Ce.form||Ce.canvas&&(be==null?void 0:be.size)>0}}Le=new WeakMap,exports.RenderTask=RenderTask;const Te=class Te{constructor({callback:Ce,params:be,objs:nt,commonObjs:Ae,annotationCanvasMap:De,operatorList:lt,pageIndex:Ct,canvasFactory:ft,filterFactory:Et,useRequestAnimationFrame:gt=!1,pdfBug:bt=!1,pageColors:Ie=null}){this.callback=Ce,this.params=be,this.objs=nt,this.commonObjs=Ae,this.annotationCanvasMap=De,this.operatorListIdx=null,this.operatorList=lt,this._pageIndex=Ct,this.canvasFactory=ft,this.filterFactory=Et,this._pdfBug=bt,this.pageColors=Ie,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=gt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=be.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:Ce=!1,optionalContentConfig:be}){var Ct,ft;if(this.cancelled)return;if(this._canvas){if(Fe(Te,Se).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Fe(Te,Se).add(this._canvas)}this._pdfBug&&((Ct=globalThis.StepperManager)!=null&&Ct.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:nt,viewport:Ae,transform:De,background:lt}=this.params;this.gfx=new _canvas.CanvasGraphics(nt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:be},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:De,viewport:Ae,transparency:Ce,background:lt}),this.operatorListIdx=0,this.graphicsReady=!0,(ft=this.graphicsReadyCallback)==null||ft.call(this)}cancel(Ce=null,be=0){var nt;this.running=!1,this.cancelled=!0,(nt=this.gfx)==null||nt.endDrawing(),Fe(Te,Se).delete(this._canvas),this.callback(Ce||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,be))}operatorListChanged(){var Ce;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(Ce=this.stepper)==null||Ce.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Fe(Te,Se).delete(this._canvas),this.callback())))}};Se=new WeakMap,zt(Te,Se,new WeakSet);let InternalRenderTask=Te;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(g,A,L)=>{var se,ie,le,a0,he;Object.defineProperty(A,"__esModule",{value:!0}),A.SerializableEmpty=A.PrintAnnotationStorage=A.AnnotationStorage=void 0;var B=L(1),W=L(4),q=L(8);const J=Object.freeze({map:null,hash:"",transfers:void 0});A.SerializableEmpty=J;class re{constructor(){zt(this,le);zt(this,se,!1);zt(this,ie,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(ce,fe){const me=Fe(this,ie).get(ce);return me===void 0?fe:Object.assign(fe,me)}getRawValue(ce){return Fe(this,ie).get(ce)}remove(ce){if(Fe(this,ie).delete(ce),Fe(this,ie).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const fe of Fe(this,ie).values())if(fe instanceof W.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(ce,fe){const me=Fe(this,ie).get(ce);let ke=!1;if(me!==void 0)for(const[xe,Le]of Object.entries(fe))me[xe]!==Le&&(ke=!0,me[xe]=Le);else ke=!0,Fe(this,ie).set(ce,fe);ke&&Mt(this,le,a0).call(this),fe instanceof W.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(fe.constructor._type)}has(ce){return Fe(this,ie).has(ce)}getAll(){return Fe(this,ie).size>0?(0,B.objectFromMap)(Fe(this,ie)):null}setAll(ce){for(const[fe,me]of Object.entries(ce))this.setValue(fe,me)}get size(){return Fe(this,ie).size}resetModified(){Fe(this,se)&&(Xt(this,se,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ae(this)}get serializable(){if(Fe(this,ie).size===0)return J;const ce=new Map,fe=new q.MurmurHash3_64,me=[],ke=Object.create(null);let xe=!1;for(const[Le,Se]of Fe(this,ie)){const Te=Se instanceof W.AnnotationEditor?Se.serialize(!1,ke):Se;Te&&(ce.set(Le,Te),fe.update(`${Le}:${JSON.stringify(Te)}`),xe||(xe=!!Te.bitmap))}if(xe)for(const Le of ce.values())Le.bitmap&&me.push(Le.bitmap);return ce.size>0?{map:ce,hash:fe.hexdigest(),transfers:me}:J}}se=new WeakMap,ie=new WeakMap,le=new WeakSet,a0=function(){Fe(this,se)||(Xt(this,se,!0),typeof this.onSetModified=="function"&&this.onSetModified())},A.AnnotationStorage=re;class ae extends re{constructor(fe){super();zt(this,he);const{map:me,hash:ke,transfers:xe}=fe.serializable,Le=structuredClone(me,xe?{transfer:xe}:null);Xt(this,he,{map:Le,hash:ke,transfers:xe})}get print(){(0,B.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return Fe(this,he)}}he=new WeakMap,A.PrintAnnotationStorage=ae},(g,A,L)=>{var ae,se,ie,le,pe,he,ue,ce,fe,me,ke,xe,Le,Se,Te,ec,tc,be,rc,nc,i0,s0,o0,ac,l0;Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationEditor=void 0;var B=L(5),W=L(1),q=L(6);const gt=class gt{constructor(Ie){zt(this,Te);zt(this,ae,"");zt(this,se,!1);zt(this,ie,null);zt(this,le,null);zt(this,pe,null);zt(this,he,!1);zt(this,ue,null);zt(this,ce,this.focusin.bind(this));zt(this,fe,this.focusout.bind(this));zt(this,me,!1);zt(this,ke,!1);zt(this,xe,!1);Kr(this,"_initialOptions",Object.create(null));Kr(this,"_uiManager",null);Kr(this,"_focusEventsAllowed",!0);Kr(this,"_l10nPromise",null);zt(this,Le,!1);zt(this,Se,gt._zIndex++);this.constructor===gt&&(0,W.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Ie.parent,this.id=Ie.id,this.width=this.height=null,this.pageIndex=Ie.parent.pageIndex,this.name=Ie.name,this.div=null,this._uiManager=Ie.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Ie.isCentered,this._structTreeParentId=null;const{rotation:pt,rawDims:{pageWidth:at,pageHeight:Ee,pageX:ye,pageY:ve}}=this.parent.viewport;this.rotation=pt,this.pageRotation=(360+pt-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[at,Ee],this.pageTranslation=[ye,ve];const[Pe,rt]=this.parentDimensions;this.x=Ie.x/Pe,this.y=Ie.y/rt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,W.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Ie){const pt=new re({id:Ie.parent.getNextId(),parent:Ie.parent,uiManager:Ie._uiManager});pt.annotationElementId=Ie.annotationElementId,pt.deleted=!0,pt._uiManager.addToAnnotationStorage(pt)}static initialize(Ie,pt=null){if(gt._l10nPromise||(gt._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Ee=>[Ee,Ie.get(Ee)]))),pt!=null&&pt.strings)for(const Ee of pt.strings)gt._l10nPromise.set(Ee,Ie.get(Ee));if(gt._borderLineWidth!==-1)return;const at=getComputedStyle(document.documentElement);gt._borderLineWidth=parseFloat(at.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Ie,pt){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Ie){return!1}static paste(Ie,pt){(0,W.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return Fe(this,Le)}set _isDraggable(Ie){var pt;Xt(this,Le,Ie),(pt=this.div)==null||pt.classList.toggle("draggable",Ie)}center(){const[Ie,pt]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*pt/(Ie*2),this.y+=this.width*Ie/(pt*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*pt/(Ie*2),this.y-=this.width*Ie/(pt*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Ie){this._uiManager.addCommands(Ie)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Fe(this,Se)}setParent(Ie){Ie!==null&&(this.pageIndex=Ie.pageIndex,this.pageDimensions=Ie.pageDimensions),this.parent=Ie}focusin(Ie){this._focusEventsAllowed&&(Fe(this,me)?Xt(this,me,!1):this.parent.setSelected(this))}focusout(Ie){var at;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const pt=Ie.relatedTarget;pt!=null&&pt.closest(`#${this.id}`)||(Ie.preventDefault(),(at=this.parent)!=null&&at.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Ie,pt,at,Ee){const[ye,ve]=this.parentDimensions;[at,Ee]=this.screenToPageTranslation(at,Ee),this.x=(Ie+at)/ye,this.y=(pt+Ee)/ve,this.fixAndSetPosition()}translate(Ie,pt){Mt(this,Te,ec).call(this,this.parentDimensions,Ie,pt)}translateInPage(Ie,pt){Mt(this,Te,ec).call(this,this.pageDimensions,Ie,pt),this.div.scrollIntoView({block:"nearest"})}drag(Ie,pt){const[at,Ee]=this.parentDimensions;if(this.x+=Ie/at,this.y+=pt/Ee,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:st,y:ot}=this.div.getBoundingClientRect();this.parent.findNewParent(this,st,ot)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:ye,y:ve}=this;const[Pe,rt]=Mt(this,Te,tc).call(this);ye+=Pe,ve+=rt,this.div.style.left=`${(100*ye).toFixed(2)}%`,this.div.style.top=`${(100*ve).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[Ie,pt]=this.pageDimensions;let{x:at,y:Ee,width:ye,height:ve}=this;switch(ye*=Ie,ve*=pt,at*=Ie,Ee*=pt,this.rotation){case 0:at=Math.max(0,Math.min(Ie-ye,at)),Ee=Math.max(0,Math.min(pt-ve,Ee));break;case 90:at=Math.max(0,Math.min(Ie-ve,at)),Ee=Math.min(pt,Math.max(ye,Ee));break;case 180:at=Math.min(Ie,Math.max(ye,at)),Ee=Math.min(pt,Math.max(ve,Ee));break;case 270:at=Math.min(Ie,Math.max(ve,at)),Ee=Math.max(0,Math.min(pt-ye,Ee));break}this.x=at/=Ie,this.y=Ee/=pt;const[Pe,rt]=Mt(this,Te,tc).call(this);at+=Pe,Ee+=rt;const{style:st}=this.div;st.left=`${(100*at).toFixed(2)}%`,st.top=`${(100*Ee).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Ie,pt){var at;return Mt(at=gt,be,rc).call(at,Ie,pt,this.parentRotation)}pageTranslationToScreen(Ie,pt){var at;return Mt(at=gt,be,rc).call(at,Ie,pt,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Ie,pageDimensions:[pt,at]}=this,Ee=pt*Ie,ye=at*Ie;return W.FeatureTest.isCSSRoundSupported?[Math.round(Ee),Math.round(ye)]:[Ee,ye]}setDims(Ie,pt){var ye;const[at,Ee]=this.parentDimensions;this.div.style.width=`${(100*Ie/at).toFixed(2)}%`,Fe(this,he)||(this.div.style.height=`${(100*pt/Ee).toFixed(2)}%`),(ye=Fe(this,ie))==null||ye.classList.toggle("small",Ie<gt.SMALL_EDITOR_SIZE||pt<gt.SMALL_EDITOR_SIZE)}fixDims(){const{style:Ie}=this.div,{height:pt,width:at}=Ie,Ee=at.endsWith("%"),ye=!Fe(this,he)&&pt.endsWith("%");if(Ee&&ye)return;const[ve,Pe]=this.parentDimensions;Ee||(Ie.width=`${(100*parseFloat(at)/ve).toFixed(2)}%`),!Fe(this,he)&&!ye&&(Ie.height=`${(100*parseFloat(pt)/Pe).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(Fe(this,ie))return;const Ie=Xt(this,ie,document.createElement("button"));Ie.className="altText";const pt=await gt._l10nPromise.get("editor_alt_text_button_label");Ie.textContent=pt,Ie.setAttribute("aria-label",pt),Ie.tabIndex="0",Ie.addEventListener("contextmenu",q.noContextMenu),Ie.addEventListener("pointerdown",at=>at.stopPropagation()),Ie.addEventListener("click",at=>{at.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Ie.addEventListener("keydown",at=>{at.target===Ie&&at.key==="Enter"&&(at.preventDefault(),this._uiManager.editAltText(this))}),Mt(this,Te,ac).call(this),this.div.append(Ie),gt.SMALL_EDITOR_SIZE||(gt.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Ie.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:Fe(this,ae),decorative:Fe(this,se)}}set altTextData({altText:Ie,decorative:pt}){Fe(this,ae)===Ie&&Fe(this,se)===pt||(Xt(this,ae,Ie),Xt(this,se,pt),Mt(this,Te,ac).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",Fe(this,ce)),this.div.addEventListener("focusout",Fe(this,fe));const[Ie,pt]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*pt/Ie).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Ie/pt).toFixed(2)}%`);const[at,Ee]=this.getInitialTranslation();return this.translate(at,Ee),(0,B.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Ie){const{isMac:pt}=W.FeatureTest.platform;if(Ie.button!==0||Ie.ctrlKey&&pt){Ie.preventDefault();return}Xt(this,me,!0),Mt(this,Te,l0).call(this,Ie)}moveInDOM(){var Ie;(Ie=this.parent)==null||Ie.moveEditorInDOM(this)}_setParentAndPosition(Ie,pt,at){Ie.changeParent(this),this.x=pt,this.y=at,this.fixAndSetPosition()}getRect(Ie,pt){const at=this.parentScale,[Ee,ye]=this.pageDimensions,[ve,Pe]=this.pageTranslation,rt=Ie/at,st=pt/at,ot=this.x*Ee,mt=this.y*ye,At=this.width*Ee,It=this.height*ye;switch(this.rotation){case 0:return[ot+rt+ve,ye-mt-st-It+Pe,ot+rt+At+ve,ye-mt-st+Pe];case 90:return[ot+st+ve,ye-mt+rt+Pe,ot+st+It+ve,ye-mt+rt+At+Pe];case 180:return[ot-rt-At+ve,ye-mt+st+Pe,ot-rt+ve,ye-mt+st+It+Pe];case 270:return[ot-st-It+ve,ye-mt-rt-At+Pe,ot-st+ve,ye-mt-rt+Pe];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Ie,pt){const[at,Ee,ye,ve]=Ie,Pe=ye-at,rt=ve-Ee;switch(this.rotation){case 0:return[at,pt-ve,Pe,rt];case 90:return[at,pt-Ee,rt,Pe];case 180:return[ye,pt-Ee,Pe,rt];case 270:return[ye,pt-ve,rt,Pe];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Xt(this,xe,!0)}disableEditMode(){Xt(this,xe,!1)}isInEditMode(){return Fe(this,xe)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Ie,pt;(Ie=this.div)==null||Ie.addEventListener("focusin",Fe(this,ce)),(pt=this.div)==null||pt.addEventListener("focusout",Fe(this,fe))}serialize(Ie=!1,pt=null){(0,W.unreachable)("An editor must be serializable")}static deserialize(Ie,pt,at){const Ee=new this.prototype.constructor({parent:pt,id:pt.getNextId(),uiManager:at});Ee.rotation=Ie.rotation;const[ye,ve]=Ee.pageDimensions,[Pe,rt,st,ot]=Ee.getRectInCurrentCoords(Ie.rect,ve);return Ee.x=Pe/ye,Ee.y=rt/ve,Ee.width=st/ye,Ee.height=ot/ve,Ee}remove(){var Ie;this.div.removeEventListener("focusin",Fe(this,ce)),this.div.removeEventListener("focusout",Fe(this,fe)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(Ie=Fe(this,ie))==null||Ie.remove(),Xt(this,ie,null),Xt(this,le,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Mt(this,Te,i0).call(this),Fe(this,ue).classList.remove("hidden"))}select(){var Ie;this.makeResizable(),(Ie=this.div)==null||Ie.classList.add("selectedEditor")}unselect(){var Ie,pt,at;(Ie=Fe(this,ue))==null||Ie.classList.add("hidden"),(pt=this.div)==null||pt.classList.remove("selectedEditor"),(at=this.div)!=null&&at.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Ie,pt){}disableEditing(){Fe(this,ie)&&(Fe(this,ie).hidden=!0)}enableEditing(){Fe(this,ie)&&(Fe(this,ie).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return Fe(this,ke)}set isEditing(Ie){Xt(this,ke,Ie),this.parent&&(Ie?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Ie,pt){Xt(this,he,!0);const at=Ie/pt,{style:Ee}=this.div;Ee.aspectRatio=at,Ee.height="auto"}static get MIN_SIZE(){return 16}};ae=new WeakMap,se=new WeakMap,ie=new WeakMap,le=new WeakMap,pe=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakMap,fe=new WeakMap,me=new WeakMap,ke=new WeakMap,xe=new WeakMap,Le=new WeakMap,Se=new WeakMap,Te=new WeakSet,ec=function([Ie,pt],at,Ee){[at,Ee]=this.screenToPageTranslation(at,Ee),this.x+=at/Ie,this.y+=Ee/pt,this.fixAndSetPosition()},tc=function(){const[Ie,pt]=this.parentDimensions,{_borderLineWidth:at}=gt,Ee=at/Ie,ye=at/pt;switch(this.rotation){case 90:return[-Ee,ye];case 180:return[Ee,ye];case 270:return[Ee,-ye];default:return[-Ee,-ye]}},be=new WeakSet,rc=function(Ie,pt,at){switch(at){case 90:return[pt,-Ie];case 180:return[-Ie,-pt];case 270:return[-pt,Ie];default:return[Ie,pt]}},nc=function(Ie){switch(Ie){case 90:{const[pt,at]=this.pageDimensions;return[0,-pt/at,at/pt,0]}case 180:return[-1,0,0,-1];case 270:{const[pt,at]=this.pageDimensions;return[0,pt/at,-at/pt,0]}default:return[1,0,0,1]}},i0=function(){if(Fe(this,ue))return;Xt(this,ue,document.createElement("div")),Fe(this,ue).classList.add("resizers");const Ie=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Ie.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const pt of Ie){const at=document.createElement("div");Fe(this,ue).append(at),at.classList.add("resizer",pt),at.addEventListener("pointerdown",Mt(this,Te,s0).bind(this,pt)),at.addEventListener("contextmenu",q.noContextMenu)}this.div.prepend(Fe(this,ue))},s0=function(Ie,pt){pt.preventDefault();const{isMac:at}=W.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&at)return;const Ee=Mt(this,Te,o0).bind(this,Ie),ye=this._isDraggable;this._isDraggable=!1;const ve={passive:!0,capture:!0};window.addEventListener("pointermove",Ee,ve);const Pe=this.x,rt=this.y,st=this.width,ot=this.height,mt=this.parent.div.style.cursor,At=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(pt.target).cursor;const It=()=>{this._isDraggable=ye,window.removeEventListener("pointerup",It),window.removeEventListener("blur",It),window.removeEventListener("pointermove",Ee,ve),this.parent.div.style.cursor=mt,this.div.style.cursor=At;const it=this.x,Vt=this.y,Yt=this.width,Zt=this.height;it===Pe&&Vt===rt&&Yt===st&&Zt===ot||this.addCommands({cmd:()=>{this.width=Yt,this.height=Zt,this.x=it,this.y=Vt;const[Lt,Ft]=this.parentDimensions;this.setDims(Lt*Yt,Ft*Zt),this.fixAndSetPosition()},undo:()=>{this.width=st,this.height=ot,this.x=Pe,this.y=rt;const[Lt,Ft]=this.parentDimensions;this.setDims(Lt*st,Ft*ot),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",It),window.addEventListener("blur",It)},o0=function(Ie,pt){const[at,Ee]=this.parentDimensions,ye=this.x,ve=this.y,Pe=this.width,rt=this.height,st=gt.MIN_SIZE/at,ot=gt.MIN_SIZE/Ee,mt=dr=>Math.round(dr*1e4)/1e4,At=Mt(this,Te,nc).call(this,this.rotation),It=(dr,br)=>[At[0]*dr+At[2]*br,At[1]*dr+At[3]*br],it=Mt(this,Te,nc).call(this,360-this.rotation),Vt=(dr,br)=>[it[0]*dr+it[2]*br,it[1]*dr+it[3]*br];let Yt,Zt,Lt=!1,Ft=!1;switch(Ie){case"topLeft":Lt=!0,Yt=(dr,br)=>[0,0],Zt=(dr,br)=>[dr,br];break;case"topMiddle":Yt=(dr,br)=>[dr/2,0],Zt=(dr,br)=>[dr/2,br];break;case"topRight":Lt=!0,Yt=(dr,br)=>[dr,0],Zt=(dr,br)=>[0,br];break;case"middleRight":Ft=!0,Yt=(dr,br)=>[dr,br/2],Zt=(dr,br)=>[0,br/2];break;case"bottomRight":Lt=!0,Yt=(dr,br)=>[dr,br],Zt=(dr,br)=>[0,0];break;case"bottomMiddle":Yt=(dr,br)=>[dr/2,br],Zt=(dr,br)=>[dr/2,0];break;case"bottomLeft":Lt=!0,Yt=(dr,br)=>[0,br],Zt=(dr,br)=>[dr,0];break;case"middleLeft":Ft=!0,Yt=(dr,br)=>[0,br/2],Zt=(dr,br)=>[dr,br/2];break}const ht=Yt(Pe,rt),kt=Zt(Pe,rt);let Dt=It(...kt);const Bt=mt(ye+Dt[0]),Qt=mt(ve+Dt[1]);let or=1,ar=1,[Nt,fr]=this.screenToPageTranslation(pt.movementX,pt.movementY);if([Nt,fr]=Vt(Nt/at,fr/Ee),Lt){const dr=Math.hypot(Pe,rt);or=ar=Math.max(Math.min(Math.hypot(kt[0]-ht[0]-Nt,kt[1]-ht[1]-fr)/dr,1/Pe,1/rt),st/Pe,ot/rt)}else Ft?or=Math.max(st,Math.min(1,Math.abs(kt[0]-ht[0]-Nt)))/Pe:ar=Math.max(ot,Math.min(1,Math.abs(kt[1]-ht[1]-fr)))/rt;const ur=mt(Pe*or),Pr=mt(rt*ar);Dt=It(...Zt(ur,Pr));const Rr=Bt-Dt[0],vr=Qt-Dt[1];this.width=ur,this.height=Pr,this.x=Rr,this.y=vr,this.setDims(at*ur,Ee*Pr),this.fixAndSetPosition()},ac=async function(){var at;const Ie=Fe(this,ie);if(!Ie)return;if(!Fe(this,ae)&&!Fe(this,se)){Ie.classList.remove("done"),(at=Fe(this,le))==null||at.remove();return}gt._l10nPromise.get("editor_alt_text_edit_button_label").then(Ee=>{Ie.setAttribute("aria-label",Ee)});let pt=Fe(this,le);if(!pt){Xt(this,le,pt=document.createElement("span")),pt.className="tooltip",pt.setAttribute("role","tooltip");const Ee=pt.id=`alt-text-tooltip-${this.id}`;Ie.setAttribute("aria-describedby",Ee);const ye=100;Ie.addEventListener("mouseenter",()=>{Xt(this,pe,setTimeout(()=>{Xt(this,pe,null),Fe(this,le).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},ye))}),Ie.addEventListener("mouseleave",()=>{var ve;clearTimeout(Fe(this,pe)),Xt(this,pe,null),(ve=Fe(this,le))==null||ve.classList.remove("show")})}Ie.classList.add("done"),pt.innerText=Fe(this,se)?await gt._l10nPromise.get("editor_alt_text_decorative_tooltip"):Fe(this,ae),pt.parentNode||Ie.append(pt)},l0=function(Ie){if(!this._isDraggable)return;const pt=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let at,Ee;pt&&(at={passive:!0,capture:!0},Ee=ve=>{const[Pe,rt]=this.screenToPageTranslation(ve.movementX,ve.movementY);this._uiManager.dragSelectedEditors(Pe,rt)},window.addEventListener("pointermove",Ee,at));const ye=()=>{if(window.removeEventListener("pointerup",ye),window.removeEventListener("blur",ye),pt&&window.removeEventListener("pointermove",Ee,at),Xt(this,me,!1),!this._uiManager.endDragSession()){const{isMac:ve}=W.FeatureTest.platform;Ie.ctrlKey&&!ve||Ie.shiftKey||Ie.metaKey&&ve?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",ye),window.addEventListener("blur",ye)},zt(gt,be),Kr(gt,"_borderLineWidth",-1),Kr(gt,"_colorManager",new B.ColorManager),Kr(gt,"_zIndex",1),Kr(gt,"SMALL_EDITOR_SIZE",0);let J=gt;A.AnnotationEditor=J;class re extends J{constructor(Ie){super(Ie),this.annotationElementId=Ie.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(g,A,L)=>{var he,ue,ce,fe,me,ic,Le,Se,Te,ge,Ce,c0,Ae,De,lt,Ct,ft,Et,gt,bt,Ie,pt,at,Ee,ye,ve,Pe,rt,st,ot,mt,At,It,it,Vt,Yt,Zt,Lt,Ft,ht,kt,Dt,Bt,Qt,or,ar,Nt,u0,sc,oc,so,lc,cc,Un,Yi,f0,h0,uc,Ki,fc;Object.defineProperty(A,"__esModule",{value:!0}),A.KeyboardManager=A.CommandManager=A.ColorManager=A.AnnotationEditorUIManager=void 0,A.bindEvents=q,A.opacityToHex=J;var B=L(1),W=L(6);function q(Ur,Tt,rr){for(const hr of rr)Tt.addEventListener(hr,Ur[hr].bind(Ur))}function J(Ur){return Math.round(Math.min(255,Math.max(1,255*Ur))).toString(16).padStart(2,"0")}class re{constructor(){zt(this,he,0)}getId(){return`${B.AnnotationEditorPrefix}${Gi(this,he)._++}`}}he=new WeakMap;const xe=class xe{constructor(){zt(this,me);zt(this,ue,(0,B.getUuid)());zt(this,ce,0);zt(this,fe,null)}static get _isSVGFittingCanvas(){const Tt='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',hr=new OffscreenCanvas(1,3).getContext("2d"),Cr=new Image;Cr.src=Tt;const Fr=Cr.decode().then(()=>(hr.drawImage(Cr,0,0,1,1,0,0,1,3),new Uint32Array(hr.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,B.shadow)(this,"_isSVGFittingCanvas",Fr)}async getFromFile(Tt){const{lastModified:rr,name:hr,size:Cr,type:Fr}=Tt;return Mt(this,me,ic).call(this,`${rr}_${hr}_${Cr}_${Fr}`,Tt)}async getFromUrl(Tt){return Mt(this,me,ic).call(this,Tt,Tt)}async getFromId(Tt){Fe(this,fe)||Xt(this,fe,new Map);const rr=Fe(this,fe).get(Tt);return rr?rr.bitmap?(rr.refCounter+=1,rr):rr.file?this.getFromFile(rr.file):this.getFromUrl(rr.url):null}getSvgUrl(Tt){const rr=Fe(this,fe).get(Tt);return rr!=null&&rr.isSvg?rr.svgUrl:null}deleteId(Tt){Fe(this,fe)||Xt(this,fe,new Map);const rr=Fe(this,fe).get(Tt);rr&&(rr.refCounter-=1,rr.refCounter===0&&(rr.bitmap=null))}isValidId(Tt){return Tt.startsWith(`image_${Fe(this,ue)}_`)}};ue=new WeakMap,ce=new WeakMap,fe=new WeakMap,me=new WeakSet,ic=async function(Tt,rr){Fe(this,fe)||Xt(this,fe,new Map);let hr=Fe(this,fe).get(Tt);if(hr===null)return null;if(hr!=null&&hr.bitmap)return hr.refCounter+=1,hr;try{hr||(hr={bitmap:null,id:`image_${Fe(this,ue)}_${Gi(this,ce)._++}`,refCounter:0,isSvg:!1});let Cr;if(typeof rr=="string"){hr.url=rr;const Fr=await fetch(rr);if(!Fr.ok)throw new Error(Fr.statusText);Cr=await Fr.blob()}else Cr=hr.file=rr;if(Cr.type==="image/svg+xml"){const Fr=xe._isSVGFittingCanvas,yr=new FileReader,St=new Image,xt=new Promise((Pt,Gt)=>{St.onload=()=>{hr.bitmap=St,hr.isSvg=!0,Pt()},yr.onload=async()=>{const qt=hr.svgUrl=yr.result;St.src=await Fr?`${qt}#svgView(preserveAspectRatio(none))`:qt},St.onerror=yr.onerror=Gt});yr.readAsDataURL(Cr),await xt}else hr.bitmap=await createImageBitmap(Cr);hr.refCounter=1}catch(Cr){console.error(Cr),hr=null}return Fe(this,fe).set(Tt,hr),hr&&Fe(this,fe).set(hr.id,hr),hr};let ae=xe;class se{constructor(Tt=128){zt(this,Le,[]);zt(this,Se,!1);zt(this,Te);zt(this,ge,-1);Xt(this,Te,Tt)}add({cmd:Tt,undo:rr,mustExec:hr,type:Cr=NaN,overwriteIfSameType:Fr=!1,keepUndo:yr=!1}){if(hr&&Tt(),Fe(this,Se))return;const St={cmd:Tt,undo:rr,type:Cr};if(Fe(this,ge)===-1){Fe(this,Le).length>0&&(Fe(this,Le).length=0),Xt(this,ge,0),Fe(this,Le).push(St);return}if(Fr&&Fe(this,Le)[Fe(this,ge)].type===Cr){yr&&(St.undo=Fe(this,Le)[Fe(this,ge)].undo),Fe(this,Le)[Fe(this,ge)]=St;return}const xt=Fe(this,ge)+1;xt===Fe(this,Te)?Fe(this,Le).splice(0,1):(Xt(this,ge,xt),xt<Fe(this,Le).length&&Fe(this,Le).splice(xt)),Fe(this,Le).push(St)}undo(){Fe(this,ge)!==-1&&(Xt(this,Se,!0),Fe(this,Le)[Fe(this,ge)].undo(),Xt(this,Se,!1),Xt(this,ge,Fe(this,ge)-1))}redo(){Fe(this,ge)<Fe(this,Le).length-1&&(Xt(this,ge,Fe(this,ge)+1),Xt(this,Se,!0),Fe(this,Le)[Fe(this,ge)].cmd(),Xt(this,Se,!1))}hasSomethingToUndo(){return Fe(this,ge)!==-1}hasSomethingToRedo(){return Fe(this,ge)<Fe(this,Le).length-1}destroy(){Xt(this,Le,null)}}Le=new WeakMap,Se=new WeakMap,Te=new WeakMap,ge=new WeakMap,A.CommandManager=se;class ie{constructor(Tt){zt(this,Ce);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:rr}=B.FeatureTest.platform;for(const[hr,Cr,Fr={}]of Tt)for(const yr of hr){const St=yr.startsWith("mac+");rr&&St?(this.callbacks.set(yr.slice(4),{callback:Cr,options:Fr}),this.allKeys.add(yr.split("+").at(-1))):!rr&&!St&&(this.callbacks.set(yr,{callback:Cr,options:Fr}),this.allKeys.add(yr.split("+").at(-1)))}}exec(Tt,rr){if(!this.allKeys.has(rr.key))return;const hr=this.callbacks.get(Mt(this,Ce,c0).call(this,rr));if(!hr)return;const{callback:Cr,options:{bubbles:Fr=!1,args:yr=[],checker:St=null}}=hr;St&&!St(Tt,rr)||(Cr.bind(Tt,...yr)(),Fr||(rr.stopPropagation(),rr.preventDefault()))}}Ce=new WeakSet,c0=function(Tt){Tt.altKey&&this.buffer.push("alt"),Tt.ctrlKey&&this.buffer.push("ctrl"),Tt.metaKey&&this.buffer.push("meta"),Tt.shiftKey&&this.buffer.push("shift"),this.buffer.push(Tt.key);const rr=this.buffer.join("+");return this.buffer.length=0,rr},A.KeyboardManager=ie;const nt=class nt{get _colors(){const Tt=new Map([["CanvasText",null],["Canvas",null]]);return(0,W.getColorValues)(Tt),(0,B.shadow)(this,"_colors",Tt)}convert(Tt){const rr=(0,W.getRGB)(Tt);if(!window.matchMedia("(forced-colors: active)").matches)return rr;for(const[hr,Cr]of this._colors)if(Cr.every((Fr,yr)=>Fr===rr[yr]))return nt._colorsMapping.get(hr);return rr}getHexCode(Tt){const rr=this._colors.get(Tt);return rr?B.Util.makeHexColor(...rr):Tt}};Kr(nt,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let le=nt;A.ColorManager=le;const Wr=class Wr{constructor(Tt,rr,hr,Cr,Fr,yr){zt(this,Nt);zt(this,Ae,null);zt(this,De,new Map);zt(this,lt,new Map);zt(this,Ct,null);zt(this,ft,null);zt(this,Et,new se);zt(this,gt,0);zt(this,bt,new Set);zt(this,Ie,null);zt(this,pt,null);zt(this,at,new Set);zt(this,Ee,null);zt(this,ye,new re);zt(this,ve,!1);zt(this,Pe,!1);zt(this,rt,null);zt(this,st,B.AnnotationEditorType.NONE);zt(this,ot,new Set);zt(this,mt,null);zt(this,At,this.blur.bind(this));zt(this,It,this.focus.bind(this));zt(this,it,this.copy.bind(this));zt(this,Vt,this.cut.bind(this));zt(this,Yt,this.paste.bind(this));zt(this,Zt,this.keydown.bind(this));zt(this,Lt,this.onEditingAction.bind(this));zt(this,Ft,this.onPageChanging.bind(this));zt(this,ht,this.onScaleChanging.bind(this));zt(this,kt,this.onRotationChanging.bind(this));zt(this,Dt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});zt(this,Bt,[0,0]);zt(this,Qt,null);zt(this,or,null);zt(this,ar,null);Xt(this,or,Tt),Xt(this,ar,rr),Xt(this,Ct,hr),this._eventBus=Cr,this._eventBus._on("editingaction",Fe(this,Lt)),this._eventBus._on("pagechanging",Fe(this,Ft)),this._eventBus._on("scalechanging",Fe(this,ht)),this._eventBus._on("rotationchanging",Fe(this,kt)),Xt(this,ft,Fr.annotationStorage),Xt(this,Ee,Fr.filterFactory),Xt(this,mt,yr),this.viewParameters={realScale:W.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const Tt=Wr.prototype,rr=Fr=>{const{activeElement:yr}=document;return yr&&Fe(Fr,or).contains(yr)&&Fr.hasSomethingToControl()},hr=this.TRANSLATE_SMALL,Cr=this.TRANSLATE_BIG;return(0,B.shadow)(this,"_keyboardManager",new ie([[["ctrl+a","mac+meta+a"],Tt.selectAll],[["ctrl+z","mac+meta+z"],Tt.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],Tt.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],Tt.delete],[["Escape","mac+Escape"],Tt.unselectAll],[["ArrowLeft","mac+ArrowLeft"],Tt.translateSelectedEditors,{args:[-hr,0],checker:rr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Tt.translateSelectedEditors,{args:[-Cr,0],checker:rr}],[["ArrowRight","mac+ArrowRight"],Tt.translateSelectedEditors,{args:[hr,0],checker:rr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Tt.translateSelectedEditors,{args:[Cr,0],checker:rr}],[["ArrowUp","mac+ArrowUp"],Tt.translateSelectedEditors,{args:[0,-hr],checker:rr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Tt.translateSelectedEditors,{args:[0,-Cr],checker:rr}],[["ArrowDown","mac+ArrowDown"],Tt.translateSelectedEditors,{args:[0,hr],checker:rr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Tt.translateSelectedEditors,{args:[0,Cr],checker:rr}]]))}destroy(){Mt(this,Nt,so).call(this),Mt(this,Nt,sc).call(this),this._eventBus._off("editingaction",Fe(this,Lt)),this._eventBus._off("pagechanging",Fe(this,Ft)),this._eventBus._off("scalechanging",Fe(this,ht)),this._eventBus._off("rotationchanging",Fe(this,kt));for(const Tt of Fe(this,lt).values())Tt.destroy();Fe(this,lt).clear(),Fe(this,De).clear(),Fe(this,at).clear(),Xt(this,Ae,null),Fe(this,ot).clear(),Fe(this,Et).destroy(),Fe(this,Ct).destroy()}get hcmFilter(){return(0,B.shadow)(this,"hcmFilter",Fe(this,mt)?Fe(this,Ee).addHCMFilter(Fe(this,mt).foreground,Fe(this,mt).background):"none")}get direction(){return(0,B.shadow)(this,"direction",getComputedStyle(Fe(this,or)).direction)}editAltText(Tt){var rr;(rr=Fe(this,Ct))==null||rr.editAltText(this,Tt)}onPageChanging({pageNumber:Tt}){Xt(this,gt,Tt-1)}focusMainContainer(){Fe(this,or).focus()}findParent(Tt,rr){for(const hr of Fe(this,lt).values()){const{x:Cr,y:Fr,width:yr,height:St}=hr.div.getBoundingClientRect();if(Tt>=Cr&&Tt<=Cr+yr&&rr>=Fr&&rr<=Fr+St)return hr}return null}disableUserSelect(Tt=!1){Fe(this,ar).classList.toggle("noUserSelect",Tt)}addShouldRescale(Tt){Fe(this,at).add(Tt)}removeShouldRescale(Tt){Fe(this,at).delete(Tt)}onScaleChanging({scale:Tt}){this.commitOrRemove(),this.viewParameters.realScale=Tt*W.PixelsPerInch.PDF_TO_CSS_UNITS;for(const rr of Fe(this,at))rr.onScaleChanging()}onRotationChanging({pagesRotation:Tt}){this.commitOrRemove(),this.viewParameters.rotation=Tt}addToAnnotationStorage(Tt){!Tt.isEmpty()&&Fe(this,ft)&&!Fe(this,ft).has(Tt.id)&&Fe(this,ft).setValue(Tt.id,Tt)}blur(){if(!this.hasSelection)return;const{activeElement:Tt}=document;for(const rr of Fe(this,ot))if(rr.div.contains(Tt)){Xt(this,rt,[rr,Tt]),rr._focusEventsAllowed=!1;break}}focus(){if(!Fe(this,rt))return;const[Tt,rr]=Fe(this,rt);Xt(this,rt,null),rr.addEventListener("focusin",()=>{Tt._focusEventsAllowed=!0},{once:!0}),rr.focus()}addEditListeners(){Mt(this,Nt,oc).call(this),Mt(this,Nt,lc).call(this)}removeEditListeners(){Mt(this,Nt,so).call(this),Mt(this,Nt,cc).call(this)}copy(Tt){var hr;if(Tt.preventDefault(),(hr=Fe(this,Ae))==null||hr.commitOrRemove(),!this.hasSelection)return;const rr=[];for(const Cr of Fe(this,ot)){const Fr=Cr.serialize(!0);Fr&&rr.push(Fr)}rr.length!==0&&Tt.clipboardData.setData("application/pdfjs",JSON.stringify(rr))}cut(Tt){this.copy(Tt),this.delete()}paste(Tt){Tt.preventDefault();const{clipboardData:rr}=Tt;for(const Fr of rr.items)for(const yr of Fe(this,pt))if(yr.isHandlingMimeForPasting(Fr.type)){yr.paste(Fr,this.currentLayer);return}let hr=rr.getData("application/pdfjs");if(!hr)return;try{hr=JSON.parse(hr)}catch(Fr){(0,B.warn)(`paste: "${Fr.message}".`);return}if(!Array.isArray(hr))return;this.unselectAll();const Cr=this.currentLayer;try{const Fr=[];for(const xt of hr){const Pt=Cr.deserialize(xt);if(!Pt)return;Fr.push(Pt)}const yr=()=>{for(const xt of Fr)Mt(this,Nt,uc).call(this,xt);Mt(this,Nt,fc).call(this,Fr)},St=()=>{for(const xt of Fr)xt.remove()};this.addCommands({cmd:yr,undo:St,mustExec:!0})}catch(Fr){(0,B.warn)(`paste: "${Fr.message}".`)}}keydown(Tt){var rr;(rr=this.getActive())!=null&&rr.shouldGetKeyboardEvents()||Wr._keyboardManager.exec(this,Tt)}onEditingAction(Tt){["undo","redo","delete","selectAll"].includes(Tt.name)&&this[Tt.name]()}setEditingState(Tt){Tt?(Mt(this,Nt,u0).call(this),Mt(this,Nt,oc).call(this),Mt(this,Nt,lc).call(this),Mt(this,Nt,Un).call(this,{isEditing:Fe(this,st)!==B.AnnotationEditorType.NONE,isEmpty:Mt(this,Nt,Ki).call(this),hasSomethingToUndo:Fe(this,Et).hasSomethingToUndo(),hasSomethingToRedo:Fe(this,Et).hasSomethingToRedo(),hasSelectedEditor:!1})):(Mt(this,Nt,sc).call(this),Mt(this,Nt,so).call(this),Mt(this,Nt,cc).call(this),Mt(this,Nt,Un).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(Tt){if(!Fe(this,pt)){Xt(this,pt,Tt);for(const rr of Fe(this,pt))Mt(this,Nt,Yi).call(this,rr.defaultPropertiesToUpdate)}}getId(){return Fe(this,ye).getId()}get currentLayer(){return Fe(this,lt).get(Fe(this,gt))}getLayer(Tt){return Fe(this,lt).get(Tt)}get currentPageIndex(){return Fe(this,gt)}addLayer(Tt){Fe(this,lt).set(Tt.pageIndex,Tt),Fe(this,ve)?Tt.enable():Tt.disable()}removeLayer(Tt){Fe(this,lt).delete(Tt.pageIndex)}updateMode(Tt,rr=null){if(Fe(this,st)!==Tt){if(Xt(this,st,Tt),Tt===B.AnnotationEditorType.NONE){this.setEditingState(!1),Mt(this,Nt,h0).call(this);return}this.setEditingState(!0),Mt(this,Nt,f0).call(this),this.unselectAll();for(const hr of Fe(this,lt).values())hr.updateMode(Tt);if(rr){for(const hr of Fe(this,De).values())if(hr.annotationElementId===rr){this.setSelected(hr),hr.enterInEditMode();break}}}}updateToolbar(Tt){Tt!==Fe(this,st)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:Tt})}updateParams(Tt,rr){if(Fe(this,pt)){if(Tt===B.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(Tt);return}for(const hr of Fe(this,ot))hr.updateParams(Tt,rr);for(const hr of Fe(this,pt))hr.updateDefaultParams(Tt,rr)}}enableWaiting(Tt=!1){if(Fe(this,Pe)!==Tt){Xt(this,Pe,Tt);for(const rr of Fe(this,lt).values())Tt?rr.disableClick():rr.enableClick(),rr.div.classList.toggle("waiting",Tt)}}getEditors(Tt){const rr=[];for(const hr of Fe(this,De).values())hr.pageIndex===Tt&&rr.push(hr);return rr}getEditor(Tt){return Fe(this,De).get(Tt)}addEditor(Tt){Fe(this,De).set(Tt.id,Tt)}removeEditor(Tt){var rr;Fe(this,De).delete(Tt.id),this.unselect(Tt),(!Tt.annotationElementId||!Fe(this,bt).has(Tt.annotationElementId))&&((rr=Fe(this,ft))==null||rr.remove(Tt.id))}addDeletedAnnotationElement(Tt){Fe(this,bt).add(Tt.annotationElementId),Tt.deleted=!0}isDeletedAnnotationElement(Tt){return Fe(this,bt).has(Tt)}removeDeletedAnnotationElement(Tt){Fe(this,bt).delete(Tt.annotationElementId),Tt.deleted=!1}setActiveEditor(Tt){Fe(this,Ae)!==Tt&&(Xt(this,Ae,Tt),Tt&&Mt(this,Nt,Yi).call(this,Tt.propertiesToUpdate))}toggleSelected(Tt){if(Fe(this,ot).has(Tt)){Fe(this,ot).delete(Tt),Tt.unselect(),Mt(this,Nt,Un).call(this,{hasSelectedEditor:this.hasSelection});return}Fe(this,ot).add(Tt),Tt.select(),Mt(this,Nt,Yi).call(this,Tt.propertiesToUpdate),Mt(this,Nt,Un).call(this,{hasSelectedEditor:!0})}setSelected(Tt){for(const rr of Fe(this,ot))rr!==Tt&&rr.unselect();Fe(this,ot).clear(),Fe(this,ot).add(Tt),Tt.select(),Mt(this,Nt,Yi).call(this,Tt.propertiesToUpdate),Mt(this,Nt,Un).call(this,{hasSelectedEditor:!0})}isSelected(Tt){return Fe(this,ot).has(Tt)}unselect(Tt){Tt.unselect(),Fe(this,ot).delete(Tt),Mt(this,Nt,Un).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return Fe(this,ot).size!==0}undo(){Fe(this,Et).undo(),Mt(this,Nt,Un).call(this,{hasSomethingToUndo:Fe(this,Et).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Mt(this,Nt,Ki).call(this)})}redo(){Fe(this,Et).redo(),Mt(this,Nt,Un).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Fe(this,Et).hasSomethingToRedo(),isEmpty:Mt(this,Nt,Ki).call(this)})}addCommands(Tt){Fe(this,Et).add(Tt),Mt(this,Nt,Un).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Mt(this,Nt,Ki).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const Tt=[...Fe(this,ot)],rr=()=>{for(const Cr of Tt)Cr.remove()},hr=()=>{for(const Cr of Tt)Mt(this,Nt,uc).call(this,Cr)};this.addCommands({cmd:rr,undo:hr,mustExec:!0})}commitOrRemove(){var Tt;(Tt=Fe(this,Ae))==null||Tt.commitOrRemove()}hasSomethingToControl(){return Fe(this,Ae)||this.hasSelection}selectAll(){for(const Tt of Fe(this,ot))Tt.commit();Mt(this,Nt,fc).call(this,Fe(this,De).values())}unselectAll(){if(Fe(this,Ae)){Fe(this,Ae).commitOrRemove();return}if(this.hasSelection){for(const Tt of Fe(this,ot))Tt.unselect();Fe(this,ot).clear(),Mt(this,Nt,Un).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(Tt,rr,hr=!1){if(hr||this.commitOrRemove(),!this.hasSelection)return;Fe(this,Bt)[0]+=Tt,Fe(this,Bt)[1]+=rr;const[Cr,Fr]=Fe(this,Bt),yr=[...Fe(this,ot)],St=1e3;Fe(this,Qt)&&clearTimeout(Fe(this,Qt)),Xt(this,Qt,setTimeout(()=>{Xt(this,Qt,null),Fe(this,Bt)[0]=Fe(this,Bt)[1]=0,this.addCommands({cmd:()=>{for(const xt of yr)Fe(this,De).has(xt.id)&&xt.translateInPage(Cr,Fr)},undo:()=>{for(const xt of yr)Fe(this,De).has(xt.id)&&xt.translateInPage(-Cr,-Fr)},mustExec:!1})},St));for(const xt of yr)xt.translateInPage(Tt,rr)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Xt(this,Ie,new Map);for(const Tt of Fe(this,ot))Fe(this,Ie).set(Tt,{savedX:Tt.x,savedY:Tt.y,savedPageIndex:Tt.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!Fe(this,Ie))return!1;this.disableUserSelect(!1);const Tt=Fe(this,Ie);Xt(this,Ie,null);let rr=!1;for(const[{x:Cr,y:Fr,pageIndex:yr},St]of Tt)St.newX=Cr,St.newY=Fr,St.newPageIndex=yr,rr||(rr=Cr!==St.savedX||Fr!==St.savedY||yr!==St.savedPageIndex);if(!rr)return!1;const hr=(Cr,Fr,yr,St)=>{if(Fe(this,De).has(Cr.id)){const xt=Fe(this,lt).get(St);xt?Cr._setParentAndPosition(xt,Fr,yr):(Cr.pageIndex=St,Cr.x=Fr,Cr.y=yr)}};return this.addCommands({cmd:()=>{for(const[Cr,{newX:Fr,newY:yr,newPageIndex:St}]of Tt)hr(Cr,Fr,yr,St)},undo:()=>{for(const[Cr,{savedX:Fr,savedY:yr,savedPageIndex:St}]of Tt)hr(Cr,Fr,yr,St)},mustExec:!0}),!0}dragSelectedEditors(Tt,rr){if(Fe(this,Ie))for(const hr of Fe(this,Ie).keys())hr.drag(Tt,rr)}rebuild(Tt){if(Tt.parent===null){const rr=this.getLayer(Tt.pageIndex);rr?(rr.changeParent(Tt),rr.addOrRebuild(Tt)):(this.addEditor(Tt),this.addToAnnotationStorage(Tt),Tt.rebuild())}else Tt.parent.addOrRebuild(Tt)}isActive(Tt){return Fe(this,Ae)===Tt}getActive(){return Fe(this,Ae)}getMode(){return Fe(this,st)}get imageManager(){return(0,B.shadow)(this,"imageManager",new ae)}};Ae=new WeakMap,De=new WeakMap,lt=new WeakMap,Ct=new WeakMap,ft=new WeakMap,Et=new WeakMap,gt=new WeakMap,bt=new WeakMap,Ie=new WeakMap,pt=new WeakMap,at=new WeakMap,Ee=new WeakMap,ye=new WeakMap,ve=new WeakMap,Pe=new WeakMap,rt=new WeakMap,st=new WeakMap,ot=new WeakMap,mt=new WeakMap,At=new WeakMap,It=new WeakMap,it=new WeakMap,Vt=new WeakMap,Yt=new WeakMap,Zt=new WeakMap,Lt=new WeakMap,Ft=new WeakMap,ht=new WeakMap,kt=new WeakMap,Dt=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,or=new WeakMap,ar=new WeakMap,Nt=new WeakSet,u0=function(){window.addEventListener("focus",Fe(this,It)),window.addEventListener("blur",Fe(this,At))},sc=function(){window.removeEventListener("focus",Fe(this,It)),window.removeEventListener("blur",Fe(this,At))},oc=function(){window.addEventListener("keydown",Fe(this,Zt),{capture:!0})},so=function(){window.removeEventListener("keydown",Fe(this,Zt),{capture:!0})},lc=function(){document.addEventListener("copy",Fe(this,it)),document.addEventListener("cut",Fe(this,Vt)),document.addEventListener("paste",Fe(this,Yt))},cc=function(){document.removeEventListener("copy",Fe(this,it)),document.removeEventListener("cut",Fe(this,Vt)),document.removeEventListener("paste",Fe(this,Yt))},Un=function(Tt){Object.entries(Tt).some(([hr,Cr])=>Fe(this,Dt)[hr]!==Cr)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Fe(this,Dt),Tt)})},Yi=function(Tt){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:Tt})},f0=function(){if(!Fe(this,ve)){Xt(this,ve,!0);for(const Tt of Fe(this,lt).values())Tt.enable()}},h0=function(){if(this.unselectAll(),Fe(this,ve)){Xt(this,ve,!1);for(const Tt of Fe(this,lt).values())Tt.disable()}},uc=function(Tt){const rr=Fe(this,lt).get(Tt.pageIndex);rr?rr.addOrRebuild(Tt):this.addEditor(Tt)},Ki=function(){if(Fe(this,De).size===0)return!0;if(Fe(this,De).size===1)for(const Tt of Fe(this,De).values())return Tt.isEmpty();return!1},fc=function(Tt){Fe(this,ot).clear();for(const rr of Tt)rr.isEmpty()||(Fe(this,ot).add(rr),rr.select());Mt(this,Nt,Un).call(this,{hasSelectedEditor:!0})},Kr(Wr,"TRANSLATE_SMALL",1),Kr(Wr,"TRANSLATE_BIG",10);let pe=Wr;A.AnnotationEditorUIManager=pe},(g,A,L)=>{var gt,bt,Ie,pt,at,Ee,ye,ve,Pe,rt,st,ot,ci,ui,hc,oo,lo,qi,Ji;Object.defineProperty(A,"__esModule",{value:!0}),A.StatTimer=A.RenderingCancelledException=A.PixelsPerInch=A.PageViewport=A.PDFDateString=A.DOMStandardFontDataFactory=A.DOMSVGFactory=A.DOMFilterFactory=A.DOMCanvasFactory=A.DOMCMapReaderFactory=void 0,A.deprecated=ge,A.getColorValues=De,A.getCurrentTransform=lt,A.getCurrentTransformInverse=Ct,A.getFilenameFromUrl=me,A.getPdfFilenameFromUrl=ke,A.getRGB=Ae,A.getXfaPageViewport=nt,A.isDataScheme=ce,A.isPdfFile=fe,A.isValidFetchUrl=Le,A.loadScript=Te,A.noContextMenu=Se,A.setLayerDimensions=ft;var B=L(7),W=L(1);const q="http://www.w3.org/2000/svg",Et=class Et{};Kr(Et,"CSS",96),Kr(Et,"PDF",72),Kr(Et,"PDF_TO_CSS_UNITS",Et.CSS/Et.PDF);let J=Et;A.PixelsPerInch=J;class re extends B.BaseFilterFactory{constructor({docId:ht,ownerDocument:kt=globalThis.document}={}){super();zt(this,ot);zt(this,gt);zt(this,bt);zt(this,Ie);zt(this,pt);zt(this,at);zt(this,Ee);zt(this,ye);zt(this,ve);zt(this,Pe);zt(this,rt);zt(this,st,0);Xt(this,Ie,ht),Xt(this,pt,kt)}addFilter(ht){if(!ht)return"none";let kt=Fe(this,ot,ci).get(ht);if(kt)return kt;let Dt,Bt,Qt,or;if(ht.length===1){const ur=ht[0],Pr=new Array(256);for(let Rr=0;Rr<256;Rr++)Pr[Rr]=ur[Rr]/255;or=Dt=Bt=Qt=Pr.join(",")}else{const[ur,Pr,Rr]=ht,vr=new Array(256),dr=new Array(256),br=new Array(256);for(let Ir=0;Ir<256;Ir++)vr[Ir]=ur[Ir]/255,dr[Ir]=Pr[Ir]/255,br[Ir]=Rr[Ir]/255;Dt=vr.join(","),Bt=dr.join(","),Qt=br.join(","),or=`${Dt}${Bt}${Qt}`}if(kt=Fe(this,ot,ci).get(or),kt)return Fe(this,ot,ci).set(ht,kt),kt;const ar=`g_${Fe(this,Ie)}_transfer_map_${Gi(this,st)._++}`,Nt=`url(#${ar})`;Fe(this,ot,ci).set(ht,Nt),Fe(this,ot,ci).set(or,Nt);const fr=Mt(this,ot,oo).call(this,ar);return Mt(this,ot,qi).call(this,Dt,Bt,Qt,fr),Nt}addHCMFilter(ht,kt){var Pr;const Dt=`${ht}-${kt}`;if(Fe(this,Ee)===Dt)return Fe(this,ye);if(Xt(this,Ee,Dt),Xt(this,ye,"none"),(Pr=Fe(this,at))==null||Pr.remove(),!ht||!kt)return Fe(this,ye);const Bt=Mt(this,ot,Ji).call(this,ht);ht=W.Util.makeHexColor(...Bt);const Qt=Mt(this,ot,Ji).call(this,kt);if(kt=W.Util.makeHexColor(...Qt),Fe(this,ot,ui).style.color="",ht==="#000000"&&kt==="#ffffff"||ht===kt)return Fe(this,ye);const or=new Array(256);for(let Rr=0;Rr<=255;Rr++){const vr=Rr/255;or[Rr]=vr<=.03928?vr/12.92:((vr+.055)/1.055)**2.4}const ar=or.join(","),Nt=`g_${Fe(this,Ie)}_hcm_filter`,fr=Xt(this,ve,Mt(this,ot,oo).call(this,Nt));Mt(this,ot,qi).call(this,ar,ar,ar,fr),Mt(this,ot,hc).call(this,fr);const ur=(Rr,vr)=>{const dr=Bt[Rr]/255,br=Qt[Rr]/255,Ir=new Array(vr+1);for(let zr=0;zr<=vr;zr++)Ir[zr]=dr+zr/vr*(br-dr);return Ir.join(",")};return Mt(this,ot,qi).call(this,ur(0,5),ur(1,5),ur(2,5),fr),Xt(this,ye,`url(#${Nt})`),Fe(this,ye)}addHighlightHCMFilter(ht,kt,Dt,Bt){var br;const Qt=`${ht}-${kt}-${Dt}-${Bt}`;if(Fe(this,Pe)===Qt)return Fe(this,rt);if(Xt(this,Pe,Qt),Xt(this,rt,"none"),(br=Fe(this,ve))==null||br.remove(),!ht||!kt)return Fe(this,rt);const[or,ar]=[ht,kt].map(Mt(this,ot,Ji).bind(this));let Nt=Math.round(.2126*or[0]+.7152*or[1]+.0722*or[2]),fr=Math.round(.2126*ar[0]+.7152*ar[1]+.0722*ar[2]),[ur,Pr]=[Dt,Bt].map(Mt(this,ot,Ji).bind(this));fr<Nt&&([Nt,fr,ur,Pr]=[fr,Nt,Pr,ur]),Fe(this,ot,ui).style.color="";const Rr=(Ir,zr,lr)=>{const Ht=new Array(256),$t=(fr-Nt)/lr,kr=Ir/255,Wr=(zr-Ir)/(255*lr);let Ur=0;for(let Tt=0;Tt<=lr;Tt++){const rr=Math.round(Nt+Tt*$t),hr=kr+Tt*Wr;for(let Cr=Ur;Cr<=rr;Cr++)Ht[Cr]=hr;Ur=rr+1}for(let Tt=Ur;Tt<256;Tt++)Ht[Tt]=Ht[Ur-1];return Ht.join(",")},vr=`g_${Fe(this,Ie)}_hcm_highlight_filter`,dr=Xt(this,ve,Mt(this,ot,oo).call(this,vr));return Mt(this,ot,hc).call(this,dr),Mt(this,ot,qi).call(this,Rr(ur[0],Pr[0],5),Rr(ur[1],Pr[1],5),Rr(ur[2],Pr[2],5),dr),Xt(this,rt,`url(#${vr})`),Fe(this,rt)}destroy(ht=!1){ht&&(Fe(this,ye)||Fe(this,rt))||(Fe(this,bt)&&(Fe(this,bt).parentNode.parentNode.remove(),Xt(this,bt,null)),Fe(this,gt)&&(Fe(this,gt).clear(),Xt(this,gt,null)),Xt(this,st,0))}}gt=new WeakMap,bt=new WeakMap,Ie=new WeakMap,pt=new WeakMap,at=new WeakMap,Ee=new WeakMap,ye=new WeakMap,ve=new WeakMap,Pe=new WeakMap,rt=new WeakMap,st=new WeakMap,ot=new WeakSet,ci=function(){return Fe(this,gt)||Xt(this,gt,new Map)},ui=function(){if(!Fe(this,bt)){const ht=Fe(this,pt).createElement("div"),{style:kt}=ht;kt.visibility="hidden",kt.contain="strict",kt.width=kt.height=0,kt.position="absolute",kt.top=kt.left=0,kt.zIndex=-1;const Dt=Fe(this,pt).createElementNS(q,"svg");Dt.setAttribute("width",0),Dt.setAttribute("height",0),Xt(this,bt,Fe(this,pt).createElementNS(q,"defs")),ht.append(Dt),Dt.append(Fe(this,bt)),Fe(this,pt).body.append(ht)}return Fe(this,bt)},hc=function(ht){const kt=Fe(this,pt).createElementNS(q,"feColorMatrix");kt.setAttribute("type","matrix"),kt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),ht.append(kt)},oo=function(ht){const kt=Fe(this,pt).createElementNS(q,"filter");return kt.setAttribute("color-interpolation-filters","sRGB"),kt.setAttribute("id",ht),Fe(this,ot,ui).append(kt),kt},lo=function(ht,kt,Dt){const Bt=Fe(this,pt).createElementNS(q,kt);Bt.setAttribute("type","discrete"),Bt.setAttribute("tableValues",Dt),ht.append(Bt)},qi=function(ht,kt,Dt,Bt){const Qt=Fe(this,pt).createElementNS(q,"feComponentTransfer");Bt.append(Qt),Mt(this,ot,lo).call(this,Qt,"feFuncR",ht),Mt(this,ot,lo).call(this,Qt,"feFuncG",kt),Mt(this,ot,lo).call(this,Qt,"feFuncB",Dt)},Ji=function(ht){return Fe(this,ot,ui).style.color=ht,Ae(getComputedStyle(Fe(this,ot,ui)).getPropertyValue("color"))},A.DOMFilterFactory=re;class ae extends B.BaseCanvasFactory{constructor({ownerDocument:Ft=globalThis.document}={}){super(),this._document=Ft}_createCanvas(Ft,ht){const kt=this._document.createElement("canvas");return kt.width=Ft,kt.height=ht,kt}}A.DOMCanvasFactory=ae;async function se(Lt,Ft=!1){if(Le(Lt,document.baseURI)){const ht=await fetch(Lt);if(!ht.ok)throw new Error(ht.statusText);return Ft?new Uint8Array(await ht.arrayBuffer()):(0,W.stringToBytes)(await ht.text())}return new Promise((ht,kt)=>{const Dt=new XMLHttpRequest;Dt.open("GET",Lt,!0),Ft&&(Dt.responseType="arraybuffer"),Dt.onreadystatechange=()=>{if(Dt.readyState===XMLHttpRequest.DONE){if(Dt.status===200||Dt.status===0){let Bt;if(Ft&&Dt.response?Bt=new Uint8Array(Dt.response):!Ft&&Dt.responseText&&(Bt=(0,W.stringToBytes)(Dt.responseText)),Bt){ht(Bt);return}}kt(new Error(Dt.statusText))}},Dt.send(null)})}class ie extends B.BaseCMapReaderFactory{_fetchData(Ft,ht){return se(Ft,this.isCompressed).then(kt=>({cMapData:kt,compressionType:ht}))}}A.DOMCMapReaderFactory=ie;class le extends B.BaseStandardFontDataFactory{_fetchData(Ft){return se(Ft,!0)}}A.DOMStandardFontDataFactory=le;class pe extends B.BaseSVGFactory{_createSVG(Ft){return document.createElementNS(q,Ft)}}A.DOMSVGFactory=pe;class he{constructor({viewBox:Ft,scale:ht,rotation:kt,offsetX:Dt=0,offsetY:Bt=0,dontFlip:Qt=!1}){this.viewBox=Ft,this.scale=ht,this.rotation=kt,this.offsetX=Dt,this.offsetY=Bt;const or=(Ft[2]+Ft[0])/2,ar=(Ft[3]+Ft[1])/2;let Nt,fr,ur,Pr;switch(kt%=360,kt<0&&(kt+=360),kt){case 180:Nt=-1,fr=0,ur=0,Pr=1;break;case 90:Nt=0,fr=1,ur=1,Pr=0;break;case 270:Nt=0,fr=-1,ur=-1,Pr=0;break;case 0:Nt=1,fr=0,ur=0,Pr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Qt&&(ur=-ur,Pr=-Pr);let Rr,vr,dr,br;Nt===0?(Rr=Math.abs(ar-Ft[1])*ht+Dt,vr=Math.abs(or-Ft[0])*ht+Bt,dr=(Ft[3]-Ft[1])*ht,br=(Ft[2]-Ft[0])*ht):(Rr=Math.abs(or-Ft[0])*ht+Dt,vr=Math.abs(ar-Ft[1])*ht+Bt,dr=(Ft[2]-Ft[0])*ht,br=(Ft[3]-Ft[1])*ht),this.transform=[Nt*ht,fr*ht,ur*ht,Pr*ht,Rr-Nt*ht*or-ur*ht*ar,vr-fr*ht*or-Pr*ht*ar],this.width=dr,this.height=br}get rawDims(){const{viewBox:Ft}=this;return(0,W.shadow)(this,"rawDims",{pageWidth:Ft[2]-Ft[0],pageHeight:Ft[3]-Ft[1],pageX:Ft[0],pageY:Ft[1]})}clone({scale:Ft=this.scale,rotation:ht=this.rotation,offsetX:kt=this.offsetX,offsetY:Dt=this.offsetY,dontFlip:Bt=!1}={}){return new he({viewBox:this.viewBox.slice(),scale:Ft,rotation:ht,offsetX:kt,offsetY:Dt,dontFlip:Bt})}convertToViewportPoint(Ft,ht){return W.Util.applyTransform([Ft,ht],this.transform)}convertToViewportRectangle(Ft){const ht=W.Util.applyTransform([Ft[0],Ft[1]],this.transform),kt=W.Util.applyTransform([Ft[2],Ft[3]],this.transform);return[ht[0],ht[1],kt[0],kt[1]]}convertToPdfPoint(Ft,ht){return W.Util.applyInverseTransform([Ft,ht],this.transform)}}A.PageViewport=he;class ue extends W.BaseException{constructor(Ft,ht=0){super(Ft,"RenderingCancelledException"),this.extraDelay=ht}}A.RenderingCancelledException=ue;function ce(Lt){const Ft=Lt.length;let ht=0;for(;ht<Ft&&Lt[ht].trim()==="";)ht++;return Lt.substring(ht,ht+5).toLowerCase()==="data:"}function fe(Lt){return typeof Lt=="string"&&/\.pdf$/i.test(Lt)}function me(Lt,Ft=!1){return Ft||([Lt]=Lt.split(/[#?]/,1)),Lt.substring(Lt.lastIndexOf("/")+1)}function ke(Lt,Ft="document.pdf"){if(typeof Lt!="string")return Ft;if(ce(Lt))return(0,W.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ft;const ht=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,kt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Dt=ht.exec(Lt);let Bt=kt.exec(Dt[1])||kt.exec(Dt[2])||kt.exec(Dt[3]);if(Bt&&(Bt=Bt[0],Bt.includes("%")))try{Bt=kt.exec(decodeURIComponent(Bt))[0]}catch{}return Bt||Ft}class xe{constructor(){Kr(this,"started",Object.create(null));Kr(this,"times",[])}time(Ft){Ft in this.started&&(0,W.warn)(`Timer is already running for ${Ft}`),this.started[Ft]=Date.now()}timeEnd(Ft){Ft in this.started||(0,W.warn)(`Timer has not been started for ${Ft}`),this.times.push({name:Ft,start:this.started[Ft],end:Date.now()}),delete this.started[Ft]}toString(){const Ft=[];let ht=0;for(const{name:kt}of this.times)ht=Math.max(kt.length,ht);for(const{name:kt,start:Dt,end:Bt}of this.times)Ft.push(`${kt.padEnd(ht)} ${Bt-Dt}ms
`);return Ft.join("")}}A.StatTimer=xe;function Le(Lt,Ft){try{const{protocol:ht}=Ft?new URL(Lt,Ft):new URL(Lt);return ht==="http:"||ht==="https:"}catch{return!1}}function Se(Lt){Lt.preventDefault()}function Te(Lt,Ft=!1){return new Promise((ht,kt)=>{const Dt=document.createElement("script");Dt.src=Lt,Dt.onload=function(Bt){Ft&&Dt.remove(),ht(Bt)},Dt.onerror=function(){kt(new Error(`Cannot load script at: ${Dt.src}`))},(document.head||document.documentElement).append(Dt)})}function ge(Lt){console.log("Deprecated API usage: "+Lt)}let Ce;class be{static toDateObject(Ft){if(!Ft||typeof Ft!="string")return null;Ce||(Ce=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const ht=Ce.exec(Ft);if(!ht)return null;const kt=parseInt(ht[1],10);let Dt=parseInt(ht[2],10);Dt=Dt>=1&&Dt<=12?Dt-1:0;let Bt=parseInt(ht[3],10);Bt=Bt>=1&&Bt<=31?Bt:1;let Qt=parseInt(ht[4],10);Qt=Qt>=0&&Qt<=23?Qt:0;let or=parseInt(ht[5],10);or=or>=0&&or<=59?or:0;let ar=parseInt(ht[6],10);ar=ar>=0&&ar<=59?ar:0;const Nt=ht[7]||"Z";let fr=parseInt(ht[8],10);fr=fr>=0&&fr<=23?fr:0;let ur=parseInt(ht[9],10)||0;return ur=ur>=0&&ur<=59?ur:0,Nt==="-"?(Qt+=fr,or+=ur):Nt==="+"&&(Qt-=fr,or-=ur),new Date(Date.UTC(kt,Dt,Bt,Qt,or,ar))}}A.PDFDateString=be;function nt(Lt,{scale:Ft=1,rotation:ht=0}){const{width:kt,height:Dt}=Lt.attributes.style,Bt=[0,0,parseInt(kt),parseInt(Dt)];return new he({viewBox:Bt,scale:Ft,rotation:ht})}function Ae(Lt){if(Lt.startsWith("#")){const Ft=parseInt(Lt.slice(1),16);return[(Ft&16711680)>>16,(Ft&65280)>>8,Ft&255]}return Lt.startsWith("rgb(")?Lt.slice(4,-1).split(",").map(Ft=>parseInt(Ft)):Lt.startsWith("rgba(")?Lt.slice(5,-1).split(",").map(Ft=>parseInt(Ft)).slice(0,3):((0,W.warn)(`Not a valid color format: "${Lt}"`),[0,0,0])}function De(Lt){const Ft=document.createElement("span");Ft.style.visibility="hidden",document.body.append(Ft);for(const ht of Lt.keys()){Ft.style.color=ht;const kt=window.getComputedStyle(Ft).color;Lt.set(ht,Ae(kt))}Ft.remove()}function lt(Lt){const{a:Ft,b:ht,c:kt,d:Dt,e:Bt,f:Qt}=Lt.getTransform();return[Ft,ht,kt,Dt,Bt,Qt]}function Ct(Lt){const{a:Ft,b:ht,c:kt,d:Dt,e:Bt,f:Qt}=Lt.getTransform().invertSelf();return[Ft,ht,kt,Dt,Bt,Qt]}function ft(Lt,Ft,ht=!1,kt=!0){if(Ft instanceof he){const{pageWidth:Dt,pageHeight:Bt}=Ft.rawDims,{style:Qt}=Lt,or=W.FeatureTest.isCSSRoundSupported,ar=`var(--scale-factor) * ${Dt}px`,Nt=`var(--scale-factor) * ${Bt}px`,fr=or?`round(${ar}, 1px)`:`calc(${ar})`,ur=or?`round(${Nt}, 1px)`:`calc(${Nt})`;!ht||Ft.rotation%180===0?(Qt.width=fr,Qt.height=ur):(Qt.width=ur,Qt.height=fr)}kt&&Lt.setAttribute("data-main-rotation",Ft.rotation)}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.BaseStandardFontDataFactory=A.BaseSVGFactory=A.BaseFilterFactory=A.BaseCanvasFactory=A.BaseCMapReaderFactory=void 0;var B=L(1);class W{constructor(){this.constructor===W&&(0,B.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(ie){return"none"}addHCMFilter(ie,le){return"none"}addHighlightHCMFilter(ie,le,pe,he){return"none"}destroy(ie=!1){}}A.BaseFilterFactory=W;class q{constructor(){this.constructor===q&&(0,B.unreachable)("Cannot initialize BaseCanvasFactory.")}create(ie,le){if(ie<=0||le<=0)throw new Error("Invalid canvas size");const pe=this._createCanvas(ie,le);return{canvas:pe,context:pe.getContext("2d")}}reset(ie,le,pe){if(!ie.canvas)throw new Error("Canvas is not specified");if(le<=0||pe<=0)throw new Error("Invalid canvas size");ie.canvas.width=le,ie.canvas.height=pe}destroy(ie){if(!ie.canvas)throw new Error("Canvas is not specified");ie.canvas.width=0,ie.canvas.height=0,ie.canvas=null,ie.context=null}_createCanvas(ie,le){(0,B.unreachable)("Abstract method `_createCanvas` called.")}}A.BaseCanvasFactory=q;class J{constructor({baseUrl:ie=null,isCompressed:le=!0}){this.constructor===J&&(0,B.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=ie,this.isCompressed=le}async fetch({name:ie}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!ie)throw new Error("CMap name must be specified.");const le=this.baseUrl+ie+(this.isCompressed?".bcmap":""),pe=this.isCompressed?B.CMapCompressionType.BINARY:B.CMapCompressionType.NONE;return this._fetchData(le,pe).catch(he=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${le}`)})}_fetchData(ie,le){(0,B.unreachable)("Abstract method `_fetchData` called.")}}A.BaseCMapReaderFactory=J;class re{constructor({baseUrl:ie=null}){this.constructor===re&&(0,B.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=ie}async fetch({filename:ie}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!ie)throw new Error("Font filename must be specified.");const le=`${this.baseUrl}${ie}`;return this._fetchData(le).catch(pe=>{throw new Error(`Unable to load font data at: ${le}`)})}_fetchData(ie){(0,B.unreachable)("Abstract method `_fetchData` called.")}}A.BaseStandardFontDataFactory=re;class ae{constructor(){this.constructor===ae&&(0,B.unreachable)("Cannot initialize BaseSVGFactory.")}create(ie,le,pe=!1){if(ie<=0||le<=0)throw new Error("Invalid SVG dimensions");const he=this._createSVG("svg:svg");return he.setAttribute("version","1.1"),pe||(he.setAttribute("width",`${ie}px`),he.setAttribute("height",`${le}px`)),he.setAttribute("preserveAspectRatio","none"),he.setAttribute("viewBox",`0 0 ${ie} ${le}`),he}createElement(ie){if(typeof ie!="string")throw new Error("Invalid SVG element type");return this._createSVG(ie)}_createSVG(ie){(0,B.unreachable)("Abstract method `_createSVG` called.")}}A.BaseSVGFactory=ae},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.MurmurHash3_64=void 0;var B=L(1);const W=3285377520,q=4294901760,J=65535;class re{constructor(se){this.h1=se?se&4294967295:W,this.h2=se?se&4294967295:W}update(se){let ie,le;if(typeof se=="string"){ie=new Uint8Array(se.length*2),le=0;for(let ge=0,Ce=se.length;ge<Ce;ge++){const be=se.charCodeAt(ge);be<=255?ie[le++]=be:(ie[le++]=be>>>8,ie[le++]=be&255)}}else if((0,B.isArrayBuffer)(se))ie=se.slice(),le=ie.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const pe=le>>2,he=le-pe*4,ue=new Uint32Array(ie.buffer,0,pe);let ce=0,fe=0,me=this.h1,ke=this.h2;const xe=3432918353,Le=461845907,Se=xe&J,Te=Le&J;for(let ge=0;ge<pe;ge++)ge&1?(ce=ue[ge],ce=ce*xe&q|ce*Se&J,ce=ce<<15|ce>>>17,ce=ce*Le&q|ce*Te&J,me^=ce,me=me<<13|me>>>19,me=me*5+3864292196):(fe=ue[ge],fe=fe*xe&q|fe*Se&J,fe=fe<<15|fe>>>17,fe=fe*Le&q|fe*Te&J,ke^=fe,ke=ke<<13|ke>>>19,ke=ke*5+3864292196);switch(ce=0,he){case 3:ce^=ie[pe*4+2]<<16;case 2:ce^=ie[pe*4+1]<<8;case 1:ce^=ie[pe*4],ce=ce*xe&q|ce*Se&J,ce=ce<<15|ce>>>17,ce=ce*Le&q|ce*Te&J,pe&1?me^=ce:ke^=ce}this.h1=me,this.h2=ke}hexdigest(){let se=this.h1,ie=this.h2;return se^=ie>>>1,se=se*3981806797&q|se*36045&J,ie=ie*4283543511&q|((ie<<16|se>>>16)*2950163797&q)>>>16,se^=ie>>>1,se=se*444984403&q|se*60499&J,ie=ie*3301882366&q|((ie<<16|se>>>16)*3120437893&q)>>>16,se^=ie>>>1,(se>>>0).toString(16).padStart(8,"0")+(ie>>>0).toString(16).padStart(8,"0")}}A.MurmurHash3_64=re},(g,A,L)=>{var J;Object.defineProperty(A,"__esModule",{value:!0}),A.FontLoader=A.FontFaceObject=void 0;var B=L(1);class W{constructor({ownerDocument:ae=globalThis.document,styleElement:se=null}){zt(this,J,new Set);this._document=ae,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(ae){this.nativeFontFaces.add(ae),this._document.fonts.add(ae)}removeNativeFontFace(ae){this.nativeFontFaces.delete(ae),this._document.fonts.delete(ae)}insertRule(ae){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const se=this.styleElement.sheet;se.insertRule(ae,se.cssRules.length)}clear(){for(const ae of this.nativeFontFaces)this._document.fonts.delete(ae);this.nativeFontFaces.clear(),Fe(this,J).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(ae){if(!(!ae||Fe(this,J).has(ae.loadedName))){if((0,B.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:se,src:ie,style:le}=ae,pe=new FontFace(se,ie,le);this.addNativeFontFace(pe);try{await pe.load(),Fe(this,J).add(se)}catch{(0,B.warn)(`Cannot load system font: ${ae.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(pe)}return}(0,B.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(ae){if(ae.attached||ae.missingFile&&!ae.systemFontInfo)return;if(ae.attached=!0,ae.systemFontInfo){await this.loadSystemFont(ae.systemFontInfo);return}if(this.isFontLoadingAPISupported){const ie=ae.createNativeFontFace();if(ie){this.addNativeFontFace(ie);try{await ie.loaded}catch(le){throw(0,B.warn)(`Failed to load font '${ie.family}': '${le}'.`),ae.disableFontFace=!0,le}}return}const se=ae.createFontFaceRule();if(se){if(this.insertRule(se),this.isSyncFontLoadingSupported)return;await new Promise(ie=>{const le=this._queueLoadingCallback(ie);this._prepareFontLoadEvent(ae,le)})}}get isFontLoadingAPISupported(){var se;const ae=!!((se=this._document)!=null&&se.fonts);return(0,B.shadow)(this,"isFontLoadingAPISupported",ae)}get isSyncFontLoadingSupported(){let ae=!1;return(B.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(ae=!0),(0,B.shadow)(this,"isSyncFontLoadingSupported",ae)}_queueLoadingCallback(ae){function se(){for((0,B.assert)(!le.done,"completeRequest() cannot be called twice."),le.done=!0;ie.length>0&&ie[0].done;){const pe=ie.shift();setTimeout(pe.callback,0)}}const{loadingRequests:ie}=this,le={done:!1,complete:se,callback:ae};return ie.push(le),le}get _loadTestFont(){const ae=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,B.shadow)(this,"_loadTestFont",ae)}_prepareFontLoadEvent(ae,se){function ie(Ae,De){return Ae.charCodeAt(De)<<24|Ae.charCodeAt(De+1)<<16|Ae.charCodeAt(De+2)<<8|Ae.charCodeAt(De+3)&255}function le(Ae,De,lt,Ct){const ft=Ae.substring(0,De),Et=Ae.substring(De+lt);return ft+Ct+Et}let pe,he;const ue=this._document.createElement("canvas");ue.width=1,ue.height=1;const ce=ue.getContext("2d");let fe=0;function me(Ae,De){if(++fe>30){(0,B.warn)("Load test font never loaded."),De();return}if(ce.font="30px "+Ae,ce.fillText(".",0,20),ce.getImageData(0,0,1,1).data[3]>0){De();return}setTimeout(me.bind(null,Ae,De))}const ke=`lt${Date.now()}${this.loadTestFontId++}`;let xe=this._loadTestFont;xe=le(xe,976,ke.length,ke);const Se=16,Te=1482184792;let ge=ie(xe,Se);for(pe=0,he=ke.length-3;pe<he;pe+=4)ge=ge-Te+ie(ke,pe)|0;pe<ke.length&&(ge=ge-Te+ie(ke+"XXX",pe)|0),xe=le(xe,Se,4,(0,B.string32)(ge));const Ce=`url(data:font/opentype;base64,${btoa(xe)});`,be=`@font-face {font-family:"${ke}";src:${Ce}}`;this.insertRule(be);const nt=this._document.createElement("div");nt.style.visibility="hidden",nt.style.width=nt.style.height="10px",nt.style.position="absolute",nt.style.top=nt.style.left="0px";for(const Ae of[ae.loadedName,ke]){const De=this._document.createElement("span");De.textContent="Hi",De.style.fontFamily=Ae,nt.append(De)}this._document.body.append(nt),me(ke,()=>{nt.remove(),se.complete()})}}J=new WeakMap,A.FontLoader=W;class q{constructor(ae,{isEvalSupported:se=!0,disableFontFace:ie=!1,ignoreErrors:le=!1,inspectFont:pe=null}){this.compiledGlyphs=Object.create(null);for(const he in ae)this[he]=ae[he];this.isEvalSupported=se!==!1,this.disableFontFace=ie===!0,this.ignoreErrors=le===!0,this._inspectFont=pe}createNativeFontFace(){var se;if(!this.data||this.disableFontFace)return null;let ae;if(!this.cssFontInfo)ae=new FontFace(this.loadedName,this.data,{});else{const ie={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(ie.style=`oblique ${this.cssFontInfo.italicAngle}deg`),ae=new FontFace(this.cssFontInfo.fontFamily,this.data,ie)}return(se=this._inspectFont)==null||se.call(this,this),ae}createFontFaceRule(){var le;if(!this.data||this.disableFontFace)return null;const ae=(0,B.bytesToString)(this.data),se=`url(data:${this.mimetype};base64,${btoa(ae)});`;let ie;if(!this.cssFontInfo)ie=`@font-face {font-family:"${this.loadedName}";src:${se}}`;else{let pe=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(pe+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),ie=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${pe}src:${se}}`}return(le=this._inspectFont)==null||le.call(this,this,se),ie}getPathGenerator(ae,se){if(this.compiledGlyphs[se]!==void 0)return this.compiledGlyphs[se];let ie;try{ie=ae.get(this.loadedName+"_path_"+se)}catch(le){if(!this.ignoreErrors)throw le;return(0,B.warn)(`getPathGenerator - ignoring character: "${le}".`),this.compiledGlyphs[se]=function(pe,he){}}if(this.isEvalSupported&&B.FeatureTest.isEvalSupported){const le=[];for(const pe of ie){const he=pe.args!==void 0?pe.args.join(","):"";le.push("c.",pe.cmd,"(",he,`);
`)}return this.compiledGlyphs[se]=new Function("c","size",le.join(""))}return this.compiledGlyphs[se]=function(le,pe){for(const he of ie)he.cmd==="scale"&&(he.args=[pe,-pe]),le[he.cmd].apply(le,he.args)}}}A.FontFaceObject=q},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.NodeStandardFontDataFactory=A.NodeFilterFactory=A.NodeCanvasFactory=A.NodeCMapReaderFactory=void 0;var B=L(7);L(1);const W=function(se){return new Promise((ie,le)=>{require$$5.readFile(se,(he,ue)=>{if(he||!ue){le(new Error(he));return}ie(new Uint8Array(ue))})})};class q extends B.BaseFilterFactory{}A.NodeFilterFactory=q;class J extends B.BaseCanvasFactory{_createCanvas(ie,le){return require$$5.createCanvas(ie,le)}}A.NodeCanvasFactory=J;class re extends B.BaseCMapReaderFactory{_fetchData(ie,le){return W(ie).then(pe=>({cMapData:pe,compressionType:le}))}}A.NodeCMapReaderFactory=re;class ae extends B.BaseStandardFontDataFactory{_fetchData(ie){return W(ie)}}A.NodeStandardFontDataFactory=ae},(g,A,L)=>{var bt,dc,pc;Object.defineProperty(A,"__esModule",{value:!0}),A.CanvasGraphics=void 0;var B=L(1),W=L(6),q=L(12),J=L(13);const re=16,ae=100,se=4096,ie=15,le=10,pe=1e3,he=16;function ue(Ee,ye){if(Ee._removeMirroring)throw new Error("Context is already forwarding operations.");Ee.__originalSave=Ee.save,Ee.__originalRestore=Ee.restore,Ee.__originalRotate=Ee.rotate,Ee.__originalScale=Ee.scale,Ee.__originalTranslate=Ee.translate,Ee.__originalTransform=Ee.transform,Ee.__originalSetTransform=Ee.setTransform,Ee.__originalResetTransform=Ee.resetTransform,Ee.__originalClip=Ee.clip,Ee.__originalMoveTo=Ee.moveTo,Ee.__originalLineTo=Ee.lineTo,Ee.__originalBezierCurveTo=Ee.bezierCurveTo,Ee.__originalRect=Ee.rect,Ee.__originalClosePath=Ee.closePath,Ee.__originalBeginPath=Ee.beginPath,Ee._removeMirroring=()=>{Ee.save=Ee.__originalSave,Ee.restore=Ee.__originalRestore,Ee.rotate=Ee.__originalRotate,Ee.scale=Ee.__originalScale,Ee.translate=Ee.__originalTranslate,Ee.transform=Ee.__originalTransform,Ee.setTransform=Ee.__originalSetTransform,Ee.resetTransform=Ee.__originalResetTransform,Ee.clip=Ee.__originalClip,Ee.moveTo=Ee.__originalMoveTo,Ee.lineTo=Ee.__originalLineTo,Ee.bezierCurveTo=Ee.__originalBezierCurveTo,Ee.rect=Ee.__originalRect,Ee.closePath=Ee.__originalClosePath,Ee.beginPath=Ee.__originalBeginPath,delete Ee._removeMirroring},Ee.save=function(){ye.save(),this.__originalSave()},Ee.restore=function(){ye.restore(),this.__originalRestore()},Ee.translate=function(Pe,rt){ye.translate(Pe,rt),this.__originalTranslate(Pe,rt)},Ee.scale=function(Pe,rt){ye.scale(Pe,rt),this.__originalScale(Pe,rt)},Ee.transform=function(Pe,rt,st,ot,mt,At){ye.transform(Pe,rt,st,ot,mt,At),this.__originalTransform(Pe,rt,st,ot,mt,At)},Ee.setTransform=function(Pe,rt,st,ot,mt,At){ye.setTransform(Pe,rt,st,ot,mt,At),this.__originalSetTransform(Pe,rt,st,ot,mt,At)},Ee.resetTransform=function(){ye.resetTransform(),this.__originalResetTransform()},Ee.rotate=function(Pe){ye.rotate(Pe),this.__originalRotate(Pe)},Ee.clip=function(Pe){ye.clip(Pe),this.__originalClip(Pe)},Ee.moveTo=function(ve,Pe){ye.moveTo(ve,Pe),this.__originalMoveTo(ve,Pe)},Ee.lineTo=function(ve,Pe){ye.lineTo(ve,Pe),this.__originalLineTo(ve,Pe)},Ee.bezierCurveTo=function(ve,Pe,rt,st,ot,mt){ye.bezierCurveTo(ve,Pe,rt,st,ot,mt),this.__originalBezierCurveTo(ve,Pe,rt,st,ot,mt)},Ee.rect=function(ve,Pe,rt,st){ye.rect(ve,Pe,rt,st),this.__originalRect(ve,Pe,rt,st)},Ee.closePath=function(){ye.closePath(),this.__originalClosePath()},Ee.beginPath=function(){ye.beginPath(),this.__originalBeginPath()}}class ce{constructor(ye){this.canvasFactory=ye,this.cache=Object.create(null)}getCanvas(ye,ve,Pe){let rt;return this.cache[ye]!==void 0?(rt=this.cache[ye],this.canvasFactory.reset(rt,ve,Pe)):(rt=this.canvasFactory.create(ve,Pe),this.cache[ye]=rt),rt}delete(ye){delete this.cache[ye]}clear(){for(const ye in this.cache){const ve=this.cache[ye];this.canvasFactory.destroy(ve),delete this.cache[ye]}}}function fe(Ee,ye,ve,Pe,rt,st,ot,mt,At,It){const[it,Vt,Yt,Zt,Lt,Ft]=(0,W.getCurrentTransform)(Ee);if(Vt===0&&Yt===0){const Dt=ot*it+Lt,Bt=Math.round(Dt),Qt=mt*Zt+Ft,or=Math.round(Qt),ar=(ot+At)*it+Lt,Nt=Math.abs(Math.round(ar)-Bt)||1,fr=(mt+It)*Zt+Ft,ur=Math.abs(Math.round(fr)-or)||1;return Ee.setTransform(Math.sign(it),0,0,Math.sign(Zt),Bt,or),Ee.drawImage(ye,ve,Pe,rt,st,0,0,Nt,ur),Ee.setTransform(it,Vt,Yt,Zt,Lt,Ft),[Nt,ur]}if(it===0&&Zt===0){const Dt=mt*Yt+Lt,Bt=Math.round(Dt),Qt=ot*Vt+Ft,or=Math.round(Qt),ar=(mt+It)*Yt+Lt,Nt=Math.abs(Math.round(ar)-Bt)||1,fr=(ot+At)*Vt+Ft,ur=Math.abs(Math.round(fr)-or)||1;return Ee.setTransform(0,Math.sign(Vt),Math.sign(Yt),0,Bt,or),Ee.drawImage(ye,ve,Pe,rt,st,0,0,ur,Nt),Ee.setTransform(it,Vt,Yt,Zt,Lt,Ft),[ur,Nt]}Ee.drawImage(ye,ve,Pe,rt,st,ot,mt,At,It);const ht=Math.hypot(it,Vt),kt=Math.hypot(Yt,Zt);return[ht*At,kt*It]}function me(Ee){const{width:ye,height:ve}=Ee;if(ye>pe||ve>pe)return null;const Pe=1e3,rt=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),st=ye+1;let ot=new Uint8Array(st*(ve+1)),mt,At,It;const it=ye+7&-8;let Vt=new Uint8Array(it*ve),Yt=0;for(const kt of Ee.data){let Dt=128;for(;Dt>0;)Vt[Yt++]=kt&Dt?0:255,Dt>>=1}let Zt=0;for(Yt=0,Vt[Yt]!==0&&(ot[0]=1,++Zt),At=1;At<ye;At++)Vt[Yt]!==Vt[Yt+1]&&(ot[At]=Vt[Yt]?2:1,++Zt),Yt++;for(Vt[Yt]!==0&&(ot[At]=2,++Zt),mt=1;mt<ve;mt++){Yt=mt*it,It=mt*st,Vt[Yt-it]!==Vt[Yt]&&(ot[It]=Vt[Yt]?1:8,++Zt);let kt=(Vt[Yt]?4:0)+(Vt[Yt-it]?8:0);for(At=1;At<ye;At++)kt=(kt>>2)+(Vt[Yt+1]?4:0)+(Vt[Yt-it+1]?8:0),rt[kt]&&(ot[It+At]=rt[kt],++Zt),Yt++;if(Vt[Yt-it]!==Vt[Yt]&&(ot[It+At]=Vt[Yt]?2:4,++Zt),Zt>Pe)return null}for(Yt=it*(ve-1),It=mt*st,Vt[Yt]!==0&&(ot[It]=8,++Zt),At=1;At<ye;At++)Vt[Yt]!==Vt[Yt+1]&&(ot[It+At]=Vt[Yt]?4:8,++Zt),Yt++;if(Vt[Yt]!==0&&(ot[It+At]=4,++Zt),Zt>Pe)return null;const Lt=new Int32Array([0,st,-1,0,-st,0,0,0,1]),Ft=new Path2D;for(mt=0;Zt&&mt<=ve;mt++){let kt=mt*st;const Dt=kt+ye;for(;kt<Dt&&!ot[kt];)kt++;if(kt===Dt)continue;Ft.moveTo(kt%st,mt);const Bt=kt;let Qt=ot[kt];do{const or=Lt[Qt];do kt+=or;while(!ot[kt]);const ar=ot[kt];ar!==5&&ar!==10?(Qt=ar,ot[kt]=0):(Qt=ar&51*Qt>>4,ot[kt]&=Qt>>2|Qt<<2),Ft.lineTo(kt%st,kt/st|0),ot[kt]||--Zt}while(Bt!==kt);--mt}return Vt=null,ot=null,function(kt){kt.save(),kt.scale(1/ye,-1/ve),kt.translate(0,-ve),kt.fill(Ft),kt.beginPath(),kt.restore()}}class ke{constructor(ye,ve){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=B.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=B.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=B.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ye,ve])}clone(){const ye=Object.create(this);return ye.clipBox=this.clipBox.slice(),ye}setCurrentPoint(ye,ve){this.x=ye,this.y=ve}updatePathMinMax(ye,ve,Pe){[ve,Pe]=B.Util.applyTransform([ve,Pe],ye),this.minX=Math.min(this.minX,ve),this.minY=Math.min(this.minY,Pe),this.maxX=Math.max(this.maxX,ve),this.maxY=Math.max(this.maxY,Pe)}updateRectMinMax(ye,ve){const Pe=B.Util.applyTransform(ve,ye),rt=B.Util.applyTransform(ve.slice(2),ye);this.minX=Math.min(this.minX,Pe[0],rt[0]),this.minY=Math.min(this.minY,Pe[1],rt[1]),this.maxX=Math.max(this.maxX,Pe[0],rt[0]),this.maxY=Math.max(this.maxY,Pe[1],rt[1])}updateScalingPathMinMax(ye,ve){B.Util.scaleMinMax(ye,ve),this.minX=Math.min(this.minX,ve[0]),this.maxX=Math.max(this.maxX,ve[1]),this.minY=Math.min(this.minY,ve[2]),this.maxY=Math.max(this.maxY,ve[3])}updateCurvePathMinMax(ye,ve,Pe,rt,st,ot,mt,At,It,it){const Vt=B.Util.bezierBoundingBox(ve,Pe,rt,st,ot,mt,At,It);if(it){it[0]=Math.min(it[0],Vt[0],Vt[2]),it[1]=Math.max(it[1],Vt[0],Vt[2]),it[2]=Math.min(it[2],Vt[1],Vt[3]),it[3]=Math.max(it[3],Vt[1],Vt[3]);return}this.updateRectMinMax(ye,Vt)}getPathBoundingBox(ye=q.PathType.FILL,ve=null){const Pe=[this.minX,this.minY,this.maxX,this.maxY];if(ye===q.PathType.STROKE){ve||(0,B.unreachable)("Stroke bounding box must include transform.");const rt=B.Util.singularValueDecompose2dScale(ve),st=rt[0]*this.lineWidth/2,ot=rt[1]*this.lineWidth/2;Pe[0]-=st,Pe[1]-=ot,Pe[2]+=st,Pe[3]+=ot}return Pe}updateClipFromPath(){const ye=B.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ye||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ye){this.clipBox=ye,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ye=q.PathType.FILL,ve=null){return B.Util.intersect(this.clipBox,this.getPathBoundingBox(ye,ve))}}function xe(Ee,ye){if(typeof ImageData<"u"&&ye instanceof ImageData){Ee.putImageData(ye,0,0);return}const ve=ye.height,Pe=ye.width,rt=ve%he,st=(ve-rt)/he,ot=rt===0?st:st+1,mt=Ee.createImageData(Pe,he);let At=0,It;const it=ye.data,Vt=mt.data;let Yt,Zt,Lt,Ft;if(ye.kind===B.ImageKind.GRAYSCALE_1BPP){const ht=it.byteLength,kt=new Uint32Array(Vt.buffer,0,Vt.byteLength>>2),Dt=kt.length,Bt=Pe+7>>3,Qt=4294967295,or=B.FeatureTest.isLittleEndian?4278190080:255;for(Yt=0;Yt<ot;Yt++){for(Lt=Yt<st?he:rt,It=0,Zt=0;Zt<Lt;Zt++){const ar=ht-At;let Nt=0;const fr=ar>Bt?Pe:ar*8-7,ur=fr&-8;let Pr=0,Rr=0;for(;Nt<ur;Nt+=8)Rr=it[At++],kt[It++]=Rr&128?Qt:or,kt[It++]=Rr&64?Qt:or,kt[It++]=Rr&32?Qt:or,kt[It++]=Rr&16?Qt:or,kt[It++]=Rr&8?Qt:or,kt[It++]=Rr&4?Qt:or,kt[It++]=Rr&2?Qt:or,kt[It++]=Rr&1?Qt:or;for(;Nt<fr;Nt++)Pr===0&&(Rr=it[At++],Pr=128),kt[It++]=Rr&Pr?Qt:or,Pr>>=1}for(;It<Dt;)kt[It++]=0;Ee.putImageData(mt,0,Yt*he)}}else if(ye.kind===B.ImageKind.RGBA_32BPP){for(Zt=0,Ft=Pe*he*4,Yt=0;Yt<st;Yt++)Vt.set(it.subarray(At,At+Ft)),At+=Ft,Ee.putImageData(mt,0,Zt),Zt+=he;Yt<ot&&(Ft=Pe*rt*4,Vt.set(it.subarray(At,At+Ft)),Ee.putImageData(mt,0,Zt))}else if(ye.kind===B.ImageKind.RGB_24BPP)for(Lt=he,Ft=Pe*Lt,Yt=0;Yt<ot;Yt++){for(Yt>=st&&(Lt=rt,Ft=Pe*Lt),It=0,Zt=Ft;Zt--;)Vt[It++]=it[At++],Vt[It++]=it[At++],Vt[It++]=it[At++],Vt[It++]=255;Ee.putImageData(mt,0,Yt*he)}else throw new Error(`bad image kind: ${ye.kind}`)}function Le(Ee,ye){if(ye.bitmap){Ee.drawImage(ye.bitmap,0,0);return}const ve=ye.height,Pe=ye.width,rt=ve%he,st=(ve-rt)/he,ot=rt===0?st:st+1,mt=Ee.createImageData(Pe,he);let At=0;const It=ye.data,it=mt.data;for(let Vt=0;Vt<ot;Vt++){const Yt=Vt<st?he:rt;({srcPos:At}=(0,J.convertBlackAndWhiteToRGBA)({src:It,srcPos:At,dest:it,width:Pe,height:Yt,nonBlackColor:0})),Ee.putImageData(mt,0,Vt*he)}}function Se(Ee,ye){const ve=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const Pe of ve)Ee[Pe]!==void 0&&(ye[Pe]=Ee[Pe]);Ee.setLineDash!==void 0&&(ye.setLineDash(Ee.getLineDash()),ye.lineDashOffset=Ee.lineDashOffset)}function Te(Ee){if(Ee.strokeStyle=Ee.fillStyle="#000000",Ee.fillRule="nonzero",Ee.globalAlpha=1,Ee.lineWidth=1,Ee.lineCap="butt",Ee.lineJoin="miter",Ee.miterLimit=10,Ee.globalCompositeOperation="source-over",Ee.font="10px sans-serif",Ee.setLineDash!==void 0&&(Ee.setLineDash([]),Ee.lineDashOffset=0),!B.isNodeJS){const{filter:ye}=Ee;ye!=="none"&&ye!==""&&(Ee.filter="none")}}function ge(Ee,ye,ve,Pe){const rt=Ee.length;for(let st=3;st<rt;st+=4){const ot=Ee[st];if(ot===0)Ee[st-3]=ye,Ee[st-2]=ve,Ee[st-1]=Pe;else if(ot<255){const mt=255-ot;Ee[st-3]=Ee[st-3]*ot+ye*mt>>8,Ee[st-2]=Ee[st-2]*ot+ve*mt>>8,Ee[st-1]=Ee[st-1]*ot+Pe*mt>>8}}}function Ce(Ee,ye,ve){const Pe=Ee.length,rt=1/255;for(let st=3;st<Pe;st+=4){const ot=ve?ve[Ee[st]]:Ee[st];ye[st]=ye[st]*ot*rt|0}}function be(Ee,ye,ve){const Pe=Ee.length;for(let rt=3;rt<Pe;rt+=4){const st=Ee[rt-3]*77+Ee[rt-2]*152+Ee[rt-1]*28;ye[rt]=ve?ye[rt]*ve[st>>8]>>8:ye[rt]*st>>16}}function nt(Ee,ye,ve,Pe,rt,st,ot,mt,At,It,it){const Vt=!!st,Yt=Vt?st[0]:0,Zt=Vt?st[1]:0,Lt=Vt?st[2]:0,Ft=rt==="Luminosity"?be:Ce,kt=Math.min(Pe,Math.ceil(1048576/ve));for(let Dt=0;Dt<Pe;Dt+=kt){const Bt=Math.min(kt,Pe-Dt),Qt=Ee.getImageData(mt-It,Dt+(At-it),ve,Bt),or=ye.getImageData(mt,Dt+At,ve,Bt);Vt&&ge(Qt.data,Yt,Zt,Lt),Ft(Qt.data,or.data,ot),ye.putImageData(or,mt,Dt+At)}}function Ae(Ee,ye,ve,Pe){const rt=Pe[0],st=Pe[1],ot=Pe[2]-rt,mt=Pe[3]-st;ot===0||mt===0||(nt(ye.context,ve,ot,mt,ye.subtype,ye.backdrop,ye.transferMap,rt,st,ye.offsetX,ye.offsetY),Ee.save(),Ee.globalAlpha=1,Ee.globalCompositeOperation="source-over",Ee.setTransform(1,0,0,1,0,0),Ee.drawImage(ve.canvas,0,0),Ee.restore())}function De(Ee,ye){const ve=B.Util.singularValueDecompose2dScale(Ee);ve[0]=Math.fround(ve[0]),ve[1]=Math.fround(ve[1]);const Pe=Math.fround((globalThis.devicePixelRatio||1)*W.PixelsPerInch.PDF_TO_CSS_UNITS);return ye!==void 0?ye:ve[0]<=Pe||ve[1]<=Pe}const lt=["butt","round","square"],Ct=["miter","round","bevel"],ft={},Et={},at=class at{constructor(ye,ve,Pe,rt,st,{optionalContentConfig:ot,markedContentStack:mt=null},At,It){zt(this,bt);this.ctx=ye,this.current=new ke(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=ve,this.objs=Pe,this.canvasFactory=rt,this.filterFactory=st,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=mt||[],this.optionalContentConfig=ot,this.cachedCanvases=new ce(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=At,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=It,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ye,ve=null){return typeof ye=="string"?ye.startsWith("g_")?this.commonObjs.get(ye):this.objs.get(ye):ve}beginDrawing({transform:ye,viewport:ve,transparency:Pe=!1,background:rt=null}){const st=this.ctx.canvas.width,ot=this.ctx.canvas.height,mt=this.ctx.fillStyle;if(this.ctx.fillStyle=rt||"#ffffff",this.ctx.fillRect(0,0,st,ot),this.ctx.fillStyle=mt,Pe){const At=this.cachedCanvases.getCanvas("transparent",st,ot);this.compositeCtx=this.ctx,this.transparentCanvas=At.canvas,this.ctx=At.context,this.ctx.save(),this.ctx.transform(...(0,W.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Te(this.ctx),ye&&(this.ctx.transform(...ye),this.outputScaleX=ye[0],this.outputScaleY=ye[0]),this.ctx.transform(...ve.transform),this.viewportScale=ve.scale,this.baseTransform=(0,W.getCurrentTransform)(this.ctx)}executeOperatorList(ye,ve,Pe,rt){const st=ye.argsArray,ot=ye.fnArray;let mt=ve||0;const At=st.length;if(At===mt)return mt;const It=At-mt>le&&typeof Pe=="function",it=It?Date.now()+ie:0;let Vt=0;const Yt=this.commonObjs,Zt=this.objs;let Lt;for(;;){if(rt!==void 0&&mt===rt.nextBreakPoint)return rt.breakIt(mt,Pe),mt;if(Lt=ot[mt],Lt!==B.OPS.dependency)this[Lt].apply(this,st[mt]);else for(const Ft of st[mt]){const ht=Ft.startsWith("g_")?Yt:Zt;if(!ht.has(Ft))return ht.get(Ft,Pe),mt}if(mt++,mt===At)return mt;if(It&&++Vt>le){if(Date.now()>it)return Pe(),mt;Vt=0}}}endDrawing(){Mt(this,bt,dc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ye of this._cachedBitmapsMap.values()){for(const ve of ye.values())typeof HTMLCanvasElement<"u"&&ve instanceof HTMLCanvasElement&&(ve.width=ve.height=0);ye.clear()}this._cachedBitmapsMap.clear(),Mt(this,bt,pc).call(this)}_scaleImage(ye,ve){const Pe=ye.width,rt=ye.height;let st=Math.max(Math.hypot(ve[0],ve[1]),1),ot=Math.max(Math.hypot(ve[2],ve[3]),1),mt=Pe,At=rt,It="prescale1",it,Vt;for(;st>2&&mt>1||ot>2&&At>1;){let Yt=mt,Zt=At;st>2&&mt>1&&(Yt=mt>=16384?Math.floor(mt/2)-1||1:Math.ceil(mt/2),st/=mt/Yt),ot>2&&At>1&&(Zt=At>=16384?Math.floor(At/2)-1||1:Math.ceil(At)/2,ot/=At/Zt),it=this.cachedCanvases.getCanvas(It,Yt,Zt),Vt=it.context,Vt.clearRect(0,0,Yt,Zt),Vt.drawImage(ye,0,0,mt,At,0,0,Yt,Zt),ye=it.canvas,mt=Yt,At=Zt,It=It==="prescale1"?"prescale2":"prescale1"}return{img:ye,paintWidth:mt,paintHeight:At}}_createMaskCanvas(ye){const ve=this.ctx,{width:Pe,height:rt}=ye,st=this.current.fillColor,ot=this.current.patternFill,mt=(0,W.getCurrentTransform)(ve);let At,It,it,Vt;if((ye.bitmap||ye.data)&&ye.count>1){const Nt=ye.bitmap||ye.data.buffer;It=JSON.stringify(ot?mt:[mt.slice(0,4),st]),At=this._cachedBitmapsMap.get(Nt),At||(At=new Map,this._cachedBitmapsMap.set(Nt,At));const fr=At.get(It);if(fr&&!ot){const ur=Math.round(Math.min(mt[0],mt[2])+mt[4]),Pr=Math.round(Math.min(mt[1],mt[3])+mt[5]);return{canvas:fr,offsetX:ur,offsetY:Pr}}it=fr}it||(Vt=this.cachedCanvases.getCanvas("maskCanvas",Pe,rt),Le(Vt.context,ye));let Yt=B.Util.transform(mt,[1/Pe,0,0,-1/rt,0,0]);Yt=B.Util.transform(Yt,[1,0,0,1,0,-rt]);const Zt=B.Util.applyTransform([0,0],Yt),Lt=B.Util.applyTransform([Pe,rt],Yt),Ft=B.Util.normalizeRect([Zt[0],Zt[1],Lt[0],Lt[1]]),ht=Math.round(Ft[2]-Ft[0])||1,kt=Math.round(Ft[3]-Ft[1])||1,Dt=this.cachedCanvases.getCanvas("fillCanvas",ht,kt),Bt=Dt.context,Qt=Math.min(Zt[0],Lt[0]),or=Math.min(Zt[1],Lt[1]);Bt.translate(-Qt,-or),Bt.transform(...Yt),it||(it=this._scaleImage(Vt.canvas,(0,W.getCurrentTransformInverse)(Bt)),it=it.img,At&&ot&&At.set(It,it)),Bt.imageSmoothingEnabled=De((0,W.getCurrentTransform)(Bt),ye.interpolate),fe(Bt,it,0,0,it.width,it.height,0,0,Pe,rt),Bt.globalCompositeOperation="source-in";const ar=B.Util.transform((0,W.getCurrentTransformInverse)(Bt),[1,0,0,1,-Qt,-or]);return Bt.fillStyle=ot?st.getPattern(ve,this,ar,q.PathType.FILL):st,Bt.fillRect(0,0,Pe,rt),At&&!ot&&(this.cachedCanvases.delete("fillCanvas"),At.set(It,Dt.canvas)),{canvas:Dt.canvas,offsetX:Math.round(Qt),offsetY:Math.round(or)}}setLineWidth(ye){ye!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ye,this.ctx.lineWidth=ye}setLineCap(ye){this.ctx.lineCap=lt[ye]}setLineJoin(ye){this.ctx.lineJoin=Ct[ye]}setMiterLimit(ye){this.ctx.miterLimit=ye}setDash(ye,ve){const Pe=this.ctx;Pe.setLineDash!==void 0&&(Pe.setLineDash(ye),Pe.lineDashOffset=ve)}setRenderingIntent(ye){}setFlatness(ye){}setGState(ye){for(const[ve,Pe]of ye)switch(ve){case"LW":this.setLineWidth(Pe);break;case"LC":this.setLineCap(Pe);break;case"LJ":this.setLineJoin(Pe);break;case"ML":this.setMiterLimit(Pe);break;case"D":this.setDash(Pe[0],Pe[1]);break;case"RI":this.setRenderingIntent(Pe);break;case"FL":this.setFlatness(Pe);break;case"Font":this.setFont(Pe[0],Pe[1]);break;case"CA":this.current.strokeAlpha=Pe;break;case"ca":this.current.fillAlpha=Pe,this.ctx.globalAlpha=Pe;break;case"BM":this.ctx.globalCompositeOperation=Pe;break;case"SMask":this.current.activeSMask=Pe?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(Pe);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ye=this.inSMaskMode;this.current.activeSMask&&!ye?this.beginSMaskMode():!this.current.activeSMask&&ye&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ye=this.ctx.canvas.width,ve=this.ctx.canvas.height,Pe="smaskGroupAt"+this.groupLevel,rt=this.cachedCanvases.getCanvas(Pe,ye,ve);this.suspendedCtx=this.ctx,this.ctx=rt.context;const st=this.ctx;st.setTransform(...(0,W.getCurrentTransform)(this.suspendedCtx)),Se(this.suspendedCtx,st),ue(st,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Se(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ye){if(!this.current.activeSMask)return;ye?(ye[0]=Math.floor(ye[0]),ye[1]=Math.floor(ye[1]),ye[2]=Math.ceil(ye[2]),ye[3]=Math.ceil(ye[3])):ye=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const ve=this.current.activeSMask,Pe=this.suspendedCtx;Ae(Pe,ve,this.ctx,ye),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Se(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ye=this.current;this.stateStack.push(ye),this.current=ye.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Se(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ye,ve,Pe,rt,st,ot){this.ctx.transform(ye,ve,Pe,rt,st,ot),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ye,ve,Pe){const rt=this.ctx,st=this.current;let ot=st.x,mt=st.y,At,It;const it=(0,W.getCurrentTransform)(rt),Vt=it[0]===0&&it[3]===0||it[1]===0&&it[2]===0,Yt=Vt?Pe.slice(0):null;for(let Zt=0,Lt=0,Ft=ye.length;Zt<Ft;Zt++)switch(ye[Zt]|0){case B.OPS.rectangle:ot=ve[Lt++],mt=ve[Lt++];const ht=ve[Lt++],kt=ve[Lt++],Dt=ot+ht,Bt=mt+kt;rt.moveTo(ot,mt),ht===0||kt===0?rt.lineTo(Dt,Bt):(rt.lineTo(Dt,mt),rt.lineTo(Dt,Bt),rt.lineTo(ot,Bt)),Vt||st.updateRectMinMax(it,[ot,mt,Dt,Bt]),rt.closePath();break;case B.OPS.moveTo:ot=ve[Lt++],mt=ve[Lt++],rt.moveTo(ot,mt),Vt||st.updatePathMinMax(it,ot,mt);break;case B.OPS.lineTo:ot=ve[Lt++],mt=ve[Lt++],rt.lineTo(ot,mt),Vt||st.updatePathMinMax(it,ot,mt);break;case B.OPS.curveTo:At=ot,It=mt,ot=ve[Lt+4],mt=ve[Lt+5],rt.bezierCurveTo(ve[Lt],ve[Lt+1],ve[Lt+2],ve[Lt+3],ot,mt),st.updateCurvePathMinMax(it,At,It,ve[Lt],ve[Lt+1],ve[Lt+2],ve[Lt+3],ot,mt,Yt),Lt+=6;break;case B.OPS.curveTo2:At=ot,It=mt,rt.bezierCurveTo(ot,mt,ve[Lt],ve[Lt+1],ve[Lt+2],ve[Lt+3]),st.updateCurvePathMinMax(it,At,It,ot,mt,ve[Lt],ve[Lt+1],ve[Lt+2],ve[Lt+3],Yt),ot=ve[Lt+2],mt=ve[Lt+3],Lt+=4;break;case B.OPS.curveTo3:At=ot,It=mt,ot=ve[Lt+2],mt=ve[Lt+3],rt.bezierCurveTo(ve[Lt],ve[Lt+1],ot,mt,ot,mt),st.updateCurvePathMinMax(it,At,It,ve[Lt],ve[Lt+1],ot,mt,ot,mt,Yt),Lt+=4;break;case B.OPS.closePath:rt.closePath();break}Vt&&st.updateScalingPathMinMax(it,Yt),st.setCurrentPoint(ot,mt)}closePath(){this.ctx.closePath()}stroke(ye=!0){const ve=this.ctx,Pe=this.current.strokeColor;ve.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Pe=="object"&&(Pe!=null&&Pe.getPattern)?(ve.save(),ve.strokeStyle=Pe.getPattern(ve,this,(0,W.getCurrentTransformInverse)(ve),q.PathType.STROKE),this.rescaleAndStroke(!1),ve.restore()):this.rescaleAndStroke(!0)),ye&&this.consumePath(this.current.getClippedPathBoundingBox()),ve.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ye=!0){const ve=this.ctx,Pe=this.current.fillColor,rt=this.current.patternFill;let st=!1;rt&&(ve.save(),ve.fillStyle=Pe.getPattern(ve,this,(0,W.getCurrentTransformInverse)(ve),q.PathType.FILL),st=!0);const ot=this.current.getClippedPathBoundingBox();this.contentVisible&&ot!==null&&(this.pendingEOFill?(ve.fill("evenodd"),this.pendingEOFill=!1):ve.fill()),st&&ve.restore(),ye&&this.consumePath(ot)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ft}eoClip(){this.pendingClip=Et}beginText(){this.current.textMatrix=B.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ye=this.pendingTextPaths,ve=this.ctx;if(ye===void 0){ve.beginPath();return}ve.save(),ve.beginPath();for(const Pe of ye)ve.setTransform(...Pe.transform),ve.translate(Pe.x,Pe.y),Pe.addToPath(ve,Pe.fontSize);ve.restore(),ve.clip(),ve.beginPath(),delete this.pendingTextPaths}setCharSpacing(ye){this.current.charSpacing=ye}setWordSpacing(ye){this.current.wordSpacing=ye}setHScale(ye){this.current.textHScale=ye/100}setLeading(ye){this.current.leading=-ye}setFont(ye,ve){var it;const Pe=this.commonObjs.get(ye),rt=this.current;if(!Pe)throw new Error(`Can't find font for ${ye}`);if(rt.fontMatrix=Pe.fontMatrix||B.FONT_IDENTITY_MATRIX,(rt.fontMatrix[0]===0||rt.fontMatrix[3]===0)&&(0,B.warn)("Invalid font matrix for font "+ye),ve<0?(ve=-ve,rt.fontDirection=-1):rt.fontDirection=1,this.current.font=Pe,this.current.fontSize=ve,Pe.isType3Font)return;const st=Pe.loadedName||"sans-serif",ot=((it=Pe.systemFontInfo)==null?void 0:it.css)||`"${st}", ${Pe.fallbackName}`;let mt="normal";Pe.black?mt="900":Pe.bold&&(mt="bold");const At=Pe.italic?"italic":"normal";let It=ve;ve<re?It=re:ve>ae&&(It=ae),this.current.fontSizeScale=ve/It,this.ctx.font=`${At} ${mt} ${It}px ${ot}`}setTextRenderingMode(ye){this.current.textRenderingMode=ye}setTextRise(ye){this.current.textRise=ye}moveText(ye,ve){this.current.x=this.current.lineX+=ye,this.current.y=this.current.lineY+=ve}setLeadingMoveText(ye,ve){this.setLeading(-ve),this.moveText(ye,ve)}setTextMatrix(ye,ve,Pe,rt,st,ot){this.current.textMatrix=[ye,ve,Pe,rt,st,ot],this.current.textMatrixScale=Math.hypot(ye,ve),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ye,ve,Pe,rt){const st=this.ctx,ot=this.current,mt=ot.font,At=ot.textRenderingMode,It=ot.fontSize/ot.fontSizeScale,it=At&B.TextRenderingMode.FILL_STROKE_MASK,Vt=!!(At&B.TextRenderingMode.ADD_TO_PATH_FLAG),Yt=ot.patternFill&&!mt.missingFile;let Zt;(mt.disableFontFace||Vt||Yt)&&(Zt=mt.getPathGenerator(this.commonObjs,ye)),mt.disableFontFace||Yt?(st.save(),st.translate(ve,Pe),st.beginPath(),Zt(st,It),rt&&st.setTransform(...rt),(it===B.TextRenderingMode.FILL||it===B.TextRenderingMode.FILL_STROKE)&&st.fill(),(it===B.TextRenderingMode.STROKE||it===B.TextRenderingMode.FILL_STROKE)&&st.stroke(),st.restore()):((it===B.TextRenderingMode.FILL||it===B.TextRenderingMode.FILL_STROKE)&&st.fillText(ye,ve,Pe),(it===B.TextRenderingMode.STROKE||it===B.TextRenderingMode.FILL_STROKE)&&st.strokeText(ye,ve,Pe)),Vt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,W.getCurrentTransform)(st),x:ve,y:Pe,fontSize:It,addToPath:Zt})}get isFontSubpixelAAEnabled(){const{context:ye}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ye.scale(1.5,1),ye.fillText("I",0,10);const ve=ye.getImageData(0,0,10,10).data;let Pe=!1;for(let rt=3;rt<ve.length;rt+=4)if(ve[rt]>0&&ve[rt]<255){Pe=!0;break}return(0,B.shadow)(this,"isFontSubpixelAAEnabled",Pe)}showText(ye){const ve=this.current,Pe=ve.font;if(Pe.isType3Font)return this.showType3Text(ye);const rt=ve.fontSize;if(rt===0)return;const st=this.ctx,ot=ve.fontSizeScale,mt=ve.charSpacing,At=ve.wordSpacing,It=ve.fontDirection,it=ve.textHScale*It,Vt=ye.length,Yt=Pe.vertical,Zt=Yt?1:-1,Lt=Pe.defaultVMetrics,Ft=rt*ve.fontMatrix[0],ht=ve.textRenderingMode===B.TextRenderingMode.FILL&&!Pe.disableFontFace&&!ve.patternFill;st.save(),st.transform(...ve.textMatrix),st.translate(ve.x,ve.y+ve.textRise),It>0?st.scale(it,-1):st.scale(it,1);let kt;if(ve.patternFill){st.save();const ar=ve.fillColor.getPattern(st,this,(0,W.getCurrentTransformInverse)(st),q.PathType.FILL);kt=(0,W.getCurrentTransform)(st),st.restore(),st.fillStyle=ar}let Dt=ve.lineWidth;const Bt=ve.textMatrixScale;if(Bt===0||Dt===0){const ar=ve.textRenderingMode&B.TextRenderingMode.FILL_STROKE_MASK;(ar===B.TextRenderingMode.STROKE||ar===B.TextRenderingMode.FILL_STROKE)&&(Dt=this.getSinglePixelWidth())}else Dt/=Bt;if(ot!==1&&(st.scale(ot,ot),Dt/=ot),st.lineWidth=Dt,Pe.isInvalidPDFjsFont){const ar=[];let Nt=0;for(const fr of ye)ar.push(fr.unicode),Nt+=fr.width;st.fillText(ar.join(""),0,0),ve.x+=Nt*Ft*it,st.restore(),this.compose();return}let Qt=0,or;for(or=0;or<Vt;++or){const ar=ye[or];if(typeof ar=="number"){Qt+=Zt*ar*rt/1e3;continue}let Nt=!1;const fr=(ar.isSpace?At:0)+mt,ur=ar.fontChar,Pr=ar.accent;let Rr,vr,dr=ar.width;if(Yt){const Ir=ar.vmetric||Lt,zr=-(ar.vmetric?Ir[1]:dr*.5)*Ft,lr=Ir[2]*Ft;dr=Ir?-Ir[0]:dr,Rr=zr/ot,vr=(Qt+lr)/ot}else Rr=Qt/ot,vr=0;if(Pe.remeasure&&dr>0){const Ir=st.measureText(ur).width*1e3/rt*ot;if(dr<Ir&&this.isFontSubpixelAAEnabled){const zr=dr/Ir;Nt=!0,st.save(),st.scale(zr,1),Rr/=zr}else dr!==Ir&&(Rr+=(dr-Ir)/2e3*rt/ot)}if(this.contentVisible&&(ar.isInFont||Pe.missingFile)){if(ht&&!Pr)st.fillText(ur,Rr,vr);else if(this.paintChar(ur,Rr,vr,kt),Pr){const Ir=Rr+rt*Pr.offset.x/ot,zr=vr-rt*Pr.offset.y/ot;this.paintChar(Pr.fontChar,Ir,zr,kt)}}const br=Yt?dr*Ft-fr*It:dr*Ft+fr*It;Qt+=br,Nt&&st.restore()}Yt?ve.y-=Qt:ve.x+=Qt*it,st.restore(),this.compose()}showType3Text(ye){const ve=this.ctx,Pe=this.current,rt=Pe.font,st=Pe.fontSize,ot=Pe.fontDirection,mt=rt.vertical?1:-1,At=Pe.charSpacing,It=Pe.wordSpacing,it=Pe.textHScale*ot,Vt=Pe.fontMatrix||B.FONT_IDENTITY_MATRIX,Yt=ye.length,Zt=Pe.textRenderingMode===B.TextRenderingMode.INVISIBLE;let Lt,Ft,ht,kt;if(!(Zt||st===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,ve.save(),ve.transform(...Pe.textMatrix),ve.translate(Pe.x,Pe.y),ve.scale(it,ot),Lt=0;Lt<Yt;++Lt){if(Ft=ye[Lt],typeof Ft=="number"){kt=mt*Ft*st/1e3,this.ctx.translate(kt,0),Pe.x+=kt*it;continue}const Dt=(Ft.isSpace?It:0)+At,Bt=rt.charProcOperatorList[Ft.operatorListId];if(!Bt){(0,B.warn)(`Type3 character "${Ft.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ft,this.save(),ve.scale(st,st),ve.transform(...Vt),this.executeOperatorList(Bt),this.restore()),ht=B.Util.applyTransform([Ft.width,0],Vt)[0]*st+Dt,ve.translate(ht,0),Pe.x+=ht*it}ve.restore(),this.processingType3=null}}setCharWidth(ye,ve){}setCharWidthAndBounds(ye,ve,Pe,rt,st,ot){this.ctx.rect(Pe,rt,st-Pe,ot-rt),this.ctx.clip(),this.endPath()}getColorN_Pattern(ye){let ve;if(ye[0]==="TilingPattern"){const Pe=ye[1],rt=this.baseTransform||(0,W.getCurrentTransform)(this.ctx),st={createCanvasGraphics:ot=>new at(ot,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};ve=new q.TilingPattern(ye,Pe,this.ctx,st,rt)}else ve=this._getPattern(ye[1],ye[2]);return ve}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ye,ve,Pe){const rt=B.Util.makeHexColor(ye,ve,Pe);this.ctx.strokeStyle=rt,this.current.strokeColor=rt}setFillRGBColor(ye,ve,Pe){const rt=B.Util.makeHexColor(ye,ve,Pe);this.ctx.fillStyle=rt,this.current.fillColor=rt,this.current.patternFill=!1}_getPattern(ye,ve=null){let Pe;return this.cachedPatterns.has(ye)?Pe=this.cachedPatterns.get(ye):(Pe=(0,q.getShadingPattern)(this.getObject(ye)),this.cachedPatterns.set(ye,Pe)),ve&&(Pe.matrix=ve),Pe}shadingFill(ye){if(!this.contentVisible)return;const ve=this.ctx;this.save();const Pe=this._getPattern(ye);ve.fillStyle=Pe.getPattern(ve,this,(0,W.getCurrentTransformInverse)(ve),q.PathType.SHADING);const rt=(0,W.getCurrentTransformInverse)(ve);if(rt){const{width:st,height:ot}=ve.canvas,[mt,At,It,it]=B.Util.getAxialAlignedBoundingBox([0,0,st,ot],rt);this.ctx.fillRect(mt,At,It-mt,it-At)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,B.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,B.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ye,ve){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ye)&&ye.length===6&&this.transform(...ye),this.baseTransform=(0,W.getCurrentTransform)(this.ctx),ve)){const Pe=ve[2]-ve[0],rt=ve[3]-ve[1];this.ctx.rect(ve[0],ve[1],Pe,rt),this.current.updateRectMinMax((0,W.getCurrentTransform)(this.ctx),ve),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ye){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const ve=this.ctx;ye.isolated||(0,B.info)("TODO: Support non-isolated groups."),ye.knockout&&(0,B.warn)("Knockout groups not supported.");const Pe=(0,W.getCurrentTransform)(ve);if(ye.matrix&&ve.transform(...ye.matrix),!ye.bbox)throw new Error("Bounding box is required.");let rt=B.Util.getAxialAlignedBoundingBox(ye.bbox,(0,W.getCurrentTransform)(ve));const st=[0,0,ve.canvas.width,ve.canvas.height];rt=B.Util.intersect(rt,st)||[0,0,0,0];const ot=Math.floor(rt[0]),mt=Math.floor(rt[1]);let At=Math.max(Math.ceil(rt[2])-ot,1),It=Math.max(Math.ceil(rt[3])-mt,1),it=1,Vt=1;At>se&&(it=At/se,At=se),It>se&&(Vt=It/se,It=se),this.current.startNewPathAndClipBox([0,0,At,It]);let Yt="groupAt"+this.groupLevel;ye.smask&&(Yt+="_smask_"+this.smaskCounter++%2);const Zt=this.cachedCanvases.getCanvas(Yt,At,It),Lt=Zt.context;Lt.scale(1/it,1/Vt),Lt.translate(-ot,-mt),Lt.transform(...Pe),ye.smask?this.smaskStack.push({canvas:Zt.canvas,context:Lt,offsetX:ot,offsetY:mt,scaleX:it,scaleY:Vt,subtype:ye.smask.subtype,backdrop:ye.smask.backdrop,transferMap:ye.smask.transferMap||null,startTransformInverse:null}):(ve.setTransform(1,0,0,1,0,0),ve.translate(ot,mt),ve.scale(it,Vt),ve.save()),Se(ve,Lt),this.ctx=Lt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(ve),this.groupLevel++}endGroup(ye){if(!this.contentVisible)return;this.groupLevel--;const ve=this.ctx,Pe=this.groupStack.pop();if(this.ctx=Pe,this.ctx.imageSmoothingEnabled=!1,ye.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const rt=(0,W.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...rt);const st=B.Util.getAxialAlignedBoundingBox([0,0,ve.canvas.width,ve.canvas.height],rt);this.ctx.drawImage(ve.canvas,0,0),this.ctx.restore(),this.compose(st)}}beginAnnotation(ye,ve,Pe,rt,st){if(Mt(this,bt,dc).call(this),Te(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(ve)&&ve.length===4){const ot=ve[2]-ve[0],mt=ve[3]-ve[1];if(st&&this.annotationCanvasMap){Pe=Pe.slice(),Pe[4]-=ve[0],Pe[5]-=ve[1],ve=ve.slice(),ve[0]=ve[1]=0,ve[2]=ot,ve[3]=mt;const[At,It]=B.Util.singularValueDecompose2dScale((0,W.getCurrentTransform)(this.ctx)),{viewportScale:it}=this,Vt=Math.ceil(ot*this.outputScaleX*it),Yt=Math.ceil(mt*this.outputScaleY*it);this.annotationCanvas=this.canvasFactory.create(Vt,Yt);const{canvas:Zt,context:Lt}=this.annotationCanvas;this.annotationCanvasMap.set(ye,Zt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Lt,this.ctx.save(),this.ctx.setTransform(At,0,0,-It,0,mt*It),Te(this.ctx)}else Te(this.ctx),this.ctx.rect(ve[0],ve[1],ot,mt),this.ctx.clip(),this.endPath()}this.current=new ke(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Pe),this.transform(...rt)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Mt(this,bt,pc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ye){if(!this.contentVisible)return;const ve=ye.count;ye=this.getObject(ye.data,ye),ye.count=ve;const Pe=this.ctx,rt=this.processingType3;if(rt&&(rt.compiled===void 0&&(rt.compiled=me(ye)),rt.compiled)){rt.compiled(Pe);return}const st=this._createMaskCanvas(ye),ot=st.canvas;Pe.save(),Pe.setTransform(1,0,0,1,0,0),Pe.drawImage(ot,st.offsetX,st.offsetY),Pe.restore(),this.compose()}paintImageMaskXObjectRepeat(ye,ve,Pe=0,rt=0,st,ot){if(!this.contentVisible)return;ye=this.getObject(ye.data,ye);const mt=this.ctx;mt.save();const At=(0,W.getCurrentTransform)(mt);mt.transform(ve,Pe,rt,st,0,0);const It=this._createMaskCanvas(ye);mt.setTransform(1,0,0,1,It.offsetX-At[4],It.offsetY-At[5]);for(let it=0,Vt=ot.length;it<Vt;it+=2){const Yt=B.Util.transform(At,[ve,Pe,rt,st,ot[it],ot[it+1]]),[Zt,Lt]=B.Util.applyTransform([0,0],Yt);mt.drawImage(It.canvas,Zt,Lt)}mt.restore(),this.compose()}paintImageMaskXObjectGroup(ye){if(!this.contentVisible)return;const ve=this.ctx,Pe=this.current.fillColor,rt=this.current.patternFill;for(const st of ye){const{data:ot,width:mt,height:At,transform:It}=st,it=this.cachedCanvases.getCanvas("maskCanvas",mt,At),Vt=it.context;Vt.save();const Yt=this.getObject(ot,st);Le(Vt,Yt),Vt.globalCompositeOperation="source-in",Vt.fillStyle=rt?Pe.getPattern(Vt,this,(0,W.getCurrentTransformInverse)(ve),q.PathType.FILL):Pe,Vt.fillRect(0,0,mt,At),Vt.restore(),ve.save(),ve.transform(...It),ve.scale(1,-1),fe(ve,it.canvas,0,0,mt,At,0,-1,1,1),ve.restore()}this.compose()}paintImageXObject(ye){if(!this.contentVisible)return;const ve=this.getObject(ye);if(!ve){(0,B.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(ve)}paintImageXObjectRepeat(ye,ve,Pe,rt){if(!this.contentVisible)return;const st=this.getObject(ye);if(!st){(0,B.warn)("Dependent image isn't ready yet");return}const ot=st.width,mt=st.height,At=[];for(let It=0,it=rt.length;It<it;It+=2)At.push({transform:[ve,0,0,Pe,rt[It],rt[It+1]],x:0,y:0,w:ot,h:mt});this.paintInlineImageXObjectGroup(st,At)}applyTransferMapsToCanvas(ye){return this.current.transferMaps!=="none"&&(ye.filter=this.current.transferMaps,ye.drawImage(ye.canvas,0,0),ye.filter="none"),ye.canvas}applyTransferMapsToBitmap(ye){if(this.current.transferMaps==="none")return ye.bitmap;const{bitmap:ve,width:Pe,height:rt}=ye,st=this.cachedCanvases.getCanvas("inlineImage",Pe,rt),ot=st.context;return ot.filter=this.current.transferMaps,ot.drawImage(ve,0,0),ot.filter="none",st.canvas}paintInlineImageXObject(ye){if(!this.contentVisible)return;const ve=ye.width,Pe=ye.height,rt=this.ctx;if(this.save(),!B.isNodeJS){const{filter:mt}=rt;mt!=="none"&&mt!==""&&(rt.filter="none")}rt.scale(1/ve,-1/Pe);let st;if(ye.bitmap)st=this.applyTransferMapsToBitmap(ye);else if(typeof HTMLElement=="function"&&ye instanceof HTMLElement||!ye.data)st=ye;else{const At=this.cachedCanvases.getCanvas("inlineImage",ve,Pe).context;xe(At,ye),st=this.applyTransferMapsToCanvas(At)}const ot=this._scaleImage(st,(0,W.getCurrentTransformInverse)(rt));rt.imageSmoothingEnabled=De((0,W.getCurrentTransform)(rt),ye.interpolate),fe(rt,ot.img,0,0,ot.paintWidth,ot.paintHeight,0,-Pe,ve,Pe),this.compose(),this.restore()}paintInlineImageXObjectGroup(ye,ve){if(!this.contentVisible)return;const Pe=this.ctx;let rt;if(ye.bitmap)rt=ye.bitmap;else{const st=ye.width,ot=ye.height,At=this.cachedCanvases.getCanvas("inlineImage",st,ot).context;xe(At,ye),rt=this.applyTransferMapsToCanvas(At)}for(const st of ve)Pe.save(),Pe.transform(...st.transform),Pe.scale(1,-1),fe(Pe,rt,st.x,st.y,st.w,st.h,0,-1,1,1),Pe.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ye){}markPointProps(ye,ve){}beginMarkedContent(ye){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ye,ve){ye==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(ve)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ye){const ve=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ye);const Pe=this.ctx;this.pendingClip&&(ve||(this.pendingClip===Et?Pe.clip("evenodd"):Pe.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Pe.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ye=(0,W.getCurrentTransform)(this.ctx);if(ye[1]===0&&ye[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ye[0]),Math.abs(ye[3]));else{const ve=Math.abs(ye[0]*ye[3]-ye[2]*ye[1]),Pe=Math.hypot(ye[0],ye[2]),rt=Math.hypot(ye[1],ye[3]);this._cachedGetSinglePixelWidth=Math.max(Pe,rt)/ve}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ye}=this.current,{a:ve,b:Pe,c:rt,d:st}=this.ctx.getTransform();let ot,mt;if(Pe===0&&rt===0){const At=Math.abs(ve),It=Math.abs(st);if(At===It)if(ye===0)ot=mt=1/At;else{const it=At*ye;ot=mt=it<1?1/it:1}else if(ye===0)ot=1/At,mt=1/It;else{const it=At*ye,Vt=It*ye;ot=it<1?1/it:1,mt=Vt<1?1/Vt:1}}else{const At=Math.abs(ve*st-Pe*rt),It=Math.hypot(ve,Pe),it=Math.hypot(rt,st);if(ye===0)ot=it/At,mt=It/At;else{const Vt=ye*At;ot=it>Vt?it/Vt:1,mt=It>Vt?It/Vt:1}}this._cachedScaleForStroking[0]=ot,this._cachedScaleForStroking[1]=mt}return this._cachedScaleForStroking}rescaleAndStroke(ye){const{ctx:ve}=this,{lineWidth:Pe}=this.current,[rt,st]=this.getScaleForStroking();if(ve.lineWidth=Pe||1,rt===1&&st===1){ve.stroke();return}const ot=ve.getLineDash();if(ye&&ve.save(),ve.scale(rt,st),ot.length>0){const mt=Math.max(rt,st);ve.setLineDash(ot.map(At=>At/mt)),ve.lineDashOffset/=mt}ve.stroke(),ye&&ve.restore()}isContentVisible(){for(let ye=this.markedContentStack.length-1;ye>=0;ye--)if(!this.markedContentStack[ye].visible)return!1;return!0}};bt=new WeakSet,dc=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},pc=function(){if(this.pageColors){const ye=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ye!=="none"){const ve=this.ctx.filter;this.ctx.filter=ye,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=ve}}};let gt=at;A.CanvasGraphics=gt;for(const Ee in B.OPS)gt.prototype[Ee]!==void 0&&(gt.prototype[B.OPS[Ee]]=gt.prototype[Ee])},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.TilingPattern=A.PathType=void 0,A.getShadingPattern=he;var B=L(1),W=L(6);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};A.PathType=q;function J(me,ke){if(!ke)return;const xe=ke[2]-ke[0],Le=ke[3]-ke[1],Se=new Path2D;Se.rect(ke[0],ke[1],xe,Le),me.clip(Se)}class re{constructor(){this.constructor===re&&(0,B.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,B.unreachable)("Abstract method `getPattern` called.")}}class ae extends re{constructor(ke){super(),this._type=ke[1],this._bbox=ke[2],this._colorStops=ke[3],this._p0=ke[4],this._p1=ke[5],this._r0=ke[6],this._r1=ke[7],this.matrix=null}_createGradient(ke){let xe;this._type==="axial"?xe=ke.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(xe=ke.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const Le of this._colorStops)xe.addColorStop(Le[0],Le[1]);return xe}getPattern(ke,xe,Le,Se){let Te;if(Se===q.STROKE||Se===q.FILL){const ge=xe.current.getClippedPathBoundingBox(Se,(0,W.getCurrentTransform)(ke))||[0,0,0,0],Ce=Math.ceil(ge[2]-ge[0])||1,be=Math.ceil(ge[3]-ge[1])||1,nt=xe.cachedCanvases.getCanvas("pattern",Ce,be,!0),Ae=nt.context;Ae.clearRect(0,0,Ae.canvas.width,Ae.canvas.height),Ae.beginPath(),Ae.rect(0,0,Ae.canvas.width,Ae.canvas.height),Ae.translate(-ge[0],-ge[1]),Le=B.Util.transform(Le,[1,0,0,1,ge[0],ge[1]]),Ae.transform(...xe.baseTransform),this.matrix&&Ae.transform(...this.matrix),J(Ae,this._bbox),Ae.fillStyle=this._createGradient(Ae),Ae.fill(),Te=ke.createPattern(nt.canvas,"no-repeat");const De=new DOMMatrix(Le);Te.setTransform(De)}else J(ke,this._bbox),Te=this._createGradient(ke);return Te}}function se(me,ke,xe,Le,Se,Te,ge,Ce){const be=ke.coords,nt=ke.colors,Ae=me.data,De=me.width*4;let lt;be[xe+1]>be[Le+1]&&(lt=xe,xe=Le,Le=lt,lt=Te,Te=ge,ge=lt),be[Le+1]>be[Se+1]&&(lt=Le,Le=Se,Se=lt,lt=ge,ge=Ce,Ce=lt),be[xe+1]>be[Le+1]&&(lt=xe,xe=Le,Le=lt,lt=Te,Te=ge,ge=lt);const Ct=(be[xe]+ke.offsetX)*ke.scaleX,ft=(be[xe+1]+ke.offsetY)*ke.scaleY,Et=(be[Le]+ke.offsetX)*ke.scaleX,gt=(be[Le+1]+ke.offsetY)*ke.scaleY,bt=(be[Se]+ke.offsetX)*ke.scaleX,Ie=(be[Se+1]+ke.offsetY)*ke.scaleY;if(ft>=Ie)return;const pt=nt[Te],at=nt[Te+1],Ee=nt[Te+2],ye=nt[ge],ve=nt[ge+1],Pe=nt[ge+2],rt=nt[Ce],st=nt[Ce+1],ot=nt[Ce+2],mt=Math.round(ft),At=Math.round(Ie);let It,it,Vt,Yt,Zt,Lt,Ft,ht;for(let kt=mt;kt<=At;kt++){if(kt<gt){const ar=kt<ft?0:(ft-kt)/(ft-gt);It=Ct-(Ct-Et)*ar,it=pt-(pt-ye)*ar,Vt=at-(at-ve)*ar,Yt=Ee-(Ee-Pe)*ar}else{let ar;kt>Ie?ar=1:gt===Ie?ar=0:ar=(gt-kt)/(gt-Ie),It=Et-(Et-bt)*ar,it=ye-(ye-rt)*ar,Vt=ve-(ve-st)*ar,Yt=Pe-(Pe-ot)*ar}let Dt;kt<ft?Dt=0:kt>Ie?Dt=1:Dt=(ft-kt)/(ft-Ie),Zt=Ct-(Ct-bt)*Dt,Lt=pt-(pt-rt)*Dt,Ft=at-(at-st)*Dt,ht=Ee-(Ee-ot)*Dt;const Bt=Math.round(Math.min(It,Zt)),Qt=Math.round(Math.max(It,Zt));let or=De*kt+Bt*4;for(let ar=Bt;ar<=Qt;ar++)Dt=(It-ar)/(It-Zt),Dt<0?Dt=0:Dt>1&&(Dt=1),Ae[or++]=it-(it-Lt)*Dt|0,Ae[or++]=Vt-(Vt-Ft)*Dt|0,Ae[or++]=Yt-(Yt-ht)*Dt|0,Ae[or++]=255}}function ie(me,ke,xe){const Le=ke.coords,Se=ke.colors;let Te,ge;switch(ke.type){case"lattice":const Ce=ke.verticesPerRow,be=Math.floor(Le.length/Ce)-1,nt=Ce-1;for(Te=0;Te<be;Te++){let Ae=Te*Ce;for(let De=0;De<nt;De++,Ae++)se(me,xe,Le[Ae],Le[Ae+1],Le[Ae+Ce],Se[Ae],Se[Ae+1],Se[Ae+Ce]),se(me,xe,Le[Ae+Ce+1],Le[Ae+1],Le[Ae+Ce],Se[Ae+Ce+1],Se[Ae+1],Se[Ae+Ce])}break;case"triangles":for(Te=0,ge=Le.length;Te<ge;Te+=3)se(me,xe,Le[Te],Le[Te+1],Le[Te+2],Se[Te],Se[Te+1],Se[Te+2]);break;default:throw new Error("illegal figure")}}class le extends re{constructor(ke){super(),this._coords=ke[2],this._colors=ke[3],this._figures=ke[4],this._bounds=ke[5],this._bbox=ke[7],this._background=ke[8],this.matrix=null}_createMeshCanvas(ke,xe,Le){const Ce=Math.floor(this._bounds[0]),be=Math.floor(this._bounds[1]),nt=Math.ceil(this._bounds[2])-Ce,Ae=Math.ceil(this._bounds[3])-be,De=Math.min(Math.ceil(Math.abs(nt*ke[0]*1.1)),3e3),lt=Math.min(Math.ceil(Math.abs(Ae*ke[1]*1.1)),3e3),Ct=nt/De,ft=Ae/lt,Et={coords:this._coords,colors:this._colors,offsetX:-Ce,offsetY:-be,scaleX:1/Ct,scaleY:1/ft},gt=De+2*2,bt=lt+2*2,Ie=Le.getCanvas("mesh",gt,bt,!1),pt=Ie.context,at=pt.createImageData(De,lt);if(xe){const ye=at.data;for(let ve=0,Pe=ye.length;ve<Pe;ve+=4)ye[ve]=xe[0],ye[ve+1]=xe[1],ye[ve+2]=xe[2],ye[ve+3]=255}for(const ye of this._figures)ie(at,ye,Et);return pt.putImageData(at,2,2),{canvas:Ie.canvas,offsetX:Ce-2*Ct,offsetY:be-2*ft,scaleX:Ct,scaleY:ft}}getPattern(ke,xe,Le,Se){J(ke,this._bbox);let Te;if(Se===q.SHADING)Te=B.Util.singularValueDecompose2dScale((0,W.getCurrentTransform)(ke));else if(Te=B.Util.singularValueDecompose2dScale(xe.baseTransform),this.matrix){const Ce=B.Util.singularValueDecompose2dScale(this.matrix);Te=[Te[0]*Ce[0],Te[1]*Ce[1]]}const ge=this._createMeshCanvas(Te,Se===q.SHADING?null:this._background,xe.cachedCanvases);return Se!==q.SHADING&&(ke.setTransform(...xe.baseTransform),this.matrix&&ke.transform(...this.matrix)),ke.translate(ge.offsetX,ge.offsetY),ke.scale(ge.scaleX,ge.scaleY),ke.createPattern(ge.canvas,"no-repeat")}}class pe extends re{getPattern(){return"hotpink"}}function he(me){switch(me[0]){case"RadialAxial":return new ae(me);case"Mesh":return new le(me);case"Dummy":return new pe}throw new Error(`Unknown IR type: ${me[0]}`)}const ue={COLORED:1,UNCOLORED:2},fe=class fe{constructor(ke,xe,Le,Se,Te){this.operatorList=ke[2],this.matrix=ke[3]||[1,0,0,1,0,0],this.bbox=ke[4],this.xstep=ke[5],this.ystep=ke[6],this.paintType=ke[7],this.tilingType=ke[8],this.color=xe,this.ctx=Le,this.canvasGraphicsFactory=Se,this.baseTransform=Te}createPatternCanvas(ke){const xe=this.operatorList,Le=this.bbox,Se=this.xstep,Te=this.ystep,ge=this.paintType,Ce=this.tilingType,be=this.color,nt=this.canvasGraphicsFactory;(0,B.info)("TilingType: "+Ce);const Ae=Le[0],De=Le[1],lt=Le[2],Ct=Le[3],ft=B.Util.singularValueDecompose2dScale(this.matrix),Et=B.Util.singularValueDecompose2dScale(this.baseTransform),gt=[ft[0]*Et[0],ft[1]*Et[1]],bt=this.getSizeAndScale(Se,this.ctx.canvas.width,gt[0]),Ie=this.getSizeAndScale(Te,this.ctx.canvas.height,gt[1]),pt=ke.cachedCanvases.getCanvas("pattern",bt.size,Ie.size,!0),at=pt.context,Ee=nt.createCanvasGraphics(at);Ee.groupLevel=ke.groupLevel,this.setFillAndStrokeStyleToContext(Ee,ge,be);let ye=Ae,ve=De,Pe=lt,rt=Ct;return Ae<0&&(ye=0,Pe+=Math.abs(Ae)),De<0&&(ve=0,rt+=Math.abs(De)),at.translate(-(bt.scale*ye),-(Ie.scale*ve)),Ee.transform(bt.scale,0,0,Ie.scale,0,0),at.save(),this.clipBbox(Ee,ye,ve,Pe,rt),Ee.baseTransform=(0,W.getCurrentTransform)(Ee.ctx),Ee.executeOperatorList(xe),Ee.endDrawing(),{canvas:pt.canvas,scaleX:bt.scale,scaleY:Ie.scale,offsetX:ye,offsetY:ve}}getSizeAndScale(ke,xe,Le){ke=Math.abs(ke);const Se=Math.max(fe.MAX_PATTERN_SIZE,xe);let Te=Math.ceil(ke*Le);return Te>=Se?Te=Se:Le=Te/ke,{scale:Le,size:Te}}clipBbox(ke,xe,Le,Se,Te){const ge=Se-xe,Ce=Te-Le;ke.ctx.rect(xe,Le,ge,Ce),ke.current.updateRectMinMax((0,W.getCurrentTransform)(ke.ctx),[xe,Le,Se,Te]),ke.clip(),ke.endPath()}setFillAndStrokeStyleToContext(ke,xe,Le){const Se=ke.ctx,Te=ke.current;switch(xe){case ue.COLORED:const ge=this.ctx;Se.fillStyle=ge.fillStyle,Se.strokeStyle=ge.strokeStyle,Te.fillColor=ge.fillStyle,Te.strokeColor=ge.strokeStyle;break;case ue.UNCOLORED:const Ce=B.Util.makeHexColor(Le[0],Le[1],Le[2]);Se.fillStyle=Ce,Se.strokeStyle=Ce,Te.fillColor=Ce,Te.strokeColor=Ce;break;default:throw new B.FormatError(`Unsupported paint type: ${xe}`)}}getPattern(ke,xe,Le,Se){let Te=Le;Se!==q.SHADING&&(Te=B.Util.transform(Te,xe.baseTransform),this.matrix&&(Te=B.Util.transform(Te,this.matrix)));const ge=this.createPatternCanvas(xe);let Ce=new DOMMatrix(Te);Ce=Ce.translate(ge.offsetX,ge.offsetY),Ce=Ce.scale(1/ge.scaleX,1/ge.scaleY);const be=ke.createPattern(ge.canvas,"repeat");return be.setTransform(Ce),be}};Kr(fe,"MAX_PATTERN_SIZE",3e3);let ce=fe;A.TilingPattern=ce},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.convertBlackAndWhiteToRGBA=q,A.convertToRGBA=W,A.grayToRGBA=re;var B=L(1);function W(ae){switch(ae.kind){case B.ImageKind.GRAYSCALE_1BPP:return q(ae);case B.ImageKind.RGB_24BPP:return J(ae)}return null}function q({src:ae,srcPos:se=0,dest:ie,width:le,height:pe,nonBlackColor:he=4294967295,inverseDecode:ue=!1}){const ce=B.FeatureTest.isLittleEndian?4278190080:255,[fe,me]=ue?[he,ce]:[ce,he],ke=le>>3,xe=le&7,Le=ae.length;ie=new Uint32Array(ie.buffer);let Se=0;for(let Te=0;Te<pe;Te++){for(const Ce=se+ke;se<Ce;se++){const be=se<Le?ae[se]:255;ie[Se++]=be&128?me:fe,ie[Se++]=be&64?me:fe,ie[Se++]=be&32?me:fe,ie[Se++]=be&16?me:fe,ie[Se++]=be&8?me:fe,ie[Se++]=be&4?me:fe,ie[Se++]=be&2?me:fe,ie[Se++]=be&1?me:fe}if(xe===0)continue;const ge=se<Le?ae[se++]:255;for(let Ce=0;Ce<xe;Ce++)ie[Se++]=ge&1<<7-Ce?me:fe}return{srcPos:se,destPos:Se}}function J({src:ae,srcPos:se=0,dest:ie,destPos:le=0,width:pe,height:he}){let ue=0;const ce=ae.length>>2,fe=new Uint32Array(ae.buffer,se,ce);if(B.FeatureTest.isLittleEndian){for(;ue<ce-2;ue+=3,le+=4){const me=fe[ue],ke=fe[ue+1],xe=fe[ue+2];ie[le]=me|4278190080,ie[le+1]=me>>>24|ke<<8|4278190080,ie[le+2]=ke>>>16|xe<<16|4278190080,ie[le+3]=xe>>>8|4278190080}for(let me=ue*4,ke=ae.length;me<ke;me+=3)ie[le++]=ae[me]|ae[me+1]<<8|ae[me+2]<<16|4278190080}else{for(;ue<ce-2;ue+=3,le+=4){const me=fe[ue],ke=fe[ue+1],xe=fe[ue+2];ie[le]=me|255,ie[le+1]=me<<24|ke>>>8|255,ie[le+2]=ke<<16|xe>>>16|255,ie[le+3]=xe<<8|255}for(let me=ue*4,ke=ae.length;me<ke;me+=3)ie[le++]=ae[me]<<24|ae[me+1]<<16|ae[me+2]<<8|255}return{srcPos:se,destPos:le}}function re(ae,se){if(B.FeatureTest.isLittleEndian)for(let ie=0,le=ae.length;ie<le;ie++)se[ie]=ae[ie]*65793|4278190080;else for(let ie=0,le=ae.length;ie<le;ie++)se[ie]=ae[ie]*16843008|255}},(g,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.GlobalWorkerOptions=void 0;const L=Object.create(null);A.GlobalWorkerOptions=L,L.workerPort=null,L.workerSrc=""},(g,A,L)=>{var ae,d0,p0,co;Object.defineProperty(A,"__esModule",{value:!0}),A.MessageHandler=void 0;var B=L(1);const W={DATA:1,ERROR:2},q={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function J(pe){switch(pe instanceof Error||typeof pe=="object"&&pe!==null||(0,B.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),pe.name){case"AbortException":return new B.AbortException(pe.message);case"MissingPDFException":return new B.MissingPDFException(pe.message);case"PasswordException":return new B.PasswordException(pe.message,pe.code);case"UnexpectedResponseException":return new B.UnexpectedResponseException(pe.message,pe.status);case"UnknownErrorException":return new B.UnknownErrorException(pe.message,pe.details);default:return new B.UnknownErrorException(pe.message,pe.toString())}}class re{constructor(he,ue,ce){zt(this,ae);this.sourceName=he,this.targetName=ue,this.comObj=ce,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=fe=>{const me=fe.data;if(me.targetName!==this.sourceName)return;if(me.stream){Mt(this,ae,p0).call(this,me);return}if(me.callback){const xe=me.callbackId,Le=this.callbackCapabilities[xe];if(!Le)throw new Error(`Cannot resolve callback ${xe}`);if(delete this.callbackCapabilities[xe],me.callback===W.DATA)Le.resolve(me.data);else if(me.callback===W.ERROR)Le.reject(J(me.reason));else throw new Error("Unexpected callback case");return}const ke=this.actionHandler[me.action];if(!ke)throw new Error(`Unknown action from worker: ${me.action}`);if(me.callbackId){const xe=this.sourceName,Le=me.sourceName;new Promise(function(Se){Se(ke(me.data))}).then(function(Se){ce.postMessage({sourceName:xe,targetName:Le,callback:W.DATA,callbackId:me.callbackId,data:Se})},function(Se){ce.postMessage({sourceName:xe,targetName:Le,callback:W.ERROR,callbackId:me.callbackId,reason:J(Se)})});return}if(me.streamId){Mt(this,ae,d0).call(this,me);return}ke(me.data)},ce.addEventListener("message",this._onComObjOnMessage)}on(he,ue){const ce=this.actionHandler;if(ce[he])throw new Error(`There is already an actionName called "${he}"`);ce[he]=ue}send(he,ue,ce){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:he,data:ue},ce)}sendWithPromise(he,ue,ce){const fe=this.callbackId++,me=new B.PromiseCapability;this.callbackCapabilities[fe]=me;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:he,callbackId:fe,data:ue},ce)}catch(ke){me.reject(ke)}return me.promise}sendWithStream(he,ue,ce,fe){const me=this.streamId++,ke=this.sourceName,xe=this.targetName,Le=this.comObj;return new ReadableStream({start:Se=>{const Te=new B.PromiseCapability;return this.streamControllers[me]={controller:Se,startCall:Te,pullCall:null,cancelCall:null,isClosed:!1},Le.postMessage({sourceName:ke,targetName:xe,action:he,streamId:me,data:ue,desiredSize:Se.desiredSize},fe),Te.promise},pull:Se=>{const Te=new B.PromiseCapability;return this.streamControllers[me].pullCall=Te,Le.postMessage({sourceName:ke,targetName:xe,stream:q.PULL,streamId:me,desiredSize:Se.desiredSize}),Te.promise},cancel:Se=>{(0,B.assert)(Se instanceof Error,"cancel must have a valid reason");const Te=new B.PromiseCapability;return this.streamControllers[me].cancelCall=Te,this.streamControllers[me].isClosed=!0,Le.postMessage({sourceName:ke,targetName:xe,stream:q.CANCEL,streamId:me,reason:J(Se)}),Te.promise}},ce)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}ae=new WeakSet,d0=function(he){const ue=he.streamId,ce=this.sourceName,fe=he.sourceName,me=this.comObj,ke=this,xe=this.actionHandler[he.action],Le={enqueue(Se,Te=1,ge){if(this.isCancelled)return;const Ce=this.desiredSize;this.desiredSize-=Te,Ce>0&&this.desiredSize<=0&&(this.sinkCapability=new B.PromiseCapability,this.ready=this.sinkCapability.promise),me.postMessage({sourceName:ce,targetName:fe,stream:q.ENQUEUE,streamId:ue,chunk:Se},ge)},close(){this.isCancelled||(this.isCancelled=!0,me.postMessage({sourceName:ce,targetName:fe,stream:q.CLOSE,streamId:ue}),delete ke.streamSinks[ue])},error(Se){(0,B.assert)(Se instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,me.postMessage({sourceName:ce,targetName:fe,stream:q.ERROR,streamId:ue,reason:J(Se)}))},sinkCapability:new B.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:he.desiredSize,ready:null};Le.sinkCapability.resolve(),Le.ready=Le.sinkCapability.promise,this.streamSinks[ue]=Le,new Promise(function(Se){Se(xe(he.data,Le))}).then(function(){me.postMessage({sourceName:ce,targetName:fe,stream:q.START_COMPLETE,streamId:ue,success:!0})},function(Se){me.postMessage({sourceName:ce,targetName:fe,stream:q.START_COMPLETE,streamId:ue,reason:J(Se)})})},p0=function(he){const ue=he.streamId,ce=this.sourceName,fe=he.sourceName,me=this.comObj,ke=this.streamControllers[ue],xe=this.streamSinks[ue];switch(he.stream){case q.START_COMPLETE:he.success?ke.startCall.resolve():ke.startCall.reject(J(he.reason));break;case q.PULL_COMPLETE:he.success?ke.pullCall.resolve():ke.pullCall.reject(J(he.reason));break;case q.PULL:if(!xe){me.postMessage({sourceName:ce,targetName:fe,stream:q.PULL_COMPLETE,streamId:ue,success:!0});break}xe.desiredSize<=0&&he.desiredSize>0&&xe.sinkCapability.resolve(),xe.desiredSize=he.desiredSize,new Promise(function(Le){var Se;Le((Se=xe.onPull)==null?void 0:Se.call(xe))}).then(function(){me.postMessage({sourceName:ce,targetName:fe,stream:q.PULL_COMPLETE,streamId:ue,success:!0})},function(Le){me.postMessage({sourceName:ce,targetName:fe,stream:q.PULL_COMPLETE,streamId:ue,reason:J(Le)})});break;case q.ENQUEUE:if((0,B.assert)(ke,"enqueue should have stream controller"),ke.isClosed)break;ke.controller.enqueue(he.chunk);break;case q.CLOSE:if((0,B.assert)(ke,"close should have stream controller"),ke.isClosed)break;ke.isClosed=!0,ke.controller.close(),Mt(this,ae,co).call(this,ke,ue);break;case q.ERROR:(0,B.assert)(ke,"error should have stream controller"),ke.controller.error(J(he.reason)),Mt(this,ae,co).call(this,ke,ue);break;case q.CANCEL_COMPLETE:he.success?ke.cancelCall.resolve():ke.cancelCall.reject(J(he.reason)),Mt(this,ae,co).call(this,ke,ue);break;case q.CANCEL:if(!xe)break;new Promise(function(Le){var Se;Le((Se=xe.onCancel)==null?void 0:Se.call(xe,J(he.reason)))}).then(function(){me.postMessage({sourceName:ce,targetName:fe,stream:q.CANCEL_COMPLETE,streamId:ue,success:!0})},function(Le){me.postMessage({sourceName:ce,targetName:fe,stream:q.CANCEL_COMPLETE,streamId:ue,reason:J(Le)})}),xe.sinkCapability.reject(J(he.reason)),xe.isCancelled=!0,delete this.streamSinks[ue];break;default:throw new Error("Unexpected stream case")}},co=async function(he,ue){var ce,fe,me;await Promise.allSettled([(ce=he.startCall)==null?void 0:ce.promise,(fe=he.pullCall)==null?void 0:fe.promise,(me=he.cancelCall)==null?void 0:me.promise]),delete this.streamControllers[ue]},A.MessageHandler=re},(g,A,L)=>{var q,J;Object.defineProperty(A,"__esModule",{value:!0}),A.Metadata=void 0;var B=L(1);class W{constructor({parsedData:ae,rawData:se}){zt(this,q);zt(this,J);Xt(this,q,ae),Xt(this,J,se)}getRaw(){return Fe(this,J)}get(ae){return Fe(this,q).get(ae)??null}getAll(){return(0,B.objectFromMap)(Fe(this,q))}has(ae){return Fe(this,q).has(ae)}}q=new WeakMap,J=new WeakMap,A.Metadata=W},(g,A,L)=>{var ae,se,ie,le,pe,he,mc;Object.defineProperty(A,"__esModule",{value:!0}),A.OptionalContentConfig=void 0;var B=L(1),W=L(8);const q=Symbol("INTERNAL");class J{constructor(fe,me){zt(this,ae,!0);this.name=fe,this.intent=me}get visible(){return Fe(this,ae)}_setVisible(fe,me){fe!==q&&(0,B.unreachable)("Internal method `_setVisible` called."),Xt(this,ae,me)}}ae=new WeakMap;class re{constructor(fe){zt(this,he);zt(this,se,null);zt(this,ie,new Map);zt(this,le,null);zt(this,pe,null);if(this.name=null,this.creator=null,fe!==null){this.name=fe.name,this.creator=fe.creator,Xt(this,pe,fe.order);for(const me of fe.groups)Fe(this,ie).set(me.id,new J(me.name,me.intent));if(fe.baseState==="OFF")for(const me of Fe(this,ie).values())me._setVisible(q,!1);for(const me of fe.on)Fe(this,ie).get(me)._setVisible(q,!0);for(const me of fe.off)Fe(this,ie).get(me)._setVisible(q,!1);Xt(this,le,this.getHash())}}isVisible(fe){if(Fe(this,ie).size===0)return!0;if(!fe)return(0,B.warn)("Optional content group not defined."),!0;if(fe.type==="OCG")return Fe(this,ie).has(fe.id)?Fe(this,ie).get(fe.id).visible:((0,B.warn)(`Optional content group not found: ${fe.id}`),!0);if(fe.type==="OCMD"){if(fe.expression)return Mt(this,he,mc).call(this,fe.expression);if(!fe.policy||fe.policy==="AnyOn"){for(const me of fe.ids){if(!Fe(this,ie).has(me))return(0,B.warn)(`Optional content group not found: ${me}`),!0;if(Fe(this,ie).get(me).visible)return!0}return!1}else if(fe.policy==="AllOn"){for(const me of fe.ids){if(!Fe(this,ie).has(me))return(0,B.warn)(`Optional content group not found: ${me}`),!0;if(!Fe(this,ie).get(me).visible)return!1}return!0}else if(fe.policy==="AnyOff"){for(const me of fe.ids){if(!Fe(this,ie).has(me))return(0,B.warn)(`Optional content group not found: ${me}`),!0;if(!Fe(this,ie).get(me).visible)return!0}return!1}else if(fe.policy==="AllOff"){for(const me of fe.ids){if(!Fe(this,ie).has(me))return(0,B.warn)(`Optional content group not found: ${me}`),!0;if(Fe(this,ie).get(me).visible)return!1}return!0}return(0,B.warn)(`Unknown optional content policy ${fe.policy}.`),!0}return(0,B.warn)(`Unknown group type ${fe.type}.`),!0}setVisibility(fe,me=!0){if(!Fe(this,ie).has(fe)){(0,B.warn)(`Optional content group not found: ${fe}`);return}Fe(this,ie).get(fe)._setVisible(q,!!me),Xt(this,se,null)}get hasInitialVisibility(){return Fe(this,le)===null||this.getHash()===Fe(this,le)}getOrder(){return Fe(this,ie).size?Fe(this,pe)?Fe(this,pe).slice():[...Fe(this,ie).keys()]:null}getGroups(){return Fe(this,ie).size>0?(0,B.objectFromMap)(Fe(this,ie)):null}getGroup(fe){return Fe(this,ie).get(fe)||null}getHash(){if(Fe(this,se)!==null)return Fe(this,se);const fe=new W.MurmurHash3_64;for(const[me,ke]of Fe(this,ie))fe.update(`${me}:${ke.visible}`);return Xt(this,se,fe.hexdigest())}}se=new WeakMap,ie=new WeakMap,le=new WeakMap,pe=new WeakMap,he=new WeakSet,mc=function(fe){const me=fe.length;if(me<2)return!0;const ke=fe[0];for(let xe=1;xe<me;xe++){const Le=fe[xe];let Se;if(Array.isArray(Le))Se=Mt(this,he,mc).call(this,Le);else if(Fe(this,ie).has(Le))Se=Fe(this,ie).get(Le).visible;else return(0,B.warn)(`Optional content group not found: ${Le}`),!0;switch(ke){case"And":if(!Se)return!1;break;case"Or":if(Se)return!0;break;case"Not":return!Se;default:return!0}}return ke==="And"},A.OptionalContentConfig=re},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFDataTransportStream=void 0;var B=L(1),W=L(6);class q{constructor({length:se,initialData:ie,progressiveDone:le=!1,contentDispositionFilename:pe=null,disableRange:he=!1,disableStream:ue=!1},ce){if((0,B.assert)(ce,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=le,this._contentDispositionFilename=pe,(ie==null?void 0:ie.length)>0){const fe=ie instanceof Uint8Array&&ie.byteLength===ie.buffer.byteLength?ie.buffer:new Uint8Array(ie).buffer;this._queuedChunks.push(fe)}this._pdfDataRangeTransport=ce,this._isStreamingSupported=!ue,this._isRangeSupported=!he,this._contentLength=se,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((fe,me)=>{this._onReceiveData({begin:fe,chunk:me})}),this._pdfDataRangeTransport.addProgressListener((fe,me)=>{this._onProgress({loaded:fe,total:me})}),this._pdfDataRangeTransport.addProgressiveReadListener(fe=>{this._onReceiveData({chunk:fe})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:se,chunk:ie}){const le=ie instanceof Uint8Array&&ie.byteLength===ie.buffer.byteLength?ie.buffer:new Uint8Array(ie).buffer;if(se===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(le):this._queuedChunks.push(le);else{const pe=this._rangeReaders.some(function(he){return he._begin!==se?!1:(he._enqueue(le),!0)});(0,B.assert)(pe,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var se;return((se=this._fullRequestReader)==null?void 0:se._loaded)??0}_onProgress(se){var ie,le,pe,he;se.total===void 0?(le=(ie=this._rangeReaders[0])==null?void 0:ie.onProgress)==null||le.call(ie,{loaded:se.loaded}):(he=(pe=this._fullRequestReader)==null?void 0:pe.onProgress)==null||he.call(pe,{loaded:se.loaded,total:se.total})}_onProgressiveDone(){var se;(se=this._fullRequestReader)==null||se.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(se){const ie=this._rangeReaders.indexOf(se);ie>=0&&this._rangeReaders.splice(ie,1)}getFullReader(){(0,B.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const se=this._queuedChunks;return this._queuedChunks=null,new J(this,se,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(se,ie){if(ie<=this._progressiveDataLength)return null;const le=new re(this,se,ie);return this._pdfDataRangeTransport.requestDataRange(se,ie),this._rangeReaders.push(le),le}cancelAllRequests(se){var ie;(ie=this._fullRequestReader)==null||ie.cancel(se);for(const le of this._rangeReaders.slice(0))le.cancel(se);this._pdfDataRangeTransport.abort()}}A.PDFDataTransportStream=q;class J{constructor(se,ie,le=!1,pe=null){this._stream=se,this._done=le||!1,this._filename=(0,W.isPdfFile)(pe)?pe:null,this._queuedChunks=ie||[],this._loaded=0;for(const he of this._queuedChunks)this._loaded+=he.byteLength;this._requests=[],this._headersReady=Promise.resolve(),se._fullRequestReader=this,this.onProgress=null}_enqueue(se){this._done||(this._requests.length>0?this._requests.shift().resolve({value:se,done:!1}):this._queuedChunks.push(se),this._loaded+=se.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const se=new B.PromiseCapability;return this._requests.push(se),se.promise}cancel(se){this._done=!0;for(const ie of this._requests)ie.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class re{constructor(se,ie,le){this._stream=se,this._begin=ie,this._end=le,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(se){if(!this._done){if(this._requests.length===0)this._queuedChunk=se;else{this._requests.shift().resolve({value:se,done:!1});for(const le of this._requests)le.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const ie=this._queuedChunk;return this._queuedChunk=null,{value:ie,done:!1}}if(this._done)return{value:void 0,done:!0};const se=new B.PromiseCapability;return this._requests.push(se),se.promise}cancel(se){this._done=!0;for(const ie of this._requests)ie.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFFetchStream=void 0;var B=L(1),W=L(20);function q(le,pe,he){return{method:"GET",headers:le,signal:he.signal,mode:"cors",credentials:pe?"include":"same-origin",redirect:"follow"}}function J(le){const pe=new Headers;for(const he in le){const ue=le[he];ue!==void 0&&pe.append(he,ue)}return pe}function re(le){return le instanceof Uint8Array?le.buffer:le instanceof ArrayBuffer?le:((0,B.warn)(`getArrayBuffer - unexpected data format: ${le}`),new Uint8Array(le).buffer)}class ae{constructor(pe){this.source=pe,this.isHttp=/^https?:/i.test(pe.url),this.httpHeaders=this.isHttp&&pe.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var pe;return((pe=this._fullRequestReader)==null?void 0:pe._loaded)??0}getFullReader(){return(0,B.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new se(this),this._fullRequestReader}getRangeReader(pe,he){if(he<=this._progressiveDataLength)return null;const ue=new ie(this,pe,he);return this._rangeRequestReaders.push(ue),ue}cancelAllRequests(pe){var he;(he=this._fullRequestReader)==null||he.cancel(pe);for(const ue of this._rangeRequestReaders.slice(0))ue.cancel(pe)}}A.PDFFetchStream=ae;class se{constructor(pe){this._stream=pe,this._reader=null,this._loaded=0,this._filename=null;const he=pe.source;this._withCredentials=he.withCredentials||!1,this._contentLength=he.length,this._headersCapability=new B.PromiseCapability,this._disableRange=he.disableRange||!1,this._rangeChunkSize=he.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!he.disableStream,this._isRangeSupported=!he.disableRange,this._headers=J(this._stream.httpHeaders);const ue=he.url;fetch(ue,q(this._headers,this._withCredentials,this._abortController)).then(ce=>{if(!(0,W.validateResponseStatus)(ce.status))throw(0,W.createResponseStatusError)(ce.status,ue);this._reader=ce.body.getReader(),this._headersCapability.resolve();const fe=xe=>ce.headers.get(xe),{allowRangeRequests:me,suggestedLength:ke}=(0,W.validateRangeRequestCapabilities)({getResponseHeader:fe,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=me,this._contentLength=ke||this._contentLength,this._filename=(0,W.extractFilenameFromHeader)(fe),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new B.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ue;await this._headersCapability.promise;const{value:pe,done:he}=await this._reader.read();return he?{value:pe,done:he}:(this._loaded+=pe.byteLength,(ue=this.onProgress)==null||ue.call(this,{loaded:this._loaded,total:this._contentLength}),{value:re(pe),done:!1})}cancel(pe){var he;(he=this._reader)==null||he.cancel(pe),this._abortController.abort()}}class ie{constructor(pe,he,ue){this._stream=pe,this._reader=null,this._loaded=0;const ce=pe.source;this._withCredentials=ce.withCredentials||!1,this._readCapability=new B.PromiseCapability,this._isStreamingSupported=!ce.disableStream,this._abortController=new AbortController,this._headers=J(this._stream.httpHeaders),this._headers.append("Range",`bytes=${he}-${ue-1}`);const fe=ce.url;fetch(fe,q(this._headers,this._withCredentials,this._abortController)).then(me=>{if(!(0,W.validateResponseStatus)(me.status))throw(0,W.createResponseStatusError)(me.status,fe);this._readCapability.resolve(),this._reader=me.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ue;await this._readCapability.promise;const{value:pe,done:he}=await this._reader.read();return he?{value:pe,done:he}:(this._loaded+=pe.byteLength,(ue=this.onProgress)==null||ue.call(this,{loaded:this._loaded}),{value:re(pe),done:!1})}cancel(pe){var he;(he=this._reader)==null||he.cancel(pe),this._abortController.abort()}}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.createResponseStatusError=ae,A.extractFilenameFromHeader=re,A.validateRangeRequestCapabilities=J,A.validateResponseStatus=se;var B=L(1),W=L(21),q=L(6);function J({getResponseHeader:ie,isHttp:le,rangeChunkSize:pe,disableRange:he}){const ue={allowRangeRequests:!1,suggestedLength:void 0},ce=parseInt(ie("Content-Length"),10);return!Number.isInteger(ce)||(ue.suggestedLength=ce,ce<=2*pe)||he||!le||ie("Accept-Ranges")!=="bytes"||(ie("Content-Encoding")||"identity")!=="identity"||(ue.allowRangeRequests=!0),ue}function re(ie){const le=ie("Content-Disposition");if(le){let pe=(0,W.getFilenameFromContentDispositionHeader)(le);if(pe.includes("%"))try{pe=decodeURIComponent(pe)}catch{}if((0,q.isPdfFile)(pe))return pe}return null}function ae(ie,le){return ie===404||ie===0&&le.startsWith("file:")?new B.MissingPDFException('Missing PDF "'+le+'".'):new B.UnexpectedResponseException(`Unexpected server response (${ie}) while retrieving PDF "${le}".`,ie)}function se(ie){return ie===200||ie===206}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.getFilenameFromContentDispositionHeader=W;var B=L(1);function W(q){let J=!0,re=ae("filename\\*","i").exec(q);if(re){re=re[1];let ce=pe(re);return ce=unescape(ce),ce=he(ce),ce=ue(ce),ie(ce)}if(re=le(q),re){const ce=ue(re);return ie(ce)}if(re=ae("filename","i").exec(q),re){re=re[1];let ce=pe(re);return ce=ue(ce),ie(ce)}function ae(ce,fe){return new RegExp("(?:^|;)\\s*"+ce+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',fe)}function se(ce,fe){if(ce){if(!/^[\x00-\xFF]+$/.test(fe))return fe;try{const me=new TextDecoder(ce,{fatal:!0}),ke=(0,B.stringToBytes)(fe);fe=me.decode(ke),J=!1}catch{}}return fe}function ie(ce){return J&&/[\x80-\xff]/.test(ce)&&(ce=se("utf-8",ce),J&&(ce=se("iso-8859-1",ce))),ce}function le(ce){const fe=[];let me;const ke=ae("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(me=ke.exec(ce))!==null;){let[,Le,Se,Te]=me;if(Le=parseInt(Le,10),Le in fe){if(Le===0)break;continue}fe[Le]=[Se,Te]}const xe=[];for(let Le=0;Le<fe.length&&Le in fe;++Le){let[Se,Te]=fe[Le];Te=pe(Te),Se&&(Te=unescape(Te),Le===0&&(Te=he(Te))),xe.push(Te)}return xe.join("")}function pe(ce){if(ce.startsWith('"')){const fe=ce.slice(1).split('\\"');for(let me=0;me<fe.length;++me){const ke=fe[me].indexOf('"');ke!==-1&&(fe[me]=fe[me].slice(0,ke),fe.length=me+1),fe[me]=fe[me].replaceAll(/\\(.)/g,"$1")}ce=fe.join('"')}return ce}function he(ce){const fe=ce.indexOf("'");if(fe===-1)return ce;const me=ce.slice(0,fe),xe=ce.slice(fe+1).replace(/^[^']*'/,"");return se(me,xe)}function ue(ce){return!ce.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(ce)?ce:ce.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(fe,me,ke,xe){if(ke==="q"||ke==="Q")return xe=xe.replaceAll("_"," "),xe=xe.replaceAll(/=([0-9a-fA-F]{2})/g,function(Le,Se){return String.fromCharCode(parseInt(Se,16))}),se(me,xe);try{xe=atob(xe)}catch{}return se(me,xe)})}return""}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFNetworkStream=void 0;var B=L(1),W=L(20);const q=200,J=206;function re(pe){const he=pe.response;return typeof he!="string"?he:(0,B.stringToBytes)(he).buffer}class ae{constructor(he,ue={}){this.url=he,this.isHttp=/^https?:/i.test(he),this.httpHeaders=this.isHttp&&ue.httpHeaders||Object.create(null),this.withCredentials=ue.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(he,ue,ce){const fe={begin:he,end:ue};for(const me in ce)fe[me]=ce[me];return this.request(fe)}requestFull(he){return this.request(he)}request(he){const ue=new XMLHttpRequest,ce=this.currXhrId++,fe=this.pendingRequests[ce]={xhr:ue};ue.open("GET",this.url),ue.withCredentials=this.withCredentials;for(const me in this.httpHeaders){const ke=this.httpHeaders[me];ke!==void 0&&ue.setRequestHeader(me,ke)}return this.isHttp&&"begin"in he&&"end"in he?(ue.setRequestHeader("Range",`bytes=${he.begin}-${he.end-1}`),fe.expectedStatus=J):fe.expectedStatus=q,ue.responseType="arraybuffer",he.onError&&(ue.onerror=function(me){he.onError(ue.status)}),ue.onreadystatechange=this.onStateChange.bind(this,ce),ue.onprogress=this.onProgress.bind(this,ce),fe.onHeadersReceived=he.onHeadersReceived,fe.onDone=he.onDone,fe.onError=he.onError,fe.onProgress=he.onProgress,ue.send(null),ce}onProgress(he,ue){var fe;const ce=this.pendingRequests[he];ce&&((fe=ce.onProgress)==null||fe.call(ce,ue))}onStateChange(he,ue){var Le,Se,Te;const ce=this.pendingRequests[he];if(!ce)return;const fe=ce.xhr;if(fe.readyState>=2&&ce.onHeadersReceived&&(ce.onHeadersReceived(),delete ce.onHeadersReceived),fe.readyState!==4||!(he in this.pendingRequests))return;if(delete this.pendingRequests[he],fe.status===0&&this.isHttp){(Le=ce.onError)==null||Le.call(ce,fe.status);return}const me=fe.status||q;if(!(me===q&&ce.expectedStatus===J)&&me!==ce.expectedStatus){(Se=ce.onError)==null||Se.call(ce,fe.status);return}const xe=re(fe);if(me===J){const ge=fe.getResponseHeader("Content-Range"),Ce=/bytes (\d+)-(\d+)\/(\d+)/.exec(ge);ce.onDone({begin:parseInt(Ce[1],10),chunk:xe})}else xe?ce.onDone({begin:0,chunk:xe}):(Te=ce.onError)==null||Te.call(ce,fe.status)}getRequestXhr(he){return this.pendingRequests[he].xhr}isPendingRequest(he){return he in this.pendingRequests}abortRequest(he){const ue=this.pendingRequests[he].xhr;delete this.pendingRequests[he],ue.abort()}}class se{constructor(he){this._source=he,this._manager=new ae(he.url,{httpHeaders:he.httpHeaders,withCredentials:he.withCredentials}),this._rangeChunkSize=he.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(he){const ue=this._rangeRequestReaders.indexOf(he);ue>=0&&this._rangeRequestReaders.splice(ue,1)}getFullReader(){return(0,B.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ie(this._manager,this._source),this._fullRequestReader}getRangeReader(he,ue){const ce=new le(this._manager,he,ue);return ce.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(ce),ce}cancelAllRequests(he){var ue;(ue=this._fullRequestReader)==null||ue.cancel(he);for(const ce of this._rangeRequestReaders.slice(0))ce.cancel(he)}}A.PDFNetworkStream=se;class ie{constructor(he,ue){this._manager=he;const ce={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=ue.url,this._fullRequestId=he.requestFull(ce),this._headersReceivedCapability=new B.PromiseCapability,this._disableRange=ue.disableRange||!1,this._contentLength=ue.length,this._rangeChunkSize=ue.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const he=this._fullRequestId,ue=this._manager.getRequestXhr(he),ce=ke=>ue.getResponseHeader(ke),{allowRangeRequests:fe,suggestedLength:me}=(0,W.validateRangeRequestCapabilities)({getResponseHeader:ce,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});fe&&(this._isRangeSupported=!0),this._contentLength=me||this._contentLength,this._filename=(0,W.extractFilenameFromHeader)(ce),this._isRangeSupported&&this._manager.abortRequest(he),this._headersReceivedCapability.resolve()}_onDone(he){if(he&&(this._requests.length>0?this._requests.shift().resolve({value:he.chunk,done:!1}):this._cachedChunks.push(he.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const ue of this._requests)ue.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(he){this._storedError=(0,W.createResponseStatusError)(he,this._url),this._headersReceivedCapability.reject(this._storedError);for(const ue of this._requests)ue.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(he){var ue;(ue=this.onProgress)==null||ue.call(this,{loaded:he.loaded,total:he.lengthComputable?he.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const he=new B.PromiseCapability;return this._requests.push(he),he.promise}cancel(he){this._done=!0,this._headersReceivedCapability.reject(he);for(const ue of this._requests)ue.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class le{constructor(he,ue,ce){this._manager=he;const fe={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=he.url,this._requestId=he.requestRange(ue,ce,fe),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var he;(he=this.onClosed)==null||he.call(this,this)}_onDone(he){const ue=he.chunk;this._requests.length>0?this._requests.shift().resolve({value:ue,done:!1}):this._queuedChunk=ue,this._done=!0;for(const ce of this._requests)ce.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(he){this._storedError=(0,W.createResponseStatusError)(he,this._url);for(const ue of this._requests)ue.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(he){var ue;this.isStreamingSupported||(ue=this.onProgress)==null||ue.call(this,{loaded:he.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const ue=this._queuedChunk;return this._queuedChunk=null,{value:ue,done:!1}}if(this._done)return{value:void 0,done:!0};const he=new B.PromiseCapability;return this._requests.push(he),he.promise}cancel(he){this._done=!0;for(const ue of this._requests)ue.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFNodeStream=void 0;var B=L(1),W=L(20);const q=/^file:\/\/\/[a-zA-Z]:\//;function J(ce){const fe=require$$5,me=fe.parse(ce);return me.protocol==="file:"||me.host?me:/^[a-z]:[/\\]/i.test(ce)?fe.parse(`file:///${ce}`):(me.host||(me.protocol="file:"),me)}class re{constructor(fe){this.source=fe,this.url=J(fe.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&fe.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var fe;return((fe=this._fullRequestReader)==null?void 0:fe._loaded)??0}getFullReader(){return(0,B.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new he(this):new le(this),this._fullRequestReader}getRangeReader(fe,me){if(me<=this._progressiveDataLength)return null;const ke=this.isFsUrl?new ue(this,fe,me):new pe(this,fe,me);return this._rangeRequestReaders.push(ke),ke}cancelAllRequests(fe){var me;(me=this._fullRequestReader)==null||me.cancel(fe);for(const ke of this._rangeRequestReaders.slice(0))ke.cancel(fe)}}A.PDFNodeStream=re;class ae{constructor(fe){this._url=fe.url,this._done=!1,this._storedError=null,this.onProgress=null;const me=fe.source;this._contentLength=me.length,this._loaded=0,this._filename=null,this._disableRange=me.disableRange||!1,this._rangeChunkSize=me.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!me.disableStream,this._isRangeSupported=!me.disableRange,this._readableStream=null,this._readCapability=new B.PromiseCapability,this._headersCapability=new B.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ke;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const fe=this._readableStream.read();return fe===null?(this._readCapability=new B.PromiseCapability,this.read()):(this._loaded+=fe.length,(ke=this.onProgress)==null||ke.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(fe).buffer,done:!1})}cancel(fe){if(!this._readableStream){this._error(fe);return}this._readableStream.destroy(fe)}_error(fe){this._storedError=fe,this._readCapability.resolve()}_setReadableStream(fe){this._readableStream=fe,fe.on("readable",()=>{this._readCapability.resolve()}),fe.on("end",()=>{fe.destroy(),this._done=!0,this._readCapability.resolve()}),fe.on("error",me=>{this._error(me)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new B.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class se{constructor(fe){this._url=fe.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new B.PromiseCapability;const me=fe.source;this._isStreamingSupported=!me.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ke;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const fe=this._readableStream.read();return fe===null?(this._readCapability=new B.PromiseCapability,this.read()):(this._loaded+=fe.length,(ke=this.onProgress)==null||ke.call(this,{loaded:this._loaded}),{value:new Uint8Array(fe).buffer,done:!1})}cancel(fe){if(!this._readableStream){this._error(fe);return}this._readableStream.destroy(fe)}_error(fe){this._storedError=fe,this._readCapability.resolve()}_setReadableStream(fe){this._readableStream=fe,fe.on("readable",()=>{this._readCapability.resolve()}),fe.on("end",()=>{fe.destroy(),this._done=!0,this._readCapability.resolve()}),fe.on("error",me=>{this._error(me)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function ie(ce,fe){return{protocol:ce.protocol,auth:ce.auth,host:ce.hostname,port:ce.port,path:ce.path,method:"GET",headers:fe}}class le extends ae{constructor(fe){super(fe);const me=ke=>{if(ke.statusCode===404){const Te=new B.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Te,this._headersCapability.reject(Te);return}this._headersCapability.resolve(),this._setReadableStream(ke);const xe=Te=>this._readableStream.headers[Te.toLowerCase()],{allowRangeRequests:Le,suggestedLength:Se}=(0,W.validateRangeRequestCapabilities)({getResponseHeader:xe,isHttp:fe.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Le,this._contentLength=Se||this._contentLength,this._filename=(0,W.extractFilenameFromHeader)(xe)};if(this._request=null,this._url.protocol==="http:"){const ke=require$$5;this._request=ke.request(ie(this._url,fe.httpHeaders),me)}else{const ke=require$$5;this._request=ke.request(ie(this._url,fe.httpHeaders),me)}this._request.on("error",ke=>{this._storedError=ke,this._headersCapability.reject(ke)}),this._request.end()}}class pe extends se{constructor(fe,me,ke){super(fe),this._httpHeaders={};for(const Le in fe.httpHeaders){const Se=fe.httpHeaders[Le];Se!==void 0&&(this._httpHeaders[Le]=Se)}this._httpHeaders.Range=`bytes=${me}-${ke-1}`;const xe=Le=>{if(Le.statusCode===404){const Se=new B.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Se;return}this._setReadableStream(Le)};if(this._request=null,this._url.protocol==="http:"){const Le=require$$5;this._request=Le.request(ie(this._url,this._httpHeaders),xe)}else{const Le=require$$5;this._request=Le.request(ie(this._url,this._httpHeaders),xe)}this._request.on("error",Le=>{this._storedError=Le}),this._request.end()}}class he extends ae{constructor(fe){super(fe);let me=decodeURIComponent(this._url.path);q.test(this._url.href)&&(me=me.replace(/^\//,""));const ke=require$$5;ke.lstat(me,(xe,Le)=>{if(xe){xe.code==="ENOENT"&&(xe=new B.MissingPDFException(`Missing PDF "${me}".`)),this._storedError=xe,this._headersCapability.reject(xe);return}this._contentLength=Le.size,this._setReadableStream(ke.createReadStream(me)),this._headersCapability.resolve()})}}class ue extends se{constructor(fe,me,ke){super(fe);let xe=decodeURIComponent(this._url.path);q.test(this._url.href)&&(xe=xe.replace(/^\//,""));const Le=require$$5;this._setReadableStream(Le.createReadStream(xe,{start:me,end:ke-1}))}}},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.SVGGraphics=void 0;var B=L(6),W=L(1);const q={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},J="http://www.w3.org/XML/1998/namespace",re="http://www.w3.org/1999/xlink",ae=["butt","round","square"],se=["miter","round","bevel"],ie=function(Le,Se="",Te=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Te)return URL.createObjectURL(new Blob([Le],{type:Se}));const ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Ce=`data:${Se};base64,`;for(let be=0,nt=Le.length;be<nt;be+=3){const Ae=Le[be]&255,De=Le[be+1]&255,lt=Le[be+2]&255,Ct=Ae>>2,ft=(Ae&3)<<4|De>>4,Et=be+1<nt?(De&15)<<2|lt>>6:64,gt=be+2<nt?lt&63:64;Ce+=ge[Ct]+ge[ft]+ge[Et]+ge[gt]}return Ce},le=function(){const Le=new Uint8Array([137,80,78,71,13,10,26,10]),Se=12,Te=new Int32Array(256);for(let lt=0;lt<256;lt++){let Ct=lt;for(let ft=0;ft<8;ft++)Ct=Ct&1?3988292384^Ct>>1&2147483647:Ct>>1&2147483647;Te[lt]=Ct}function ge(lt,Ct,ft){let Et=-1;for(let gt=Ct;gt<ft;gt++){const bt=(Et^lt[gt])&255,Ie=Te[bt];Et=Et>>>8^Ie}return Et^-1}function Ce(lt,Ct,ft,Et){let gt=Et;const bt=Ct.length;ft[gt]=bt>>24&255,ft[gt+1]=bt>>16&255,ft[gt+2]=bt>>8&255,ft[gt+3]=bt&255,gt+=4,ft[gt]=lt.charCodeAt(0)&255,ft[gt+1]=lt.charCodeAt(1)&255,ft[gt+2]=lt.charCodeAt(2)&255,ft[gt+3]=lt.charCodeAt(3)&255,gt+=4,ft.set(Ct,gt),gt+=Ct.length;const Ie=ge(ft,Et+4,gt);ft[gt]=Ie>>24&255,ft[gt+1]=Ie>>16&255,ft[gt+2]=Ie>>8&255,ft[gt+3]=Ie&255}function be(lt,Ct,ft){let Et=1,gt=0;for(let bt=Ct;bt<ft;++bt)Et=(Et+(lt[bt]&255))%65521,gt=(gt+Et)%65521;return gt<<16|Et}function nt(lt){if(!W.isNodeJS)return Ae(lt);try{const Ct=parseInt(process.versions.node)>=8?lt:Buffer.from(lt),ft=require$$5.deflateSync(Ct,{level:9});return ft instanceof Uint8Array?ft:new Uint8Array(ft)}catch(Ct){(0,W.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Ct)}return Ae(lt)}function Ae(lt){let Ct=lt.length;const ft=65535,Et=Math.ceil(Ct/ft),gt=new Uint8Array(2+Ct+Et*5+4);let bt=0;gt[bt++]=120,gt[bt++]=156;let Ie=0;for(;Ct>ft;)gt[bt++]=0,gt[bt++]=255,gt[bt++]=255,gt[bt++]=0,gt[bt++]=0,gt.set(lt.subarray(Ie,Ie+ft),bt),bt+=ft,Ie+=ft,Ct-=ft;gt[bt++]=1,gt[bt++]=Ct&255,gt[bt++]=Ct>>8&255,gt[bt++]=~Ct&65535&255,gt[bt++]=(~Ct&65535)>>8&255,gt.set(lt.subarray(Ie),bt),bt+=lt.length-Ie;const pt=be(lt,0,lt.length);return gt[bt++]=pt>>24&255,gt[bt++]=pt>>16&255,gt[bt++]=pt>>8&255,gt[bt++]=pt&255,gt}function De(lt,Ct,ft,Et){const gt=lt.width,bt=lt.height;let Ie,pt,at;const Ee=lt.data;switch(Ct){case W.ImageKind.GRAYSCALE_1BPP:pt=0,Ie=1,at=gt+7>>3;break;case W.ImageKind.RGB_24BPP:pt=2,Ie=8,at=gt*3;break;case W.ImageKind.RGBA_32BPP:pt=6,Ie=8,at=gt*4;break;default:throw new Error("invalid format")}const ye=new Uint8Array((1+at)*bt);let ve=0,Pe=0;for(let It=0;It<bt;++It)ye[ve++]=0,ye.set(Ee.subarray(Pe,Pe+at),ve),Pe+=at,ve+=at;if(Ct===W.ImageKind.GRAYSCALE_1BPP&&Et){ve=0;for(let It=0;It<bt;It++){ve++;for(let it=0;it<at;it++)ye[ve++]^=255}}const rt=new Uint8Array([gt>>24&255,gt>>16&255,gt>>8&255,gt&255,bt>>24&255,bt>>16&255,bt>>8&255,bt&255,Ie,pt,0,0,0]),st=nt(ye),ot=Le.length+Se*3+rt.length+st.length,mt=new Uint8Array(ot);let At=0;return mt.set(Le,At),At+=Le.length,Ce("IHDR",rt,mt,At),At+=Se+rt.length,Ce("IDATA",st,mt,At),At+=Se+st.length,Ce("IEND",new Uint8Array(0),mt,At),ie(mt,"image/png",ft)}return function(Ct,ft,Et){const gt=Ct.kind===void 0?W.ImageKind.GRAYSCALE_1BPP:Ct.kind;return De(Ct,gt,ft,Et)}}();class pe{constructor(){this.fontSizeScale=1,this.fontWeight=q.fontWeight,this.fontSize=0,this.textMatrix=W.IDENTITY_MATRIX,this.fontMatrix=W.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=W.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=q.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(Se,Te){this.x=Se,this.y=Te}}function he(Le){let Se=[];const Te=[];for(const ge of Le){if(ge.fn==="save"){Se.push({fnId:92,fn:"group",items:[]}),Te.push(Se),Se=Se.at(-1).items;continue}ge.fn==="restore"?Se=Te.pop():Se.push(ge)}return Se}function ue(Le){if(Number.isInteger(Le))return Le.toString();const Se=Le.toFixed(10);let Te=Se.length-1;if(Se[Te]!=="0")return Se;do Te--;while(Se[Te]==="0");return Se.substring(0,Se[Te]==="."?Te:Te+1)}function ce(Le){if(Le[4]===0&&Le[5]===0){if(Le[1]===0&&Le[2]===0)return Le[0]===1&&Le[3]===1?"":`scale(${ue(Le[0])} ${ue(Le[3])})`;if(Le[0]===Le[3]&&Le[1]===-Le[2]){const Se=Math.acos(Le[0])*180/Math.PI;return`rotate(${ue(Se)})`}}else if(Le[0]===1&&Le[1]===0&&Le[2]===0&&Le[3]===1)return`translate(${ue(Le[4])} ${ue(Le[5])})`;return`matrix(${ue(Le[0])} ${ue(Le[1])} ${ue(Le[2])} ${ue(Le[3])} ${ue(Le[4])} ${ue(Le[5])})`}let fe=0,me=0,ke=0;class xe{constructor(Se,Te,ge=!1){(0,B.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new B.DOMSVGFactory,this.current=new pe,this.transformMatrix=W.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=Se,this.objs=Te,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!ge,this._operatorIdMapping=[];for(const Ce in W.OPS)this._operatorIdMapping[W.OPS[Ce]]=Ce}getObject(Se,Te=null){return typeof Se=="string"?Se.startsWith("g_")?this.commonObjs.get(Se):this.objs.get(Se):Te}save(){this.transformStack.push(this.transformMatrix);const Se=this.current;this.extraStack.push(Se),this.current=Se.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(Se){this.save(),this.executeOpTree(Se),this.restore()}loadDependencies(Se){const Te=Se.fnArray,ge=Se.argsArray;for(let Ce=0,be=Te.length;Ce<be;Ce++)if(Te[Ce]===W.OPS.dependency)for(const nt of ge[Ce]){const Ae=nt.startsWith("g_")?this.commonObjs:this.objs,De=new Promise(lt=>{Ae.get(nt,lt)});this.current.dependencies.push(De)}return Promise.all(this.current.dependencies)}transform(Se,Te,ge,Ce,be,nt){const Ae=[Se,Te,ge,Ce,be,nt];this.transformMatrix=W.Util.transform(this.transformMatrix,Ae),this.tgrp=null}getSVG(Se,Te){this.viewport=Te;const ge=this._initialize(Te);return this.loadDependencies(Se).then(()=>(this.transformMatrix=W.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(Se)),ge))}convertOpList(Se){const Te=this._operatorIdMapping,ge=Se.argsArray,Ce=Se.fnArray,be=[];for(let nt=0,Ae=Ce.length;nt<Ae;nt++){const De=Ce[nt];be.push({fnId:De,fn:Te[De],args:ge[nt]})}return he(be)}executeOpTree(Se){for(const Te of Se){const ge=Te.fn,Ce=Te.fnId,be=Te.args;switch(Ce|0){case W.OPS.beginText:this.beginText();break;case W.OPS.dependency:break;case W.OPS.setLeading:this.setLeading(be);break;case W.OPS.setLeadingMoveText:this.setLeadingMoveText(be[0],be[1]);break;case W.OPS.setFont:this.setFont(be);break;case W.OPS.showText:this.showText(be[0]);break;case W.OPS.showSpacedText:this.showText(be[0]);break;case W.OPS.endText:this.endText();break;case W.OPS.moveText:this.moveText(be[0],be[1]);break;case W.OPS.setCharSpacing:this.setCharSpacing(be[0]);break;case W.OPS.setWordSpacing:this.setWordSpacing(be[0]);break;case W.OPS.setHScale:this.setHScale(be[0]);break;case W.OPS.setTextMatrix:this.setTextMatrix(be[0],be[1],be[2],be[3],be[4],be[5]);break;case W.OPS.setTextRise:this.setTextRise(be[0]);break;case W.OPS.setTextRenderingMode:this.setTextRenderingMode(be[0]);break;case W.OPS.setLineWidth:this.setLineWidth(be[0]);break;case W.OPS.setLineJoin:this.setLineJoin(be[0]);break;case W.OPS.setLineCap:this.setLineCap(be[0]);break;case W.OPS.setMiterLimit:this.setMiterLimit(be[0]);break;case W.OPS.setFillRGBColor:this.setFillRGBColor(be[0],be[1],be[2]);break;case W.OPS.setStrokeRGBColor:this.setStrokeRGBColor(be[0],be[1],be[2]);break;case W.OPS.setStrokeColorN:this.setStrokeColorN(be);break;case W.OPS.setFillColorN:this.setFillColorN(be);break;case W.OPS.shadingFill:this.shadingFill(be[0]);break;case W.OPS.setDash:this.setDash(be[0],be[1]);break;case W.OPS.setRenderingIntent:this.setRenderingIntent(be[0]);break;case W.OPS.setFlatness:this.setFlatness(be[0]);break;case W.OPS.setGState:this.setGState(be[0]);break;case W.OPS.fill:this.fill();break;case W.OPS.eoFill:this.eoFill();break;case W.OPS.stroke:this.stroke();break;case W.OPS.fillStroke:this.fillStroke();break;case W.OPS.eoFillStroke:this.eoFillStroke();break;case W.OPS.clip:this.clip("nonzero");break;case W.OPS.eoClip:this.clip("evenodd");break;case W.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case W.OPS.paintImageXObject:this.paintImageXObject(be[0]);break;case W.OPS.paintInlineImageXObject:this.paintInlineImageXObject(be[0]);break;case W.OPS.paintImageMaskXObject:this.paintImageMaskXObject(be[0]);break;case W.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(be[0],be[1]);break;case W.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case W.OPS.closePath:this.closePath();break;case W.OPS.closeStroke:this.closeStroke();break;case W.OPS.closeFillStroke:this.closeFillStroke();break;case W.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case W.OPS.nextLine:this.nextLine();break;case W.OPS.transform:this.transform(be[0],be[1],be[2],be[3],be[4],be[5]);break;case W.OPS.constructPath:this.constructPath(be[0],be[1]);break;case W.OPS.endPath:this.endPath();break;case 92:this.group(Te.items);break;default:(0,W.warn)(`Unimplemented operator ${ge}`);break}}}setWordSpacing(Se){this.current.wordSpacing=Se}setCharSpacing(Se){this.current.charSpacing=Se}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(Se,Te,ge,Ce,be,nt){const Ae=this.current;Ae.textMatrix=Ae.lineMatrix=[Se,Te,ge,Ce,be,nt],Ae.textMatrixScale=Math.hypot(Se,Te),Ae.x=Ae.lineX=0,Ae.y=Ae.lineY=0,Ae.xcoords=[],Ae.ycoords=[],Ae.tspan=this.svgFactory.createElement("svg:tspan"),Ae.tspan.setAttributeNS(null,"font-family",Ae.fontFamily),Ae.tspan.setAttributeNS(null,"font-size",`${ue(Ae.fontSize)}px`),Ae.tspan.setAttributeNS(null,"y",ue(-Ae.y)),Ae.txtElement=this.svgFactory.createElement("svg:text"),Ae.txtElement.append(Ae.tspan)}beginText(){const Se=this.current;Se.x=Se.lineX=0,Se.y=Se.lineY=0,Se.textMatrix=W.IDENTITY_MATRIX,Se.lineMatrix=W.IDENTITY_MATRIX,Se.textMatrixScale=1,Se.tspan=this.svgFactory.createElement("svg:tspan"),Se.txtElement=this.svgFactory.createElement("svg:text"),Se.txtgrp=this.svgFactory.createElement("svg:g"),Se.xcoords=[],Se.ycoords=[]}moveText(Se,Te){const ge=this.current;ge.x=ge.lineX+=Se,ge.y=ge.lineY+=Te,ge.xcoords=[],ge.ycoords=[],ge.tspan=this.svgFactory.createElement("svg:tspan"),ge.tspan.setAttributeNS(null,"font-family",ge.fontFamily),ge.tspan.setAttributeNS(null,"font-size",`${ue(ge.fontSize)}px`),ge.tspan.setAttributeNS(null,"y",ue(-ge.y))}showText(Se){const Te=this.current,ge=Te.font,Ce=Te.fontSize;if(Ce===0)return;const be=Te.fontSizeScale,nt=Te.charSpacing,Ae=Te.wordSpacing,De=Te.fontDirection,lt=Te.textHScale*De,Ct=ge.vertical,ft=Ct?1:-1,Et=ge.defaultVMetrics,gt=Ce*Te.fontMatrix[0];let bt=0;for(const at of Se){if(at===null){bt+=De*Ae;continue}else if(typeof at=="number"){bt+=ft*at*Ce/1e3;continue}const Ee=(at.isSpace?Ae:0)+nt,ye=at.fontChar;let ve,Pe,rt=at.width;if(Ct){let ot;const mt=at.vmetric||Et;ot=at.vmetric?mt[1]:rt*.5,ot=-ot*gt;const At=mt[2]*gt;rt=mt?-mt[0]:rt,ve=ot/be,Pe=(bt+At)/be}else ve=bt/be,Pe=0;(at.isInFont||ge.missingFile)&&(Te.xcoords.push(Te.x+ve),Ct&&Te.ycoords.push(-Te.y+Pe),Te.tspan.textContent+=ye);const st=Ct?rt*gt-Ee*De:rt*gt+Ee*De;bt+=st}Te.tspan.setAttributeNS(null,"x",Te.xcoords.map(ue).join(" ")),Ct?Te.tspan.setAttributeNS(null,"y",Te.ycoords.map(ue).join(" ")):Te.tspan.setAttributeNS(null,"y",ue(-Te.y)),Ct?Te.y-=bt:Te.x+=bt*lt,Te.tspan.setAttributeNS(null,"font-family",Te.fontFamily),Te.tspan.setAttributeNS(null,"font-size",`${ue(Te.fontSize)}px`),Te.fontStyle!==q.fontStyle&&Te.tspan.setAttributeNS(null,"font-style",Te.fontStyle),Te.fontWeight!==q.fontWeight&&Te.tspan.setAttributeNS(null,"font-weight",Te.fontWeight);const Ie=Te.textRenderingMode&W.TextRenderingMode.FILL_STROKE_MASK;if(Ie===W.TextRenderingMode.FILL||Ie===W.TextRenderingMode.FILL_STROKE?(Te.fillColor!==q.fillColor&&Te.tspan.setAttributeNS(null,"fill",Te.fillColor),Te.fillAlpha<1&&Te.tspan.setAttributeNS(null,"fill-opacity",Te.fillAlpha)):Te.textRenderingMode===W.TextRenderingMode.ADD_TO_PATH?Te.tspan.setAttributeNS(null,"fill","transparent"):Te.tspan.setAttributeNS(null,"fill","none"),Ie===W.TextRenderingMode.STROKE||Ie===W.TextRenderingMode.FILL_STROKE){const at=1/(Te.textMatrixScale||1);this._setStrokeAttributes(Te.tspan,at)}let pt=Te.textMatrix;Te.textRise!==0&&(pt=pt.slice(),pt[5]+=Te.textRise),Te.txtElement.setAttributeNS(null,"transform",`${ce(pt)} scale(${ue(lt)}, -1)`),Te.txtElement.setAttributeNS(J,"xml:space","preserve"),Te.txtElement.append(Te.tspan),Te.txtgrp.append(Te.txtElement),this._ensureTransformGroup().append(Te.txtElement)}setLeadingMoveText(Se,Te){this.setLeading(-Te),this.moveText(Se,Te)}addFontStyle(Se){if(!Se.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const Te=ie(Se.data,Se.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${Se.loadedName}"; src: url(${Te}); }
`}setFont(Se){const Te=this.current,ge=this.commonObjs.get(Se[0]);let Ce=Se[1];Te.font=ge,this.embedFonts&&!ge.missingFile&&!this.embeddedFonts[ge.loadedName]&&(this.addFontStyle(ge),this.embeddedFonts[ge.loadedName]=ge),Te.fontMatrix=ge.fontMatrix||W.FONT_IDENTITY_MATRIX;let be="normal";ge.black?be="900":ge.bold&&(be="bold");const nt=ge.italic?"italic":"normal";Ce<0?(Ce=-Ce,Te.fontDirection=-1):Te.fontDirection=1,Te.fontSize=Ce,Te.fontFamily=ge.loadedName,Te.fontWeight=be,Te.fontStyle=nt,Te.tspan=this.svgFactory.createElement("svg:tspan"),Te.tspan.setAttributeNS(null,"y",ue(-Te.y)),Te.xcoords=[],Te.ycoords=[]}endText(){var Te;const Se=this.current;Se.textRenderingMode&W.TextRenderingMode.ADD_TO_PATH_FLAG&&((Te=Se.txtElement)!=null&&Te.hasChildNodes())&&(Se.element=Se.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(Se){Se>0&&(this.current.lineWidth=Se)}setLineCap(Se){this.current.lineCap=ae[Se]}setLineJoin(Se){this.current.lineJoin=se[Se]}setMiterLimit(Se){this.current.miterLimit=Se}setStrokeAlpha(Se){this.current.strokeAlpha=Se}setStrokeRGBColor(Se,Te,ge){this.current.strokeColor=W.Util.makeHexColor(Se,Te,ge)}setFillAlpha(Se){this.current.fillAlpha=Se}setFillRGBColor(Se,Te,ge){this.current.fillColor=W.Util.makeHexColor(Se,Te,ge),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(Se){this.current.strokeColor=this._makeColorN_Pattern(Se)}setFillColorN(Se){this.current.fillColor=this._makeColorN_Pattern(Se)}shadingFill(Se){const{width:Te,height:ge}=this.viewport,Ce=W.Util.inverseTransform(this.transformMatrix),[be,nt,Ae,De]=W.Util.getAxialAlignedBoundingBox([0,0,Te,ge],Ce),lt=this.svgFactory.createElement("svg:rect");lt.setAttributeNS(null,"x",be),lt.setAttributeNS(null,"y",nt),lt.setAttributeNS(null,"width",Ae-be),lt.setAttributeNS(null,"height",De-nt),lt.setAttributeNS(null,"fill",this._makeShadingPattern(Se)),this.current.fillAlpha<1&&lt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(lt)}_makeColorN_Pattern(Se){return Se[0]==="TilingPattern"?this._makeTilingPattern(Se):this._makeShadingPattern(Se)}_makeTilingPattern(Se){const Te=Se[1],ge=Se[2],Ce=Se[3]||W.IDENTITY_MATRIX,[be,nt,Ae,De]=Se[4],lt=Se[5],Ct=Se[6],ft=Se[7],Et=`shading${ke++}`,[gt,bt,Ie,pt]=W.Util.normalizeRect([...W.Util.applyTransform([be,nt],Ce),...W.Util.applyTransform([Ae,De],Ce)]),[at,Ee]=W.Util.singularValueDecompose2dScale(Ce),ye=lt*at,ve=Ct*Ee,Pe=this.svgFactory.createElement("svg:pattern");Pe.setAttributeNS(null,"id",Et),Pe.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Pe.setAttributeNS(null,"width",ye),Pe.setAttributeNS(null,"height",ve),Pe.setAttributeNS(null,"x",`${gt}`),Pe.setAttributeNS(null,"y",`${bt}`);const rt=this.svg,st=this.transformMatrix,ot=this.current.fillColor,mt=this.current.strokeColor,At=this.svgFactory.create(Ie-gt,pt-bt);if(this.svg=At,this.transformMatrix=Ce,ft===2){const It=W.Util.makeHexColor(...Te);this.current.fillColor=It,this.current.strokeColor=It}return this.executeOpTree(this.convertOpList(ge)),this.svg=rt,this.transformMatrix=st,this.current.fillColor=ot,this.current.strokeColor=mt,Pe.append(At.childNodes[0]),this.defs.append(Pe),`url(#${Et})`}_makeShadingPattern(Se){switch(typeof Se=="string"&&(Se=this.objs.get(Se)),Se[0]){case"RadialAxial":const Te=`shading${ke++}`,ge=Se[3];let Ce;switch(Se[1]){case"axial":const be=Se[4],nt=Se[5];Ce=this.svgFactory.createElement("svg:linearGradient"),Ce.setAttributeNS(null,"id",Te),Ce.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Ce.setAttributeNS(null,"x1",be[0]),Ce.setAttributeNS(null,"y1",be[1]),Ce.setAttributeNS(null,"x2",nt[0]),Ce.setAttributeNS(null,"y2",nt[1]);break;case"radial":const Ae=Se[4],De=Se[5],lt=Se[6],Ct=Se[7];Ce=this.svgFactory.createElement("svg:radialGradient"),Ce.setAttributeNS(null,"id",Te),Ce.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Ce.setAttributeNS(null,"cx",De[0]),Ce.setAttributeNS(null,"cy",De[1]),Ce.setAttributeNS(null,"r",Ct),Ce.setAttributeNS(null,"fx",Ae[0]),Ce.setAttributeNS(null,"fy",Ae[1]),Ce.setAttributeNS(null,"fr",lt);break;default:throw new Error(`Unknown RadialAxial type: ${Se[1]}`)}for(const be of ge){const nt=this.svgFactory.createElement("svg:stop");nt.setAttributeNS(null,"offset",be[0]),nt.setAttributeNS(null,"stop-color",be[1]),Ce.append(nt)}return this.defs.append(Ce),`url(#${Te})`;case"Mesh":return(0,W.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${Se[0]}`)}}setDash(Se,Te){this.current.dashArray=Se,this.current.dashPhase=Te}constructPath(Se,Te){const ge=this.current;let Ce=ge.x,be=ge.y,nt=[],Ae=0;for(const De of Se)switch(De|0){case W.OPS.rectangle:Ce=Te[Ae++],be=Te[Ae++];const lt=Te[Ae++],Ct=Te[Ae++],ft=Ce+lt,Et=be+Ct;nt.push("M",ue(Ce),ue(be),"L",ue(ft),ue(be),"L",ue(ft),ue(Et),"L",ue(Ce),ue(Et),"Z");break;case W.OPS.moveTo:Ce=Te[Ae++],be=Te[Ae++],nt.push("M",ue(Ce),ue(be));break;case W.OPS.lineTo:Ce=Te[Ae++],be=Te[Ae++],nt.push("L",ue(Ce),ue(be));break;case W.OPS.curveTo:Ce=Te[Ae+4],be=Te[Ae+5],nt.push("C",ue(Te[Ae]),ue(Te[Ae+1]),ue(Te[Ae+2]),ue(Te[Ae+3]),ue(Ce),ue(be)),Ae+=6;break;case W.OPS.curveTo2:nt.push("C",ue(Ce),ue(be),ue(Te[Ae]),ue(Te[Ae+1]),ue(Te[Ae+2]),ue(Te[Ae+3])),Ce=Te[Ae+2],be=Te[Ae+3],Ae+=4;break;case W.OPS.curveTo3:Ce=Te[Ae+2],be=Te[Ae+3],nt.push("C",ue(Te[Ae]),ue(Te[Ae+1]),ue(Ce),ue(be),ue(Ce),ue(be)),Ae+=4;break;case W.OPS.closePath:nt.push("Z");break}nt=nt.join(" "),ge.path&&Se.length>0&&Se[0]!==W.OPS.rectangle&&Se[0]!==W.OPS.moveTo?nt=ge.path.getAttributeNS(null,"d")+nt:(ge.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(ge.path)),ge.path.setAttributeNS(null,"d",nt),ge.path.setAttributeNS(null,"fill","none"),ge.element=ge.path,ge.setCurrentPoint(Ce,be)}endPath(){const Se=this.current;if(Se.path=null,!this.pendingClip)return;if(!Se.element){this.pendingClip=null;return}const Te=`clippath${fe++}`,ge=this.svgFactory.createElement("svg:clipPath");ge.setAttributeNS(null,"id",Te),ge.setAttributeNS(null,"transform",ce(this.transformMatrix));const Ce=Se.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Ce.setAttributeNS(null,"clip-rule","evenodd"):Ce.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,ge.append(Ce),this.defs.append(ge),Se.activeClipUrl){Se.clipGroup=null;for(const be of this.extraStack)be.clipGroup=null;ge.setAttributeNS(null,"clip-path",Se.activeClipUrl)}Se.activeClipUrl=`url(#${Te})`,this.tgrp=null}clip(Se){this.pendingClip=Se}closePath(){const Se=this.current;if(Se.path){const Te=`${Se.path.getAttributeNS(null,"d")}Z`;Se.path.setAttributeNS(null,"d",Te)}}setLeading(Se){this.current.leading=-Se}setTextRise(Se){this.current.textRise=Se}setTextRenderingMode(Se){this.current.textRenderingMode=Se}setHScale(Se){this.current.textHScale=Se/100}setRenderingIntent(Se){}setFlatness(Se){}setGState(Se){for(const[Te,ge]of Se)switch(Te){case"LW":this.setLineWidth(ge);break;case"LC":this.setLineCap(ge);break;case"LJ":this.setLineJoin(ge);break;case"ML":this.setMiterLimit(ge);break;case"D":this.setDash(ge[0],ge[1]);break;case"RI":this.setRenderingIntent(ge);break;case"FL":this.setFlatness(ge);break;case"Font":this.setFont(ge);break;case"CA":this.setStrokeAlpha(ge);break;case"ca":this.setFillAlpha(ge);break;default:(0,W.warn)(`Unimplemented graphic state operator ${Te}`);break}}fill(){const Se=this.current;Se.element&&(Se.element.setAttributeNS(null,"fill",Se.fillColor),Se.element.setAttributeNS(null,"fill-opacity",Se.fillAlpha),this.endPath())}stroke(){const Se=this.current;Se.element&&(this._setStrokeAttributes(Se.element),Se.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(Se,Te=1){const ge=this.current;let Ce=ge.dashArray;Te!==1&&Ce.length>0&&(Ce=Ce.map(function(be){return Te*be})),Se.setAttributeNS(null,"stroke",ge.strokeColor),Se.setAttributeNS(null,"stroke-opacity",ge.strokeAlpha),Se.setAttributeNS(null,"stroke-miterlimit",ue(ge.miterLimit)),Se.setAttributeNS(null,"stroke-linecap",ge.lineCap),Se.setAttributeNS(null,"stroke-linejoin",ge.lineJoin),Se.setAttributeNS(null,"stroke-width",ue(Te*ge.lineWidth)+"px"),Se.setAttributeNS(null,"stroke-dasharray",Ce.map(ue).join(" ")),Se.setAttributeNS(null,"stroke-dashoffset",ue(Te*ge.dashPhase)+"px")}eoFill(){var Se;(Se=this.current.element)==null||Se.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var Se;(Se=this.current.element)==null||Se.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const Se=this.svgFactory.createElement("svg:rect");Se.setAttributeNS(null,"x","0"),Se.setAttributeNS(null,"y","0"),Se.setAttributeNS(null,"width","1px"),Se.setAttributeNS(null,"height","1px"),Se.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(Se)}paintImageXObject(Se){const Te=this.getObject(Se);if(!Te){(0,W.warn)(`Dependent image with object ID ${Se} is not ready yet`);return}this.paintInlineImageXObject(Te)}paintInlineImageXObject(Se,Te){const ge=Se.width,Ce=Se.height,be=le(Se,this.forceDataSchema,!!Te),nt=this.svgFactory.createElement("svg:rect");nt.setAttributeNS(null,"x","0"),nt.setAttributeNS(null,"y","0"),nt.setAttributeNS(null,"width",ue(ge)),nt.setAttributeNS(null,"height",ue(Ce)),this.current.element=nt,this.clip("nonzero");const Ae=this.svgFactory.createElement("svg:image");Ae.setAttributeNS(re,"xlink:href",be),Ae.setAttributeNS(null,"x","0"),Ae.setAttributeNS(null,"y",ue(-Ce)),Ae.setAttributeNS(null,"width",ue(ge)+"px"),Ae.setAttributeNS(null,"height",ue(Ce)+"px"),Ae.setAttributeNS(null,"transform",`scale(${ue(1/ge)} ${ue(-1/Ce)})`),Te?Te.append(Ae):this._ensureTransformGroup().append(Ae)}paintImageMaskXObject(Se){const Te=this.getObject(Se.data,Se);if(Te.bitmap){(0,W.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const ge=this.current,Ce=Te.width,be=Te.height,nt=ge.fillColor;ge.maskId=`mask${me++}`;const Ae=this.svgFactory.createElement("svg:mask");Ae.setAttributeNS(null,"id",ge.maskId);const De=this.svgFactory.createElement("svg:rect");De.setAttributeNS(null,"x","0"),De.setAttributeNS(null,"y","0"),De.setAttributeNS(null,"width",ue(Ce)),De.setAttributeNS(null,"height",ue(be)),De.setAttributeNS(null,"fill",nt),De.setAttributeNS(null,"mask",`url(#${ge.maskId})`),this.defs.append(Ae),this._ensureTransformGroup().append(De),this.paintInlineImageXObject(Te,Ae)}paintFormXObjectBegin(Se,Te){if(Array.isArray(Se)&&Se.length===6&&this.transform(Se[0],Se[1],Se[2],Se[3],Se[4],Se[5]),Te){const ge=Te[2]-Te[0],Ce=Te[3]-Te[1],be=this.svgFactory.createElement("svg:rect");be.setAttributeNS(null,"x",Te[0]),be.setAttributeNS(null,"y",Te[1]),be.setAttributeNS(null,"width",ue(ge)),be.setAttributeNS(null,"height",ue(Ce)),this.current.element=be,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(Se){const Te=this.svgFactory.create(Se.width,Se.height),ge=this.svgFactory.createElement("svg:defs");Te.append(ge),this.defs=ge;const Ce=this.svgFactory.createElement("svg:g");return Ce.setAttributeNS(null,"transform",ce(Se.transform)),Te.append(Ce),this.svg=Ce,Te}_ensureClipGroup(){if(!this.current.clipGroup){const Se=this.svgFactory.createElement("svg:g");Se.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(Se),this.current.clipGroup=Se}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",ce(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}A.SVGGraphics=xe},(g,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.XfaText=void 0;class L{static textContent(W){const q=[],J={items:q,styles:Object.create(null)};function re(ae){var le;if(!ae)return;let se=null;const ie=ae.name;if(ie==="#text")se=ae.value;else if(L.shouldBuildText(ie))(le=ae==null?void 0:ae.attributes)!=null&&le.textContent?se=ae.attributes.textContent:ae.value&&(se=ae.value);else return;if(se!==null&&q.push({str:se}),!!ae.children)for(const pe of ae.children)re(pe)}return re(W),J}static shouldBuildText(W){return!(W==="textarea"||W==="input"||W==="option"||W==="select")}}A.XfaText=L},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.TextLayerRenderTask=void 0,A.renderTextLayer=ce,A.updateTextLayer=fe;var B=L(1),W=L(6);const q=1e5,J=30,re=.8,ae=new Map;function se(me,ke){let xe;if(ke&&B.FeatureTest.isOffscreenCanvasSupported)xe=new OffscreenCanvas(me,me).getContext("2d",{alpha:!1});else{const Le=document.createElement("canvas");Le.width=Le.height=me,xe=Le.getContext("2d",{alpha:!1})}return xe}function ie(me,ke){const xe=ae.get(me);if(xe)return xe;const Le=se(J,ke);Le.font=`${J}px ${me}`;const Se=Le.measureText("");let Te=Se.fontBoundingBoxAscent,ge=Math.abs(Se.fontBoundingBoxDescent);if(Te){const be=Te/(Te+ge);return ae.set(me,be),Le.canvas.width=Le.canvas.height=0,be}Le.strokeStyle="red",Le.clearRect(0,0,J,J),Le.strokeText("g",0,0);let Ce=Le.getImageData(0,0,J,J).data;ge=0;for(let be=Ce.length-1-3;be>=0;be-=4)if(Ce[be]>0){ge=Math.ceil(be/4/J);break}Le.clearRect(0,0,J,J),Le.strokeText("A",0,J),Ce=Le.getImageData(0,0,J,J).data,Te=0;for(let be=0,nt=Ce.length;be<nt;be+=4)if(Ce[be]>0){Te=J-Math.floor(be/4/J);break}if(Le.canvas.width=Le.canvas.height=0,Te){const be=Te/(Te+ge);return ae.set(me,be),be}return ae.set(me,re),re}function le(me,ke,xe){const Le=document.createElement("span"),Se={angle:0,canvasWidth:0,hasText:ke.str!=="",hasEOL:ke.hasEOL,fontSize:0};me._textDivs.push(Le);const Te=B.Util.transform(me._transform,ke.transform);let ge=Math.atan2(Te[1],Te[0]);const Ce=xe[ke.fontName];Ce.vertical&&(ge+=Math.PI/2);const be=Math.hypot(Te[2],Te[3]),nt=be*ie(Ce.fontFamily,me._isOffscreenCanvasSupported);let Ae,De;ge===0?(Ae=Te[4],De=Te[5]-nt):(Ae=Te[4]+nt*Math.sin(ge),De=Te[5]-nt*Math.cos(ge));const lt="calc(var(--scale-factor)*",Ct=Le.style;me._container===me._rootContainer?(Ct.left=`${(100*Ae/me._pageWidth).toFixed(2)}%`,Ct.top=`${(100*De/me._pageHeight).toFixed(2)}%`):(Ct.left=`${lt}${Ae.toFixed(2)}px)`,Ct.top=`${lt}${De.toFixed(2)}px)`),Ct.fontSize=`${lt}${be.toFixed(2)}px)`,Ct.fontFamily=Ce.fontFamily,Se.fontSize=be,Le.setAttribute("role","presentation"),Le.textContent=ke.str,Le.dir=ke.dir,me._fontInspectorEnabled&&(Le.dataset.fontName=ke.fontName),ge!==0&&(Se.angle=ge*(180/Math.PI));let ft=!1;if(ke.str.length>1)ft=!0;else if(ke.str!==" "&&ke.transform[0]!==ke.transform[3]){const Et=Math.abs(ke.transform[0]),gt=Math.abs(ke.transform[3]);Et!==gt&&Math.max(Et,gt)/Math.min(Et,gt)>1.5&&(ft=!0)}ft&&(Se.canvasWidth=Ce.vertical?ke.height:ke.width),me._textDivProperties.set(Le,Se),me._isReadableStream&&me._layoutText(Le)}function pe(me){const{div:ke,scale:xe,properties:Le,ctx:Se,prevFontSize:Te,prevFontFamily:ge}=me,{style:Ce}=ke;let be="";if(Le.canvasWidth!==0&&Le.hasText){const{fontFamily:nt}=Ce,{canvasWidth:Ae,fontSize:De}=Le;(Te!==De||ge!==nt)&&(Se.font=`${De*xe}px ${nt}`,me.prevFontSize=De,me.prevFontFamily=nt);const{width:lt}=Se.measureText(ke.textContent);lt>0&&(be=`scaleX(${Ae*xe/lt})`)}Le.angle!==0&&(be=`rotate(${Le.angle}deg) ${be}`),be.length>0&&(Ce.transform=be)}function he(me){if(me._canceled)return;const ke=me._textDivs,xe=me._capability;if(ke.length>q){xe.resolve();return}if(!me._isReadableStream)for(const Se of ke)me._layoutText(Se);xe.resolve()}class ue{constructor({textContentSource:ke,container:xe,viewport:Le,textDivs:Se,textDivProperties:Te,textContentItemsStr:ge,isOffscreenCanvasSupported:Ce}){var lt;this._textContentSource=ke,this._isReadableStream=ke instanceof ReadableStream,this._container=this._rootContainer=xe,this._textDivs=Se||[],this._textContentItemsStr=ge||[],this._isOffscreenCanvasSupported=Ce,this._fontInspectorEnabled=!!((lt=globalThis.FontInspector)!=null&&lt.enabled),this._reader=null,this._textDivProperties=Te||new WeakMap,this._canceled=!1,this._capability=new B.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:Le.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:se(0,Ce)};const{pageWidth:be,pageHeight:nt,pageX:Ae,pageY:De}=Le.rawDims;this._transform=[1,0,0,-1,-Ae,De+nt],this._pageWidth=be,this._pageHeight=nt,(0,W.setLayerDimensions)(xe,Le),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new B.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new B.AbortException("TextLayer task cancelled."))}_processItems(ke,xe){for(const Le of ke){if(Le.str===void 0){if(Le.type==="beginMarkedContentProps"||Le.type==="beginMarkedContent"){const Se=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),Le.id!==null&&this._container.setAttribute("id",`${Le.id}`),Se.append(this._container)}else Le.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(Le.str),le(this,Le,xe)}}_layoutText(ke){const xe=this._layoutTextParams.properties=this._textDivProperties.get(ke);if(this._layoutTextParams.div=ke,pe(this._layoutTextParams),xe.hasText&&this._container.append(ke),xe.hasEOL){const Le=document.createElement("br");Le.setAttribute("role","presentation"),this._container.append(Le)}}_render(){const ke=new B.PromiseCapability;let xe=Object.create(null);if(this._isReadableStream){const Le=()=>{this._reader.read().then(({value:Se,done:Te})=>{if(Te){ke.resolve();return}Object.assign(xe,Se.styles),this._processItems(Se.items,xe),Le()},ke.reject)};this._reader=this._textContentSource.getReader(),Le()}else if(this._textContentSource){const{items:Le,styles:Se}=this._textContentSource;this._processItems(Le,Se),ke.resolve()}else throw new Error('No "textContentSource" parameter specified.');ke.promise.then(()=>{xe=null,he(this)},this._capability.reject)}}A.TextLayerRenderTask=ue;function ce(me){!me.textContentSource&&(me.textContent||me.textContentStream)&&((0,W.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),me.textContentSource=me.textContent||me.textContentStream);const{container:ke,viewport:xe}=me,Le=getComputedStyle(ke),Se=Le.getPropertyValue("visibility"),Te=parseFloat(Le.getPropertyValue("--scale-factor"));Se==="visible"&&(!Te||Math.abs(Te-xe.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const ge=new ue(me);return ge._render(),ge}function fe({container:me,viewport:ke,textDivs:xe,textDivProperties:Le,isOffscreenCanvasSupported:Se,mustRotate:Te=!0,mustRescale:ge=!0}){if(Te&&(0,W.setLayerDimensions)(me,{rotation:ke.rotation}),ge){const Ce=se(0,Se),nt={prevFontSize:null,prevFontFamily:null,div:null,scale:ke.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Ce};for(const Ae of xe)nt.properties=Le.get(Ae),nt.div=Ae,pe(nt)}}},(g,A,L)=>{var ie,le,pe,he,ue,ce,fe,me,ke,xe,Le,_c,uo,gc,xc;Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationEditorLayer=void 0;var B=L(1),W=L(4),q=L(28),J=L(33),re=L(6),ae=L(34);const be=class be{constructor({uiManager:Ae,pageIndex:De,div:lt,accessibilityManager:Ct,annotationLayer:ft,viewport:Et,l10n:gt}){zt(this,Le);zt(this,ie);zt(this,le,!1);zt(this,pe,null);zt(this,he,this.pointerup.bind(this));zt(this,ue,this.pointerdown.bind(this));zt(this,ce,new Map);zt(this,fe,!1);zt(this,me,!1);zt(this,ke,!1);zt(this,xe);const bt=[q.FreeTextEditor,J.InkEditor,ae.StampEditor];if(!be._initialized){be._initialized=!0;for(const Ie of bt)Ie.initialize(gt)}Ae.registerEditorTypes(bt),Xt(this,xe,Ae),this.pageIndex=De,this.div=lt,Xt(this,ie,Ct),Xt(this,pe,ft),this.viewport=Et,Fe(this,xe).addLayer(this)}get isEmpty(){return Fe(this,ce).size===0}updateToolbar(Ae){Fe(this,xe).updateToolbar(Ae)}updateMode(Ae=Fe(this,xe).getMode()){Mt(this,Le,xc).call(this),Ae===B.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),Ae!==B.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",Ae===B.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",Ae===B.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",Ae===B.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(Ae){if(!Ae&&Fe(this,xe).getMode()!==B.AnnotationEditorType.INK)return;if(!Ae){for(const lt of Fe(this,ce).values())if(lt.isEmpty()){lt.setInBackground();return}}Mt(this,Le,uo).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(Ae){Fe(this,xe).setEditingState(Ae)}addCommands(Ae){Fe(this,xe).addCommands(Ae)}enable(){this.div.style.pointerEvents="auto";const Ae=new Set;for(const lt of Fe(this,ce).values())lt.enableEditing(),lt.annotationElementId&&Ae.add(lt.annotationElementId);if(!Fe(this,pe))return;const De=Fe(this,pe).getEditableAnnotations();for(const lt of De){if(lt.hide(),Fe(this,xe).isDeletedAnnotationElement(lt.data.id)||Ae.has(lt.data.id))continue;const Ct=this.deserialize(lt);Ct&&(this.addOrRebuild(Ct),Ct.enableEditing())}}disable(){var De;Xt(this,ke,!0),this.div.style.pointerEvents="none";const Ae=new Set;for(const lt of Fe(this,ce).values()){if(lt.disableEditing(),!lt.annotationElementId||lt.serialize()!==null){Ae.add(lt.annotationElementId);continue}(De=this.getEditableAnnotation(lt.annotationElementId))==null||De.show(),lt.remove()}if(Fe(this,pe)){const lt=Fe(this,pe).getEditableAnnotations();for(const Ct of lt){const{id:ft}=Ct.data;Ae.has(ft)||Fe(this,xe).isDeletedAnnotationElement(ft)||Ct.show()}}Mt(this,Le,xc).call(this),this.isEmpty&&(this.div.hidden=!0),Xt(this,ke,!1)}getEditableAnnotation(Ae){var De;return((De=Fe(this,pe))==null?void 0:De.getEditableAnnotation(Ae))||null}setActiveEditor(Ae){Fe(this,xe).getActive()!==Ae&&Fe(this,xe).setActiveEditor(Ae)}enableClick(){this.div.addEventListener("pointerdown",Fe(this,ue)),this.div.addEventListener("pointerup",Fe(this,he))}disableClick(){this.div.removeEventListener("pointerdown",Fe(this,ue)),this.div.removeEventListener("pointerup",Fe(this,he))}attach(Ae){Fe(this,ce).set(Ae.id,Ae);const{annotationElementId:De}=Ae;De&&Fe(this,xe).isDeletedAnnotationElement(De)&&Fe(this,xe).removeDeletedAnnotationElement(Ae)}detach(Ae){var De;Fe(this,ce).delete(Ae.id),(De=Fe(this,ie))==null||De.removePointerInTextLayer(Ae.contentDiv),!Fe(this,ke)&&Ae.annotationElementId&&Fe(this,xe).addDeletedAnnotationElement(Ae)}remove(Ae){this.detach(Ae),Fe(this,xe).removeEditor(Ae),Ae.div.contains(document.activeElement)&&setTimeout(()=>{Fe(this,xe).focusMainContainer()},0),Ae.div.remove(),Ae.isAttachedToDOM=!1,Fe(this,me)||this.addInkEditorIfNeeded(!1)}changeParent(Ae){var De;Ae.parent!==this&&(Ae.annotationElementId&&(Fe(this,xe).addDeletedAnnotationElement(Ae.annotationElementId),W.AnnotationEditor.deleteAnnotationElement(Ae),Ae.annotationElementId=null),this.attach(Ae),(De=Ae.parent)==null||De.detach(Ae),Ae.setParent(this),Ae.div&&Ae.isAttachedToDOM&&(Ae.div.remove(),this.div.append(Ae.div)))}add(Ae){if(this.changeParent(Ae),Fe(this,xe).addEditor(Ae),this.attach(Ae),!Ae.isAttachedToDOM){const De=Ae.render();this.div.append(De),Ae.isAttachedToDOM=!0}Ae.fixAndSetPosition(),Ae.onceAdded(),Fe(this,xe).addToAnnotationStorage(Ae)}moveEditorInDOM(Ae){var lt;if(!Ae.isAttachedToDOM)return;const{activeElement:De}=document;Ae.div.contains(De)&&(Ae._focusEventsAllowed=!1,setTimeout(()=>{Ae.div.contains(document.activeElement)?Ae._focusEventsAllowed=!0:(Ae.div.addEventListener("focusin",()=>{Ae._focusEventsAllowed=!0},{once:!0}),De.focus())},0)),Ae._structTreeParentId=(lt=Fe(this,ie))==null?void 0:lt.moveElementInDOM(this.div,Ae.div,Ae.contentDiv,!0)}addOrRebuild(Ae){Ae.needsToBeRebuilt()?Ae.rebuild():this.add(Ae)}addUndoableEditor(Ae){const De=()=>Ae._uiManager.rebuild(Ae),lt=()=>{Ae.remove()};this.addCommands({cmd:De,undo:lt,mustExec:!1})}getNextId(){return Fe(this,xe).getId()}pasteEditor(Ae,De){Fe(this,xe).updateToolbar(Ae),Fe(this,xe).updateMode(Ae);const{offsetX:lt,offsetY:Ct}=Mt(this,Le,gc).call(this),ft=this.getNextId(),Et=Mt(this,Le,_c).call(this,{parent:this,id:ft,x:lt,y:Ct,uiManager:Fe(this,xe),isCentered:!0,...De});Et&&this.add(Et)}deserialize(Ae){switch(Ae.annotationType??Ae.annotationEditorType){case B.AnnotationEditorType.FREETEXT:return q.FreeTextEditor.deserialize(Ae,this,Fe(this,xe));case B.AnnotationEditorType.INK:return J.InkEditor.deserialize(Ae,this,Fe(this,xe));case B.AnnotationEditorType.STAMP:return ae.StampEditor.deserialize(Ae,this,Fe(this,xe))}return null}addNewEditor(){Mt(this,Le,uo).call(this,Mt(this,Le,gc).call(this),!0)}setSelected(Ae){Fe(this,xe).setSelected(Ae)}toggleSelected(Ae){Fe(this,xe).toggleSelected(Ae)}isSelected(Ae){return Fe(this,xe).isSelected(Ae)}unselect(Ae){Fe(this,xe).unselect(Ae)}pointerup(Ae){const{isMac:De}=B.FeatureTest.platform;if(!(Ae.button!==0||Ae.ctrlKey&&De)&&Ae.target===this.div&&Fe(this,fe)){if(Xt(this,fe,!1),!Fe(this,le)){Xt(this,le,!0);return}if(Fe(this,xe).getMode()===B.AnnotationEditorType.STAMP){Fe(this,xe).unselectAll();return}Mt(this,Le,uo).call(this,Ae,!1)}}pointerdown(Ae){if(Fe(this,fe)){Xt(this,fe,!1);return}const{isMac:De}=B.FeatureTest.platform;if(Ae.button!==0||Ae.ctrlKey&&De||Ae.target!==this.div)return;Xt(this,fe,!0);const lt=Fe(this,xe).getActive();Xt(this,le,!lt||lt.isEmpty())}findNewParent(Ae,De,lt){const Ct=Fe(this,xe).findParent(De,lt);return Ct===null||Ct===this?!1:(Ct.changeParent(Ae),!0)}destroy(){var Ae,De;((Ae=Fe(this,xe).getActive())==null?void 0:Ae.parent)===this&&(Fe(this,xe).commitOrRemove(),Fe(this,xe).setActiveEditor(null));for(const lt of Fe(this,ce).values())(De=Fe(this,ie))==null||De.removePointerInTextLayer(lt.contentDiv),lt.setParent(null),lt.isAttachedToDOM=!1,lt.div.remove();this.div=null,Fe(this,ce).clear(),Fe(this,xe).removeLayer(this)}render({viewport:Ae}){this.viewport=Ae,(0,re.setLayerDimensions)(this.div,Ae);for(const De of Fe(this,xe).getEditors(this.pageIndex))this.add(De);this.updateMode()}update({viewport:Ae}){Fe(this,xe).commitOrRemove(),this.viewport=Ae,(0,re.setLayerDimensions)(this.div,{rotation:Ae.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:Ae,pageHeight:De}=this.viewport.rawDims;return[Ae,De]}};ie=new WeakMap,le=new WeakMap,pe=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakMap,fe=new WeakMap,me=new WeakMap,ke=new WeakMap,xe=new WeakMap,Le=new WeakSet,_c=function(Ae){switch(Fe(this,xe).getMode()){case B.AnnotationEditorType.FREETEXT:return new q.FreeTextEditor(Ae);case B.AnnotationEditorType.INK:return new J.InkEditor(Ae);case B.AnnotationEditorType.STAMP:return new ae.StampEditor(Ae)}return null},uo=function(Ae,De){const lt=this.getNextId(),Ct=Mt(this,Le,_c).call(this,{parent:this,id:lt,x:Ae.offsetX,y:Ae.offsetY,uiManager:Fe(this,xe),isCentered:De});return Ct&&this.add(Ct),Ct},gc=function(){const{x:Ae,y:De,width:lt,height:Ct}=this.div.getBoundingClientRect(),ft=Math.max(0,Ae),Et=Math.max(0,De),gt=Math.min(window.innerWidth,Ae+lt),bt=Math.min(window.innerHeight,De+Ct),Ie=(ft+gt)/2-Ae,pt=(Et+bt)/2-De,[at,Ee]=this.viewport.rotation%180===0?[Ie,pt]:[pt,Ie];return{offsetX:at,offsetY:Ee}},xc=function(){Xt(this,me,!0);for(const Ae of Fe(this,ce).values())Ae.isEmpty()&&Ae.remove();Xt(this,me,!1)},Kr(be,"_initialized",!1);let se=be;A.AnnotationEditorLayer=se},(g,A,L)=>{var ae,se,ie,le,pe,he,ue,ce,fe,me,m0,_0,g0,Qi,vc,x0,wc;Object.defineProperty(A,"__esModule",{value:!0}),A.FreeTextEditor=void 0;var B=L(1),W=L(5),q=L(4),J=L(29);const be=class be extends q.AnnotationEditor{constructor(De){super({...De,name:"freeTextEditor"});zt(this,me);zt(this,ae,this.editorDivBlur.bind(this));zt(this,se,this.editorDivFocus.bind(this));zt(this,ie,this.editorDivInput.bind(this));zt(this,le,this.editorDivKeydown.bind(this));zt(this,pe);zt(this,he,"");zt(this,ue,`${this.id}-editor`);zt(this,ce);zt(this,fe,null);Xt(this,pe,De.color||be._defaultColor||q.AnnotationEditor._defaultLineColor),Xt(this,ce,De.fontSize||be._defaultFontSize)}static get _keyboardManager(){const De=be.prototype,lt=Et=>Et.isEmpty(),Ct=W.AnnotationEditorUIManager.TRANSLATE_SMALL,ft=W.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,B.shadow)(this,"_keyboardManager",new W.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],De.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],De.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],De._translateEmpty,{args:[-Ct,0],checker:lt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],De._translateEmpty,{args:[-ft,0],checker:lt}],[["ArrowRight","mac+ArrowRight"],De._translateEmpty,{args:[Ct,0],checker:lt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],De._translateEmpty,{args:[ft,0],checker:lt}],[["ArrowUp","mac+ArrowUp"],De._translateEmpty,{args:[0,-Ct],checker:lt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],De._translateEmpty,{args:[0,-ft],checker:lt}],[["ArrowDown","mac+ArrowDown"],De._translateEmpty,{args:[0,Ct],checker:lt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],De._translateEmpty,{args:[0,ft],checker:lt}]]))}static initialize(De){q.AnnotationEditor.initialize(De,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const lt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(lt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(De,lt){switch(De){case B.AnnotationEditorParamsType.FREETEXT_SIZE:be._defaultFontSize=lt;break;case B.AnnotationEditorParamsType.FREETEXT_COLOR:be._defaultColor=lt;break}}updateParams(De,lt){switch(De){case B.AnnotationEditorParamsType.FREETEXT_SIZE:Mt(this,me,m0).call(this,lt);break;case B.AnnotationEditorParamsType.FREETEXT_COLOR:Mt(this,me,_0).call(this,lt);break}}static get defaultPropertiesToUpdate(){return[[B.AnnotationEditorParamsType.FREETEXT_SIZE,be._defaultFontSize],[B.AnnotationEditorParamsType.FREETEXT_COLOR,be._defaultColor||q.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[B.AnnotationEditorParamsType.FREETEXT_SIZE,Fe(this,ce)],[B.AnnotationEditorParamsType.FREETEXT_COLOR,Fe(this,pe)]]}_translateEmpty(De,lt){this._uiManager.translateSelectedEditors(De,lt,!0)}getInitialTranslation(){const De=this.parentScale;return[-be._internalPadding*De,-(be._internalPadding+Fe(this,ce))*De]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(B.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",Fe(this,le)),this.editorDiv.addEventListener("focus",Fe(this,se)),this.editorDiv.addEventListener("blur",Fe(this,ae)),this.editorDiv.addEventListener("input",Fe(this,ie)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Fe(this,ue)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",Fe(this,le)),this.editorDiv.removeEventListener("focus",Fe(this,se)),this.editorDiv.removeEventListener("blur",Fe(this,ae)),this.editorDiv.removeEventListener("input",Fe(this,ie)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(De){this._focusEventsAllowed&&(super.focusin(De),De.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var De;if(this.width){Mt(this,me,wc).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(De=this._initialOptions)!=null&&De.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const De=Fe(this,he),lt=Xt(this,he,Mt(this,me,g0).call(this).trimEnd());if(De===lt)return;const Ct=ft=>{if(Xt(this,he,ft),!ft){this.remove();return}Mt(this,me,vc).call(this),this._uiManager.rebuild(this),Mt(this,me,Qi).call(this)};this.addCommands({cmd:()=>{Ct(lt)},undo:()=>{Ct(De)},mustExec:!1}),Mt(this,me,Qi).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(De){this.enterInEditMode()}keydown(De){De.target===this.div&&De.key==="Enter"&&(this.enterInEditMode(),De.preventDefault())}editorDivKeydown(De){be._keyboardManager.exec(this,De)}editorDivFocus(De){this.isEditing=!0}editorDivBlur(De){this.isEditing=!1}editorDivInput(De){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let De,lt;this.width&&(De=this.x,lt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Fe(this,ue)),this.enableEditing(),q.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(ft=>{var Et;return(Et=this.editorDiv)==null?void 0:Et.setAttribute("aria-label",ft)}),q.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(ft=>{var Et;return(Et=this.editorDiv)==null?void 0:Et.setAttribute("default-content",ft)}),this.editorDiv.contentEditable=!0;const{style:Ct}=this.editorDiv;if(Ct.fontSize=`calc(${Fe(this,ce)}px * var(--scale-factor))`,Ct.color=Fe(this,pe),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,W.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ft,Et]=this.parentDimensions;if(this.annotationElementId){const{position:gt}=Fe(this,fe);let[bt,Ie]=this.getInitialTranslation();[bt,Ie]=this.pageTranslationToScreen(bt,Ie);const[pt,at]=this.pageDimensions,[Ee,ye]=this.pageTranslation;let ve,Pe;switch(this.rotation){case 0:ve=De+(gt[0]-Ee)/pt,Pe=lt+this.height-(gt[1]-ye)/at;break;case 90:ve=De+(gt[0]-Ee)/pt,Pe=lt-(gt[1]-ye)/at,[bt,Ie]=[Ie,-bt];break;case 180:ve=De-this.width+(gt[0]-Ee)/pt,Pe=lt-(gt[1]-ye)/at,[bt,Ie]=[-bt,-Ie];break;case 270:ve=De+(gt[0]-Ee-this.height*at)/pt,Pe=lt+(gt[1]-ye-this.width*pt)/at,[bt,Ie]=[-Ie,bt];break}this.setAt(ve*ft,Pe*Et,bt,Ie)}else this.setAt(De*ft,lt*Et,this.width*ft,this.height*Et);Mt(this,me,vc).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(De,lt,Ct){let ft=null;if(De instanceof J.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:gt,fontColor:bt},rect:Ie,rotation:pt,id:at},textContent:Ee,textPosition:ye,parent:{page:{pageNumber:ve}}}=De;if(!Ee||Ee.length===0)return null;ft=De={annotationType:B.AnnotationEditorType.FREETEXT,color:Array.from(bt),fontSize:gt,value:Ee.join(`
`),position:ye,pageIndex:ve-1,rect:Ie,rotation:pt,id:at,deleted:!1}}const Et=super.deserialize(De,lt,Ct);return Xt(Et,ce,De.fontSize),Xt(Et,pe,B.Util.makeHexColor(...De.color)),Xt(Et,he,De.value),Et.annotationElementId=De.id||null,Xt(Et,fe,ft),Et}serialize(De=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const lt=be._internalPadding*this.parentScale,Ct=this.getRect(lt,lt),ft=q.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:Fe(this,pe)),Et={annotationType:B.AnnotationEditorType.FREETEXT,color:ft,fontSize:Fe(this,ce),value:Fe(this,he),pageIndex:this.pageIndex,rect:Ct,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return De?Et:this.annotationElementId&&!Mt(this,me,x0).call(this,Et)?null:(Et.id=this.annotationElementId,Et)}};ae=new WeakMap,se=new WeakMap,ie=new WeakMap,le=new WeakMap,pe=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakMap,fe=new WeakMap,me=new WeakSet,m0=function(De){const lt=ft=>{this.editorDiv.style.fontSize=`calc(${ft}px * var(--scale-factor))`,this.translate(0,-(ft-Fe(this,ce))*this.parentScale),Xt(this,ce,ft),Mt(this,me,Qi).call(this)},Ct=Fe(this,ce);this.addCommands({cmd:()=>{lt(De)},undo:()=>{lt(Ct)},mustExec:!0,type:B.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},_0=function(De){const lt=Fe(this,pe);this.addCommands({cmd:()=>{Xt(this,pe,this.editorDiv.style.color=De)},undo:()=>{Xt(this,pe,this.editorDiv.style.color=lt)},mustExec:!0,type:B.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g0=function(){const De=this.editorDiv.getElementsByTagName("div");if(De.length===0)return this.editorDiv.innerText;const lt=[];for(const Ct of De)lt.push(Ct.innerText.replace(/\r\n?|\n/,""));return lt.join(`
`)},Qi=function(){const[De,lt]=this.parentDimensions;let Ct;if(this.isAttachedToDOM)Ct=this.div.getBoundingClientRect();else{const{currentLayer:ft,div:Et}=this,gt=Et.style.display;Et.style.display="hidden",ft.div.append(this.div),Ct=Et.getBoundingClientRect(),Et.remove(),Et.style.display=gt}this.rotation%180===this.parentRotation%180?(this.width=Ct.width/De,this.height=Ct.height/lt):(this.width=Ct.height/De,this.height=Ct.width/lt),this.fixAndSetPosition()},vc=function(){if(this.editorDiv.replaceChildren(),!!Fe(this,he))for(const De of Fe(this,he).split(`
`)){const lt=document.createElement("div");lt.append(De?document.createTextNode(De):document.createElement("br")),this.editorDiv.append(lt)}},x0=function(De){const{value:lt,fontSize:Ct,color:ft,rect:Et,pageIndex:gt}=Fe(this,fe);return De.value!==lt||De.fontSize!==Ct||De.rect.some((bt,Ie)=>Math.abs(bt-Et[Ie])>=1)||De.color.some((bt,Ie)=>bt!==ft[Ie])||De.pageIndex!==gt},wc=function(De=!1){if(!this.annotationElementId)return;if(Mt(this,me,Qi).call(this),!De&&(this.width===0||this.height===0)){setTimeout(()=>Mt(this,me,wc).call(this,!0),0);return}const lt=be._internalPadding*this.parentScale;Fe(this,fe).rect=this.getRect(lt,lt)},Kr(be,"_freeTextDefaultContent",""),Kr(be,"_internalPadding",0),Kr(be,"_defaultColor",null),Kr(be,"_defaultFontSize",10),Kr(be,"_type","freetext");let re=be;A.FreeTextEditor=re},(g,A,L)=>{var Pe,st,Ua,v0,At,It,it,Vt,Yt,Zt,Lt,Ft,ht,kt,Dt,Bt,Qt,or,ar,Nt,fr,ur,w0,fo,yc,Ec,br,Ir,zr,lr,Ht,$t,kr,Sc,Ur,Tt,rr,hr,y0,kc;Object.defineProperty(A,"__esModule",{value:!0}),A.StampAnnotationElement=A.InkAnnotationElement=A.FreeTextAnnotationElement=A.AnnotationLayer=void 0;var B=L(1),W=L(6),q=L(3),J=L(30),re=L(31),ae=L(32);const se=1e3,ie=9,le=new WeakSet;function pe(yr){return{width:yr[2]-yr[0],height:yr[3]-yr[1]}}class he{static create(St){switch(St.data.annotationType){case B.AnnotationType.LINK:return new ce(St);case B.AnnotationType.TEXT:return new fe(St);case B.AnnotationType.WIDGET:switch(St.data.fieldType){case"Tx":return new ke(St);case"Btn":return St.data.radioButton?new Se(St):St.data.checkBox?new Le(St):new Te(St);case"Ch":return new ge(St);case"Sig":return new xe(St)}return new me(St);case B.AnnotationType.POPUP:return new Ce(St);case B.AnnotationType.FREETEXT:return new nt(St);case B.AnnotationType.LINE:return new Ae(St);case B.AnnotationType.SQUARE:return new De(St);case B.AnnotationType.CIRCLE:return new lt(St);case B.AnnotationType.POLYLINE:return new Ct(St);case B.AnnotationType.CARET:return new Et(St);case B.AnnotationType.INK:return new gt(St);case B.AnnotationType.POLYGON:return new ft(St);case B.AnnotationType.HIGHLIGHT:return new bt(St);case B.AnnotationType.UNDERLINE:return new Ie(St);case B.AnnotationType.SQUIGGLY:return new pt(St);case B.AnnotationType.STRIKEOUT:return new at(St);case B.AnnotationType.STAMP:return new Ee(St);case B.AnnotationType.FILEATTACHMENT:return new ye(St);default:return new ue(St)}}}const rt=class rt{constructor(St,{isRenderable:xt=!1,ignoreBorder:Pt=!1,createQuadrilaterals:Gt=!1}={}){zt(this,Pe,!1);this.isRenderable=xt,this.data=St.data,this.layer=St.layer,this.linkService=St.linkService,this.downloadManager=St.downloadManager,this.imageResourcesPath=St.imageResourcesPath,this.renderForms=St.renderForms,this.svgFactory=St.svgFactory,this.annotationStorage=St.annotationStorage,this.enableScripting=St.enableScripting,this.hasJSActions=St.hasJSActions,this._fieldObjects=St.fieldObjects,this.parent=St.parent,xt&&(this.container=this._createContainer(Pt)),Gt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:St,contentsObj:xt,richText:Pt}){return!!(St!=null&&St.str||xt!=null&&xt.str||Pt!=null&&Pt.str)}get hasPopupData(){return rt._hasPopupData(this.data)}_createContainer(St){const{data:xt,parent:{page:Pt,viewport:Gt}}=this,qt=document.createElement("section");qt.setAttribute("data-annotation-id",xt.id),this instanceof me||(qt.tabIndex=se),qt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&qt.setAttribute("aria-haspopup","dialog"),xt.noRotate&&qt.classList.add("norotate");const{pageWidth:sr,pageHeight:cr,pageX:Tr,pageY:Ar}=Gt.rawDims;if(!xt.rect||this instanceof Ce){const{rotation:wt}=xt;return!xt.hasOwnCanvas&&wt!==0&&this.setRotation(wt,qt),qt}const{width:Oe,height:vt}=pe(xt.rect),ut=B.Util.normalizeRect([xt.rect[0],Pt.view[3]-xt.rect[1]+Pt.view[1],xt.rect[2],Pt.view[3]-xt.rect[3]+Pt.view[1]]);if(!St&&xt.borderStyle.width>0){qt.style.borderWidth=`${xt.borderStyle.width}px`;const wt=xt.borderStyle.horizontalCornerRadius,yt=xt.borderStyle.verticalCornerRadius;if(wt>0||yt>0){const tr=`calc(${wt}px * var(--scale-factor)) / calc(${yt}px * var(--scale-factor))`;qt.style.borderRadius=tr}else if(this instanceof Se){const tr=`calc(${Oe}px * var(--scale-factor)) / calc(${vt}px * var(--scale-factor))`;qt.style.borderRadius=tr}switch(xt.borderStyle.style){case B.AnnotationBorderStyleType.SOLID:qt.style.borderStyle="solid";break;case B.AnnotationBorderStyleType.DASHED:qt.style.borderStyle="dashed";break;case B.AnnotationBorderStyleType.BEVELED:(0,B.warn)("Unimplemented border style: beveled");break;case B.AnnotationBorderStyleType.INSET:(0,B.warn)("Unimplemented border style: inset");break;case B.AnnotationBorderStyleType.UNDERLINE:qt.style.borderBottomStyle="solid";break}const Ut=xt.borderColor||null;Ut?(Xt(this,Pe,!0),qt.style.borderColor=B.Util.makeHexColor(Ut[0]|0,Ut[1]|0,Ut[2]|0)):qt.style.borderWidth=0}qt.style.left=`${100*(ut[0]-Tr)/sr}%`,qt.style.top=`${100*(ut[1]-Ar)/cr}%`;const{rotation:dt}=xt;return xt.hasOwnCanvas||dt===0?(qt.style.width=`${100*Oe/sr}%`,qt.style.height=`${100*vt/cr}%`):this.setRotation(dt,qt),qt}setRotation(St,xt=this.container){if(!this.data.rect)return;const{pageWidth:Pt,pageHeight:Gt}=this.parent.viewport.rawDims,{width:qt,height:sr}=pe(this.data.rect);let cr,Tr;St%180===0?(cr=100*qt/Pt,Tr=100*sr/Gt):(cr=100*sr/Pt,Tr=100*qt/Gt),xt.style.width=`${cr}%`,xt.style.height=`${Tr}%`,xt.setAttribute("data-main-rotation",(360-St)%360)}get _commonActions(){const St=(xt,Pt,Gt)=>{const qt=Gt.detail[xt],sr=qt[0],cr=qt.slice(1);Gt.target.style[Pt]=J.ColorConverters[`${sr}_HTML`](cr),this.annotationStorage.setValue(this.data.id,{[Pt]:J.ColorConverters[`${sr}_rgb`](cr)})};return(0,B.shadow)(this,"_commonActions",{display:xt=>{const{display:Pt}=xt.detail,Gt=Pt%2===1;this.container.style.visibility=Gt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Gt,noPrint:Pt===1||Pt===2})},print:xt=>{this.annotationStorage.setValue(this.data.id,{noPrint:!xt.detail.print})},hidden:xt=>{const{hidden:Pt}=xt.detail;this.container.style.visibility=Pt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Pt,noView:Pt})},focus:xt=>{setTimeout(()=>xt.target.focus({preventScroll:!1}),0)},userName:xt=>{xt.target.title=xt.detail.userName},readonly:xt=>{xt.target.disabled=xt.detail.readonly},required:xt=>{this._setRequired(xt.target,xt.detail.required)},bgColor:xt=>{St("bgColor","backgroundColor",xt)},fillColor:xt=>{St("fillColor","backgroundColor",xt)},fgColor:xt=>{St("fgColor","color",xt)},textColor:xt=>{St("textColor","color",xt)},borderColor:xt=>{St("borderColor","borderColor",xt)},strokeColor:xt=>{St("strokeColor","borderColor",xt)},rotation:xt=>{const Pt=xt.detail.rotation;this.setRotation(Pt),this.annotationStorage.setValue(this.data.id,{rotation:Pt})}})}_dispatchEventFromSandbox(St,xt){const Pt=this._commonActions;for(const Gt of Object.keys(xt.detail)){const qt=St[Gt]||Pt[Gt];qt==null||qt(xt)}}_setDefaultPropertiesFromJS(St){if(!this.enableScripting)return;const xt=this.annotationStorage.getRawValue(this.data.id);if(!xt)return;const Pt=this._commonActions;for(const[Gt,qt]of Object.entries(xt)){const sr=Pt[Gt];if(sr){const cr={detail:{[Gt]:qt},target:St};sr(cr),delete xt[Gt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:St}=this.data;if(!St)return;const[xt,Pt,Gt,qt]=this.data.rect;if(St.length===1){const[,{x:yt,y:Ut},{x:tr,y:Kt}]=St[0];if(Gt===yt&&qt===Ut&&xt===tr&&Pt===Kt)return}const{style:sr}=this.container;let cr;if(Fe(this,Pe)){const{borderColor:yt,borderWidth:Ut}=sr;sr.borderWidth=0,cr=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${yt}" stroke-width="${Ut}">`],this.container.classList.add("hasBorder")}const Tr=Gt-xt,Ar=qt-Pt,{svgFactory:Oe}=this,vt=Oe.createElement("svg");vt.classList.add("quadrilateralsContainer"),vt.setAttribute("width",0),vt.setAttribute("height",0);const ut=Oe.createElement("defs");vt.append(ut);const dt=Oe.createElement("clipPath"),wt=`clippath_${this.data.id}`;dt.setAttribute("id",wt),dt.setAttribute("clipPathUnits","objectBoundingBox"),ut.append(dt);for(const[,{x:yt,y:Ut},{x:tr,y:Kt}]of St){const jt=Oe.createElement("rect"),er=(tr-xt)/Tr,pr=(qt-Ut)/Ar,wr=(yt-tr)/Tr,Lr=(Ut-Kt)/Ar;jt.setAttribute("x",er),jt.setAttribute("y",pr),jt.setAttribute("width",wr),jt.setAttribute("height",Lr),dt.append(jt),cr==null||cr.push(`<rect vector-effect="non-scaling-stroke" x="${er}" y="${pr}" width="${wr}" height="${Lr}"/>`)}Fe(this,Pe)&&(cr.push("</g></svg>')"),sr.backgroundImage=cr.join("")),this.container.append(vt),this.container.style.clipPath=`url(#${wt})`}_createPopup(){const{container:St,data:xt}=this;St.setAttribute("aria-haspopup","dialog");const Pt=new Ce({data:{color:xt.color,titleObj:xt.titleObj,modificationDate:xt.modificationDate,contentsObj:xt.contentsObj,richText:xt.richText,parentRect:xt.rect,borderStyle:0,id:`popup_${xt.id}`,rotation:xt.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Pt.render())}render(){(0,B.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(St,xt=null){const Pt=[];if(this._fieldObjects){const Gt=this._fieldObjects[St];if(Gt)for(const{page:qt,id:sr,exportValues:cr}of Gt){if(qt===-1||sr===xt)continue;const Tr=typeof cr=="string"?cr:null,Ar=document.querySelector(`[data-element-id="${sr}"]`);if(Ar&&!le.has(Ar)){(0,B.warn)(`_getElementsByName - element not allowed: ${sr}`);continue}Pt.push({id:sr,exportValue:Tr,domElement:Ar})}return Pt}for(const Gt of document.getElementsByName(St)){const{exportValue:qt}=Gt,sr=Gt.getAttribute("data-element-id");sr!==xt&&le.has(Gt)&&Pt.push({id:sr,exportValue:qt,domElement:Gt})}return Pt}show(){var St;this.container&&(this.container.hidden=!1),(St=this.popup)==null||St.maybeShow()}hide(){var St;this.container&&(this.container.hidden=!0),(St=this.popup)==null||St.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const St=this.getElementsToTriggerPopup();if(Array.isArray(St))for(const xt of St)xt.classList.add("highlightArea");else St.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:St,data:{id:xt}}=this;this.container.addEventListener("dblclick",()=>{var Pt;(Pt=this.linkService.eventBus)==null||Pt.dispatch("switchannotationeditormode",{source:this,mode:St,editId:xt})})}};Pe=new WeakMap;let ue=rt;class ce extends ue{constructor(xt,Pt=null){super(xt,{isRenderable:!0,ignoreBorder:!!(Pt!=null&&Pt.ignoreBorder),createQuadrilaterals:!0});zt(this,st);this.isTooltipOnly=xt.data.isTooltipOnly}render(){const{data:xt,linkService:Pt}=this,Gt=document.createElement("a");Gt.setAttribute("data-element-id",xt.id);let qt=!1;return xt.url?(Pt.addLinkAttributes(Gt,xt.url,xt.newWindow),qt=!0):xt.action?(this._bindNamedAction(Gt,xt.action),qt=!0):xt.attachment?(this._bindAttachment(Gt,xt.attachment),qt=!0):xt.setOCGState?(Mt(this,st,v0).call(this,Gt,xt.setOCGState),qt=!0):xt.dest?(this._bindLink(Gt,xt.dest),qt=!0):(xt.actions&&(xt.actions.Action||xt.actions["Mouse Up"]||xt.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Gt,xt),qt=!0),xt.resetForm?(this._bindResetFormAction(Gt,xt.resetForm),qt=!0):this.isTooltipOnly&&!qt&&(this._bindLink(Gt,""),qt=!0)),this.container.classList.add("linkAnnotation"),qt&&this.container.append(Gt),this.container}_bindLink(xt,Pt){xt.href=this.linkService.getDestinationHash(Pt),xt.onclick=()=>(Pt&&this.linkService.goToDestination(Pt),!1),(Pt||Pt==="")&&Mt(this,st,Ua).call(this)}_bindNamedAction(xt,Pt){xt.href=this.linkService.getAnchorUrl(""),xt.onclick=()=>(this.linkService.executeNamedAction(Pt),!1),Mt(this,st,Ua).call(this)}_bindAttachment(xt,Pt){xt.href=this.linkService.getAnchorUrl(""),xt.onclick=()=>{var Gt;return(Gt=this.downloadManager)==null||Gt.openOrDownloadData(this.container,Pt.content,Pt.filename),!1},Mt(this,st,Ua).call(this)}_bindJSAction(xt,Pt){xt.href=this.linkService.getAnchorUrl("");const Gt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const qt of Object.keys(Pt.actions)){const sr=Gt.get(qt);sr&&(xt[sr]=()=>{var cr;return(cr=this.linkService.eventBus)==null||cr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Pt.id,name:qt}}),!1})}xt.onclick||(xt.onclick=()=>!1),Mt(this,st,Ua).call(this)}_bindResetFormAction(xt,Pt){const Gt=xt.onclick;if(Gt||(xt.href=this.linkService.getAnchorUrl("")),Mt(this,st,Ua).call(this),!this._fieldObjects){(0,B.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Gt||(xt.onclick=()=>!1);return}xt.onclick=()=>{var vt;Gt==null||Gt();const{fields:qt,refs:sr,include:cr}=Pt,Tr=[];if(qt.length!==0||sr.length!==0){const ut=new Set(sr);for(const dt of qt){const wt=this._fieldObjects[dt]||[];for(const{id:yt}of wt)ut.add(yt)}for(const dt of Object.values(this._fieldObjects))for(const wt of dt)ut.has(wt.id)===cr&&Tr.push(wt)}else for(const ut of Object.values(this._fieldObjects))Tr.push(...ut);const Ar=this.annotationStorage,Oe=[];for(const ut of Tr){const{id:dt}=ut;switch(Oe.push(dt),ut.type){case"text":{const yt=ut.defaultValue||"";Ar.setValue(dt,{value:yt});break}case"checkbox":case"radiobutton":{const yt=ut.defaultValue===ut.exportValues;Ar.setValue(dt,{value:yt});break}case"combobox":case"listbox":{const yt=ut.defaultValue||"";Ar.setValue(dt,{value:yt});break}default:continue}const wt=document.querySelector(`[data-element-id="${dt}"]`);if(wt){if(!le.has(wt)){(0,B.warn)(`_bindResetFormAction - element not allowed: ${dt}`);continue}}else continue;wt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Oe,name:"ResetForm"}})),!1}}}st=new WeakSet,Ua=function(){this.container.setAttribute("data-internal-link","")},v0=function(xt,Pt){xt.href=this.linkService.getAnchorUrl(""),xt.onclick=()=>(this.linkService.executeSetOCGState(Pt),!1),Mt(this,st,Ua).call(this)};class fe extends ue{constructor(St){super(St,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const St=document.createElement("img");return St.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",St.alt="[{{type}} Annotation]",St.dataset.l10nId="text_annotation_type",St.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(St),this.container}}class me extends ue{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(St){var xt;this.data.hasOwnCanvas&&(((xt=St.previousSibling)==null?void 0:xt.nodeName)==="CANVAS"&&(St.previousSibling.hidden=!0),St.hidden=!1)}_getKeyModifier(St){const{isWin:xt,isMac:Pt}=B.FeatureTest.platform;return xt&&St.ctrlKey||Pt&&St.metaKey}_setEventListener(St,xt,Pt,Gt,qt){Pt.includes("mouse")?St.addEventListener(Pt,sr=>{var cr;(cr=this.linkService.eventBus)==null||cr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Gt,value:qt(sr),shift:sr.shiftKey,modifier:this._getKeyModifier(sr)}})}):St.addEventListener(Pt,sr=>{var cr;if(Pt==="blur"){if(!xt.focused||!sr.relatedTarget)return;xt.focused=!1}else if(Pt==="focus"){if(xt.focused)return;xt.focused=!0}qt&&((cr=this.linkService.eventBus)==null||cr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Gt,value:qt(sr)}}))})}_setEventListeners(St,xt,Pt,Gt){var qt,sr,cr;for(const[Tr,Ar]of Pt)(Ar==="Action"||(qt=this.data.actions)!=null&&qt[Ar])&&((Ar==="Focus"||Ar==="Blur")&&(xt||(xt={focused:!1})),this._setEventListener(St,xt,Tr,Ar,Gt),Ar==="Focus"&&!((sr=this.data.actions)!=null&&sr.Blur)?this._setEventListener(St,xt,"blur","Blur",null):Ar==="Blur"&&!((cr=this.data.actions)!=null&&cr.Focus)&&this._setEventListener(St,xt,"focus","Focus",null))}_setBackgroundColor(St){const xt=this.data.backgroundColor||null;St.style.backgroundColor=xt===null?"transparent":B.Util.makeHexColor(xt[0],xt[1],xt[2])}_setTextStyle(St){const xt=["left","center","right"],{fontColor:Pt}=this.data.defaultAppearanceData,Gt=this.data.defaultAppearanceData.fontSize||ie,qt=St.style;let sr;const cr=2,Tr=Ar=>Math.round(10*Ar)/10;if(this.data.multiLine){const Ar=Math.abs(this.data.rect[3]-this.data.rect[1]-cr),Oe=Math.round(Ar/(B.LINE_FACTOR*Gt))||1,vt=Ar/Oe;sr=Math.min(Gt,Tr(vt/B.LINE_FACTOR))}else{const Ar=Math.abs(this.data.rect[3]-this.data.rect[1]-cr);sr=Math.min(Gt,Tr(Ar/B.LINE_FACTOR))}qt.fontSize=`calc(${sr}px * var(--scale-factor))`,qt.color=B.Util.makeHexColor(Pt[0],Pt[1],Pt[2]),this.data.textAlignment!==null&&(qt.textAlign=xt[this.data.textAlignment])}_setRequired(St,xt){xt?St.setAttribute("required",!0):St.removeAttribute("required"),St.setAttribute("aria-required",xt)}}class ke extends me{constructor(St){const xt=St.renderForms||!St.data.hasAppearance&&!!St.data.fieldValue;super(St,{isRenderable:xt})}setPropertyOnSiblings(St,xt,Pt,Gt){const qt=this.annotationStorage;for(const sr of this._getElementsByName(St.name,St.id))sr.domElement&&(sr.domElement[xt]=Pt),qt.setValue(sr.id,{[Gt]:Pt})}render(){var Gt,qt;const St=this.annotationStorage,xt=this.data.id;this.container.classList.add("textWidgetAnnotation");let Pt=null;if(this.renderForms){const sr=St.getValue(xt,{value:this.data.fieldValue});let cr=sr.value||"";const Tr=St.getValue(xt,{charLimit:this.data.maxLen}).charLimit;Tr&&cr.length>Tr&&(cr=cr.slice(0,Tr));let Ar=sr.formattedValue||((Gt=this.data.textContent)==null?void 0:Gt.join(`
`))||null;Ar&&this.data.comb&&(Ar=Ar.replaceAll(/\s+/g,""));const Oe={userValue:cr,formattedValue:Ar,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Pt=document.createElement("textarea"),Pt.textContent=Ar??cr,this.data.doNotScroll&&(Pt.style.overflowY="hidden")):(Pt=document.createElement("input"),Pt.type="text",Pt.setAttribute("value",Ar??cr),this.data.doNotScroll&&(Pt.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Pt.hidden=!0),le.add(Pt),Pt.setAttribute("data-element-id",xt),Pt.disabled=this.data.readOnly,Pt.name=this.data.fieldName,Pt.tabIndex=se,this._setRequired(Pt,this.data.required),Tr&&(Pt.maxLength=Tr),Pt.addEventListener("input",ut=>{St.setValue(xt,{value:ut.target.value}),this.setPropertyOnSiblings(Pt,"value",ut.target.value,"value"),Oe.formattedValue=null}),Pt.addEventListener("resetform",ut=>{const dt=this.data.defaultFieldValue??"";Pt.value=Oe.userValue=dt,Oe.formattedValue=null});let vt=ut=>{const{formattedValue:dt}=Oe;dt!=null&&(ut.target.value=dt),ut.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Pt.addEventListener("focus",dt=>{if(Oe.focused)return;const{target:wt}=dt;Oe.userValue&&(wt.value=Oe.userValue),Oe.lastCommittedValue=wt.value,Oe.commitKey=1,Oe.focused=!0}),Pt.addEventListener("updatefromsandbox",dt=>{this.showElementAndHideCanvas(dt.target);const wt={value(yt){Oe.userValue=yt.detail.value??"",St.setValue(xt,{value:Oe.userValue.toString()}),yt.target.value=Oe.userValue},formattedValue(yt){const{formattedValue:Ut}=yt.detail;Oe.formattedValue=Ut,Ut!=null&&yt.target!==document.activeElement&&(yt.target.value=Ut),St.setValue(xt,{formattedValue:Ut})},selRange(yt){yt.target.setSelectionRange(...yt.detail.selRange)},charLimit:yt=>{var jt;const{charLimit:Ut}=yt.detail,{target:tr}=yt;if(Ut===0){tr.removeAttribute("maxLength");return}tr.setAttribute("maxLength",Ut);let Kt=Oe.userValue;!Kt||Kt.length<=Ut||(Kt=Kt.slice(0,Ut),tr.value=Oe.userValue=Kt,St.setValue(xt,{value:Kt}),(jt=this.linkService.eventBus)==null||jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:xt,name:"Keystroke",value:Kt,willCommit:!0,commitKey:1,selStart:tr.selectionStart,selEnd:tr.selectionEnd}}))}};this._dispatchEventFromSandbox(wt,dt)}),Pt.addEventListener("keydown",dt=>{var Ut;Oe.commitKey=1;let wt=-1;if(dt.key==="Escape"?wt=0:dt.key==="Enter"&&!this.data.multiLine?wt=2:dt.key==="Tab"&&(Oe.commitKey=3),wt===-1)return;const{value:yt}=dt.target;Oe.lastCommittedValue!==yt&&(Oe.lastCommittedValue=yt,Oe.userValue=yt,(Ut=this.linkService.eventBus)==null||Ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:xt,name:"Keystroke",value:yt,willCommit:!0,commitKey:wt,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}}))});const ut=vt;vt=null,Pt.addEventListener("blur",dt=>{var yt;if(!Oe.focused||!dt.relatedTarget)return;Oe.focused=!1;const{value:wt}=dt.target;Oe.userValue=wt,Oe.lastCommittedValue!==wt&&((yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:xt,name:"Keystroke",value:wt,willCommit:!0,commitKey:Oe.commitKey,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}})),ut(dt)}),(qt=this.data.actions)!=null&&qt.Keystroke&&Pt.addEventListener("beforeinput",dt=>{var pr;Oe.lastCommittedValue=null;const{data:wt,target:yt}=dt,{value:Ut,selectionStart:tr,selectionEnd:Kt}=yt;let jt=tr,er=Kt;switch(dt.inputType){case"deleteWordBackward":{const wr=Ut.substring(0,tr).match(/\w*[^\w]*$/);wr&&(jt-=wr[0].length);break}case"deleteWordForward":{const wr=Ut.substring(tr).match(/^[^\w]*\w*/);wr&&(er+=wr[0].length);break}case"deleteContentBackward":tr===Kt&&(jt-=1);break;case"deleteContentForward":tr===Kt&&(er+=1);break}dt.preventDefault(),(pr=this.linkService.eventBus)==null||pr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:xt,name:"Keystroke",value:Ut,change:wt||"",willCommit:!1,selStart:jt,selEnd:er}})}),this._setEventListeners(Pt,Oe,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dt=>dt.target.value)}if(vt&&Pt.addEventListener("blur",vt),this.data.comb){const dt=(this.data.rect[2]-this.data.rect[0])/Tr;Pt.classList.add("comb"),Pt.style.letterSpacing=`calc(${dt}px * var(--scale-factor) - 1ch)`}}else Pt=document.createElement("div"),Pt.textContent=this.data.fieldValue,Pt.style.verticalAlign="middle",Pt.style.display="table-cell";return this._setTextStyle(Pt),this._setBackgroundColor(Pt),this._setDefaultPropertiesFromJS(Pt),this.container.append(Pt),this.container}}class xe extends me{constructor(St){super(St,{isRenderable:!!St.data.hasOwnCanvas})}}class Le extends me{constructor(St){super(St,{isRenderable:St.renderForms})}render(){const St=this.annotationStorage,xt=this.data,Pt=xt.id;let Gt=St.getValue(Pt,{value:xt.exportValue===xt.fieldValue}).value;typeof Gt=="string"&&(Gt=Gt!=="Off",St.setValue(Pt,{value:Gt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const qt=document.createElement("input");return le.add(qt),qt.setAttribute("data-element-id",Pt),qt.disabled=xt.readOnly,this._setRequired(qt,this.data.required),qt.type="checkbox",qt.name=xt.fieldName,Gt&&qt.setAttribute("checked",!0),qt.setAttribute("exportValue",xt.exportValue),qt.tabIndex=se,qt.addEventListener("change",sr=>{const{name:cr,checked:Tr}=sr.target;for(const Ar of this._getElementsByName(cr,Pt)){const Oe=Tr&&Ar.exportValue===xt.exportValue;Ar.domElement&&(Ar.domElement.checked=Oe),St.setValue(Ar.id,{value:Oe})}St.setValue(Pt,{value:Tr})}),qt.addEventListener("resetform",sr=>{const cr=xt.defaultFieldValue||"Off";sr.target.checked=cr===xt.exportValue}),this.enableScripting&&this.hasJSActions&&(qt.addEventListener("updatefromsandbox",sr=>{const cr={value(Tr){Tr.target.checked=Tr.detail.value!=="Off",St.setValue(Pt,{value:Tr.target.checked})}};this._dispatchEventFromSandbox(cr,sr)}),this._setEventListeners(qt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],sr=>sr.target.checked)),this._setBackgroundColor(qt),this._setDefaultPropertiesFromJS(qt),this.container.append(qt),this.container}}class Se extends me{constructor(St){super(St,{isRenderable:St.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const St=this.annotationStorage,xt=this.data,Pt=xt.id;let Gt=St.getValue(Pt,{value:xt.fieldValue===xt.buttonValue}).value;typeof Gt=="string"&&(Gt=Gt!==xt.buttonValue,St.setValue(Pt,{value:Gt}));const qt=document.createElement("input");if(le.add(qt),qt.setAttribute("data-element-id",Pt),qt.disabled=xt.readOnly,this._setRequired(qt,this.data.required),qt.type="radio",qt.name=xt.fieldName,Gt&&qt.setAttribute("checked",!0),qt.tabIndex=se,qt.addEventListener("change",sr=>{const{name:cr,checked:Tr}=sr.target;for(const Ar of this._getElementsByName(cr,Pt))St.setValue(Ar.id,{value:!1});St.setValue(Pt,{value:Tr})}),qt.addEventListener("resetform",sr=>{const cr=xt.defaultFieldValue;sr.target.checked=cr!=null&&cr===xt.buttonValue}),this.enableScripting&&this.hasJSActions){const sr=xt.buttonValue;qt.addEventListener("updatefromsandbox",cr=>{const Tr={value:Ar=>{const Oe=sr===Ar.detail.value;for(const vt of this._getElementsByName(Ar.target.name)){const ut=Oe&&vt.id===Pt;vt.domElement&&(vt.domElement.checked=ut),St.setValue(vt.id,{value:ut})}}};this._dispatchEventFromSandbox(Tr,cr)}),this._setEventListeners(qt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],cr=>cr.target.checked)}return this._setBackgroundColor(qt),this._setDefaultPropertiesFromJS(qt),this.container.append(qt),this.container}}class Te extends ce{constructor(St){super(St,{ignoreBorder:St.data.hasAppearance})}render(){const St=super.render();St.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(St.title=this.data.alternativeText);const xt=St.lastChild;return this.enableScripting&&this.hasJSActions&&xt&&(this._setDefaultPropertiesFromJS(xt),xt.addEventListener("updatefromsandbox",Pt=>{this._dispatchEventFromSandbox({},Pt)})),St}}class ge extends me{constructor(St){super(St,{isRenderable:St.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const St=this.annotationStorage,xt=this.data.id,Pt=St.getValue(xt,{value:this.data.fieldValue}),Gt=document.createElement("select");le.add(Gt),Gt.setAttribute("data-element-id",xt),Gt.disabled=this.data.readOnly,this._setRequired(Gt,this.data.required),Gt.name=this.data.fieldName,Gt.tabIndex=se;let qt=this.data.combo&&this.data.options.length>0;this.data.combo||(Gt.size=this.data.options.length,this.data.multiSelect&&(Gt.multiple=!0)),Gt.addEventListener("resetform",Oe=>{const vt=this.data.defaultFieldValue;for(const ut of Gt.options)ut.selected=ut.value===vt});for(const Oe of this.data.options){const vt=document.createElement("option");vt.textContent=Oe.displayValue,vt.value=Oe.exportValue,Pt.value.includes(Oe.exportValue)&&(vt.setAttribute("selected",!0),qt=!1),Gt.append(vt)}let sr=null;if(qt){const Oe=document.createElement("option");Oe.value=" ",Oe.setAttribute("hidden",!0),Oe.setAttribute("selected",!0),Gt.prepend(Oe),sr=()=>{Oe.remove(),Gt.removeEventListener("input",sr),sr=null},Gt.addEventListener("input",sr)}const cr=Oe=>{const vt=Oe?"value":"textContent",{options:ut,multiple:dt}=Gt;return dt?Array.prototype.filter.call(ut,wt=>wt.selected).map(wt=>wt[vt]):ut.selectedIndex===-1?null:ut[ut.selectedIndex][vt]};let Tr=cr(!1);const Ar=Oe=>{const vt=Oe.target.options;return Array.prototype.map.call(vt,ut=>({displayValue:ut.textContent,exportValue:ut.value}))};return this.enableScripting&&this.hasJSActions?(Gt.addEventListener("updatefromsandbox",Oe=>{const vt={value(ut){sr==null||sr();const dt=ut.detail.value,wt=new Set(Array.isArray(dt)?dt:[dt]);for(const yt of Gt.options)yt.selected=wt.has(yt.value);St.setValue(xt,{value:cr(!0)}),Tr=cr(!1)},multipleSelection(ut){Gt.multiple=!0},remove(ut){const dt=Gt.options,wt=ut.detail.remove;dt[wt].selected=!1,Gt.remove(wt),dt.length>0&&Array.prototype.findIndex.call(dt,Ut=>Ut.selected)===-1&&(dt[0].selected=!0),St.setValue(xt,{value:cr(!0),items:Ar(ut)}),Tr=cr(!1)},clear(ut){for(;Gt.length!==0;)Gt.remove(0);St.setValue(xt,{value:null,items:[]}),Tr=cr(!1)},insert(ut){const{index:dt,displayValue:wt,exportValue:yt}=ut.detail.insert,Ut=Gt.children[dt],tr=document.createElement("option");tr.textContent=wt,tr.value=yt,Ut?Ut.before(tr):Gt.append(tr),St.setValue(xt,{value:cr(!0),items:Ar(ut)}),Tr=cr(!1)},items(ut){const{items:dt}=ut.detail;for(;Gt.length!==0;)Gt.remove(0);for(const wt of dt){const{displayValue:yt,exportValue:Ut}=wt,tr=document.createElement("option");tr.textContent=yt,tr.value=Ut,Gt.append(tr)}Gt.options.length>0&&(Gt.options[0].selected=!0),St.setValue(xt,{value:cr(!0),items:Ar(ut)}),Tr=cr(!1)},indices(ut){const dt=new Set(ut.detail.indices);for(const wt of ut.target.options)wt.selected=dt.has(wt.index);St.setValue(xt,{value:cr(!0)}),Tr=cr(!1)},editable(ut){ut.target.disabled=!ut.detail.editable}};this._dispatchEventFromSandbox(vt,Oe)}),Gt.addEventListener("input",Oe=>{var ut;const vt=cr(!0);St.setValue(xt,{value:vt}),Oe.preventDefault(),(ut=this.linkService.eventBus)==null||ut.dispatch("dispatcheventinsandbox",{source:this,detail:{id:xt,name:"Keystroke",value:Tr,changeEx:vt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Gt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Oe=>Oe.target.value)):Gt.addEventListener("input",function(Oe){St.setValue(xt,{value:cr(!0)})}),this.data.combo&&this._setTextStyle(Gt),this._setBackgroundColor(Gt),this._setDefaultPropertiesFromJS(Gt),this.container.append(Gt),this.container}}class Ce extends ue{constructor(St){const{data:xt,elements:Pt}=St;super(St,{isRenderable:ue._hasPopupData(xt)}),this.elements=Pt}render(){this.container.classList.add("popupAnnotation");const St=new be({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),xt=[];for(const Pt of this.elements)Pt.popup=St,xt.push(Pt.data.id),Pt.addHighlightArea();return this.container.setAttribute("aria-controls",xt.map(Pt=>`${B.AnnotationPrefix}${Pt}`).join(",")),this.container}}class be{constructor({container:St,color:xt,elements:Pt,titleObj:Gt,modificationDate:qt,contentsObj:sr,richText:cr,parent:Tr,rect:Ar,parentRect:Oe,open:vt}){zt(this,ur);zt(this,At,null);zt(this,It,Mt(this,ur,w0).bind(this));zt(this,it,Mt(this,ur,Ec).bind(this));zt(this,Vt,Mt(this,ur,yc).bind(this));zt(this,Yt,Mt(this,ur,fo).bind(this));zt(this,Zt,null);zt(this,Lt,null);zt(this,Ft,null);zt(this,ht,null);zt(this,kt,null);zt(this,Dt,null);zt(this,Bt,!1);zt(this,Qt,null);zt(this,or,null);zt(this,ar,null);zt(this,Nt,null);zt(this,fr,!1);var dt;Xt(this,Lt,St),Xt(this,Nt,Gt),Xt(this,Ft,sr),Xt(this,ar,cr),Xt(this,kt,Tr),Xt(this,Zt,xt),Xt(this,or,Ar),Xt(this,Dt,Oe),Xt(this,ht,Pt);const ut=W.PDFDateString.toDateObject(qt);ut&&Xt(this,At,Tr.l10n.get("annotation_date_string",{date:ut.toLocaleDateString(),time:ut.toLocaleTimeString()})),this.trigger=Pt.flatMap(wt=>wt.getElementsToTriggerPopup());for(const wt of this.trigger)wt.addEventListener("click",Fe(this,Yt)),wt.addEventListener("mouseenter",Fe(this,Vt)),wt.addEventListener("mouseleave",Fe(this,it)),wt.classList.add("popupTriggerArea");for(const wt of Pt)(dt=wt.container)==null||dt.addEventListener("keydown",Fe(this,It));Fe(this,Lt).hidden=!0,vt&&Mt(this,ur,fo).call(this)}render(){if(Fe(this,Qt))return;const{page:{view:St},viewport:{rawDims:{pageWidth:xt,pageHeight:Pt,pageX:Gt,pageY:qt}}}=Fe(this,kt),sr=Xt(this,Qt,document.createElement("div"));if(sr.className="popup",Fe(this,Zt)){const jt=sr.style.outlineColor=B.Util.makeHexColor(...Fe(this,Zt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?sr.style.backgroundColor=`color-mix(in srgb, ${jt} 30%, white)`:sr.style.backgroundColor=B.Util.makeHexColor(...Fe(this,Zt).map(pr=>Math.floor(.7*(255-pr)+pr)))}const cr=document.createElement("span");cr.className="header";const Tr=document.createElement("h1");if(cr.append(Tr),{dir:Tr.dir,str:Tr.textContent}=Fe(this,Nt),sr.append(cr),Fe(this,At)){const jt=document.createElement("span");jt.classList.add("popupDate"),Fe(this,At).then(er=>{jt.textContent=er}),cr.append(jt)}const Ar=Fe(this,Ft),Oe=Fe(this,ar);if(Oe!=null&&Oe.str&&(!(Ar!=null&&Ar.str)||Ar.str===Oe.str))ae.XfaLayer.render({xfaHtml:Oe.html,intent:"richText",div:sr}),sr.lastChild.classList.add("richText","popupContent");else{const jt=this._formatContents(Ar);sr.append(jt)}let vt=!!Fe(this,Dt),ut=vt?Fe(this,Dt):Fe(this,or);for(const jt of Fe(this,ht))if(!ut||B.Util.intersect(jt.data.rect,ut)!==null){ut=jt.data.rect,vt=!0;break}const dt=B.Util.normalizeRect([ut[0],St[3]-ut[1]+St[1],ut[2],St[3]-ut[3]+St[1]]),yt=vt?ut[2]-ut[0]+5:0,Ut=dt[0]+yt,tr=dt[1],{style:Kt}=Fe(this,Lt);Kt.left=`${100*(Ut-Gt)/xt}%`,Kt.top=`${100*(tr-qt)/Pt}%`,Fe(this,Lt).append(sr)}_formatContents({str:St,dir:xt}){const Pt=document.createElement("p");Pt.classList.add("popupContent"),Pt.dir=xt;const Gt=St.split(/(?:\r\n?|\n)/);for(let qt=0,sr=Gt.length;qt<sr;++qt){const cr=Gt[qt];Pt.append(document.createTextNode(cr)),qt<sr-1&&Pt.append(document.createElement("br"))}return Pt}forceHide(){Xt(this,fr,this.isVisible),Fe(this,fr)&&(Fe(this,Lt).hidden=!0)}maybeShow(){Fe(this,fr)&&(Xt(this,fr,!1),Fe(this,Lt).hidden=!1)}get isVisible(){return Fe(this,Lt).hidden===!1}}At=new WeakMap,It=new WeakMap,it=new WeakMap,Vt=new WeakMap,Yt=new WeakMap,Zt=new WeakMap,Lt=new WeakMap,Ft=new WeakMap,ht=new WeakMap,kt=new WeakMap,Dt=new WeakMap,Bt=new WeakMap,Qt=new WeakMap,or=new WeakMap,ar=new WeakMap,Nt=new WeakMap,fr=new WeakMap,ur=new WeakSet,w0=function(St){St.altKey||St.shiftKey||St.ctrlKey||St.metaKey||(St.key==="Enter"||St.key==="Escape"&&Fe(this,Bt))&&Mt(this,ur,fo).call(this)},fo=function(){Xt(this,Bt,!Fe(this,Bt)),Fe(this,Bt)?(Mt(this,ur,yc).call(this),Fe(this,Lt).addEventListener("click",Fe(this,Yt)),Fe(this,Lt).addEventListener("keydown",Fe(this,It))):(Mt(this,ur,Ec).call(this),Fe(this,Lt).removeEventListener("click",Fe(this,Yt)),Fe(this,Lt).removeEventListener("keydown",Fe(this,It)))},yc=function(){Fe(this,Qt)||this.render(),this.isVisible?Fe(this,Bt)&&Fe(this,Lt).classList.add("focused"):(Fe(this,Lt).hidden=!1,Fe(this,Lt).style.zIndex=parseInt(Fe(this,Lt).style.zIndex)+1e3)},Ec=function(){Fe(this,Lt).classList.remove("focused"),!(Fe(this,Bt)||!this.isVisible)&&(Fe(this,Lt).hidden=!0,Fe(this,Lt).style.zIndex=parseInt(Fe(this,Lt).style.zIndex)-1e3)};class nt extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0}),this.textContent=St.data.textContent,this.textPosition=St.data.textPosition,this.annotationEditorType=B.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const St=document.createElement("div");St.classList.add("annotationTextContent"),St.setAttribute("role","comment");for(const xt of this.textContent){const Pt=document.createElement("span");Pt.textContent=xt,St.append(Pt)}this.container.append(St)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}A.FreeTextAnnotationElement=nt;class Ae extends ue{constructor(xt){super(xt,{isRenderable:!0,ignoreBorder:!0});zt(this,br,null)}render(){this.container.classList.add("lineAnnotation");const xt=this.data,{width:Pt,height:Gt}=pe(xt.rect),qt=this.svgFactory.create(Pt,Gt,!0),sr=Xt(this,br,this.svgFactory.createElement("svg:line"));return sr.setAttribute("x1",xt.rect[2]-xt.lineCoordinates[0]),sr.setAttribute("y1",xt.rect[3]-xt.lineCoordinates[1]),sr.setAttribute("x2",xt.rect[2]-xt.lineCoordinates[2]),sr.setAttribute("y2",xt.rect[3]-xt.lineCoordinates[3]),sr.setAttribute("stroke-width",xt.borderStyle.width||1),sr.setAttribute("stroke","transparent"),sr.setAttribute("fill","transparent"),qt.append(sr),this.container.append(qt),!xt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Fe(this,br)}addHighlightArea(){this.container.classList.add("highlightArea")}}br=new WeakMap;class De extends ue{constructor(xt){super(xt,{isRenderable:!0,ignoreBorder:!0});zt(this,Ir,null)}render(){this.container.classList.add("squareAnnotation");const xt=this.data,{width:Pt,height:Gt}=pe(xt.rect),qt=this.svgFactory.create(Pt,Gt,!0),sr=xt.borderStyle.width,cr=Xt(this,Ir,this.svgFactory.createElement("svg:rect"));return cr.setAttribute("x",sr/2),cr.setAttribute("y",sr/2),cr.setAttribute("width",Pt-sr),cr.setAttribute("height",Gt-sr),cr.setAttribute("stroke-width",sr||1),cr.setAttribute("stroke","transparent"),cr.setAttribute("fill","transparent"),qt.append(cr),this.container.append(qt),!xt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Fe(this,Ir)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ir=new WeakMap;class lt extends ue{constructor(xt){super(xt,{isRenderable:!0,ignoreBorder:!0});zt(this,zr,null)}render(){this.container.classList.add("circleAnnotation");const xt=this.data,{width:Pt,height:Gt}=pe(xt.rect),qt=this.svgFactory.create(Pt,Gt,!0),sr=xt.borderStyle.width,cr=Xt(this,zr,this.svgFactory.createElement("svg:ellipse"));return cr.setAttribute("cx",Pt/2),cr.setAttribute("cy",Gt/2),cr.setAttribute("rx",Pt/2-sr/2),cr.setAttribute("ry",Gt/2-sr/2),cr.setAttribute("stroke-width",sr||1),cr.setAttribute("stroke","transparent"),cr.setAttribute("fill","transparent"),qt.append(cr),this.container.append(qt),!xt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Fe(this,zr)}addHighlightArea(){this.container.classList.add("highlightArea")}}zr=new WeakMap;class Ct extends ue{constructor(xt){super(xt,{isRenderable:!0,ignoreBorder:!0});zt(this,lr,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const xt=this.data,{width:Pt,height:Gt}=pe(xt.rect),qt=this.svgFactory.create(Pt,Gt,!0);let sr=[];for(const Tr of xt.vertices){const Ar=Tr.x-xt.rect[0],Oe=xt.rect[3]-Tr.y;sr.push(Ar+","+Oe)}sr=sr.join(" ");const cr=Xt(this,lr,this.svgFactory.createElement(this.svgElementName));return cr.setAttribute("points",sr),cr.setAttribute("stroke-width",xt.borderStyle.width||1),cr.setAttribute("stroke","transparent"),cr.setAttribute("fill","transparent"),qt.append(cr),this.container.append(qt),!xt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Fe(this,lr)}addHighlightArea(){this.container.classList.add("highlightArea")}}lr=new WeakMap;class ft extends Ct{constructor(St){super(St),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Et extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class gt extends ue{constructor(xt){super(xt,{isRenderable:!0,ignoreBorder:!0});zt(this,Ht,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=B.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const xt=this.data,{width:Pt,height:Gt}=pe(xt.rect),qt=this.svgFactory.create(Pt,Gt,!0);for(const sr of xt.inkLists){let cr=[];for(const Ar of sr){const Oe=Ar.x-xt.rect[0],vt=xt.rect[3]-Ar.y;cr.push(`${Oe},${vt}`)}cr=cr.join(" ");const Tr=this.svgFactory.createElement(this.svgElementName);Fe(this,Ht).push(Tr),Tr.setAttribute("points",cr),Tr.setAttribute("stroke-width",xt.borderStyle.width||1),Tr.setAttribute("stroke","transparent"),Tr.setAttribute("fill","transparent"),!xt.popupRef&&this.hasPopupData&&this._createPopup(),qt.append(Tr)}return this.container.append(qt),this.container}getElementsToTriggerPopup(){return Fe(this,Ht)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ht=new WeakMap,A.InkAnnotationElement=gt;class bt extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Ie extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class pt extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class at extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ee extends ue{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}A.StampAnnotationElement=Ee;class ye extends ue{constructor(xt){var qt;super(xt,{isRenderable:!0});zt(this,kr);zt(this,$t,null);const{filename:Pt,content:Gt}=this.data.file;this.filename=(0,W.getFilenameFromUrl)(Pt,!0),this.content=Gt,(qt=this.linkService.eventBus)==null||qt.dispatch("fileattachmentannotation",{source:this,filename:Pt,content:Gt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:xt,data:Pt}=this;let Gt;Pt.hasAppearance||Pt.fillAlpha===0?Gt=document.createElement("div"):(Gt=document.createElement("img"),Gt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Pt.name)?"paperclip":"pushpin"}.svg`,Pt.fillAlpha&&Pt.fillAlpha<1&&(Gt.style=`filter: opacity(${Math.round(Pt.fillAlpha*100)}%);`)),Gt.addEventListener("dblclick",Mt(this,kr,Sc).bind(this)),Xt(this,$t,Gt);const{isMac:qt}=B.FeatureTest.platform;return xt.addEventListener("keydown",sr=>{sr.key==="Enter"&&(qt?sr.metaKey:sr.ctrlKey)&&Mt(this,kr,Sc).call(this)}),!Pt.popupRef&&this.hasPopupData?this._createPopup():Gt.classList.add("popupTriggerArea"),xt.append(Gt),xt}getElementsToTriggerPopup(){return Fe(this,$t)}addHighlightArea(){this.container.classList.add("highlightArea")}}$t=new WeakMap,kr=new WeakSet,Sc=function(){var xt;(xt=this.downloadManager)==null||xt.openOrDownloadData(this.container,this.content,this.filename)};class ve{constructor({div:St,accessibilityManager:xt,annotationCanvasMap:Pt,l10n:Gt,page:qt,viewport:sr}){zt(this,hr);zt(this,Ur,null);zt(this,Tt,null);zt(this,rr,new Map);this.div=St,Xt(this,Ur,xt),Xt(this,Tt,Pt),this.l10n=Gt,this.page=qt,this.viewport=sr,this.zIndex=0,this.l10n||(this.l10n=re.NullL10n)}async render(St){const{annotations:xt}=St,Pt=this.div;(0,W.setLayerDimensions)(Pt,this.viewport);const Gt=new Map,qt={data:null,layer:Pt,linkService:St.linkService,downloadManager:St.downloadManager,imageResourcesPath:St.imageResourcesPath||"",renderForms:St.renderForms!==!1,svgFactory:new W.DOMSVGFactory,annotationStorage:St.annotationStorage||new q.AnnotationStorage,enableScripting:St.enableScripting===!0,hasJSActions:St.hasJSActions,fieldObjects:St.fieldObjects,parent:this,elements:null};for(const sr of xt){if(sr.noHTML)continue;const cr=sr.annotationType===B.AnnotationType.POPUP;if(cr){const Oe=Gt.get(sr.id);if(!Oe)continue;qt.elements=Oe}else{const{width:Oe,height:vt}=pe(sr.rect);if(Oe<=0||vt<=0)continue}qt.data=sr;const Tr=he.create(qt);if(!Tr.isRenderable)continue;if(!cr&&sr.popupRef){const Oe=Gt.get(sr.popupRef);Oe?Oe.push(Tr):Gt.set(sr.popupRef,[Tr])}Tr.annotationEditorType>0&&Fe(this,rr).set(Tr.data.id,Tr);const Ar=Tr.render();sr.hidden&&(Ar.style.visibility="hidden"),Mt(this,hr,y0).call(this,Ar,sr.id)}Mt(this,hr,kc).call(this),await this.l10n.translate(Pt)}update({viewport:St}){const xt=this.div;this.viewport=St,(0,W.setLayerDimensions)(xt,{rotation:St.rotation}),Mt(this,hr,kc).call(this),xt.hidden=!1}getEditableAnnotations(){return Array.from(Fe(this,rr).values())}getEditableAnnotation(St){return Fe(this,rr).get(St)}}Ur=new WeakMap,Tt=new WeakMap,rr=new WeakMap,hr=new WeakSet,y0=function(St,xt){var Gt;const Pt=St.firstChild||St;Pt.id=`${B.AnnotationPrefix}${xt}`,this.div.append(St),(Gt=Fe(this,Ur))==null||Gt.moveElementInDOM(this.div,St,Pt,!1)},kc=function(){if(!Fe(this,Tt))return;const St=this.div;for(const[xt,Pt]of Fe(this,Tt)){const Gt=St.querySelector(`[data-annotation-id="${xt}"]`);if(!Gt)continue;const{firstChild:qt}=Gt;qt?qt.nodeName==="CANVAS"?qt.replaceWith(Pt):qt.before(Pt):Gt.append(Pt)}Fe(this,Tt).clear()},A.AnnotationLayer=ve},(g,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.ColorConverters=void 0;function L(q){return Math.floor(Math.max(0,Math.min(1,q))*255).toString(16).padStart(2,"0")}function B(q){return Math.max(0,Math.min(255,255*q))}class W{static CMYK_G([J,re,ae,se]){return["G",1-Math.min(1,.3*J+.59*ae+.11*re+se)]}static G_CMYK([J]){return["CMYK",0,0,0,1-J]}static G_RGB([J]){return["RGB",J,J,J]}static G_rgb([J]){return J=B(J),[J,J,J]}static G_HTML([J]){const re=L(J);return`#${re}${re}${re}`}static RGB_G([J,re,ae]){return["G",.3*J+.59*re+.11*ae]}static RGB_rgb(J){return J.map(B)}static RGB_HTML(J){return`#${J.map(L).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([J,re,ae,se]){return["RGB",1-Math.min(1,J+se),1-Math.min(1,ae+se),1-Math.min(1,re+se)]}static CMYK_rgb([J,re,ae,se]){return[B(1-Math.min(1,J+se)),B(1-Math.min(1,ae+se)),B(1-Math.min(1,re+se))]}static CMYK_HTML(J){const re=this.CMYK_RGB(J).slice(1);return this.RGB_HTML(re)}static RGB_CMYK([J,re,ae]){const se=1-J,ie=1-re,le=1-ae,pe=Math.min(se,ie,le);return["CMYK",se,ie,le,pe]}}A.ColorConverters=W},(g,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.NullL10n=void 0,A.getL10nFallback=B;const L={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};L.print_progress_percent="{{progress}}%";function B(J,re){switch(J){case"find_match_count":J=`find_match_count[${re.total===1?"one":"other"}]`;break;case"find_match_count_limit":J=`find_match_count_limit[${re.limit===1?"one":"other"}]`;break}return L[J]||""}function W(J,re){return re?J.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(ae,se)=>se in re?re[se]:"{{"+se+"}}"):J}const q={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(J,re=null,ae=B(J,re)){return W(ae,re)},async translate(J){}};A.NullL10n=q},(g,A,L)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.XfaLayer=void 0;var B=L(25);class W{static setupStorage(J,re,ae,se,ie){const le=se.getValue(re,{value:null});switch(ae.name){case"textarea":if(le.value!==null&&(J.textContent=le.value),ie==="print")break;J.addEventListener("input",pe=>{se.setValue(re,{value:pe.target.value})});break;case"input":if(ae.attributes.type==="radio"||ae.attributes.type==="checkbox"){if(le.value===ae.attributes.xfaOn?J.setAttribute("checked",!0):le.value===ae.attributes.xfaOff&&J.removeAttribute("checked"),ie==="print")break;J.addEventListener("change",pe=>{se.setValue(re,{value:pe.target.checked?pe.target.getAttribute("xfaOn"):pe.target.getAttribute("xfaOff")})})}else{if(le.value!==null&&J.setAttribute("value",le.value),ie==="print")break;J.addEventListener("input",pe=>{se.setValue(re,{value:pe.target.value})})}break;case"select":if(le.value!==null){J.setAttribute("value",le.value);for(const pe of ae.children)pe.attributes.value===le.value?pe.attributes.selected=!0:pe.attributes.hasOwnProperty("selected")&&delete pe.attributes.selected}J.addEventListener("input",pe=>{const he=pe.target.options,ue=he.selectedIndex===-1?"":he[he.selectedIndex].value;se.setValue(re,{value:ue})});break}}static setAttributes({html:J,element:re,storage:ae=null,intent:se,linkService:ie}){const{attributes:le}=re,pe=J instanceof HTMLAnchorElement;le.type==="radio"&&(le.name=`${le.name}-${se}`);for(const[he,ue]of Object.entries(le))if(ue!=null)switch(he){case"class":ue.length&&J.setAttribute(he,ue.join(" "));break;case"dataId":break;case"id":J.setAttribute("data-element-id",ue);break;case"style":Object.assign(J.style,ue);break;case"textContent":J.textContent=ue;break;default:(!pe||he!=="href"&&he!=="newWindow")&&J.setAttribute(he,ue)}pe&&ie.addLinkAttributes(J,le.href,le.newWindow),ae&&le.dataId&&this.setupStorage(J,le.dataId,re,ae)}static render(J){var ce;const re=J.annotationStorage,ae=J.linkService,se=J.xfaHtml,ie=J.intent||"display",le=document.createElement(se.name);se.attributes&&this.setAttributes({html:le,element:se,intent:ie,linkService:ae});const pe=[[se,-1,le]],he=J.div;if(he.append(le),J.viewport){const fe=`matrix(${J.viewport.transform.join(",")})`;he.style.transform=fe}ie!=="richText"&&he.setAttribute("class","xfaLayer xfaFont");const ue=[];for(;pe.length>0;){const[fe,me,ke]=pe.at(-1);if(me+1===fe.children.length){pe.pop();continue}const xe=fe.children[++pe.at(-1)[1]];if(xe===null)continue;const{name:Le}=xe;if(Le==="#text"){const Te=document.createTextNode(xe.value);ue.push(Te),ke.append(Te);continue}const Se=(ce=xe==null?void 0:xe.attributes)!=null&&ce.xmlns?document.createElementNS(xe.attributes.xmlns,Le):document.createElement(Le);if(ke.append(Se),xe.attributes&&this.setAttributes({html:Se,element:xe,storage:re,intent:ie,linkService:ae}),xe.children&&xe.children.length>0)pe.push([xe,-1,Se]);else if(xe.value){const Te=document.createTextNode(xe.value);B.XfaText.shouldBuildText(Le)&&ue.push(Te),Se.append(Te)}}for(const fe of he.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))fe.setAttribute("readOnly",!0);return{textDivs:ue}}static update(J){const re=`matrix(${J.viewport.transform.join(",")})`;J.div.style.transform=re,J.div.hidden=!1}}A.XfaLayer=W},(g,A,L)=>{var se,ie,le,pe,he,ue,ce,fe,me,ke,xe,Le,Se,Te,ge,E0,S0,k0,A0,Ac,T0,Tc,b0,C0,F0,R0,P0,ia,bc,ho,po,fi,Cc,mo,st,L0,Fc,D0,I0,Rc,_o,hi;Object.defineProperty(A,"__esModule",{value:!0}),A.InkEditor=void 0;var B=L(1),W=L(4),q=L(29),J=L(6),re=L(5);const Zt=class Zt extends W.AnnotationEditor{constructor(ht){super({...ht,name:"inkEditor"});zt(this,ge);zt(this,se,0);zt(this,ie,0);zt(this,le,this.canvasPointermove.bind(this));zt(this,pe,this.canvasPointerleave.bind(this));zt(this,he,this.canvasPointerup.bind(this));zt(this,ue,this.canvasPointerdown.bind(this));zt(this,ce,new Path2D);zt(this,fe,!1);zt(this,me,!1);zt(this,ke,!1);zt(this,xe,null);zt(this,Le,0);zt(this,Se,0);zt(this,Te,null);this.color=ht.color||null,this.thickness=ht.thickness||null,this.opacity=ht.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(ht){W.AnnotationEditor.initialize(ht,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(ht,kt){switch(ht){case B.AnnotationEditorParamsType.INK_THICKNESS:Zt._defaultThickness=kt;break;case B.AnnotationEditorParamsType.INK_COLOR:Zt._defaultColor=kt;break;case B.AnnotationEditorParamsType.INK_OPACITY:Zt._defaultOpacity=kt/100;break}}updateParams(ht,kt){switch(ht){case B.AnnotationEditorParamsType.INK_THICKNESS:Mt(this,ge,E0).call(this,kt);break;case B.AnnotationEditorParamsType.INK_COLOR:Mt(this,ge,S0).call(this,kt);break;case B.AnnotationEditorParamsType.INK_OPACITY:Mt(this,ge,k0).call(this,kt);break}}static get defaultPropertiesToUpdate(){return[[B.AnnotationEditorParamsType.INK_THICKNESS,Zt._defaultThickness],[B.AnnotationEditorParamsType.INK_COLOR,Zt._defaultColor||W.AnnotationEditor._defaultLineColor],[B.AnnotationEditorParamsType.INK_OPACITY,Math.round(Zt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[B.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Zt._defaultThickness],[B.AnnotationEditorParamsType.INK_COLOR,this.color||Zt._defaultColor||W.AnnotationEditor._defaultLineColor],[B.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Zt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Mt(this,ge,ho).call(this),Mt(this,ge,po).call(this)),this.isAttachedToDOM||(this.parent.add(this),Mt(this,ge,fi).call(this)),Mt(this,ge,hi).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,Fe(this,xe).disconnect(),Xt(this,xe,null),super.remove())}setParent(ht){!this.parent&&ht?this._uiManager.removeShouldRescale(this):this.parent&&ht===null&&this._uiManager.addShouldRescale(this),super.setParent(ht)}onScaleChanging(){const[ht,kt]=this.parentDimensions,Dt=this.width*ht,Bt=this.height*kt;this.setDimensions(Dt,Bt)}enableEditMode(){Fe(this,fe)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",Fe(this,ue)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",Fe(this,ue)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){Fe(this,fe)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Xt(this,fe,!0),this.div.classList.add("disabled"),Mt(this,ge,hi).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(ht){this._focusEventsAllowed&&(super.focusin(ht),this.enableEditMode())}canvasPointerdown(ht){ht.button!==0||!this.isInEditMode()||Fe(this,fe)||(this.setInForeground(),ht.preventDefault(),ht.type!=="mouse"&&this.div.focus(),Mt(this,ge,T0).call(this,ht.offsetX,ht.offsetY))}canvasPointermove(ht){ht.preventDefault(),Mt(this,ge,Tc).call(this,ht.offsetX,ht.offsetY)}canvasPointerup(ht){ht.preventDefault(),Mt(this,ge,bc).call(this,ht)}canvasPointerleave(ht){Mt(this,ge,bc).call(this,ht)}get isResizable(){return!this.isEmpty()&&Fe(this,fe)}render(){if(this.div)return this.div;let ht,kt;this.width&&(ht=this.x,kt=this.y),super.render(),W.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(ar=>{var Nt;return(Nt=this.div)==null?void 0:Nt.setAttribute("aria-label",ar)});const[Dt,Bt,Qt,or]=Mt(this,ge,A0).call(this);if(this.setAt(Dt,Bt,0,0),this.setDims(Qt,or),Mt(this,ge,ho).call(this),this.width){const[ar,Nt]=this.parentDimensions;this.setAspectRatio(this.width*ar,this.height*Nt),this.setAt(ht*ar,kt*Nt,this.width*ar,this.height*Nt),Xt(this,ke,!0),Mt(this,ge,fi).call(this),this.setDims(this.width*ar,this.height*Nt),Mt(this,ge,ia).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Mt(this,ge,po).call(this),this.div}setDimensions(ht,kt){const Dt=Math.round(ht),Bt=Math.round(kt);if(Fe(this,Le)===Dt&&Fe(this,Se)===Bt)return;Xt(this,Le,Dt),Xt(this,Se,Bt),this.canvas.style.visibility="hidden";const[Qt,or]=this.parentDimensions;this.width=ht/Qt,this.height=kt/or,this.fixAndSetPosition(),Fe(this,fe)&&Mt(this,ge,Cc).call(this,ht,kt),Mt(this,ge,fi).call(this),Mt(this,ge,ia).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(ht,kt,Dt){var br,Ir,zr;if(ht instanceof q.InkAnnotationElement)return null;const Bt=super.deserialize(ht,kt,Dt);Bt.thickness=ht.thickness,Bt.color=B.Util.makeHexColor(...ht.color),Bt.opacity=ht.opacity;const[Qt,or]=Bt.pageDimensions,ar=Bt.width*Qt,Nt=Bt.height*or,fr=Bt.parentScale,ur=ht.thickness/2;Xt(Bt,fe,!0),Xt(Bt,Le,Math.round(ar)),Xt(Bt,Se,Math.round(Nt));const{paths:Pr,rect:Rr,rotation:vr}=ht;for(let{bezier:lr}of Pr){lr=Mt(br=Zt,st,D0).call(br,lr,Rr,vr);const Ht=[];Bt.paths.push(Ht);let $t=fr*(lr[0]-ur),kr=fr*(lr[1]-ur);for(let Ur=2,Tt=lr.length;Ur<Tt;Ur+=6){const rr=fr*(lr[Ur]-ur),hr=fr*(lr[Ur+1]-ur),Cr=fr*(lr[Ur+2]-ur),Fr=fr*(lr[Ur+3]-ur),yr=fr*(lr[Ur+4]-ur),St=fr*(lr[Ur+5]-ur);Ht.push([[$t,kr],[rr,hr],[Cr,Fr],[yr,St]]),$t=yr,kr=St}const Wr=Mt(this,st,L0).call(this,Ht);Bt.bezierPath2D.push(Wr)}const dr=Mt(Ir=Bt,ge,Rc).call(Ir);return Xt(Bt,ie,Math.max(W.AnnotationEditor.MIN_SIZE,dr[2]-dr[0])),Xt(Bt,se,Math.max(W.AnnotationEditor.MIN_SIZE,dr[3]-dr[1])),Mt(zr=Bt,ge,Cc).call(zr,ar,Nt),Bt}serialize(){if(this.isEmpty())return null;const ht=this.getRect(0,0),kt=W.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:B.AnnotationEditorType.INK,color:kt,thickness:this.thickness,opacity:this.opacity,paths:Mt(this,ge,I0).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,ht),pageIndex:this.pageIndex,rect:ht,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};se=new WeakMap,ie=new WeakMap,le=new WeakMap,pe=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakMap,fe=new WeakMap,me=new WeakMap,ke=new WeakMap,xe=new WeakMap,Le=new WeakMap,Se=new WeakMap,Te=new WeakMap,ge=new WeakSet,E0=function(ht){const kt=this.thickness;this.addCommands({cmd:()=>{this.thickness=ht,Mt(this,ge,hi).call(this)},undo:()=>{this.thickness=kt,Mt(this,ge,hi).call(this)},mustExec:!0,type:B.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},S0=function(ht){const kt=this.color;this.addCommands({cmd:()=>{this.color=ht,Mt(this,ge,ia).call(this)},undo:()=>{this.color=kt,Mt(this,ge,ia).call(this)},mustExec:!0,type:B.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},k0=function(ht){ht/=100;const kt=this.opacity;this.addCommands({cmd:()=>{this.opacity=ht,Mt(this,ge,ia).call(this)},undo:()=>{this.opacity=kt,Mt(this,ge,ia).call(this)},mustExec:!0,type:B.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},A0=function(){const{parentRotation:ht,parentDimensions:[kt,Dt]}=this;switch(ht){case 90:return[0,Dt,Dt,kt];case 180:return[kt,Dt,kt,Dt];case 270:return[kt,0,Dt,kt];default:return[0,0,kt,Dt]}},Ac=function(){const{ctx:ht,color:kt,opacity:Dt,thickness:Bt,parentScale:Qt,scaleFactor:or}=this;ht.lineWidth=Bt*Qt/or,ht.lineCap="round",ht.lineJoin="round",ht.miterLimit=10,ht.strokeStyle=`${kt}${(0,re.opacityToHex)(Dt)}`},T0=function(ht,kt){this.canvas.addEventListener("contextmenu",J.noContextMenu),this.canvas.addEventListener("pointerleave",Fe(this,pe)),this.canvas.addEventListener("pointermove",Fe(this,le)),this.canvas.addEventListener("pointerup",Fe(this,he)),this.canvas.removeEventListener("pointerdown",Fe(this,ue)),this.isEditing=!0,Fe(this,ke)||(Xt(this,ke,!0),Mt(this,ge,fi).call(this),this.thickness||(this.thickness=Zt._defaultThickness),this.color||(this.color=Zt._defaultColor||W.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Zt._defaultOpacity)),this.currentPath.push([ht,kt]),Xt(this,me,!1),Mt(this,ge,Ac).call(this),Xt(this,Te,()=>{Mt(this,ge,F0).call(this),Fe(this,Te)&&window.requestAnimationFrame(Fe(this,Te))}),window.requestAnimationFrame(Fe(this,Te))},Tc=function(ht,kt){const[Dt,Bt]=this.currentPath.at(-1);if(this.currentPath.length>1&&ht===Dt&&kt===Bt)return;const Qt=this.currentPath;let or=Fe(this,ce);if(Qt.push([ht,kt]),Xt(this,me,!0),Qt.length<=2){or.moveTo(...Qt[0]),or.lineTo(ht,kt);return}Qt.length===3&&(Xt(this,ce,or=new Path2D),or.moveTo(...Qt[0])),Mt(this,ge,R0).call(this,or,...Qt.at(-3),...Qt.at(-2),ht,kt)},b0=function(){if(this.currentPath.length===0)return;const ht=this.currentPath.at(-1);Fe(this,ce).lineTo(...ht)},C0=function(ht,kt){Xt(this,Te,null),ht=Math.min(Math.max(ht,0),this.canvas.width),kt=Math.min(Math.max(kt,0),this.canvas.height),Mt(this,ge,Tc).call(this,ht,kt),Mt(this,ge,b0).call(this);let Dt;if(this.currentPath.length!==1)Dt=Mt(this,ge,P0).call(this);else{const Nt=[ht,kt];Dt=[[Nt,Nt.slice(),Nt.slice(),Nt]]}const Bt=Fe(this,ce),Qt=this.currentPath;this.currentPath=[],Xt(this,ce,new Path2D);const or=()=>{this.allRawPaths.push(Qt),this.paths.push(Dt),this.bezierPath2D.push(Bt),this.rebuild()},ar=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Mt(this,ge,ho).call(this),Mt(this,ge,po).call(this)),Mt(this,ge,hi).call(this))};this.addCommands({cmd:or,undo:ar,mustExec:!0})},F0=function(){if(!Fe(this,me))return;Xt(this,me,!1);const ht=Math.ceil(this.thickness*this.parentScale),kt=this.currentPath.slice(-3),Dt=kt.map(or=>or[0]),Bt=kt.map(or=>or[1]);Math.min(...Dt)-ht,Math.max(...Dt)+ht,Math.min(...Bt)-ht,Math.max(...Bt)+ht;const{ctx:Qt}=this;Qt.save(),Qt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const or of this.bezierPath2D)Qt.stroke(or);Qt.stroke(Fe(this,ce)),Qt.restore()},R0=function(ht,kt,Dt,Bt,Qt,or,ar){const Nt=(kt+Bt)/2,fr=(Dt+Qt)/2,ur=(Bt+or)/2,Pr=(Qt+ar)/2;ht.bezierCurveTo(Nt+2*(Bt-Nt)/3,fr+2*(Qt-fr)/3,ur+2*(Bt-ur)/3,Pr+2*(Qt-Pr)/3,ur,Pr)},P0=function(){const ht=this.currentPath;if(ht.length<=2)return[[ht[0],ht[0],ht.at(-1),ht.at(-1)]];const kt=[];let Dt,[Bt,Qt]=ht[0];for(Dt=1;Dt<ht.length-2;Dt++){const[Rr,vr]=ht[Dt],[dr,br]=ht[Dt+1],Ir=(Rr+dr)/2,zr=(vr+br)/2,lr=[Bt+2*(Rr-Bt)/3,Qt+2*(vr-Qt)/3],Ht=[Ir+2*(Rr-Ir)/3,zr+2*(vr-zr)/3];kt.push([[Bt,Qt],lr,Ht,[Ir,zr]]),[Bt,Qt]=[Ir,zr]}const[or,ar]=ht[Dt],[Nt,fr]=ht[Dt+1],ur=[Bt+2*(or-Bt)/3,Qt+2*(ar-Qt)/3],Pr=[Nt+2*(or-Nt)/3,fr+2*(ar-fr)/3];return kt.push([[Bt,Qt],ur,Pr,[Nt,fr]]),kt},ia=function(){if(this.isEmpty()){Mt(this,ge,mo).call(this);return}Mt(this,ge,Ac).call(this);const{canvas:ht,ctx:kt}=this;kt.setTransform(1,0,0,1,0,0),kt.clearRect(0,0,ht.width,ht.height),Mt(this,ge,mo).call(this);for(const Dt of this.bezierPath2D)kt.stroke(Dt)},bc=function(ht){this.canvas.removeEventListener("pointerleave",Fe(this,pe)),this.canvas.removeEventListener("pointermove",Fe(this,le)),this.canvas.removeEventListener("pointerup",Fe(this,he)),this.canvas.addEventListener("pointerdown",Fe(this,ue)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",J.noContextMenu)},10),Mt(this,ge,C0).call(this,ht.offsetX,ht.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ho=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",W.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(ht=>{var kt;return(kt=this.canvas)==null?void 0:kt.setAttribute("aria-label",ht)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},po=function(){Xt(this,xe,new ResizeObserver(ht=>{const kt=ht[0].contentRect;kt.width&&kt.height&&this.setDimensions(kt.width,kt.height)})),Fe(this,xe).observe(this.div)},fi=function(){if(!Fe(this,ke))return;const[ht,kt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*ht),this.canvas.height=Math.ceil(this.height*kt),Mt(this,ge,mo).call(this)},Cc=function(ht,kt){const Dt=Mt(this,ge,_o).call(this),Bt=(ht-Dt)/Fe(this,ie),Qt=(kt-Dt)/Fe(this,se);this.scaleFactor=Math.min(Bt,Qt)},mo=function(){const ht=Mt(this,ge,_o).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+ht,this.translationY*this.scaleFactor+ht)},st=new WeakSet,L0=function(ht){const kt=new Path2D;for(let Dt=0,Bt=ht.length;Dt<Bt;Dt++){const[Qt,or,ar,Nt]=ht[Dt];Dt===0&&kt.moveTo(...Qt),kt.bezierCurveTo(or[0],or[1],ar[0],ar[1],Nt[0],Nt[1])}return kt},Fc=function(ht,kt,Dt){const[Bt,Qt,or,ar]=kt;switch(Dt){case 0:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2)ht[Nt]+=Bt,ht[Nt+1]=ar-ht[Nt+1];break;case 90:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2){const ur=ht[Nt];ht[Nt]=ht[Nt+1]+Bt,ht[Nt+1]=ur+Qt}break;case 180:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2)ht[Nt]=or-ht[Nt],ht[Nt+1]+=Qt;break;case 270:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2){const ur=ht[Nt];ht[Nt]=or-ht[Nt+1],ht[Nt+1]=ar-ur}break;default:throw new Error("Invalid rotation")}return ht},D0=function(ht,kt,Dt){const[Bt,Qt,or,ar]=kt;switch(Dt){case 0:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2)ht[Nt]-=Bt,ht[Nt+1]=ar-ht[Nt+1];break;case 90:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2){const ur=ht[Nt];ht[Nt]=ht[Nt+1]-Qt,ht[Nt+1]=ur-Bt}break;case 180:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2)ht[Nt]=or-ht[Nt],ht[Nt+1]-=Qt;break;case 270:for(let Nt=0,fr=ht.length;Nt<fr;Nt+=2){const ur=ht[Nt];ht[Nt]=ar-ht[Nt+1],ht[Nt+1]=or-ur}break;default:throw new Error("Invalid rotation")}return ht},I0=function(ht,kt,Dt,Bt){var fr,ur;const Qt=[],or=this.thickness/2,ar=ht*kt+or,Nt=ht*Dt+or;for(const Pr of this.paths){const Rr=[],vr=[];for(let dr=0,br=Pr.length;dr<br;dr++){const[Ir,zr,lr,Ht]=Pr[dr],$t=ht*Ir[0]+ar,kr=ht*Ir[1]+Nt,Wr=ht*zr[0]+ar,Ur=ht*zr[1]+Nt,Tt=ht*lr[0]+ar,rr=ht*lr[1]+Nt,hr=ht*Ht[0]+ar,Cr=ht*Ht[1]+Nt;dr===0&&(Rr.push($t,kr),vr.push($t,kr)),Rr.push(Wr,Ur,Tt,rr,hr,Cr),vr.push(Wr,Ur),dr===br-1&&vr.push(hr,Cr)}Qt.push({bezier:Mt(fr=Zt,st,Fc).call(fr,Rr,Bt,this.rotation),points:Mt(ur=Zt,st,Fc).call(ur,vr,Bt,this.rotation)})}return Qt},Rc=function(){let ht=1/0,kt=-1/0,Dt=1/0,Bt=-1/0;for(const Qt of this.paths)for(const[or,ar,Nt,fr]of Qt){const ur=B.Util.bezierBoundingBox(...or,...ar,...Nt,...fr);ht=Math.min(ht,ur[0]),Dt=Math.min(Dt,ur[1]),kt=Math.max(kt,ur[2]),Bt=Math.max(Bt,ur[3])}return[ht,Dt,kt,Bt]},_o=function(){return Fe(this,fe)?Math.ceil(this.thickness*this.parentScale):0},hi=function(ht=!1){if(this.isEmpty())return;if(!Fe(this,fe)){Mt(this,ge,ia).call(this);return}const kt=Mt(this,ge,Rc).call(this),Dt=Mt(this,ge,_o).call(this);Xt(this,ie,Math.max(W.AnnotationEditor.MIN_SIZE,kt[2]-kt[0])),Xt(this,se,Math.max(W.AnnotationEditor.MIN_SIZE,kt[3]-kt[1]));const Bt=Math.ceil(Dt+Fe(this,ie)*this.scaleFactor),Qt=Math.ceil(Dt+Fe(this,se)*this.scaleFactor),[or,ar]=this.parentDimensions;this.width=Bt/or,this.height=Qt/ar,this.setAspectRatio(Bt,Qt);const Nt=this.translationX,fr=this.translationY;this.translationX=-kt[0],this.translationY=-kt[1],Mt(this,ge,fi).call(this),Mt(this,ge,ia).call(this),Xt(this,Le,Bt),Xt(this,Se,Qt),this.setDims(Bt,Qt);const ur=ht?Dt/this.scaleFactor/2:0;this.translate(Nt-this.translationX-ur,fr-this.translationY-ur)},zt(Zt,st),Kr(Zt,"_defaultColor",null),Kr(Zt,"_defaultOpacity",1),Kr(Zt,"_defaultThickness",1),Kr(Zt,"_type","ink");let ae=Zt;A.InkEditor=ae},(g,A,L)=>{var ae,se,ie,le,pe,he,ue,ce,fe,me,ke,Zi,es,go,Pc,N0,M0,Lc,xo,O0;Object.defineProperty(A,"__esModule",{value:!0}),A.StampEditor=void 0;var B=L(1),W=L(4),q=L(6),J=L(29);const De=class De extends W.AnnotationEditor{constructor(ft){super({...ft,name:"stampEditor"});zt(this,ke);zt(this,ae,null);zt(this,se,null);zt(this,ie,null);zt(this,le,null);zt(this,pe,null);zt(this,he,null);zt(this,ue,null);zt(this,ce,null);zt(this,fe,!1);zt(this,me,!1);Xt(this,le,ft.bitmapUrl),Xt(this,pe,ft.bitmapFile)}static initialize(ft){W.AnnotationEditor.initialize(ft)}static get supportedTypes(){const ft=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,B.shadow)(this,"supportedTypes",ft.map(Et=>`image/${Et}`))}static get supportedTypesStr(){return(0,B.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(ft){return this.supportedTypes.includes(ft)}static paste(ft,Et){Et.pasteEditor(B.AnnotationEditorType.STAMP,{bitmapFile:ft.getAsFile()})}remove(){var ft,Et;Fe(this,se)&&(Xt(this,ae,null),this._uiManager.imageManager.deleteId(Fe(this,se)),(ft=Fe(this,he))==null||ft.remove(),Xt(this,he,null),(Et=Fe(this,ue))==null||Et.disconnect(),Xt(this,ue,null)),super.remove()}rebuild(){if(!this.parent){Fe(this,se)&&Mt(this,ke,go).call(this);return}super.rebuild(),this.div!==null&&(Fe(this,se)&&Mt(this,ke,go).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(Fe(this,ie)||Fe(this,ae)||Fe(this,le)||Fe(this,pe))}get isResizable(){return!0}render(){if(this.div)return this.div;let ft,Et;if(this.width&&(ft=this.x,Et=this.y),super.render(),this.div.hidden=!0,Fe(this,ae)?Mt(this,ke,Pc).call(this):Mt(this,ke,go).call(this),this.width){const[gt,bt]=this.parentDimensions;this.setAt(ft*gt,Et*bt,this.width*gt,this.height*bt)}return this.div}static deserialize(ft,Et,gt){if(ft instanceof J.StampAnnotationElement)return null;const bt=super.deserialize(ft,Et,gt),{rect:Ie,bitmapUrl:pt,bitmapId:at,isSvg:Ee,accessibilityData:ye}=ft;at&&gt.imageManager.isValidId(at)?Xt(bt,se,at):Xt(bt,le,pt),Xt(bt,fe,Ee);const[ve,Pe]=bt.pageDimensions;return bt.width=(Ie[2]-Ie[0])/ve,bt.height=(Ie[3]-Ie[1])/Pe,ye&&(bt.altTextData=ye),bt}serialize(ft=!1,Et=null){if(this.isEmpty())return null;const gt={annotationType:B.AnnotationEditorType.STAMP,bitmapId:Fe(this,se),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:Fe(this,fe),structTreeParentId:this._structTreeParentId};if(ft)return gt.bitmapUrl=Mt(this,ke,xo).call(this,!0),gt.accessibilityData=this.altTextData,gt;const{decorative:bt,altText:Ie}=this.altTextData;if(!bt&&Ie&&(gt.accessibilityData={type:"Figure",alt:Ie}),Et===null)return gt;Et.stamps||(Et.stamps=new Map);const pt=Fe(this,fe)?(gt.rect[2]-gt.rect[0])*(gt.rect[3]-gt.rect[1]):null;if(!Et.stamps.has(Fe(this,se)))Et.stamps.set(Fe(this,se),{area:pt,serialized:gt}),gt.bitmap=Mt(this,ke,xo).call(this,!1);else if(Fe(this,fe)){const at=Et.stamps.get(Fe(this,se));pt>at.area&&(at.area=pt,at.serialized.bitmap.close(),at.serialized.bitmap=Mt(this,ke,xo).call(this,!1))}return gt}};ae=new WeakMap,se=new WeakMap,ie=new WeakMap,le=new WeakMap,pe=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakMap,fe=new WeakMap,me=new WeakMap,ke=new WeakSet,Zi=function(ft,Et=!1){if(!ft){this.remove();return}Xt(this,ae,ft.bitmap),Et||(Xt(this,se,ft.id),Xt(this,fe,ft.isSvg)),Mt(this,ke,Pc).call(this)},es=function(){Xt(this,ie,null),this._uiManager.enableWaiting(!1),Fe(this,he)&&this.div.focus()},go=function(){if(Fe(this,se)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(Fe(this,se)).then(Et=>Mt(this,ke,Zi).call(this,Et,!0)).finally(()=>Mt(this,ke,es).call(this));return}if(Fe(this,le)){const Et=Fe(this,le);Xt(this,le,null),this._uiManager.enableWaiting(!0),Xt(this,ie,this._uiManager.imageManager.getFromUrl(Et).then(gt=>Mt(this,ke,Zi).call(this,gt)).finally(()=>Mt(this,ke,es).call(this)));return}if(Fe(this,pe)){const Et=Fe(this,pe);Xt(this,pe,null),this._uiManager.enableWaiting(!0),Xt(this,ie,this._uiManager.imageManager.getFromFile(Et).then(gt=>Mt(this,ke,Zi).call(this,gt)).finally(()=>Mt(this,ke,es).call(this)));return}const ft=document.createElement("input");ft.type="file",ft.accept=De.supportedTypesStr,Xt(this,ie,new Promise(Et=>{ft.addEventListener("change",async()=>{if(!ft.files||ft.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const gt=await this._uiManager.imageManager.getFromFile(ft.files[0]);Mt(this,ke,Zi).call(this,gt)}Et()}),ft.addEventListener("cancel",()=>{this.remove(),Et()})}).finally(()=>Mt(this,ke,es).call(this))),ft.click()},Pc=function(){const{div:ft}=this;let{width:Et,height:gt}=Fe(this,ae);const[bt,Ie]=this.pageDimensions,pt=.75;if(this.width)Et=this.width*bt,gt=this.height*Ie;else if(Et>pt*bt||gt>pt*Ie){const ve=Math.min(pt*bt/Et,pt*Ie/gt);Et*=ve,gt*=ve}const[at,Ee]=this.parentDimensions;this.setDims(Et*at/bt,gt*Ee/Ie),this._uiManager.enableWaiting(!1);const ye=Xt(this,he,document.createElement("canvas"));ft.append(ye),ft.hidden=!1,Mt(this,ke,Lc).call(this,Et,gt),Mt(this,ke,O0).call(this),Fe(this,me)||(this.parent.addUndoableEditor(this),Xt(this,me,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},N0=function(ft,Et){var pt;const[gt,bt]=this.parentDimensions;this.width=ft/gt,this.height=Et/bt,this.setDims(ft,Et),(pt=this._initialOptions)!=null&&pt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,Fe(this,ce)!==null&&clearTimeout(Fe(this,ce)),Xt(this,ce,setTimeout(()=>{Xt(this,ce,null),Mt(this,ke,Lc).call(this,ft,Et)},200))},M0=function(ft,Et){const{width:gt,height:bt}=Fe(this,ae);let Ie=gt,pt=bt,at=Fe(this,ae);for(;Ie>2*ft||pt>2*Et;){const Ee=Ie,ye=pt;Ie>2*ft&&(Ie=Ie>=16384?Math.floor(Ie/2)-1:Math.ceil(Ie/2)),pt>2*Et&&(pt=pt>=16384?Math.floor(pt/2)-1:Math.ceil(pt/2));const ve=new OffscreenCanvas(Ie,pt);ve.getContext("2d").drawImage(at,0,0,Ee,ye,0,0,Ie,pt),at=ve.transferToImageBitmap()}return at},Lc=function(ft,Et){ft=Math.ceil(ft),Et=Math.ceil(Et);const gt=Fe(this,he);if(!gt||gt.width===ft&&gt.height===Et)return;gt.width=ft,gt.height=Et;const bt=Fe(this,fe)?Fe(this,ae):Mt(this,ke,M0).call(this,ft,Et),Ie=gt.getContext("2d");Ie.filter=this._uiManager.hcmFilter,Ie.drawImage(bt,0,0,bt.width,bt.height,0,0,ft,Et)},xo=function(ft){if(ft){if(Fe(this,fe)){const bt=this._uiManager.imageManager.getSvgUrl(Fe(this,se));if(bt)return bt}const Et=document.createElement("canvas");return{width:Et.width,height:Et.height}=Fe(this,ae),Et.getContext("2d").drawImage(Fe(this,ae),0,0),Et.toDataURL()}if(Fe(this,fe)){const[Et,gt]=this.pageDimensions,bt=Math.round(this.width*Et*q.PixelsPerInch.PDF_TO_CSS_UNITS),Ie=Math.round(this.height*gt*q.PixelsPerInch.PDF_TO_CSS_UNITS),pt=new OffscreenCanvas(bt,Ie);return pt.getContext("2d").drawImage(Fe(this,ae),0,0,Fe(this,ae).width,Fe(this,ae).height,0,0,bt,Ie),pt.transferToImageBitmap()}return structuredClone(Fe(this,ae))},O0=function(){Xt(this,ue,new ResizeObserver(ft=>{const Et=ft[0].contentRect;Et.width&&Et.height&&Mt(this,ke,N0).call(this,Et.width,Et.height)})),Fe(this,ue).observe(this.div)},Kr(De,"_type","stamp");let re=De;A.StampEditor=re}],__webpack_module_cache__={};function __w_pdfjs_require__(g){var A=__webpack_module_cache__[g];if(A!==void 0)return A.exports;var L=__webpack_module_cache__[g]={exports:{}};return __webpack_modules__[g](L,L.exports,__w_pdfjs_require__),L.exports}var __webpack_exports__={};return(()=>{var g=__webpack_exports__;Object.defineProperty(g,"__esModule",{value:!0}),Object.defineProperty(g,"AbortException",{enumerable:!0,get:function(){return A.AbortException}}),Object.defineProperty(g,"AnnotationEditorLayer",{enumerable:!0,get:function(){return q.AnnotationEditorLayer}}),Object.defineProperty(g,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return A.AnnotationEditorParamsType}}),Object.defineProperty(g,"AnnotationEditorType",{enumerable:!0,get:function(){return A.AnnotationEditorType}}),Object.defineProperty(g,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return J.AnnotationEditorUIManager}}),Object.defineProperty(g,"AnnotationLayer",{enumerable:!0,get:function(){return re.AnnotationLayer}}),Object.defineProperty(g,"AnnotationMode",{enumerable:!0,get:function(){return A.AnnotationMode}}),Object.defineProperty(g,"CMapCompressionType",{enumerable:!0,get:function(){return A.CMapCompressionType}}),Object.defineProperty(g,"DOMSVGFactory",{enumerable:!0,get:function(){return B.DOMSVGFactory}}),Object.defineProperty(g,"FeatureTest",{enumerable:!0,get:function(){return A.FeatureTest}}),Object.defineProperty(g,"GlobalWorkerOptions",{enumerable:!0,get:function(){return ae.GlobalWorkerOptions}}),Object.defineProperty(g,"ImageKind",{enumerable:!0,get:function(){return A.ImageKind}}),Object.defineProperty(g,"InvalidPDFException",{enumerable:!0,get:function(){return A.InvalidPDFException}}),Object.defineProperty(g,"MissingPDFException",{enumerable:!0,get:function(){return A.MissingPDFException}}),Object.defineProperty(g,"OPS",{enumerable:!0,get:function(){return A.OPS}}),Object.defineProperty(g,"PDFDataRangeTransport",{enumerable:!0,get:function(){return L.PDFDataRangeTransport}}),Object.defineProperty(g,"PDFDateString",{enumerable:!0,get:function(){return B.PDFDateString}}),Object.defineProperty(g,"PDFWorker",{enumerable:!0,get:function(){return L.PDFWorker}}),Object.defineProperty(g,"PasswordResponses",{enumerable:!0,get:function(){return A.PasswordResponses}}),Object.defineProperty(g,"PermissionFlag",{enumerable:!0,get:function(){return A.PermissionFlag}}),Object.defineProperty(g,"PixelsPerInch",{enumerable:!0,get:function(){return B.PixelsPerInch}}),Object.defineProperty(g,"PromiseCapability",{enumerable:!0,get:function(){return A.PromiseCapability}}),Object.defineProperty(g,"RenderingCancelledException",{enumerable:!0,get:function(){return B.RenderingCancelledException}}),Object.defineProperty(g,"SVGGraphics",{enumerable:!0,get:function(){return L.SVGGraphics}}),Object.defineProperty(g,"UnexpectedResponseException",{enumerable:!0,get:function(){return A.UnexpectedResponseException}}),Object.defineProperty(g,"Util",{enumerable:!0,get:function(){return A.Util}}),Object.defineProperty(g,"VerbosityLevel",{enumerable:!0,get:function(){return A.VerbosityLevel}}),Object.defineProperty(g,"XfaLayer",{enumerable:!0,get:function(){return se.XfaLayer}}),Object.defineProperty(g,"build",{enumerable:!0,get:function(){return L.build}}),Object.defineProperty(g,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return A.createValidAbsoluteUrl}}),Object.defineProperty(g,"getDocument",{enumerable:!0,get:function(){return L.getDocument}}),Object.defineProperty(g,"getFilenameFromUrl",{enumerable:!0,get:function(){return B.getFilenameFromUrl}}),Object.defineProperty(g,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return B.getPdfFilenameFromUrl}}),Object.defineProperty(g,"getXfaPageViewport",{enumerable:!0,get:function(){return B.getXfaPageViewport}}),Object.defineProperty(g,"isDataScheme",{enumerable:!0,get:function(){return B.isDataScheme}}),Object.defineProperty(g,"isPdfFile",{enumerable:!0,get:function(){return B.isPdfFile}}),Object.defineProperty(g,"loadScript",{enumerable:!0,get:function(){return B.loadScript}}),Object.defineProperty(g,"noContextMenu",{enumerable:!0,get:function(){return B.noContextMenu}}),Object.defineProperty(g,"normalizeUnicode",{enumerable:!0,get:function(){return A.normalizeUnicode}}),Object.defineProperty(g,"renderTextLayer",{enumerable:!0,get:function(){return W.renderTextLayer}}),Object.defineProperty(g,"setLayerDimensions",{enumerable:!0,get:function(){return B.setLayerDimensions}}),Object.defineProperty(g,"shadow",{enumerable:!0,get:function(){return A.shadow}}),Object.defineProperty(g,"updateTextLayer",{enumerable:!0,get:function(){return W.updateTextLayer}}),Object.defineProperty(g,"version",{enumerable:!0,get:function(){return L.version}});var A=__w_pdfjs_require__(1),L=__w_pdfjs_require__(2),B=__w_pdfjs_require__(6),W=__w_pdfjs_require__(26),q=__w_pdfjs_require__(27),J=__w_pdfjs_require__(5),re=__w_pdfjs_require__(29),ae=__w_pdfjs_require__(14),se=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(g){VALID_ANSI.indexOf(g)!=-1&&(current_ansi=CS2CP[0]=g)};function reset_ansi(){set_ansi(1252)}var set_cp=function(g){set_ansi(g)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(g){for(var A=[],L=0,B=g.length;L<B;++L)A[L]=g.charCodeAt(L);return A}function utf16leread(g){for(var A=[],L=0;L<g.length>>1;++L)A[L]=String.fromCharCode(g.charCodeAt(2*L)+(g.charCodeAt(2*L+1)<<8));return A.join("")}function utf16beread(g){for(var A=[],L=0;L<g.length>>1;++L)A[L]=String.fromCharCode(g.charCodeAt(2*L+1)+(g.charCodeAt(2*L)<<8));return A.join("")}var debom=function(g){var A=g.charCodeAt(0),L=g.charCodeAt(1);return A==255&&L==254?utf16leread(g.slice(2)):A==254&&L==255?utf16beread(g.slice(2)):A==65279?g.slice(1):g},_getchar=function g(A){return String.fromCharCode(A)},_getansi=function g(A){return String.fromCharCode(A)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(g){for(var A="",L=0,B=0,W=0,q=0,J=0,re=0,ae=0,se=0;se<g.length;)L=g.charCodeAt(se++),q=L>>2,B=g.charCodeAt(se++),J=(L&3)<<4|B>>4,W=g.charCodeAt(se++),re=(B&15)<<2|W>>6,ae=W&63,isNaN(B)?re=ae=64:isNaN(W)&&(ae=64),A+=Base64_map.charAt(q)+Base64_map.charAt(J)+Base64_map.charAt(re)+Base64_map.charAt(ae);return A}function Base64_decode(g){var A="",L=0,B=0,W=0,q=0,J=0,re=0,ae=0;g=g.replace(/[^\w\+\/\=]/g,"");for(var se=0;se<g.length;)q=Base64_map.indexOf(g.charAt(se++)),J=Base64_map.indexOf(g.charAt(se++)),L=q<<2|J>>4,A+=String.fromCharCode(L),re=Base64_map.indexOf(g.charAt(se++)),B=(J&15)<<4|re>>2,re!==64&&(A+=String.fromCharCode(B)),ae=Base64_map.indexOf(g.charAt(se++)),W=(re&3)<<6|ae,ae!==64&&(A+=String.fromCharCode(W));return A}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var g=!Buffer.from;if(!g)try{Buffer.from("foo","utf8")}catch{g=!0}return g?function(A,L){return L?new Buffer(A,L):new Buffer(A)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(g){return has_buf?Buffer.alloc?Buffer.alloc(g):new Buffer(g):typeof Uint8Array<"u"?new Uint8Array(g):new Array(g)}function new_unsafe_buf(g){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(g):new Buffer(g):typeof Uint8Array<"u"?new Uint8Array(g):new Array(g)}var s2a=function g(A){return has_buf?Buffer_from(A,"binary"):A.split("").map(function(L){return L.charCodeAt(0)&255})};function s2ab(g){if(typeof ArrayBuffer>"u")return s2a(g);for(var A=new ArrayBuffer(g.length),L=new Uint8Array(A),B=0;B!=g.length;++B)L[B]=g.charCodeAt(B)&255;return A}function a2s(g){if(Array.isArray(g))return g.map(function(B){return String.fromCharCode(B)}).join("");for(var A=[],L=0;L<g.length;++L)A[L]=String.fromCharCode(g[L]);return A.join("")}function a2u(g){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(g)}function ab2a(g){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(g instanceof ArrayBuffer)return ab2a(new Uint8Array(g));for(var A=new Array(g.length),L=0;L<g.length;++L)A[L]=g[L];return A}var bconcat=has_buf?function(g){return Buffer.concat(g.map(function(A){return Buffer.isBuffer(A)?A:Buffer_from(A)}))}:function(g){if(typeof Uint8Array<"u"){var A=0,L=0;for(A=0;A<g.length;++A)L+=g[A].length;var B=new Uint8Array(L),W=0;for(A=0,L=0;A<g.length;L+=W,++A)if(W=g[A].length,g[A]instanceof Uint8Array)B.set(g[A],L);else{if(typeof g[A]=="string")throw"wtf";B.set(new Uint8Array(g[A]),L)}return B}return[].concat.apply([],g.map(function(q){return Array.isArray(q)?q:[].slice.call(q)}))};function utf8decode(g){for(var A=[],L=0,B=g.length+250,W=new_raw_buf(g.length+255),q=0;q<g.length;++q){var J=g.charCodeAt(q);if(J<128)W[L++]=J;else if(J<2048)W[L++]=192|J>>6&31,W[L++]=128|J&63;else if(J>=55296&&J<57344){J=(J&1023)+64;var re=g.charCodeAt(++q)&1023;W[L++]=240|J>>8&7,W[L++]=128|J>>2&63,W[L++]=128|re>>6&15|(J&3)<<4,W[L++]=128|re&63}else W[L++]=224|J>>12&15,W[L++]=128|J>>6&63,W[L++]=128|J&63;L>B&&(A.push(W.slice(0,L)),L=0,W=new_raw_buf(65535),B=65530)}return A.push(W.slice(0,L)),bconcat(A)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(g){for(var A="",L=g.length-1;L>=0;)A+=g.charAt(L--);return A}function pad0(g,A){var L=""+g;return L.length>=A?L:fill("0",A-L.length)+L}function pad_(g,A){var L=""+g;return L.length>=A?L:fill(" ",A-L.length)+L}function rpad_(g,A){var L=""+g;return L.length>=A?L:L+fill(" ",A-L.length)}function pad0r1(g,A){var L=""+Math.round(g);return L.length>=A?L:fill("0",A-L.length)+L}function pad0r2(g,A){var L=""+g;return L.length>=A?L:fill("0",A-L.length)+L}var p2_32=Math.pow(2,32);function pad0r(g,A){if(g>p2_32||g<-p2_32)return pad0r1(g,A);var L=Math.round(g);return pad0r2(L,A)}function SSF_isgeneral(g,A){return A=A||0,g.length>=7+A&&(g.charCodeAt(A)|32)===103&&(g.charCodeAt(A+1)|32)===101&&(g.charCodeAt(A+2)|32)===110&&(g.charCodeAt(A+3)|32)===101&&(g.charCodeAt(A+4)|32)===114&&(g.charCodeAt(A+5)|32)===97&&(g.charCodeAt(A+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(g){return g||(g={}),g[0]="General",g[1]="0",g[2]="0.00",g[3]="#,##0",g[4]="#,##0.00",g[9]="0%",g[10]="0.00%",g[11]="0.00E+00",g[12]="# ?/?",g[13]="# ??/??",g[14]="m/d/yy",g[15]="d-mmm-yy",g[16]="d-mmm",g[17]="mmm-yy",g[18]="h:mm AM/PM",g[19]="h:mm:ss AM/PM",g[20]="h:mm",g[21]="h:mm:ss",g[22]="m/d/yy h:mm",g[37]="#,##0 ;(#,##0)",g[38]="#,##0 ;[Red](#,##0)",g[39]="#,##0.00;(#,##0.00)",g[40]="#,##0.00;[Red](#,##0.00)",g[45]="mm:ss",g[46]="[h]:mm:ss",g[47]="mmss.0",g[48]="##0.0E+0",g[49]="@",g[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',g}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(g,A,L){for(var B=g<0?-1:1,W=g*B,q=0,J=1,re=0,ae=1,se=0,ie=0,le=Math.floor(W);se<A&&(le=Math.floor(W),re=le*J+q,ie=le*se+ae,!(W-le<5e-8));)W=1/(W-le),q=J,J=re,ae=se,se=ie;if(ie>A&&(se>A?(ie=ae,re=q):(ie=se,re=J)),!L)return[0,B*re,ie];var pe=Math.floor(B*re/ie);return[pe,B*re-pe*ie,ie]}function SSF_parse_date_code(g,A,L){if(g>2958465||g<0)return null;var B=g|0,W=Math.floor(86400*(g-B)),q=0,J=[],re={D:B,T:W,u:86400*(g-B)-W,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(re.u)<1e-6&&(re.u=0),A&&A.date1904&&(B+=1462),re.u>.9999&&(re.u=0,++W==86400&&(re.T=W=0,++B,++re.D)),B===60)J=L?[1317,10,29]:[1900,2,29],q=3;else if(B===0)J=L?[1317,8,29]:[1900,1,0],q=6;else{B>60&&--B;var ae=new Date(1900,0,1);ae.setDate(ae.getDate()+B-1),J=[ae.getFullYear(),ae.getMonth()+1,ae.getDate()],q=ae.getDay(),B<60&&(q=(q+6)%7),L&&(q=SSF_fix_hijri(ae,J))}return re.y=J[0],re.m=J[1],re.d=J[2],re.S=W%60,W=Math.floor(W/60),re.M=W%60,W=Math.floor(W/60),re.H=W,re.q=q,re}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(g,A){var L=g.getTime();return A?L-=1461*24*60*60*1e3:g>=SSFbase1904&&(L+=24*60*60*1e3),(L-(SSFdnthresh+(g.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(g){return g.indexOf(".")==-1?g:g.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(g){return g.indexOf("E")==-1?g:g.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(g){var A=g<0?12:11,L=SSF_strip_decimal(g.toFixed(12));return L.length<=A||(L=g.toPrecision(10),L.length<=A)?L:g.toExponential(5)}function SSF_large_exp(g){var A=SSF_strip_decimal(g.toFixed(11));return A.length>(g<0?12:11)||A==="0"||A==="-0"?g.toPrecision(6):A}function SSF_general_num(g){var A=Math.floor(Math.log(Math.abs(g))*Math.LOG10E),L;return A>=-4&&A<=-1?L=g.toPrecision(10+A):Math.abs(A)<=9?L=SSF_small_exp(g):A===10?L=g.toFixed(10).substr(0,12):L=SSF_large_exp(g),SSF_strip_decimal(SSF_normalize_exp(L.toUpperCase()))}function SSF_general(g,A){switch(typeof g){case"string":return g;case"boolean":return g?"TRUE":"FALSE";case"number":return(g|0)===g?g.toString(10):SSF_general_num(g);case"undefined":return"";case"object":if(g==null)return"";if(g instanceof Date)return SSF_format(14,datenum_local(g,A&&A.date1904),A)}throw new Error("unsupported value in General format: "+g)}function SSF_fix_hijri(g,A){A[0]-=581;var L=g.getDay();return g<60&&(L=(L+6)%7),L}function SSF_write_date(g,A,L,B){var W="",q=0,J=0,re=L.y,ae,se=0;switch(g){case 98:re=L.y+543;case 121:switch(A.length){case 1:case 2:ae=re%100,se=2;break;default:ae=re%1e4,se=4;break}break;case 109:switch(A.length){case 1:case 2:ae=L.m,se=A.length;break;case 3:return months[L.m-1][1];case 5:return months[L.m-1][0];default:return months[L.m-1][2]}break;case 100:switch(A.length){case 1:case 2:ae=L.d,se=A.length;break;case 3:return days[L.q][0];default:return days[L.q][1]}break;case 104:switch(A.length){case 1:case 2:ae=1+(L.H+11)%12,se=A.length;break;default:throw"bad hour format: "+A}break;case 72:switch(A.length){case 1:case 2:ae=L.H,se=A.length;break;default:throw"bad hour format: "+A}break;case 77:switch(A.length){case 1:case 2:ae=L.M,se=A.length;break;default:throw"bad minute format: "+A}break;case 115:if(A!="s"&&A!="ss"&&A!=".0"&&A!=".00"&&A!=".000")throw"bad second format: "+A;return L.u===0&&(A=="s"||A=="ss")?pad0(L.S,A.length):(B>=2?J=B===3?1e3:100:J=B===1?10:1,q=Math.round(J*(L.S+L.u)),q>=60*J&&(q=0),A==="s"?q===0?"0":""+q/J:(W=pad0(q,2+B),A==="ss"?W.substr(0,2):"."+W.substr(2,A.length-1)));case 90:switch(A){case"[h]":case"[hh]":ae=L.D*24+L.H;break;case"[m]":case"[mm]":ae=(L.D*24+L.H)*60+L.M;break;case"[s]":case"[ss]":ae=((L.D*24+L.H)*60+L.M)*60+Math.round(L.S+L.u);break;default:throw"bad abstime format: "+A}se=A.length===3?1:2;break;case 101:ae=re,se=1;break}var ie=se>0?pad0(ae,se):"";return ie}function commaify(g){var A=3;if(g.length<=A)return g;for(var L=g.length%A,B=g.substr(0,L);L!=g.length;L+=A)B+=(B.length>0?",":"")+g.substr(L,A);return B}var pct1=/%/g;function write_num_pct(g,A,L){var B=A.replace(pct1,""),W=A.length-B.length;return write_num(g,B,L*Math.pow(10,2*W))+fill("%",W)}function write_num_cm(g,A,L){for(var B=A.length-1;A.charCodeAt(B-1)===44;)--B;return write_num(g,A.substr(0,B),L/Math.pow(10,3*(A.length-B)))}function write_num_exp(g,A){var L,B=g.indexOf("E")-g.indexOf(".")-1;if(g.match(/^#+0.0E\+0$/)){if(A==0)return"0.0E+0";if(A<0)return"-"+write_num_exp(g,-A);var W=g.indexOf(".");W===-1&&(W=g.indexOf("E"));var q=Math.floor(Math.log(A)*Math.LOG10E)%W;if(q<0&&(q+=W),L=(A/Math.pow(10,q)).toPrecision(B+1+(W+q)%W),L.indexOf("e")===-1){var J=Math.floor(Math.log(A)*Math.LOG10E);for(L.indexOf(".")===-1?L=L.charAt(0)+"."+L.substr(1)+"E+"+(J-L.length+q):L+="E+"+(J-q);L.substr(0,2)==="0.";)L=L.charAt(0)+L.substr(2,W)+"."+L.substr(2+W),L=L.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");L=L.replace(/\+-/,"-")}L=L.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(re,ae,se,ie){return ae+se+ie.substr(0,(W+q)%W)+"."+ie.substr(q)+"E"})}else L=A.toExponential(B);return g.match(/E\+00$/)&&L.match(/e[+-]\d$/)&&(L=L.substr(0,L.length-1)+"0"+L.charAt(L.length-1)),g.match(/E\-/)&&L.match(/e\+/)&&(L=L.replace(/e\+/,"e")),L.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(g,A,L){var B=parseInt(g[4],10),W=Math.round(A*B),q=Math.floor(W/B),J=W-q*B,re=B;return L+(q===0?"":""+q)+" "+(J===0?fill(" ",g[1].length+1+g[4].length):pad_(J,g[1].length)+g[2]+"/"+g[3]+pad0(re,g[4].length))}function write_num_f2(g,A,L){return L+(A===0?"":""+A)+fill(" ",g[1].length+2+g[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(g){for(var A="",L,B=0;B!=g.length;++B)switch(L=g.charCodeAt(B)){case 35:break;case 63:A+=" ";break;case 48:A+="0";break;default:A+=String.fromCharCode(L)}return A}function rnd(g,A){var L=Math.pow(10,A);return""+Math.round(g*L)/L}function dec(g,A){var L=g-Math.floor(g),B=Math.pow(10,A);return A<(""+Math.round(L*B)).length?0:Math.round(L*B)}function carry(g,A){return A<(""+Math.round((g-Math.floor(g))*Math.pow(10,A))).length?1:0}function flr(g){return g<2147483647&&g>-2147483648?""+(g>=0?g|0:g-1|0):""+Math.floor(g)}function write_num_flt(g,A,L){if(g.charCodeAt(0)===40&&!A.match(closeparen)){var B=A.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return L>=0?write_num_flt("n",B,L):"("+write_num_flt("n",B,-L)+")"}if(A.charCodeAt(A.length-1)===44)return write_num_cm(g,A,L);if(A.indexOf("%")!==-1)return write_num_pct(g,A,L);if(A.indexOf("E")!==-1)return write_num_exp(A,L);if(A.charCodeAt(0)===36)return"$"+write_num_flt(g,A.substr(A.charAt(1)==" "?2:1),L);var W,q,J,re,ae=Math.abs(L),se=L<0?"-":"";if(A.match(/^00+$/))return se+pad0r(ae,A.length);if(A.match(/^[#?]+$/))return W=pad0r(L,0),W==="0"&&(W=""),W.length>A.length?W:hashq(A.substr(0,A.length-W.length))+W;if(q=A.match(frac1))return write_num_f1(q,ae,se);if(A.match(/^#+0+$/))return se+pad0r(ae,A.length-A.indexOf("0"));if(q=A.match(dec1))return W=rnd(L,q[1].length).replace(/^([^\.]+)$/,"$1."+hashq(q[1])).replace(/\.$/,"."+hashq(q[1])).replace(/\.(\d*)$/,function(ue,ce){return"."+ce+fill("0",hashq(q[1]).length-ce.length)}),A.indexOf("0.")!==-1?W:W.replace(/^0\./,".");if(A=A.replace(/^#+([0.])/,"$1"),q=A.match(/^(0*)\.(#*)$/))return se+rnd(ae,q[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,q[1].length?"0.":".");if(q=A.match(/^#{1,3},##0(\.?)$/))return se+commaify(pad0r(ae,0));if(q=A.match(/^#,##0\.([#0]*0)$/))return L<0?"-"+write_num_flt(g,A,-L):commaify(""+(Math.floor(L)+carry(L,q[1].length)))+"."+pad0(dec(L,q[1].length),q[1].length);if(q=A.match(/^#,#*,#0/))return write_num_flt(g,A.replace(/^#,#*,/,""),L);if(q=A.match(/^([0#]+)(\\?-([0#]+))+$/))return W=_strrev(write_num_flt(g,A.replace(/[\\-]/g,""),L)),J=0,_strrev(_strrev(A.replace(/\\/g,"")).replace(/[0#]/g,function(ue){return J<W.length?W.charAt(J++):ue==="0"?"0":""}));if(A.match(phone))return W=write_num_flt(g,"##########",L),"("+W.substr(0,3)+") "+W.substr(3,3)+"-"+W.substr(6);var ie="";if(q=A.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return J=Math.min(q[4].length,7),re=SSF_frac(ae,Math.pow(10,J)-1,!1),W=""+se,ie=write_num("n",q[1],re[1]),ie.charAt(ie.length-1)==" "&&(ie=ie.substr(0,ie.length-1)+"0"),W+=ie+q[2]+"/"+q[3],ie=rpad_(re[2],J),ie.length<q[4].length&&(ie=hashq(q[4].substr(q[4].length-ie.length))+ie),W+=ie,W;if(q=A.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return J=Math.min(Math.max(q[1].length,q[4].length),7),re=SSF_frac(ae,Math.pow(10,J)-1,!0),se+(re[0]||(re[1]?"":"0"))+" "+(re[1]?pad_(re[1],J)+q[2]+"/"+q[3]+rpad_(re[2],J):fill(" ",2*J+1+q[2].length+q[3].length));if(q=A.match(/^[#0?]+$/))return W=pad0r(L,0),A.length<=W.length?W:hashq(A.substr(0,A.length-W.length))+W;if(q=A.match(/^([#0?]+)\.([#0]+)$/)){W=""+L.toFixed(Math.min(q[2].length,10)).replace(/([^0])0+$/,"$1"),J=W.indexOf(".");var le=A.indexOf(".")-J,pe=A.length-W.length-le;return hashq(A.substr(0,le)+W+A.substr(A.length-pe))}if(q=A.match(/^00,000\.([#0]*0)$/))return J=dec(L,q[1].length),L<0?"-"+write_num_flt(g,A,-L):commaify(flr(L)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ue){return"00,"+(ue.length<3?pad0(0,3-ue.length):"")+ue})+"."+pad0(J,q[1].length);switch(A){case"###,##0.00":return write_num_flt(g,"#,##0.00",L);case"###,###":case"##,###":case"#,###":var he=commaify(pad0r(ae,0));return he!=="0"?se+he:"";case"###,###.00":return write_num_flt(g,"###,##0.00",L).replace(/^0\./,".");case"#,###.00":return write_num_flt(g,"#,##0.00",L).replace(/^0\./,".")}throw new Error("unsupported format |"+A+"|")}function write_num_cm2(g,A,L){for(var B=A.length-1;A.charCodeAt(B-1)===44;)--B;return write_num(g,A.substr(0,B),L/Math.pow(10,3*(A.length-B)))}function write_num_pct2(g,A,L){var B=A.replace(pct1,""),W=A.length-B.length;return write_num(g,B,L*Math.pow(10,2*W))+fill("%",W)}function write_num_exp2(g,A){var L,B=g.indexOf("E")-g.indexOf(".")-1;if(g.match(/^#+0.0E\+0$/)){if(A==0)return"0.0E+0";if(A<0)return"-"+write_num_exp2(g,-A);var W=g.indexOf(".");W===-1&&(W=g.indexOf("E"));var q=Math.floor(Math.log(A)*Math.LOG10E)%W;if(q<0&&(q+=W),L=(A/Math.pow(10,q)).toPrecision(B+1+(W+q)%W),!L.match(/[Ee]/)){var J=Math.floor(Math.log(A)*Math.LOG10E);L.indexOf(".")===-1?L=L.charAt(0)+"."+L.substr(1)+"E+"+(J-L.length+q):L+="E+"+(J-q),L=L.replace(/\+-/,"-")}L=L.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(re,ae,se,ie){return ae+se+ie.substr(0,(W+q)%W)+"."+ie.substr(q)+"E"})}else L=A.toExponential(B);return g.match(/E\+00$/)&&L.match(/e[+-]\d$/)&&(L=L.substr(0,L.length-1)+"0"+L.charAt(L.length-1)),g.match(/E\-/)&&L.match(/e\+/)&&(L=L.replace(/e\+/,"e")),L.replace("e","E")}function write_num_int(g,A,L){if(g.charCodeAt(0)===40&&!A.match(closeparen)){var B=A.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return L>=0?write_num_int("n",B,L):"("+write_num_int("n",B,-L)+")"}if(A.charCodeAt(A.length-1)===44)return write_num_cm2(g,A,L);if(A.indexOf("%")!==-1)return write_num_pct2(g,A,L);if(A.indexOf("E")!==-1)return write_num_exp2(A,L);if(A.charCodeAt(0)===36)return"$"+write_num_int(g,A.substr(A.charAt(1)==" "?2:1),L);var W,q,J,re,ae=Math.abs(L),se=L<0?"-":"";if(A.match(/^00+$/))return se+pad0(ae,A.length);if(A.match(/^[#?]+$/))return W=""+L,L===0&&(W=""),W.length>A.length?W:hashq(A.substr(0,A.length-W.length))+W;if(q=A.match(frac1))return write_num_f2(q,ae,se);if(A.match(/^#+0+$/))return se+pad0(ae,A.length-A.indexOf("0"));if(q=A.match(dec1))return W=(""+L).replace(/^([^\.]+)$/,"$1."+hashq(q[1])).replace(/\.$/,"."+hashq(q[1])),W=W.replace(/\.(\d*)$/,function(ue,ce){return"."+ce+fill("0",hashq(q[1]).length-ce.length)}),A.indexOf("0.")!==-1?W:W.replace(/^0\./,".");if(A=A.replace(/^#+([0.])/,"$1"),q=A.match(/^(0*)\.(#*)$/))return se+(""+ae).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,q[1].length?"0.":".");if(q=A.match(/^#{1,3},##0(\.?)$/))return se+commaify(""+ae);if(q=A.match(/^#,##0\.([#0]*0)$/))return L<0?"-"+write_num_int(g,A,-L):commaify(""+L)+"."+fill("0",q[1].length);if(q=A.match(/^#,#*,#0/))return write_num_int(g,A.replace(/^#,#*,/,""),L);if(q=A.match(/^([0#]+)(\\?-([0#]+))+$/))return W=_strrev(write_num_int(g,A.replace(/[\\-]/g,""),L)),J=0,_strrev(_strrev(A.replace(/\\/g,"")).replace(/[0#]/g,function(ue){return J<W.length?W.charAt(J++):ue==="0"?"0":""}));if(A.match(phone))return W=write_num_int(g,"##########",L),"("+W.substr(0,3)+") "+W.substr(3,3)+"-"+W.substr(6);var ie="";if(q=A.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return J=Math.min(q[4].length,7),re=SSF_frac(ae,Math.pow(10,J)-1,!1),W=""+se,ie=write_num("n",q[1],re[1]),ie.charAt(ie.length-1)==" "&&(ie=ie.substr(0,ie.length-1)+"0"),W+=ie+q[2]+"/"+q[3],ie=rpad_(re[2],J),ie.length<q[4].length&&(ie=hashq(q[4].substr(q[4].length-ie.length))+ie),W+=ie,W;if(q=A.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return J=Math.min(Math.max(q[1].length,q[4].length),7),re=SSF_frac(ae,Math.pow(10,J)-1,!0),se+(re[0]||(re[1]?"":"0"))+" "+(re[1]?pad_(re[1],J)+q[2]+"/"+q[3]+rpad_(re[2],J):fill(" ",2*J+1+q[2].length+q[3].length));if(q=A.match(/^[#0?]+$/))return W=""+L,A.length<=W.length?W:hashq(A.substr(0,A.length-W.length))+W;if(q=A.match(/^([#0]+)\.([#0]+)$/)){W=""+L.toFixed(Math.min(q[2].length,10)).replace(/([^0])0+$/,"$1"),J=W.indexOf(".");var le=A.indexOf(".")-J,pe=A.length-W.length-le;return hashq(A.substr(0,le)+W+A.substr(A.length-pe))}if(q=A.match(/^00,000\.([#0]*0)$/))return L<0?"-"+write_num_int(g,A,-L):commaify(""+L).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ue){return"00,"+(ue.length<3?pad0(0,3-ue.length):"")+ue})+"."+pad0(0,q[1].length);switch(A){case"###,###":case"##,###":case"#,###":var he=commaify(""+ae);return he!=="0"?se+he:"";default:if(A.match(/\.[0#?]*$/))return write_num_int(g,A.slice(0,A.lastIndexOf(".")),L)+hashq(A.slice(A.lastIndexOf(".")))}throw new Error("unsupported format |"+A+"|")}function write_num(g,A,L){return(L|0)===L?write_num_int(g,A,L):write_num_flt(g,A,L)}function SSF_split_fmt(g){for(var A=[],L=!1,B=0,W=0;B<g.length;++B)switch(g.charCodeAt(B)){case 34:L=!L;break;case 95:case 42:case 92:++B;break;case 59:A[A.length]=g.substr(W,B-W),W=B+1}if(A[A.length]=g.substr(W),L===!0)throw new Error("Format |"+g+"| unterminated string ");return A}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(g){for(var A=0,L="",B="";A<g.length;)switch(L=g.charAt(A)){case"G":SSF_isgeneral(g,A)&&(A+=6),A++;break;case'"':for(;g.charCodeAt(++A)!==34&&A<g.length;);++A;break;case"\\":A+=2;break;case"_":A+=2;break;case"@":++A;break;case"B":case"b":if(g.charAt(A+1)==="1"||g.charAt(A+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(g.substr(A,3).toUpperCase()==="A/P"||g.substr(A,5).toUpperCase()==="AM/PM"||g.substr(A,5).toUpperCase()==="上午/下午")return!0;++A;break;case"[":for(B=L;g.charAt(A++)!=="]"&&A<g.length;)B+=g.charAt(A);if(B.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;A<g.length&&("0#?.,E+-%".indexOf(L=g.charAt(++A))>-1||L=="\\"&&g.charAt(A+1)=="-"&&"0#".indexOf(g.charAt(A+2))>-1););break;case"?":for(;g.charAt(++A)===L;);break;case"*":++A,(g.charAt(A)==" "||g.charAt(A)=="*")&&++A;break;case"(":case")":++A;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;A<g.length&&"0123456789".indexOf(g.charAt(++A))>-1;);break;case" ":++A;break;default:++A;break}return!1}function eval_fmt(g,A,L,B){for(var W=[],q="",J=0,re="",ae="t",se,ie,le,pe="H";J<g.length;)switch(re=g.charAt(J)){case"G":if(!SSF_isgeneral(g,J))throw new Error("unrecognized character "+re+" in "+g);W[W.length]={t:"G",v:"General"},J+=7;break;case'"':for(q="";(le=g.charCodeAt(++J))!==34&&J<g.length;)q+=String.fromCharCode(le);W[W.length]={t:"t",v:q},++J;break;case"\\":var he=g.charAt(++J),ue=he==="("||he===")"?he:"t";W[W.length]={t:ue,v:he},++J;break;case"_":W[W.length]={t:"t",v:" "},J+=2;break;case"@":W[W.length]={t:"T",v:A},++J;break;case"B":case"b":if(g.charAt(J+1)==="1"||g.charAt(J+1)==="2"){if(se==null&&(se=SSF_parse_date_code(A,L,g.charAt(J+1)==="2"),se==null))return"";W[W.length]={t:"X",v:g.substr(J,2)},ae=re,J+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":re=re.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(A<0||se==null&&(se=SSF_parse_date_code(A,L),se==null))return"";for(q=re;++J<g.length&&g.charAt(J).toLowerCase()===re;)q+=re;re==="m"&&ae.toLowerCase()==="h"&&(re="M"),re==="h"&&(re=pe),W[W.length]={t:re,v:q},ae=re;break;case"A":case"a":case"上":var ce={t:re,v:re};if(se==null&&(se=SSF_parse_date_code(A,L)),g.substr(J,3).toUpperCase()==="A/P"?(se!=null&&(ce.v=se.H>=12?"P":"A"),ce.t="T",pe="h",J+=3):g.substr(J,5).toUpperCase()==="AM/PM"?(se!=null&&(ce.v=se.H>=12?"PM":"AM"),ce.t="T",J+=5,pe="h"):g.substr(J,5).toUpperCase()==="上午/下午"?(se!=null&&(ce.v=se.H>=12?"下午":"上午"),ce.t="T",J+=5,pe="h"):(ce.t="t",++J),se==null&&ce.t==="T")return"";W[W.length]=ce,ae=re;break;case"[":for(q=re;g.charAt(J++)!=="]"&&J<g.length;)q+=g.charAt(J);if(q.slice(-1)!=="]")throw'unterminated "[" block: |'+q+"|";if(q.match(SSF_abstime)){if(se==null&&(se=SSF_parse_date_code(A,L),se==null))return"";W[W.length]={t:"Z",v:q.toLowerCase()},ae=q.charAt(1)}else q.indexOf("$")>-1&&(q=(q.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(g)||(W[W.length]={t:"t",v:q}));break;case".":if(se!=null){for(q=re;++J<g.length&&(re=g.charAt(J))==="0";)q+=re;W[W.length]={t:"s",v:q};break}case"0":case"#":for(q=re;++J<g.length&&"0#?.,E+-%".indexOf(re=g.charAt(J))>-1;)q+=re;W[W.length]={t:"n",v:q};break;case"?":for(q=re;g.charAt(++J)===re;)q+=re;W[W.length]={t:re,v:q},ae=re;break;case"*":++J,(g.charAt(J)==" "||g.charAt(J)=="*")&&++J;break;case"(":case")":W[W.length]={t:B===1?"t":re,v:re},++J;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(q=re;J<g.length&&"0123456789".indexOf(g.charAt(++J))>-1;)q+=g.charAt(J);W[W.length]={t:"D",v:q};break;case" ":W[W.length]={t:re,v:re},++J;break;case"$":W[W.length]={t:"t",v:"$"},++J;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(re)===-1)throw new Error("unrecognized character "+re+" in "+g);W[W.length]={t:"t",v:re},++J;break}var fe=0,me=0,ke;for(J=W.length-1,ae="t";J>=0;--J)switch(W[J].t){case"h":case"H":W[J].t=pe,ae="h",fe<1&&(fe=1);break;case"s":(ke=W[J].v.match(/\.0+$/))&&(me=Math.max(me,ke[0].length-1)),fe<3&&(fe=3);case"d":case"y":case"M":case"e":ae=W[J].t;break;case"m":ae==="s"&&(W[J].t="M",fe<2&&(fe=2));break;case"X":break;case"Z":fe<1&&W[J].v.match(/[Hh]/)&&(fe=1),fe<2&&W[J].v.match(/[Mm]/)&&(fe=2),fe<3&&W[J].v.match(/[Ss]/)&&(fe=3)}switch(fe){case 0:break;case 1:se.u>=.5&&(se.u=0,++se.S),se.S>=60&&(se.S=0,++se.M),se.M>=60&&(se.M=0,++se.H);break;case 2:se.u>=.5&&(se.u=0,++se.S),se.S>=60&&(se.S=0,++se.M);break}var xe="",Le;for(J=0;J<W.length;++J)switch(W[J].t){case"t":case"T":case" ":case"D":break;case"X":W[J].v="",W[J].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":W[J].v=SSF_write_date(W[J].t.charCodeAt(0),W[J].v,se,me),W[J].t="t";break;case"n":case"?":for(Le=J+1;W[Le]!=null&&((re=W[Le].t)==="?"||re==="D"||(re===" "||re==="t")&&W[Le+1]!=null&&(W[Le+1].t==="?"||W[Le+1].t==="t"&&W[Le+1].v==="/")||W[J].t==="("&&(re===" "||re==="n"||re===")")||re==="t"&&(W[Le].v==="/"||W[Le].v===" "&&W[Le+1]!=null&&W[Le+1].t=="?"));)W[J].v+=W[Le].v,W[Le]={v:"",t:";"},++Le;xe+=W[J].v,J=Le-1;break;case"G":W[J].t="t",W[J].v=SSF_general(A,L);break}var Se="",Te,ge;if(xe.length>0){xe.charCodeAt(0)==40?(Te=A<0&&xe.charCodeAt(0)===45?-A:A,ge=write_num("n",xe,Te)):(Te=A<0&&B>1?-A:A,ge=write_num("n",xe,Te),Te<0&&W[0]&&W[0].t=="t"&&(ge=ge.substr(1),W[0].v="-"+W[0].v)),Le=ge.length-1;var Ce=W.length;for(J=0;J<W.length;++J)if(W[J]!=null&&W[J].t!="t"&&W[J].v.indexOf(".")>-1){Ce=J;break}var be=W.length;if(Ce===W.length&&ge.indexOf("E")===-1){for(J=W.length-1;J>=0;--J)W[J]==null||"n?".indexOf(W[J].t)===-1||(Le>=W[J].v.length-1?(Le-=W[J].v.length,W[J].v=ge.substr(Le+1,W[J].v.length)):Le<0?W[J].v="":(W[J].v=ge.substr(0,Le+1),Le=-1),W[J].t="t",be=J);Le>=0&&be<W.length&&(W[be].v=ge.substr(0,Le+1)+W[be].v)}else if(Ce!==W.length&&ge.indexOf("E")===-1){for(Le=ge.indexOf(".")-1,J=Ce;J>=0;--J)if(!(W[J]==null||"n?".indexOf(W[J].t)===-1)){for(ie=W[J].v.indexOf(".")>-1&&J===Ce?W[J].v.indexOf(".")-1:W[J].v.length-1,Se=W[J].v.substr(ie+1);ie>=0;--ie)Le>=0&&(W[J].v.charAt(ie)==="0"||W[J].v.charAt(ie)==="#")&&(Se=ge.charAt(Le--)+Se);W[J].v=Se,W[J].t="t",be=J}for(Le>=0&&be<W.length&&(W[be].v=ge.substr(0,Le+1)+W[be].v),Le=ge.indexOf(".")+1,J=Ce;J<W.length;++J)if(!(W[J]==null||"n?(".indexOf(W[J].t)===-1&&J!==Ce)){for(ie=W[J].v.indexOf(".")>-1&&J===Ce?W[J].v.indexOf(".")+1:0,Se=W[J].v.substr(0,ie);ie<W[J].v.length;++ie)Le<ge.length&&(Se+=ge.charAt(Le++));W[J].v=Se,W[J].t="t",be=J}}}for(J=0;J<W.length;++J)W[J]!=null&&"n?".indexOf(W[J].t)>-1&&(Te=B>1&&A<0&&J>0&&W[J-1].v==="-"?-A:A,W[J].v=write_num(W[J].t,W[J].v,Te),W[J].t="t");var nt="";for(J=0;J!==W.length;++J)W[J]!=null&&(nt+=W[J].v);return nt}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(g,A){if(A==null)return!1;var L=parseFloat(A[2]);switch(A[1]){case"=":if(g==L)return!0;break;case">":if(g>L)return!0;break;case"<":if(g<L)return!0;break;case"<>":if(g!=L)return!0;break;case">=":if(g>=L)return!0;break;case"<=":if(g<=L)return!0;break}return!1}function choose_fmt(g,A){var L=SSF_split_fmt(g),B=L.length,W=L[B-1].indexOf("@");if(B<4&&W>-1&&--B,L.length>4)throw new Error("cannot find right format for |"+L.join("|")+"|");if(typeof A!="number")return[4,L.length===4||W>-1?L[L.length-1]:"@"];switch(L.length){case 1:L=W>-1?["General","General","General",L[0]]:[L[0],L[0],L[0],"@"];break;case 2:L=W>-1?[L[0],L[0],L[0],L[1]]:[L[0],L[1],L[0],"@"];break;case 3:L=W>-1?[L[0],L[1],L[0],L[2]]:[L[0],L[1],L[2],"@"];break}var q=A>0?L[0]:A<0?L[1]:L[2];if(L[0].indexOf("[")===-1&&L[1].indexOf("[")===-1)return[B,q];if(L[0].match(/\[[=<>]/)!=null||L[1].match(/\[[=<>]/)!=null){var J=L[0].match(cfregex2),re=L[1].match(cfregex2);return chkcond(A,J)?[B,L[0]]:chkcond(A,re)?[B,L[1]]:[B,L[J!=null&&re!=null?2:1]]}return[B,q]}function SSF_format(g,A,L){L==null&&(L={});var B="";switch(typeof g){case"string":g=="m/d/yy"&&L.dateNF?B=L.dateNF:B=g;break;case"number":g==14&&L.dateNF?B=L.dateNF:B=(L.table!=null?L.table:table_fmt)[g],B==null&&(B=L.table&&L.table[SSF_default_map[g]]||table_fmt[SSF_default_map[g]]),B==null&&(B=SSF_default_str[g]||"General");break}if(SSF_isgeneral(B,0))return SSF_general(A,L);A instanceof Date&&(A=datenum_local(A,L.date1904));var W=choose_fmt(B,A);if(SSF_isgeneral(W[1]))return SSF_general(A,L);if(A===!0)A="TRUE";else if(A===!1)A="FALSE";else if(A===""||A==null)return"";return eval_fmt(W[1],A,L,W[0])}function SSF_load(g,A){if(typeof A!="number"){A=+A||-1;for(var L=0;L<392;++L){if(table_fmt[L]==null){A<0&&(A=L);continue}if(table_fmt[L]==g){A=L;break}}A<0&&(A=391)}return table_fmt[A]=g,A}function SSF_load_table(g){for(var A=0;A!=392;++A)g[A]!==void 0&&SSF_load(g[A],A)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(g){var A=typeof g=="number"?table_fmt[g]:g;return A=A.replace(dateNFregex,"(\\d+)"),new RegExp("^"+A+"$")}function dateNF_fix(g,A,L){var B=-1,W=-1,q=-1,J=-1,re=-1,ae=-1;(A.match(dateNFregex)||[]).forEach(function(le,pe){var he=parseInt(L[pe+1],10);switch(le.toLowerCase().charAt(0)){case"y":B=he;break;case"d":q=he;break;case"h":J=he;break;case"s":ae=he;break;case"m":J>=0?re=he:W=he;break}}),ae>=0&&re==-1&&W>=0&&(re=W,W=-1);var se=(""+(B>=0?B:new Date().getFullYear())).slice(-4)+"-"+("00"+(W>=1?W:1)).slice(-2)+"-"+("00"+(q>=1?q:1)).slice(-2);se.length==7&&(se="0"+se),se.length==8&&(se="20"+se);var ie=("00"+(J>=0?J:0)).slice(-2)+":"+("00"+(re>=0?re:0)).slice(-2)+":"+("00"+(ae>=0?ae:0)).slice(-2);return J==-1&&re==-1&&ae==-1?se:B==-1&&W==-1&&q==-1?ie:se+"T"+ie}var CRC32=function(){var g={};g.version="1.2.0";function A(){for(var ge=0,Ce=new Array(256),be=0;be!=256;++be)ge=be,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,ge=ge&1?-306674912^ge>>>1:ge>>>1,Ce[be]=ge;return typeof Int32Array<"u"?new Int32Array(Ce):Ce}var L=A();function B(ge){var Ce=0,be=0,nt=0,Ae=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(nt=0;nt!=256;++nt)Ae[nt]=ge[nt];for(nt=0;nt!=256;++nt)for(be=ge[nt],Ce=256+nt;Ce<4096;Ce+=256)be=Ae[Ce]=be>>>8^ge[be&255];var De=[];for(nt=1;nt!=16;++nt)De[nt-1]=typeof Int32Array<"u"?Ae.subarray(nt*256,nt*256+256):Ae.slice(nt*256,nt*256+256);return De}var W=B(L),q=W[0],J=W[1],re=W[2],ae=W[3],se=W[4],ie=W[5],le=W[6],pe=W[7],he=W[8],ue=W[9],ce=W[10],fe=W[11],me=W[12],ke=W[13],xe=W[14];function Le(ge,Ce){for(var be=Ce^-1,nt=0,Ae=ge.length;nt<Ae;)be=be>>>8^L[(be^ge.charCodeAt(nt++))&255];return~be}function Se(ge,Ce){for(var be=Ce^-1,nt=ge.length-15,Ae=0;Ae<nt;)be=xe[ge[Ae++]^be&255]^ke[ge[Ae++]^be>>8&255]^me[ge[Ae++]^be>>16&255]^fe[ge[Ae++]^be>>>24]^ce[ge[Ae++]]^ue[ge[Ae++]]^he[ge[Ae++]]^pe[ge[Ae++]]^le[ge[Ae++]]^ie[ge[Ae++]]^se[ge[Ae++]]^ae[ge[Ae++]]^re[ge[Ae++]]^J[ge[Ae++]]^q[ge[Ae++]]^L[ge[Ae++]];for(nt+=15;Ae<nt;)be=be>>>8^L[(be^ge[Ae++])&255];return~be}function Te(ge,Ce){for(var be=Ce^-1,nt=0,Ae=ge.length,De=0,lt=0;nt<Ae;)De=ge.charCodeAt(nt++),De<128?be=be>>>8^L[(be^De)&255]:De<2048?(be=be>>>8^L[(be^(192|De>>6&31))&255],be=be>>>8^L[(be^(128|De&63))&255]):De>=55296&&De<57344?(De=(De&1023)+64,lt=ge.charCodeAt(nt++)&1023,be=be>>>8^L[(be^(240|De>>8&7))&255],be=be>>>8^L[(be^(128|De>>2&63))&255],be=be>>>8^L[(be^(128|lt>>6&15|(De&3)<<4))&255],be=be>>>8^L[(be^(128|lt&63))&255]):(be=be>>>8^L[(be^(224|De>>12&15))&255],be=be>>>8^L[(be^(128|De>>6&63))&255],be=be>>>8^L[(be^(128|De&63))&255]);return~be}return g.table=L,g.bstr=Le,g.buf=Se,g.str=Te,g}(),CFB=function g(){var A={};A.version="1.2.1";function L(Oe,vt){for(var ut=Oe.split("/"),dt=vt.split("/"),wt=0,yt=0,Ut=Math.min(ut.length,dt.length);wt<Ut;++wt){if(yt=ut[wt].length-dt[wt].length)return yt;if(ut[wt]!=dt[wt])return ut[wt]<dt[wt]?-1:1}return ut.length-dt.length}function B(Oe){if(Oe.charAt(Oe.length-1)=="/")return Oe.slice(0,-1).indexOf("/")===-1?Oe:B(Oe.slice(0,-1));var vt=Oe.lastIndexOf("/");return vt===-1?Oe:Oe.slice(0,vt+1)}function W(Oe){if(Oe.charAt(Oe.length-1)=="/")return W(Oe.slice(0,-1));var vt=Oe.lastIndexOf("/");return vt===-1?Oe:Oe.slice(vt+1)}function q(Oe,vt){typeof vt=="string"&&(vt=new Date(vt));var ut=vt.getHours();ut=ut<<6|vt.getMinutes(),ut=ut<<5|vt.getSeconds()>>>1,Oe.write_shift(2,ut);var dt=vt.getFullYear()-1980;dt=dt<<4|vt.getMonth()+1,dt=dt<<5|vt.getDate(),Oe.write_shift(2,dt)}function J(Oe){var vt=Oe.read_shift(2)&65535,ut=Oe.read_shift(2)&65535,dt=new Date,wt=ut&31;ut>>>=5;var yt=ut&15;ut>>>=4,dt.setMilliseconds(0),dt.setFullYear(ut+1980),dt.setMonth(yt-1),dt.setDate(wt);var Ut=vt&31;vt>>>=5;var tr=vt&63;return vt>>>=6,dt.setHours(vt),dt.setMinutes(tr),dt.setSeconds(Ut<<1),dt}function re(Oe){prep_blob(Oe,0);for(var vt={},ut=0;Oe.l<=Oe.length-4;){var dt=Oe.read_shift(2),wt=Oe.read_shift(2),yt=Oe.l+wt,Ut={};switch(dt){case 21589:ut=Oe.read_shift(1),ut&1&&(Ut.mtime=Oe.read_shift(4)),wt>5&&(ut&2&&(Ut.atime=Oe.read_shift(4)),ut&4&&(Ut.ctime=Oe.read_shift(4))),Ut.mtime&&(Ut.mt=new Date(Ut.mtime*1e3));break}Oe.l=yt,vt[dt]=Ut}return vt}var ae;function se(){return ae||(ae={})}function ie(Oe,vt){if(Oe[0]==80&&Oe[1]==75)return Ur(Oe,vt);if((Oe[0]|32)==109&&(Oe[1]|32)==105)return Pt(Oe,vt);if(Oe.length<512)throw new Error("CFB file size "+Oe.length+" < 512");var ut=3,dt=512,wt=0,yt=0,Ut=0,tr=0,Kt=0,jt=[],er=Oe.slice(0,512);prep_blob(er,0);var pr=le(er);switch(ut=pr[0],ut){case 3:dt=512;break;case 4:dt=4096;break;case 0:if(pr[1]==0)return Ur(Oe,vt);default:throw new Error("Major Version: Expected 3 or 4 saw "+ut)}dt!==512&&(er=Oe.slice(0,dt),prep_blob(er,28));var wr=Oe.slice(0,dt);pe(er,ut);var Lr=er.read_shift(4,"i");if(ut===3&&Lr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Lr);er.l+=4,Ut=er.read_shift(4,"i"),er.l+=4,er.chk("00100000","Mini Stream Cutoff Size: "),tr=er.read_shift(4,"i"),wt=er.read_shift(4,"i"),Kt=er.read_shift(4,"i"),yt=er.read_shift(4,"i");for(var Er=-1,xr=0;xr<109&&(Er=er.read_shift(4,"i"),!(Er<0));++xr)jt[xr]=Er;var Vr=he(Oe,dt);fe(Kt,yt,Vr,dt,jt);var qr=ke(Vr,Ut,jt,dt);qr[Ut].name="!Directory",wt>0&&tr!==lt&&(qr[tr].name="!MiniFAT"),qr[jt[0]].name="!FAT",qr.fat_addrs=jt,qr.ssz=dt;var Jr={},sn=[],Ta=[],sa=[];xe(Ut,qr,Vr,sn,wt,Jr,Ta,tr),ue(Ta,sa,sn),sn.shift();var jn={FileIndex:Ta,FullPaths:sa};return vt&&vt.raw&&(jn.raw={header:wr,sectors:Vr}),jn}function le(Oe){if(Oe[Oe.l]==80&&Oe[Oe.l+1]==75)return[0,0];Oe.chk(Ct,"Header Signature: "),Oe.l+=16;var vt=Oe.read_shift(2,"u");return[Oe.read_shift(2,"u"),vt]}function pe(Oe,vt){var ut=9;switch(Oe.l+=2,ut=Oe.read_shift(2)){case 9:if(vt!=3)throw new Error("Sector Shift: Expected 9 saw "+ut);break;case 12:if(vt!=4)throw new Error("Sector Shift: Expected 12 saw "+ut);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ut)}Oe.chk("0600","Mini Sector Shift: "),Oe.chk("000000000000","Reserved: ")}function he(Oe,vt){for(var ut=Math.ceil(Oe.length/vt)-1,dt=[],wt=1;wt<ut;++wt)dt[wt-1]=Oe.slice(wt*vt,(wt+1)*vt);return dt[ut-1]=Oe.slice(ut*vt),dt}function ue(Oe,vt,ut){for(var dt=0,wt=0,yt=0,Ut=0,tr=0,Kt=ut.length,jt=[],er=[];dt<Kt;++dt)jt[dt]=er[dt]=dt,vt[dt]=ut[dt];for(;tr<er.length;++tr)dt=er[tr],wt=Oe[dt].L,yt=Oe[dt].R,Ut=Oe[dt].C,jt[dt]===dt&&(wt!==-1&&jt[wt]!==wt&&(jt[dt]=jt[wt]),yt!==-1&&jt[yt]!==yt&&(jt[dt]=jt[yt])),Ut!==-1&&(jt[Ut]=dt),wt!==-1&&dt!=jt[dt]&&(jt[wt]=jt[dt],er.lastIndexOf(wt)<tr&&er.push(wt)),yt!==-1&&dt!=jt[dt]&&(jt[yt]=jt[dt],er.lastIndexOf(yt)<tr&&er.push(yt));for(dt=1;dt<Kt;++dt)jt[dt]===dt&&(yt!==-1&&jt[yt]!==yt?jt[dt]=jt[yt]:wt!==-1&&jt[wt]!==wt&&(jt[dt]=jt[wt]));for(dt=1;dt<Kt;++dt)if(Oe[dt].type!==0){if(tr=dt,tr!=jt[tr])do tr=jt[tr],vt[dt]=vt[tr]+"/"+vt[dt];while(tr!==0&&jt[tr]!==-1&&tr!=jt[tr]);jt[dt]=-1}for(vt[0]+="/",dt=1;dt<Kt;++dt)Oe[dt].type!==2&&(vt[dt]+="/")}function ce(Oe,vt,ut){for(var dt=Oe.start,wt=Oe.size,yt=[],Ut=dt;ut&&wt>0&&Ut>=0;)yt.push(vt.slice(Ut*De,Ut*De+De)),wt-=De,Ut=__readInt32LE(ut,Ut*4);return yt.length===0?new_buf(0):bconcat(yt).slice(0,Oe.size)}function fe(Oe,vt,ut,dt,wt){var yt=lt;if(Oe===lt){if(vt!==0)throw new Error("DIFAT chain shorter than expected")}else if(Oe!==-1){var Ut=ut[Oe],tr=(dt>>>2)-1;if(!Ut)return;for(var Kt=0;Kt<tr&&(yt=__readInt32LE(Ut,Kt*4))!==lt;++Kt)wt.push(yt);fe(__readInt32LE(Ut,dt-4),vt-1,ut,dt,wt)}}function me(Oe,vt,ut,dt,wt){var yt=[],Ut=[];wt||(wt=[]);var tr=dt-1,Kt=0,jt=0;for(Kt=vt;Kt>=0;){wt[Kt]=!0,yt[yt.length]=Kt,Ut.push(Oe[Kt]);var er=ut[Math.floor(Kt*4/dt)];if(jt=Kt*4&tr,dt<4+jt)throw new Error("FAT boundary crossed: "+Kt+" 4 "+dt);if(!Oe[er])break;Kt=__readInt32LE(Oe[er],jt)}return{nodes:yt,data:__toBuffer([Ut])}}function ke(Oe,vt,ut,dt){var wt=Oe.length,yt=[],Ut=[],tr=[],Kt=[],jt=dt-1,er=0,pr=0,wr=0,Lr=0;for(er=0;er<wt;++er)if(tr=[],wr=er+vt,wr>=wt&&(wr-=wt),!Ut[wr]){Kt=[];var Er=[];for(pr=wr;pr>=0;){Er[pr]=!0,Ut[pr]=!0,tr[tr.length]=pr,Kt.push(Oe[pr]);var xr=ut[Math.floor(pr*4/dt)];if(Lr=pr*4&jt,dt<4+Lr)throw new Error("FAT boundary crossed: "+pr+" 4 "+dt);if(!Oe[xr]||(pr=__readInt32LE(Oe[xr],Lr),Er[pr]))break}yt[wr]={nodes:tr,data:__toBuffer([Kt])}}return yt}function xe(Oe,vt,ut,dt,wt,yt,Ut,tr){for(var Kt=0,jt=dt.length?2:0,er=vt[Oe].data,pr=0,wr=0,Lr;pr<er.length;pr+=128){var Er=er.slice(pr,pr+128);prep_blob(Er,64),wr=Er.read_shift(2),Lr=__utf16le(Er,0,wr-jt),dt.push(Lr);var xr={name:Lr,type:Er.read_shift(1),color:Er.read_shift(1),L:Er.read_shift(4,"i"),R:Er.read_shift(4,"i"),C:Er.read_shift(4,"i"),clsid:Er.read_shift(16),state:Er.read_shift(4,"i"),start:0,size:0},Vr=Er.read_shift(2)+Er.read_shift(2)+Er.read_shift(2)+Er.read_shift(2);Vr!==0&&(xr.ct=Le(Er,Er.l-8));var qr=Er.read_shift(2)+Er.read_shift(2)+Er.read_shift(2)+Er.read_shift(2);qr!==0&&(xr.mt=Le(Er,Er.l-8)),xr.start=Er.read_shift(4,"i"),xr.size=Er.read_shift(4,"i"),xr.size<0&&xr.start<0&&(xr.size=xr.type=0,xr.start=lt,xr.name=""),xr.type===5?(Kt=xr.start,wt>0&&Kt!==lt&&(vt[Kt].name="!StreamData")):xr.size>=4096?(xr.storage="fat",vt[xr.start]===void 0&&(vt[xr.start]=me(ut,xr.start,vt.fat_addrs,vt.ssz)),vt[xr.start].name=xr.name,xr.content=vt[xr.start].data.slice(0,xr.size)):(xr.storage="minifat",xr.size<0?xr.size=0:Kt!==lt&&xr.start!==lt&&vt[Kt]&&(xr.content=ce(xr,vt[Kt].data,(vt[tr]||{}).data))),xr.content&&prep_blob(xr.content,0),yt[Lr]=xr,Ut.push(xr)}}function Le(Oe,vt){return new Date((__readUInt32LE(Oe,vt+4)/1e7*Math.pow(2,32)+__readUInt32LE(Oe,vt)/1e7-11644473600)*1e3)}function Se(Oe,vt){return se(),ie(ae.readFileSync(Oe),vt)}function Te(Oe,vt){var ut=vt&&vt.type;switch(ut||has_buf&&Buffer.isBuffer(Oe)&&(ut="buffer"),ut||"base64"){case"file":return Se(Oe,vt);case"base64":return ie(s2a(Base64_decode(Oe)),vt);case"binary":return ie(s2a(Oe),vt)}return ie(Oe,vt)}function ge(Oe,vt){var ut=vt||{},dt=ut.root||"Root Entry";if(Oe.FullPaths||(Oe.FullPaths=[]),Oe.FileIndex||(Oe.FileIndex=[]),Oe.FullPaths.length!==Oe.FileIndex.length)throw new Error("inconsistent CFB structure");Oe.FullPaths.length===0&&(Oe.FullPaths[0]=dt+"/",Oe.FileIndex[0]={name:dt,type:5}),ut.CLSID&&(Oe.FileIndex[0].clsid=ut.CLSID),Ce(Oe)}function Ce(Oe){var vt="Sh33tJ5";if(!CFB.find(Oe,"/"+vt)){var ut=new_buf(4);ut[0]=55,ut[1]=ut[3]=50,ut[2]=54,Oe.FileIndex.push({name:vt,type:2,content:ut,size:4,L:69,R:69,C:69}),Oe.FullPaths.push(Oe.FullPaths[0]+vt),be(Oe)}}function be(Oe,vt){ge(Oe);for(var ut=!1,dt=!1,wt=Oe.FullPaths.length-1;wt>=0;--wt){var yt=Oe.FileIndex[wt];switch(yt.type){case 0:dt?ut=!0:(Oe.FileIndex.pop(),Oe.FullPaths.pop());break;case 1:case 2:case 5:dt=!0,isNaN(yt.R*yt.L*yt.C)&&(ut=!0),yt.R>-1&&yt.L>-1&&yt.R==yt.L&&(ut=!0);break;default:ut=!0;break}}if(!(!ut&&!vt)){var Ut=new Date(1987,1,19),tr=0,Kt=Object.create?Object.create(null):{},jt=[];for(wt=0;wt<Oe.FullPaths.length;++wt)Kt[Oe.FullPaths[wt]]=!0,Oe.FileIndex[wt].type!==0&&jt.push([Oe.FullPaths[wt],Oe.FileIndex[wt]]);for(wt=0;wt<jt.length;++wt){var er=B(jt[wt][0]);dt=Kt[er],dt||(jt.push([er,{name:W(er).replace("/",""),type:1,clsid:Et,ct:Ut,mt:Ut,content:null}]),Kt[er]=!0)}for(jt.sort(function(Lr,Er){return L(Lr[0],Er[0])}),Oe.FullPaths=[],Oe.FileIndex=[],wt=0;wt<jt.length;++wt)Oe.FullPaths[wt]=jt[wt][0],Oe.FileIndex[wt]=jt[wt][1];for(wt=0;wt<jt.length;++wt){var pr=Oe.FileIndex[wt],wr=Oe.FullPaths[wt];if(pr.name=W(wr).replace("/",""),pr.L=pr.R=pr.C=-(pr.color=1),pr.size=pr.content?pr.content.length:0,pr.start=0,pr.clsid=pr.clsid||Et,wt===0)pr.C=jt.length>1?1:-1,pr.size=0,pr.type=5;else if(wr.slice(-1)=="/"){for(tr=wt+1;tr<jt.length&&B(Oe.FullPaths[tr])!=wr;++tr);for(pr.C=tr>=jt.length?-1:tr,tr=wt+1;tr<jt.length&&B(Oe.FullPaths[tr])!=B(wr);++tr);pr.R=tr>=jt.length?-1:tr,pr.type=1}else B(Oe.FullPaths[wt+1]||"")==B(wr)&&(pr.R=wt+1),pr.type=2}}}function nt(Oe,vt){var ut=vt||{};if(ut.fileType=="mad")return Gt(Oe,ut);switch(be(Oe),ut.fileType){case"zip":return rr(Oe,ut)}var dt=function(Lr){for(var Er=0,xr=0,Vr=0;Vr<Lr.FileIndex.length;++Vr){var qr=Lr.FileIndex[Vr];if(qr.content){var Jr=qr.content.length;Jr>0&&(Jr<4096?Er+=Jr+63>>6:xr+=Jr+511>>9)}}for(var sn=Lr.FullPaths.length+3>>2,Ta=Er+7>>3,sa=Er+127>>7,jn=Ta+xr+sn+sa,hn=jn+127>>7,di=hn<=109?0:Math.ceil((hn-109)/127);jn+hn+di+127>>7>hn;)di=++hn<=109?0:Math.ceil((hn-109)/127);var on=[1,di,hn,sa,sn,xr,Er,0];return Lr.FileIndex[0].size=Er<<6,on[7]=(Lr.FileIndex[0].start=on[0]+on[1]+on[2]+on[3]+on[4]+on[5])+(on[6]+7>>3),on}(Oe),wt=new_buf(dt[7]<<9),yt=0,Ut=0;{for(yt=0;yt<8;++yt)wt.write_shift(1,ft[yt]);for(yt=0;yt<8;++yt)wt.write_shift(2,0);for(wt.write_shift(2,62),wt.write_shift(2,3),wt.write_shift(2,65534),wt.write_shift(2,9),wt.write_shift(2,6),yt=0;yt<3;++yt)wt.write_shift(2,0);for(wt.write_shift(4,0),wt.write_shift(4,dt[2]),wt.write_shift(4,dt[0]+dt[1]+dt[2]+dt[3]-1),wt.write_shift(4,0),wt.write_shift(4,4096),wt.write_shift(4,dt[3]?dt[0]+dt[1]+dt[2]-1:lt),wt.write_shift(4,dt[3]),wt.write_shift(-4,dt[1]?dt[0]-1:lt),wt.write_shift(4,dt[1]),yt=0;yt<109;++yt)wt.write_shift(-4,yt<dt[2]?dt[1]+yt:-1)}if(dt[1])for(Ut=0;Ut<dt[1];++Ut){for(;yt<236+Ut*127;++yt)wt.write_shift(-4,yt<dt[2]?dt[1]+yt:-1);wt.write_shift(-4,Ut===dt[1]-1?lt:Ut+1)}var tr=function(Lr){for(Ut+=Lr;yt<Ut-1;++yt)wt.write_shift(-4,yt+1);Lr&&(++yt,wt.write_shift(-4,lt))};for(Ut=yt=0,Ut+=dt[1];yt<Ut;++yt)wt.write_shift(-4,gt.DIFSECT);for(Ut+=dt[2];yt<Ut;++yt)wt.write_shift(-4,gt.FATSECT);tr(dt[3]),tr(dt[4]);for(var Kt=0,jt=0,er=Oe.FileIndex[0];Kt<Oe.FileIndex.length;++Kt)er=Oe.FileIndex[Kt],er.content&&(jt=er.content.length,!(jt<4096)&&(er.start=Ut,tr(jt+511>>9)));for(tr(dt[6]+7>>3);wt.l&511;)wt.write_shift(-4,gt.ENDOFCHAIN);for(Ut=yt=0,Kt=0;Kt<Oe.FileIndex.length;++Kt)er=Oe.FileIndex[Kt],er.content&&(jt=er.content.length,!(!jt||jt>=4096)&&(er.start=Ut,tr(jt+63>>6)));for(;wt.l&511;)wt.write_shift(-4,gt.ENDOFCHAIN);for(yt=0;yt<dt[4]<<2;++yt){var pr=Oe.FullPaths[yt];if(!pr||pr.length===0){for(Kt=0;Kt<17;++Kt)wt.write_shift(4,0);for(Kt=0;Kt<3;++Kt)wt.write_shift(4,-1);for(Kt=0;Kt<12;++Kt)wt.write_shift(4,0);continue}er=Oe.FileIndex[yt],yt===0&&(er.start=er.size?er.start-1:lt);var wr=yt===0&&ut.root||er.name;if(jt=2*(wr.length+1),wt.write_shift(64,wr,"utf16le"),wt.write_shift(2,jt),wt.write_shift(1,er.type),wt.write_shift(1,er.color),wt.write_shift(-4,er.L),wt.write_shift(-4,er.R),wt.write_shift(-4,er.C),er.clsid)wt.write_shift(16,er.clsid,"hex");else for(Kt=0;Kt<4;++Kt)wt.write_shift(4,0);wt.write_shift(4,er.state||0),wt.write_shift(4,0),wt.write_shift(4,0),wt.write_shift(4,0),wt.write_shift(4,0),wt.write_shift(4,er.start),wt.write_shift(4,er.size),wt.write_shift(4,0)}for(yt=1;yt<Oe.FileIndex.length;++yt)if(er=Oe.FileIndex[yt],er.size>=4096)if(wt.l=er.start+1<<9,has_buf&&Buffer.isBuffer(er.content))er.content.copy(wt,wt.l,0,er.size),wt.l+=er.size+511&-512;else{for(Kt=0;Kt<er.size;++Kt)wt.write_shift(1,er.content[Kt]);for(;Kt&511;++Kt)wt.write_shift(1,0)}for(yt=1;yt<Oe.FileIndex.length;++yt)if(er=Oe.FileIndex[yt],er.size>0&&er.size<4096)if(has_buf&&Buffer.isBuffer(er.content))er.content.copy(wt,wt.l,0,er.size),wt.l+=er.size+63&-64;else{for(Kt=0;Kt<er.size;++Kt)wt.write_shift(1,er.content[Kt]);for(;Kt&63;++Kt)wt.write_shift(1,0)}if(has_buf)wt.l=wt.length;else for(;wt.l<wt.length;)wt.write_shift(1,0);return wt}function Ae(Oe,vt){var ut=Oe.FullPaths.map(function(Kt){return Kt.toUpperCase()}),dt=ut.map(function(Kt){var jt=Kt.split("/");return jt[jt.length-(Kt.slice(-1)=="/"?2:1)]}),wt=!1;vt.charCodeAt(0)===47?(wt=!0,vt=ut[0].slice(0,-1)+vt):wt=vt.indexOf("/")!==-1;var yt=vt.toUpperCase(),Ut=wt===!0?ut.indexOf(yt):dt.indexOf(yt);if(Ut!==-1)return Oe.FileIndex[Ut];var tr=!yt.match(chr1);for(yt=yt.replace(chr0,""),tr&&(yt=yt.replace(chr1,"!")),Ut=0;Ut<ut.length;++Ut)if((tr?ut[Ut].replace(chr1,"!"):ut[Ut]).replace(chr0,"")==yt||(tr?dt[Ut].replace(chr1,"!"):dt[Ut]).replace(chr0,"")==yt)return Oe.FileIndex[Ut];return null}var De=64,lt=-2,Ct="d0cf11e0a1b11ae1",ft=[208,207,17,224,161,177,26,225],Et="00000000000000000000000000000000",gt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:lt,FREESECT:-1,HEADER_SIGNATURE:Ct,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Et,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function bt(Oe,vt,ut){se();var dt=nt(Oe,ut);ae.writeFileSync(vt,dt)}function Ie(Oe){for(var vt=new Array(Oe.length),ut=0;ut<Oe.length;++ut)vt[ut]=String.fromCharCode(Oe[ut]);return vt.join("")}function pt(Oe,vt){var ut=nt(Oe,vt);switch(vt&&vt.type||"buffer"){case"file":return se(),ae.writeFileSync(vt.filename,ut),ut;case"binary":return typeof ut=="string"?ut:Ie(ut);case"base64":return Base64_encode(typeof ut=="string"?ut:Ie(ut));case"buffer":if(has_buf)return Buffer.isBuffer(ut)?ut:Buffer_from(ut);case"array":return typeof ut=="string"?s2a(ut):ut}return ut}var at;function Ee(Oe){try{var vt=Oe.InflateRaw,ut=new vt;if(ut._processChunk(new Uint8Array([3,0]),ut._finishFlushFlag),ut.bytesRead)at=Oe;else throw new Error("zlib does not expose bytesRead")}catch(dt){console.error("cannot use native zlib: "+(dt.message||dt))}}function ye(Oe,vt){if(!at)return kr(Oe,vt);var ut=at.InflateRaw,dt=new ut,wt=dt._processChunk(Oe.slice(Oe.l),dt._finishFlushFlag);return Oe.l+=dt.bytesRead,wt}function ve(Oe){return at?at.deflateRawSync(Oe):vr(Oe)}var Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],rt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],st=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ot(Oe){var vt=(Oe<<1|Oe<<11)&139536|(Oe<<5|Oe<<15)&558144;return(vt>>16|vt>>8|vt)&255}for(var mt=typeof Uint8Array<"u",At=mt?new Uint8Array(256):[],It=0;It<256;++It)At[It]=ot(It);function it(Oe,vt){var ut=At[Oe&255];return vt<=8?ut>>>8-vt:(ut=ut<<8|At[Oe>>8&255],vt<=16?ut>>>16-vt:(ut=ut<<8|At[Oe>>16&255],ut>>>24-vt))}function Vt(Oe,vt){var ut=vt&7,dt=vt>>>3;return(Oe[dt]|(ut<=6?0:Oe[dt+1]<<8))>>>ut&3}function Yt(Oe,vt){var ut=vt&7,dt=vt>>>3;return(Oe[dt]|(ut<=5?0:Oe[dt+1]<<8))>>>ut&7}function Zt(Oe,vt){var ut=vt&7,dt=vt>>>3;return(Oe[dt]|(ut<=4?0:Oe[dt+1]<<8))>>>ut&15}function Lt(Oe,vt){var ut=vt&7,dt=vt>>>3;return(Oe[dt]|(ut<=3?0:Oe[dt+1]<<8))>>>ut&31}function Ft(Oe,vt){var ut=vt&7,dt=vt>>>3;return(Oe[dt]|(ut<=1?0:Oe[dt+1]<<8))>>>ut&127}function ht(Oe,vt,ut){var dt=vt&7,wt=vt>>>3,yt=(1<<ut)-1,Ut=Oe[wt]>>>dt;return ut<8-dt||(Ut|=Oe[wt+1]<<8-dt,ut<16-dt)||(Ut|=Oe[wt+2]<<16-dt,ut<24-dt)||(Ut|=Oe[wt+3]<<24-dt),Ut&yt}function kt(Oe,vt,ut){var dt=vt&7,wt=vt>>>3;return dt<=5?Oe[wt]|=(ut&7)<<dt:(Oe[wt]|=ut<<dt&255,Oe[wt+1]=(ut&7)>>8-dt),vt+3}function Dt(Oe,vt,ut){var dt=vt&7,wt=vt>>>3;return ut=(ut&1)<<dt,Oe[wt]|=ut,vt+1}function Bt(Oe,vt,ut){var dt=vt&7,wt=vt>>>3;return ut<<=dt,Oe[wt]|=ut&255,ut>>>=8,Oe[wt+1]=ut,vt+8}function Qt(Oe,vt,ut){var dt=vt&7,wt=vt>>>3;return ut<<=dt,Oe[wt]|=ut&255,ut>>>=8,Oe[wt+1]=ut&255,Oe[wt+2]=ut>>>8,vt+16}function or(Oe,vt){var ut=Oe.length,dt=2*ut>vt?2*ut:vt+5,wt=0;if(ut>=vt)return Oe;if(has_buf){var yt=new_unsafe_buf(dt);if(Oe.copy)Oe.copy(yt);else for(;wt<Oe.length;++wt)yt[wt]=Oe[wt];return yt}else if(mt){var Ut=new Uint8Array(dt);if(Ut.set)Ut.set(Oe);else for(;wt<ut;++wt)Ut[wt]=Oe[wt];return Ut}return Oe.length=dt,Oe}function ar(Oe){for(var vt=new Array(Oe),ut=0;ut<Oe;++ut)vt[ut]=0;return vt}function Nt(Oe,vt,ut){var dt=1,wt=0,yt=0,Ut=0,tr=0,Kt=Oe.length,jt=mt?new Uint16Array(32):ar(32);for(yt=0;yt<32;++yt)jt[yt]=0;for(yt=Kt;yt<ut;++yt)Oe[yt]=0;Kt=Oe.length;var er=mt?new Uint16Array(Kt):ar(Kt);for(yt=0;yt<Kt;++yt)jt[wt=Oe[yt]]++,dt<wt&&(dt=wt),er[yt]=0;for(jt[0]=0,yt=1;yt<=dt;++yt)jt[yt+16]=tr=tr+jt[yt-1]<<1;for(yt=0;yt<Kt;++yt)tr=Oe[yt],tr!=0&&(er[yt]=jt[tr+16]++);var pr=0;for(yt=0;yt<Kt;++yt)if(pr=Oe[yt],pr!=0)for(tr=it(er[yt],dt)>>dt-pr,Ut=(1<<dt+4-pr)-1;Ut>=0;--Ut)vt[tr|Ut<<pr]=pr&15|yt<<4;return dt}var fr=mt?new Uint16Array(512):ar(512),ur=mt?new Uint16Array(32):ar(32);if(!mt){for(var Pr=0;Pr<512;++Pr)fr[Pr]=0;for(Pr=0;Pr<32;++Pr)ur[Pr]=0}(function(){for(var Oe=[],vt=0;vt<32;vt++)Oe.push(5);Nt(Oe,ur,32);var ut=[];for(vt=0;vt<=143;vt++)ut.push(8);for(;vt<=255;vt++)ut.push(9);for(;vt<=279;vt++)ut.push(7);for(;vt<=287;vt++)ut.push(8);Nt(ut,fr,288)})();var Rr=function(){for(var vt=mt?new Uint8Array(32768):[],ut=0,dt=0;ut<st.length-1;++ut)for(;dt<st[ut+1];++dt)vt[dt]=ut;for(;dt<32768;++dt)vt[dt]=29;var wt=mt?new Uint8Array(259):[];for(ut=0,dt=0;ut<rt.length-1;++ut)for(;dt<rt[ut+1];++dt)wt[dt]=ut;function yt(tr,Kt){for(var jt=0;jt<tr.length;){var er=Math.min(65535,tr.length-jt),pr=jt+er==tr.length;for(Kt.write_shift(1,+pr),Kt.write_shift(2,er),Kt.write_shift(2,~er&65535);er-- >0;)Kt[Kt.l++]=tr[jt++]}return Kt.l}function Ut(tr,Kt){for(var jt=0,er=0,pr=mt?new Uint16Array(32768):[];er<tr.length;){var wr=Math.min(65535,tr.length-er);if(wr<10){for(jt=kt(Kt,jt,+(er+wr==tr.length)),jt&7&&(jt+=8-(jt&7)),Kt.l=jt/8|0,Kt.write_shift(2,wr),Kt.write_shift(2,~wr&65535);wr-- >0;)Kt[Kt.l++]=tr[er++];jt=Kt.l*8;continue}jt=kt(Kt,jt,+(er+wr==tr.length)+2);for(var Lr=0;wr-- >0;){var Er=tr[er];Lr=(Lr<<5^Er)&32767;var xr=-1,Vr=0;if((xr=pr[Lr])&&(xr|=er&-32768,xr>er&&(xr-=32768),xr<er))for(;tr[xr+Vr]==tr[er+Vr]&&Vr<250;)++Vr;if(Vr>2){Er=wt[Vr],Er<=22?jt=Bt(Kt,jt,At[Er+1]>>1)-1:(Bt(Kt,jt,3),jt+=5,Bt(Kt,jt,At[Er-23]>>5),jt+=3);var qr=Er<8?0:Er-4>>2;qr>0&&(Qt(Kt,jt,Vr-rt[Er]),jt+=qr),Er=vt[er-xr],jt=Bt(Kt,jt,At[Er]>>3),jt-=3;var Jr=Er<4?0:Er-2>>1;Jr>0&&(Qt(Kt,jt,er-xr-st[Er]),jt+=Jr);for(var sn=0;sn<Vr;++sn)pr[Lr]=er&32767,Lr=(Lr<<5^tr[er])&32767,++er;wr-=Vr-1}else Er<=143?Er=Er+48:jt=Dt(Kt,jt,1),jt=Bt(Kt,jt,At[Er]),pr[Lr]=er&32767,++er}jt=Bt(Kt,jt,0)-1}return Kt.l=(jt+7)/8|0,Kt.l}return function(Kt,jt){return Kt.length<8?yt(Kt,jt):Ut(Kt,jt)}}();function vr(Oe){var vt=new_buf(50+Math.floor(Oe.length*1.1)),ut=Rr(Oe,vt);return vt.slice(0,ut)}var dr=mt?new Uint16Array(32768):ar(32768),br=mt?new Uint16Array(32768):ar(32768),Ir=mt?new Uint16Array(128):ar(128),zr=1,lr=1;function Ht(Oe,vt){var ut=Lt(Oe,vt)+257;vt+=5;var dt=Lt(Oe,vt)+1;vt+=5;var wt=Zt(Oe,vt)+4;vt+=4;for(var yt=0,Ut=mt?new Uint8Array(19):ar(19),tr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Kt=1,jt=mt?new Uint8Array(8):ar(8),er=mt?new Uint8Array(8):ar(8),pr=Ut.length,wr=0;wr<wt;++wr)Ut[Pe[wr]]=yt=Yt(Oe,vt),Kt<yt&&(Kt=yt),jt[yt]++,vt+=3;var Lr=0;for(jt[0]=0,wr=1;wr<=Kt;++wr)er[wr]=Lr=Lr+jt[wr-1]<<1;for(wr=0;wr<pr;++wr)(Lr=Ut[wr])!=0&&(tr[wr]=er[Lr]++);var Er=0;for(wr=0;wr<pr;++wr)if(Er=Ut[wr],Er!=0){Lr=At[tr[wr]]>>8-Er;for(var xr=(1<<7-Er)-1;xr>=0;--xr)Ir[Lr|xr<<Er]=Er&7|wr<<3}var Vr=[];for(Kt=1;Vr.length<ut+dt;)switch(Lr=Ir[Ft(Oe,vt)],vt+=Lr&7,Lr>>>=3){case 16:for(yt=3+Vt(Oe,vt),vt+=2,Lr=Vr[Vr.length-1];yt-- >0;)Vr.push(Lr);break;case 17:for(yt=3+Yt(Oe,vt),vt+=3;yt-- >0;)Vr.push(0);break;case 18:for(yt=11+Ft(Oe,vt),vt+=7;yt-- >0;)Vr.push(0);break;default:Vr.push(Lr),Kt<Lr&&(Kt=Lr);break}var qr=Vr.slice(0,ut),Jr=Vr.slice(ut);for(wr=ut;wr<286;++wr)qr[wr]=0;for(wr=dt;wr<30;++wr)Jr[wr]=0;return zr=Nt(qr,dr,286),lr=Nt(Jr,br,30),vt}function $t(Oe,vt){if(Oe[0]==3&&!(Oe[1]&3))return[new_raw_buf(vt),2];for(var ut=0,dt=0,wt=new_unsafe_buf(vt||1<<18),yt=0,Ut=wt.length>>>0,tr=0,Kt=0;(dt&1)==0;){if(dt=Yt(Oe,ut),ut+=3,dt>>>1)dt>>1==1?(tr=9,Kt=5):(ut=Ht(Oe,ut),tr=zr,Kt=lr);else{ut&7&&(ut+=8-(ut&7));var jt=Oe[ut>>>3]|Oe[(ut>>>3)+1]<<8;if(ut+=32,jt>0)for(!vt&&Ut<yt+jt&&(wt=or(wt,yt+jt),Ut=wt.length);jt-- >0;)wt[yt++]=Oe[ut>>>3],ut+=8;continue}for(;;){!vt&&Ut<yt+32767&&(wt=or(wt,yt+32767),Ut=wt.length);var er=ht(Oe,ut,tr),pr=dt>>>1==1?fr[er]:dr[er];if(ut+=pr&15,pr>>>=4,(pr>>>8&255)===0)wt[yt++]=pr;else{if(pr==256)break;pr-=257;var wr=pr<8?0:pr-4>>2;wr>5&&(wr=0);var Lr=yt+rt[pr];wr>0&&(Lr+=ht(Oe,ut,wr),ut+=wr),er=ht(Oe,ut,Kt),pr=dt>>>1==1?ur[er]:br[er],ut+=pr&15,pr>>>=4;var Er=pr<4?0:pr-2>>1,xr=st[pr];for(Er>0&&(xr+=ht(Oe,ut,Er),ut+=Er),!vt&&Ut<Lr&&(wt=or(wt,Lr+100),Ut=wt.length);yt<Lr;)wt[yt]=wt[yt-xr],++yt}}}return vt?[wt,ut+7>>>3]:[wt.slice(0,yt),ut+7>>>3]}function kr(Oe,vt){var ut=Oe.slice(Oe.l||0),dt=$t(ut,vt);return Oe.l+=dt[1],dt[0]}function Wr(Oe,vt){if(Oe)typeof console<"u"&&console.error(vt);else throw new Error(vt)}function Ur(Oe,vt){var ut=Oe;prep_blob(ut,0);var dt=[],wt=[],yt={FileIndex:dt,FullPaths:wt};ge(yt,{root:vt.root});for(var Ut=ut.length-4;(ut[Ut]!=80||ut[Ut+1]!=75||ut[Ut+2]!=5||ut[Ut+3]!=6)&&Ut>=0;)--Ut;ut.l=Ut+4,ut.l+=4;var tr=ut.read_shift(2);ut.l+=6;var Kt=ut.read_shift(4);for(ut.l=Kt,Ut=0;Ut<tr;++Ut){ut.l+=20;var jt=ut.read_shift(4),er=ut.read_shift(4),pr=ut.read_shift(2),wr=ut.read_shift(2),Lr=ut.read_shift(2);ut.l+=8;var Er=ut.read_shift(4),xr=re(ut.slice(ut.l+pr,ut.l+pr+wr));ut.l+=pr+wr+Lr;var Vr=ut.l;ut.l=Er+4,Tt(ut,jt,er,yt,xr),ut.l=Vr}return yt}function Tt(Oe,vt,ut,dt,wt){Oe.l+=2;var yt=Oe.read_shift(2),Ut=Oe.read_shift(2),tr=J(Oe);if(yt&8257)throw new Error("Unsupported ZIP encryption");for(var Kt=Oe.read_shift(4),jt=Oe.read_shift(4),er=Oe.read_shift(4),pr=Oe.read_shift(2),wr=Oe.read_shift(2),Lr="",Er=0;Er<pr;++Er)Lr+=String.fromCharCode(Oe[Oe.l++]);if(wr){var xr=re(Oe.slice(Oe.l,Oe.l+wr));(xr[21589]||{}).mt&&(tr=xr[21589].mt),((wt||{})[21589]||{}).mt&&(tr=wt[21589].mt)}Oe.l+=wr;var Vr=Oe.slice(Oe.l,Oe.l+jt);switch(Ut){case 8:Vr=ye(Oe,er);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ut)}var qr=!1;yt&8&&(Kt=Oe.read_shift(4),Kt==134695760&&(Kt=Oe.read_shift(4),qr=!0),jt=Oe.read_shift(4),er=Oe.read_shift(4)),jt!=vt&&Wr(qr,"Bad compressed size: "+vt+" != "+jt),er!=ut&&Wr(qr,"Bad uncompressed size: "+ut+" != "+er),sr(dt,Lr,Vr,{unsafe:!0,mt:tr})}function rr(Oe,vt){var ut=vt||{},dt=[],wt=[],yt=new_buf(1),Ut=ut.compression?8:0,tr=0,Kt=0,jt=0,er=0,pr=0,wr=Oe.FullPaths[0],Lr=wr,Er=Oe.FileIndex[0],xr=[],Vr=0;for(Kt=1;Kt<Oe.FullPaths.length;++Kt)if(Lr=Oe.FullPaths[Kt].slice(wr.length),Er=Oe.FileIndex[Kt],!(!Er.size||!Er.content||Lr=="Sh33tJ5")){var qr=er,Jr=new_buf(Lr.length);for(jt=0;jt<Lr.length;++jt)Jr.write_shift(1,Lr.charCodeAt(jt)&127);Jr=Jr.slice(0,Jr.l),xr[pr]=CRC32.buf(Er.content,0);var sn=Er.content;Ut==8&&(sn=ve(sn)),yt=new_buf(30),yt.write_shift(4,67324752),yt.write_shift(2,20),yt.write_shift(2,tr),yt.write_shift(2,Ut),Er.mt?q(yt,Er.mt):yt.write_shift(4,0),yt.write_shift(-4,xr[pr]),yt.write_shift(4,sn.length),yt.write_shift(4,Er.content.length),yt.write_shift(2,Jr.length),yt.write_shift(2,0),er+=yt.length,dt.push(yt),er+=Jr.length,dt.push(Jr),er+=sn.length,dt.push(sn),yt=new_buf(46),yt.write_shift(4,33639248),yt.write_shift(2,0),yt.write_shift(2,20),yt.write_shift(2,tr),yt.write_shift(2,Ut),yt.write_shift(4,0),yt.write_shift(-4,xr[pr]),yt.write_shift(4,sn.length),yt.write_shift(4,Er.content.length),yt.write_shift(2,Jr.length),yt.write_shift(2,0),yt.write_shift(2,0),yt.write_shift(2,0),yt.write_shift(2,0),yt.write_shift(4,0),yt.write_shift(4,qr),Vr+=yt.l,wt.push(yt),Vr+=Jr.length,wt.push(Jr),++pr}return yt=new_buf(22),yt.write_shift(4,101010256),yt.write_shift(2,0),yt.write_shift(2,0),yt.write_shift(2,pr),yt.write_shift(2,pr),yt.write_shift(4,Vr),yt.write_shift(4,er),yt.write_shift(2,0),bconcat([bconcat(dt),bconcat(wt),yt])}var hr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Cr(Oe,vt){if(Oe.ctype)return Oe.ctype;var ut=Oe.name||"",dt=ut.match(/\.([^\.]+)$/);return dt&&hr[dt[1]]||vt&&(dt=(ut=vt).match(/[\.\\]([^\.\\])+$/),dt&&hr[dt[1]])?hr[dt[1]]:"application/octet-stream"}function Fr(Oe){for(var vt=Base64_encode(Oe),ut=[],dt=0;dt<vt.length;dt+=76)ut.push(vt.slice(dt,dt+76));return ut.join(`\r
`)+`\r
`}function yr(Oe){var vt=Oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(jt){var er=jt.charCodeAt(0).toString(16).toUpperCase();return"="+(er.length==1?"0"+er:er)});vt=vt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),vt.charAt(0)==`
`&&(vt="=0D"+vt.slice(1)),vt=vt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ut=[],dt=vt.split(`\r
`),wt=0;wt<dt.length;++wt){var yt=dt[wt];if(yt.length==0){ut.push("");continue}for(var Ut=0;Ut<yt.length;){var tr=76,Kt=yt.slice(Ut,Ut+tr);Kt.charAt(tr-1)=="="?tr--:Kt.charAt(tr-2)=="="?tr-=2:Kt.charAt(tr-3)=="="&&(tr-=3),Kt=yt.slice(Ut,Ut+tr),Ut+=tr,Ut<yt.length&&(Kt+="="),ut.push(Kt)}}return ut.join(`\r
`)}function St(Oe){for(var vt=[],ut=0;ut<Oe.length;++ut){for(var dt=Oe[ut];ut<=Oe.length&&dt.charAt(dt.length-1)=="=";)dt=dt.slice(0,dt.length-1)+Oe[++ut];vt.push(dt)}for(var wt=0;wt<vt.length;++wt)vt[wt]=vt[wt].replace(/[=][0-9A-Fa-f]{2}/g,function(yt){return String.fromCharCode(parseInt(yt.slice(1),16))});return s2a(vt.join(`\r
`))}function xt(Oe,vt,ut){for(var dt="",wt="",yt="",Ut,tr=0;tr<10;++tr){var Kt=vt[tr];if(!Kt||Kt.match(/^\s*$/))break;var jt=Kt.match(/^(.*?):\s*([^\s].*)$/);if(jt)switch(jt[1].toLowerCase()){case"content-location":dt=jt[2].trim();break;case"content-type":yt=jt[2].trim();break;case"content-transfer-encoding":wt=jt[2].trim();break}}switch(++tr,wt.toLowerCase()){case"base64":Ut=s2a(Base64_decode(vt.slice(tr).join("")));break;case"quoted-printable":Ut=St(vt.slice(tr));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+wt)}var er=sr(Oe,dt.slice(ut.length),Ut,{unsafe:!0});yt&&(er.ctype=yt)}function Pt(Oe,vt){if(Ie(Oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ut=vt&&vt.root||"",dt=(has_buf&&Buffer.isBuffer(Oe)?Oe.toString("binary"):Ie(Oe)).split(`\r
`),wt=0,yt="";for(wt=0;wt<dt.length;++wt)if(yt=dt[wt],!!/^Content-Location:/i.test(yt)&&(yt=yt.slice(yt.indexOf("file")),ut||(ut=yt.slice(0,yt.lastIndexOf("/")+1)),yt.slice(0,ut.length)!=ut))for(;ut.length>0&&(ut=ut.slice(0,ut.length-1),ut=ut.slice(0,ut.lastIndexOf("/")+1),yt.slice(0,ut.length)!=ut););var Ut=(dt[1]||"").match(/boundary="(.*?)"/);if(!Ut)throw new Error("MAD cannot find boundary");var tr="--"+(Ut[1]||""),Kt=[],jt=[],er={FileIndex:Kt,FullPaths:jt};ge(er);var pr,wr=0;for(wt=0;wt<dt.length;++wt){var Lr=dt[wt];Lr!==tr&&Lr!==tr+"--"||(wr++&&xt(er,dt.slice(pr,wt),ut),pr=wt)}return er}function Gt(Oe,vt){var ut=vt||{},dt=ut.boundary||"SheetJS";dt="------="+dt;for(var wt=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+dt.slice(2)+'"',"","",""],yt=Oe.FullPaths[0],Ut=yt,tr=Oe.FileIndex[0],Kt=1;Kt<Oe.FullPaths.length;++Kt)if(Ut=Oe.FullPaths[Kt].slice(yt.length),tr=Oe.FileIndex[Kt],!(!tr.size||!tr.content||Ut=="Sh33tJ5")){Ut=Ut.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Vr){return"_x"+Vr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Vr){return"_u"+Vr.charCodeAt(0).toString(16)+"_"});for(var jt=tr.content,er=has_buf&&Buffer.isBuffer(jt)?jt.toString("binary"):Ie(jt),pr=0,wr=Math.min(1024,er.length),Lr=0,Er=0;Er<=wr;++Er)(Lr=er.charCodeAt(Er))>=32&&Lr<128&&++pr;var xr=pr>=wr*4/5;wt.push(dt),wt.push("Content-Location: "+(ut.root||"file:///C:/SheetJS/")+Ut),wt.push("Content-Transfer-Encoding: "+(xr?"quoted-printable":"base64")),wt.push("Content-Type: "+Cr(tr,Ut)),wt.push(""),wt.push(xr?yr(er):Fr(er))}return wt.push(dt+`--\r
`),wt.join(`\r
`)}function qt(Oe){var vt={};return ge(vt,Oe),vt}function sr(Oe,vt,ut,dt){var wt=dt&&dt.unsafe;wt||ge(Oe);var yt=!wt&&CFB.find(Oe,vt);if(!yt){var Ut=Oe.FullPaths[0];vt.slice(0,Ut.length)==Ut?Ut=vt:(Ut.slice(-1)!="/"&&(Ut+="/"),Ut=(Ut+vt).replace("//","/")),yt={name:W(vt),type:2},Oe.FileIndex.push(yt),Oe.FullPaths.push(Ut),wt||CFB.utils.cfb_gc(Oe)}return yt.content=ut,yt.size=ut?ut.length:0,dt&&(dt.CLSID&&(yt.clsid=dt.CLSID),dt.mt&&(yt.mt=dt.mt),dt.ct&&(yt.ct=dt.ct)),yt}function cr(Oe,vt){ge(Oe);var ut=CFB.find(Oe,vt);if(ut){for(var dt=0;dt<Oe.FileIndex.length;++dt)if(Oe.FileIndex[dt]==ut)return Oe.FileIndex.splice(dt,1),Oe.FullPaths.splice(dt,1),!0}return!1}function Tr(Oe,vt,ut){ge(Oe);var dt=CFB.find(Oe,vt);if(dt){for(var wt=0;wt<Oe.FileIndex.length;++wt)if(Oe.FileIndex[wt]==dt)return Oe.FileIndex[wt].name=W(ut),Oe.FullPaths[wt]=ut,!0}return!1}function Ar(Oe){be(Oe,!0)}return A.find=Ae,A.read=Te,A.parse=ie,A.write=pt,A.writeFile=bt,A.utils={cfb_new:qt,cfb_add:sr,cfb_del:cr,cfb_mov:Tr,cfb_gc:Ar,ReadShift,CheckField,prep_blob,bconcat,use_zlib:Ee,_deflateRaw:vr,_inflateRaw:kr,consts:gt},A}();function blobify(g){return typeof g=="string"?s2ab(g):Array.isArray(g)?a2u(g):g}function write_dl(g,A,L){if(typeof Deno<"u"){if(L&&typeof A=="string")switch(L){case"utf8":A=new TextEncoder(L).encode(A);break;case"binary":A=s2ab(A);break;default:throw new Error("Unsupported encoding "+L)}return Deno.writeFileSync(g,A)}var B=L=="utf8"?utf8write(A):A;if(typeof IE_SaveFile<"u")return IE_SaveFile(B,g);if(typeof Blob<"u"){var W=new Blob([blobify(B)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(W,g);if(typeof saveAs<"u")return saveAs(W,g);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var q=URL.createObjectURL(W);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(q)},6e4),chrome.downloads.download({url:q,filename:g,saveAs:!0});var J=document.createElement("a");if(J.download!=null)return J.download=g,J.href=q,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(q)},6e4),q}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var re=File(g);return re.open("w"),re.encoding="binary",Array.isArray(A)&&(A=a2s(A)),re.write(A),re.close(),A}catch(ae){if(!ae.message||!ae.message.match(/onstruct/))throw ae}throw new Error("cannot save file "+g)}function read_binary(g){if(typeof Deno<"u")return Deno.readFileSync(g);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var A=File(g);A.open("r"),A.encoding="binary";var L=A.read();return A.close(),L}catch(B){if(!B.message||!B.message.match(/onstruct/))throw B}throw new Error("Cannot access file "+g)}function keys(g){for(var A=Object.keys(g),L=[],B=0;B<A.length;++B)Object.prototype.hasOwnProperty.call(g,A[B])&&L.push(A[B]);return L}function evert_key(g,A){for(var L=[],B=keys(g),W=0;W!==B.length;++W)L[g[B[W]][A]]==null&&(L[g[B[W]][A]]=B[W]);return L}function evert(g){for(var A=[],L=keys(g),B=0;B!==L.length;++B)A[g[L[B]]]=L[B];return A}function evert_num(g){for(var A=[],L=keys(g),B=0;B!==L.length;++B)A[g[L[B]]]=parseInt(L[B],10);return A}function evert_arr(g){for(var A=[],L=keys(g),B=0;B!==L.length;++B)A[g[L[B]]]==null&&(A[g[L[B]]]=[]),A[g[L[B]]].push(L[B]);return A}var basedate=new Date(1899,11,30,0,0,0);function datenum(g,A){var L=g.getTime(),B=basedate.getTime()+(g.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(L-B)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(g){var A=new Date;return A.setTime(g*24*60*60*1e3+dnthresh),A.getTimezoneOffset()!==refoffset&&A.setTime(A.getTime()+(A.getTimezoneOffset()-refoffset)*6e4),A}function parse_isodur(g){var A=0,L=0,B=!1,W=g.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!W)throw new Error("|"+g+"| is not an ISO8601 Duration");for(var q=1;q!=W.length;++q)if(W[q]){switch(L=1,q>3&&(B=!0),W[q].slice(W[q].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+W[q].slice(W[q].length-1));case"D":L*=24;case"H":L*=60;case"M":if(B)L*=60;else throw new Error("Unsupported ISO Duration Field: M")}A+=L*parseInt(W[q],10)}return A}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(g,A){var L=new Date(g);if(good_pd)return A>0?L.setTime(L.getTime()+L.getTimezoneOffset()*60*1e3):A<0&&L.setTime(L.getTime()-L.getTimezoneOffset()*60*1e3),L;if(g instanceof Date)return g;if(good_pd_date.getFullYear()==1917&&!isNaN(L.getFullYear())){var B=L.getFullYear();return g.indexOf(""+B)>-1||L.setFullYear(L.getFullYear()+100),L}var W=g.match(/\d+/g)||["2017","2","19","0","0","0"],q=new Date(+W[0],+W[1]-1,+W[2],+W[3]||0,+W[4]||0,+W[5]||0);return g.indexOf("Z")>-1&&(q=new Date(q.getTime()-q.getTimezoneOffset()*60*1e3)),q}function cc2str(g,A){if(has_buf&&Buffer.isBuffer(g)){if(A){if(g[0]==255&&g[1]==254)return utf8write(g.slice(2).toString("utf16le"));if(g[1]==254&&g[2]==255)return utf8write(utf16beread(g.slice(2).toString("binary")))}return g.toString("binary")}if(typeof TextDecoder<"u")try{if(A){if(g[0]==255&&g[1]==254)return utf8write(new TextDecoder("utf-16le").decode(g.slice(2)));if(g[0]==254&&g[1]==255)return utf8write(new TextDecoder("utf-16be").decode(g.slice(2)))}var L={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(g)&&(g=new Uint8Array(g)),new TextDecoder("latin1").decode(g).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(q){return L[q]||q})}catch{}for(var B=[],W=0;W!=g.length;++W)B.push(String.fromCharCode(g[W]));return B.join("")}function dup(g){if(typeof JSON<"u"&&!Array.isArray(g))return JSON.parse(JSON.stringify(g));if(typeof g!="object"||g==null)return g;if(g instanceof Date)return new Date(g.getTime());var A={};for(var L in g)Object.prototype.hasOwnProperty.call(g,L)&&(A[L]=dup(g[L]));return A}function fill(g,A){for(var L="";L.length<A;)L+=g;return L}function fuzzynum(g){var A=Number(g);if(!isNaN(A))return isFinite(A)?A:NaN;if(!/\d/.test(g))return A;var L=1,B=g.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return L*=100,""});return!isNaN(A=Number(B))||(B=B.replace(/[(](.*)[)]/,function(W,q){return L=-L,q}),!isNaN(A=Number(B)))?A/L:A}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(g){var A=new Date(g),L=new Date(NaN),B=A.getYear(),W=A.getMonth(),q=A.getDate();if(isNaN(q))return L;var J=g.toLowerCase();if(J.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(J=J.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),J.length>3&&lower_months.indexOf(J)==-1)return L}else if(J.match(/[a-z]/))return L;return B<0||B>8099?L:(W>0||q>1)&&B!=101?A:g.match(/[^-0-9:,\/\\]/)?L:A}var split_regex=function(){var g="abacaba".split(/(:?b)/i).length==5;return function(L,B,W){if(g||typeof B=="string")return L.split(B);for(var q=L.split(B),J=[q[0]],re=1;re<q.length;++re)J.push(W),J.push(q[re]);return J}}();function getdatastr(g){return g?g.content&&g.type?cc2str(g.content,!0):g.data?debom(g.data):g.asNodeBuffer&&has_buf?debom(g.asNodeBuffer().toString("binary")):g.asBinary?debom(g.asBinary()):g._data&&g._data.getContent?debom(cc2str(Array.prototype.slice.call(g._data.getContent(),0))):null:null}function getdatabin(g){if(!g)return null;if(g.data)return char_codes(g.data);if(g.asNodeBuffer&&has_buf)return g.asNodeBuffer();if(g._data&&g._data.getContent){var A=g._data.getContent();return typeof A=="string"?char_codes(A):Array.prototype.slice.call(A)}return g.content&&g.type?g.content:null}function getdata(g){return g&&g.name.slice(-4)===".bin"?getdatabin(g):getdatastr(g)}function safegetzipfile(g,A){for(var L=g.FullPaths||keys(g.files),B=A.toLowerCase().replace(/[\/]/g,"\\"),W=B.replace(/\\/g,"/"),q=0;q<L.length;++q){var J=L[q].replace(/^Root Entry[\/]/,"").toLowerCase();if(B==J||W==J)return g.files?g.files[L[q]]:g.FileIndex[q]}return null}function getzipfile(g,A){var L=safegetzipfile(g,A);if(L==null)throw new Error("Cannot find file "+A+" in zip");return L}function getzipdata(g,A,L){if(!L)return getdata(getzipfile(g,A));if(!A)return null;try{return getzipdata(g,A)}catch{return null}}function getzipstr(g,A,L){if(!L)return getdatastr(getzipfile(g,A));if(!A)return null;try{return getzipstr(g,A)}catch{return null}}function getzipbin(g,A,L){return getdatabin(getzipfile(g,A))}function zipentries(g){for(var A=g.FullPaths||keys(g.files),L=[],B=0;B<A.length;++B)A[B].slice(-1)!="/"&&L.push(A[B].replace(/^Root Entry[\/]/,""));return L.sort()}function zip_add_file(g,A,L){if(g.FullPaths){if(typeof L=="string"){var B;return has_buf?B=Buffer_from(L):B=utf8decode(L),CFB.utils.cfb_add(g,A,B)}CFB.utils.cfb_add(g,A,L)}else g.file(A,L)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(g,A){switch(A.type){case"base64":return CFB.read(g,{type:"base64"});case"binary":return CFB.read(g,{type:"binary"});case"buffer":case"array":return CFB.read(g,{type:"buffer"})}throw new Error("Unrecognized type "+A.type)}function resolve_path(g,A){if(g.charAt(0)=="/")return g.slice(1);var L=A.split("/");A.slice(-1)!="/"&&L.pop();for(var B=g.split("/");B.length!==0;){var W=B.shift();W===".."?L.pop():W!=="."&&L.push(W)}return L.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(g,A,L){for(var B={},W=0,q=0;W!==g.length&&!((q=g.charCodeAt(W))===32||q===10||q===13);++W);if(A||(B[0]=g.slice(0,W)),W===g.length)return B;var J=g.match(attregexg),re=0,ae="",se=0,ie="",le="",pe=1;if(J)for(se=0;se!=J.length;++se){for(le=J[se],q=0;q!=le.length&&le.charCodeAt(q)!==61;++q);for(ie=le.slice(0,q).trim();le.charCodeAt(q+1)==32;)++q;for(pe=(W=le.charCodeAt(q+1))==34||W==39?1:0,ae=le.slice(q+1+pe,le.length-pe),re=0;re!=ie.length&&ie.charCodeAt(re)!==58;++re);if(re===ie.length)ie.indexOf("_")>0&&(ie=ie.slice(0,ie.indexOf("_"))),B[ie]=ae,B[ie.toLowerCase()]=ae;else{var he=(re===5&&ie.slice(0,5)==="xmlns"?"xmlns":"")+ie.slice(re+1);if(B[he]&&ie.slice(re-3,re)=="ext")continue;B[he]=ae,B[he.toLowerCase()]=ae}}return B}function strip_ns(g){return g.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var g=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,A=/_x([\da-fA-F]{4})_/ig;return function L(B){var W=B+"",q=W.indexOf("<![CDATA[");if(q==-1)return W.replace(g,function(re,ae){return encodings[re]||String.fromCharCode(parseInt(ae,re.indexOf("x")>-1?16:10))||re}).replace(A,function(re,ae){return String.fromCharCode(parseInt(ae,16))});var J=W.indexOf("]]>");return L(W.slice(0,q))+W.slice(q+9,J)+L(W.slice(J+3))}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(g){var A=g+"";return A.replace(decregex,function(L){return rencoding[L]}).replace(charegex,function(L){return"_x"+("000"+L.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(g){return escapexml(g).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(g){var A=g+"";return A.replace(decregex,function(L){return rencoding[L]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(L){return"&#x"+("000"+L.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(g){var A=g+"";return A.replace(decregex,function(L){return rencoding[L]}).replace(htmlcharegex,function(L){return"&#x"+L.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var g=/&#(\d+);/g;function A(L,B){return String.fromCharCode(parseInt(B,10))}return function(B){return B.replace(g,A)}}();function xlml_unfixstr(g){return g.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(g){switch(g){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(g){for(var A="",L=0,B=0,W=0,q=0,J=0,re=0;L<g.length;){if(B=g.charCodeAt(L++),B<128){A+=String.fromCharCode(B);continue}if(W=g.charCodeAt(L++),B>191&&B<224){J=(B&31)<<6,J|=W&63,A+=String.fromCharCode(J);continue}if(q=g.charCodeAt(L++),B<240){A+=String.fromCharCode((B&15)<<12|(W&63)<<6|q&63);continue}J=g.charCodeAt(L++),re=((B&7)<<18|(W&63)<<12|(q&63)<<6|J&63)-65536,A+=String.fromCharCode(55296+(re>>>10&1023)),A+=String.fromCharCode(56320+(re&1023))}return A}function utf8readb(g){var A=new_raw_buf(2*g.length),L,B,W=1,q=0,J=0,re;for(B=0;B<g.length;B+=W)W=1,(re=g.charCodeAt(B))<128?L=re:re<224?(L=(re&31)*64+(g.charCodeAt(B+1)&63),W=2):re<240?(L=(re&15)*4096+(g.charCodeAt(B+1)&63)*64+(g.charCodeAt(B+2)&63),W=3):(W=4,L=(re&7)*262144+(g.charCodeAt(B+1)&63)*4096+(g.charCodeAt(B+2)&63)*64+(g.charCodeAt(B+3)&63),L-=65536,J=55296+(L>>>10&1023),L=56320+(L&1023)),J!==0&&(A[q++]=J&255,A[q++]=J>>>8,J=0),A[q++]=L%256,A[q++]=L>>>8;return A.slice(0,q).toString("ucs2")}function utf8readc(g){return Buffer_from(g,"binary").toString("utf8")}var utf8corpus="foo bar bazâð£",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(g){return Buffer_from(g,"utf8").toString("binary")}:function(g){for(var A=[],L=0,B=0,W=0;L<g.length;)switch(B=g.charCodeAt(L++),!0){case B<128:A.push(String.fromCharCode(B));break;case B<2048:A.push(String.fromCharCode(192+(B>>6))),A.push(String.fromCharCode(128+(B&63)));break;case(B>=55296&&B<57344):B-=55296,W=g.charCodeAt(L++)-56320+(B<<10),A.push(String.fromCharCode(240+(W>>18&7))),A.push(String.fromCharCode(144+(W>>12&63))),A.push(String.fromCharCode(128+(W>>6&63))),A.push(String.fromCharCode(128+(W&63)));break;default:A.push(String.fromCharCode(224+(B>>12))),A.push(String.fromCharCode(128+(B>>6&63))),A.push(String.fromCharCode(128+(B&63)))}return A.join("")},matchtag=function(){var g={};return function(L,B){var W=L+"|"+(B||"");return g[W]?g[W]:g[W]=new RegExp("<(?:\\w+:)?"+L+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+L+">",B||"")}}(),htmldecode=function(){var g=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(A){return[new RegExp("&"+A[0]+";","ig"),A[1]]});return function(L){for(var B=L.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),W=0;W<g.length;++W)B=B.replace(g[W][0],g[W][1]);return B}}(),vtregex=function(){var g={};return function(L){return g[L]!==void 0?g[L]:g[L]=new RegExp("<(?:vt:)?"+L+">([\\s\\S]*?)</(?:vt:)?"+L+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(g,A){var L=parsexmltag(g),B=g.match(vtregex(L.baseType))||[],W=[];if(B.length!=L.size){if(A.WTF)throw new Error("unexpected vector length "+B.length+" != "+L.size);return W}return B.forEach(function(q){var J=q.replace(vtvregex,"").match(vtmregex);J&&W.push({v:utf8read(J[2]),t:J[1]})}),W}var wtregex=/(^\s|\s$|\n)/;function writetag(g,A){return"<"+g+(A.match(wtregex)?' xml:space="preserve"':"")+">"+A+"</"+g+">"}function wxt_helper(g){return keys(g).map(function(A){return" "+A+'="'+g[A]+'"'}).join("")}function writextag(g,A,L){return"<"+g+(L!=null?wxt_helper(L):"")+(A!=null?(A.match(wtregex)?' xml:space="preserve"':"")+">"+A+"</"+g:"/")+">"}function write_w3cdtf(g,A){try{return g.toISOString().replace(/\.\d*/,"")}catch(L){if(A)throw L}return""}function write_vt(g,A){switch(typeof g){case"string":var L=writextag("vt:lpwstr",escapexml(g));return L=L.replace(/&quot;/g,"_x0022_"),L;case"number":return writextag((g|0)==g?"vt:i4":"vt:r8",escapexml(String(g)));case"boolean":return writextag("vt:bool",g?"true":"false")}if(g instanceof Date)return writextag("vt:filetime",write_w3cdtf(g));throw new Error("Unable to serialize "+g)}function xlml_normalize(g){if(has_buf&&Buffer.isBuffer(g))return g.toString("utf8");if(typeof g=="string")return g;if(typeof Uint8Array<"u"&&g instanceof Uint8Array)return utf8read(a2s(ab2a(g)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(g,A){for(var L=1-2*(g[A+7]>>>7),B=((g[A+7]&127)<<4)+(g[A+6]>>>4&15),W=g[A+6]&15,q=5;q>=0;--q)W=W*256+g[A+q];return B==2047?W==0?L*(1/0):NaN:(B==0?B=-1022:(B-=1023,W+=Math.pow(2,52)),L*Math.pow(2,B-52)*W)}function write_double_le(g,A,L){var B=(A<0||1/A==-1/0?1:0)<<7,W=0,q=0,J=B?-A:A;isFinite(J)?J==0?W=q=0:(W=Math.floor(Math.log(J)/Math.LN2),q=J*Math.pow(2,52-W),W<=-1023&&(!isFinite(q)||q<Math.pow(2,52))?W=-1022:(q-=Math.pow(2,52),W+=1023)):(W=2047,q=isNaN(A)?26985:0);for(var re=0;re<=5;++re,q/=256)g[L+re]=q&255;g[L+6]=(W&15)<<4|q&15,g[L+7]=W>>4|B}var ___toBuffer=function(g){for(var A=[],L=10240,B=0;B<g[0].length;++B)if(g[0][B])for(var W=0,q=g[0][B].length;W<q;W+=L)A.push.apply(A,g[0][B].slice(W,W+L));return A},__toBuffer=has_buf?function(g){return g[0].length>0&&Buffer.isBuffer(g[0][0])?Buffer.concat(g[0].map(function(A){return Buffer.isBuffer(A)?A:Buffer_from(A)})):___toBuffer(g)}:___toBuffer,___utf16le=function(g,A,L){for(var B=[],W=A;W<L;W+=2)B.push(String.fromCharCode(__readUInt16LE(g,W)));return B.join("").replace(chr0,"")},__utf16le=has_buf?function(g,A,L){return Buffer.isBuffer(g)?g.toString("utf16le",A,L).replace(chr0,""):___utf16le(g,A,L)}:___utf16le,___hexlify=function(g,A,L){for(var B=[],W=A;W<A+L;++W)B.push(("0"+g[W].toString(16)).slice(-2));return B.join("")},__hexlify=has_buf?function(g,A,L){return Buffer.isBuffer(g)?g.toString("hex",A,A+L):___hexlify(g,A,L)}:___hexlify,___utf8=function(g,A,L){for(var B=[],W=A;W<L;W++)B.push(String.fromCharCode(__readUInt8(g,W)));return B.join("")},__utf8=has_buf?function g(A,L,B){return Buffer.isBuffer(A)?A.toString("utf8",L,B):___utf8(A,L,B)}:___utf8,___lpstr=function(g,A){var L=__readUInt32LE(g,A);return L>0?__utf8(g,A+4,A+4+L-1):""},__lpstr=___lpstr,___cpstr=function(g,A){var L=__readUInt32LE(g,A);return L>0?__utf8(g,A+4,A+4+L-1):""},__cpstr=___cpstr,___lpwstr=function(g,A){var L=2*__readUInt32LE(g,A);return L>0?__utf8(g,A+4,A+4+L-1):""},__lpwstr=___lpwstr,___lpp4=function g(A,L){var B=__readUInt32LE(A,L);return B>0?__utf16le(A,L+4,L+4+B):""},__lpp4=___lpp4,___8lpp4=function(g,A){var L=__readUInt32LE(g,A);return L>0?__utf8(g,A+4,A+4+L):""},__8lpp4=___8lpp4,___double=function(g,A){return read_double_le(g,A)},__double=___double,is_buf=function g(A){return Array.isArray(A)||typeof Uint8Array<"u"&&A instanceof Uint8Array};has_buf&&(__lpstr=function(A,L){if(!Buffer.isBuffer(A))return ___lpstr(A,L);var B=A.readUInt32LE(L);return B>0?A.toString("utf8",L+4,L+4+B-1):""},__cpstr=function(A,L){if(!Buffer.isBuffer(A))return ___cpstr(A,L);var B=A.readUInt32LE(L);return B>0?A.toString("utf8",L+4,L+4+B-1):""},__lpwstr=function(A,L){if(!Buffer.isBuffer(A))return ___lpwstr(A,L);var B=2*A.readUInt32LE(L);return A.toString("utf16le",L+4,L+4+B-1)},__lpp4=function(A,L){if(!Buffer.isBuffer(A))return ___lpp4(A,L);var B=A.readUInt32LE(L);return A.toString("utf16le",L+4,L+4+B)},__8lpp4=function(A,L){if(!Buffer.isBuffer(A))return ___8lpp4(A,L);var B=A.readUInt32LE(L);return A.toString("utf8",L+4,L+4+B)},__double=function(A,L){return Buffer.isBuffer(A)?A.readDoubleLE(L):___double(A,L)},is_buf=function(A){return Buffer.isBuffer(A)||Array.isArray(A)||typeof Uint8Array<"u"&&A instanceof Uint8Array});var __readUInt8=function(g,A){return g[A]},__readUInt16LE=function(g,A){return g[A+1]*256+g[A]},__readInt16LE=function(g,A){var L=g[A+1]*256+g[A];return L<32768?L:(65535-L+1)*-1},__readUInt32LE=function(g,A){return g[A+3]*(1<<24)+(g[A+2]<<16)+(g[A+1]<<8)+g[A]},__readInt32LE=function(g,A){return g[A+3]<<24|g[A+2]<<16|g[A+1]<<8|g[A]},__readInt32BE=function(g,A){return g[A]<<24|g[A+1]<<16|g[A+2]<<8|g[A+3]};function ReadShift(g,A){var L="",B,W,q=[],J,re,ae,se;switch(A){case"dbcs":if(se=this.l,has_buf&&Buffer.isBuffer(this))L=this.slice(this.l,this.l+2*g).toString("utf16le");else for(ae=0;ae<g;++ae)L+=String.fromCharCode(__readUInt16LE(this,se)),se+=2;g*=2;break;case"utf8":L=__utf8(this,this.l,this.l+g);break;case"utf16le":g*=2,L=__utf16le(this,this.l,this.l+g);break;case"wstr":return ReadShift.call(this,g,"dbcs");case"lpstr-ansi":L=__lpstr(this,this.l),g=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":L=__cpstr(this,this.l),g=4+__readUInt32LE(this,this.l);break;case"lpwstr":L=__lpwstr(this,this.l),g=4+2*__readUInt32LE(this,this.l);break;case"lpp4":g=4+__readUInt32LE(this,this.l),L=__lpp4(this,this.l),g&2&&(g+=2);break;case"8lpp4":g=4+__readUInt32LE(this,this.l),L=__8lpp4(this,this.l),g&3&&(g+=4-(g&3));break;case"cstr":for(g=0,L="";(J=__readUInt8(this,this.l+g++))!==0;)q.push(_getchar(J));L=q.join("");break;case"_wstr":for(g=0,L="";(J=__readUInt16LE(this,this.l+g))!==0;)q.push(_getchar(J)),g+=2;g+=2,L=q.join("");break;case"dbcs-cont":for(L="",se=this.l,ae=0;ae<g;++ae){if(this.lens&&this.lens.indexOf(se)!==-1)return J=__readUInt8(this,se),this.l=se+1,re=ReadShift.call(this,g-ae,J?"dbcs-cont":"sbcs-cont"),q.join("")+re;q.push(_getchar(__readUInt16LE(this,se))),se+=2}L=q.join(""),g*=2;break;case"cpstr":case"sbcs-cont":for(L="",se=this.l,ae=0;ae!=g;++ae){if(this.lens&&this.lens.indexOf(se)!==-1)return J=__readUInt8(this,se),this.l=se+1,re=ReadShift.call(this,g-ae,J?"dbcs-cont":"sbcs-cont"),q.join("")+re;q.push(_getchar(__readUInt8(this,se))),se+=1}L=q.join("");break;default:switch(g){case 1:return B=__readUInt8(this,this.l),this.l++,B;case 2:return B=(A==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,B;case 4:case-4:return A==="i"||(this[this.l+3]&128)===0?(B=(g>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,B):(W=__readUInt32LE(this,this.l),this.l+=4,W);case 8:case-8:if(A==="f")return g==8?W=__double(this,this.l):W=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,W;g=8;case 16:L=__hexlify(this,this.l,g);break}}return this.l+=g,L}var __writeUInt32LE=function(g,A,L){g[L]=A&255,g[L+1]=A>>>8&255,g[L+2]=A>>>16&255,g[L+3]=A>>>24&255},__writeInt32LE=function(g,A,L){g[L]=A&255,g[L+1]=A>>8&255,g[L+2]=A>>16&255,g[L+3]=A>>24&255},__writeUInt16LE=function(g,A,L){g[L]=A&255,g[L+1]=A>>>8&255};function WriteShift(g,A,L){var B=0,W=0;if(L==="dbcs"){for(W=0;W!=A.length;++W)__writeUInt16LE(this,A.charCodeAt(W),this.l+2*W);B=2*A.length}else if(L==="sbcs"){for(A=A.replace(/[^\x00-\x7F]/g,"_"),W=0;W!=A.length;++W)this[this.l+W]=A.charCodeAt(W)&255;B=A.length}else if(L==="hex"){for(;W<g;++W)this[this.l++]=parseInt(A.slice(2*W,2*W+2),16)||0;return this}else if(L==="utf16le"){var q=Math.min(this.l+g,this.length);for(W=0;W<Math.min(A.length,g);++W){var J=A.charCodeAt(W);this[this.l++]=J&255,this[this.l++]=J>>8}for(;this.l<q;)this[this.l++]=0;return this}else switch(g){case 1:B=1,this[this.l]=A&255;break;case 2:B=2,this[this.l]=A&255,A>>>=8,this[this.l+1]=A&255;break;case 3:B=3,this[this.l]=A&255,A>>>=8,this[this.l+1]=A&255,A>>>=8,this[this.l+2]=A&255;break;case 4:B=4,__writeUInt32LE(this,A,this.l);break;case 8:if(B=8,L==="f"){write_double_le(this,A,this.l);break}case 16:break;case-4:B=4,__writeInt32LE(this,A,this.l);break}return this.l+=B,this}function CheckField(g,A){var L=__hexlify(this,this.l,g.length>>1);if(L!==g)throw new Error(A+"Expected "+g+" saw "+L);this.l+=g.length>>1}function prep_blob(g,A){g.l=A,g.read_shift=ReadShift,g.chk=CheckField,g.write_shift=WriteShift}function parsenoop(g,A){g.l+=A}function new_buf(g){var A=new_raw_buf(g);return prep_blob(A,0),A}function recordhopper(g,A,L){if(g){var B,W,q;prep_blob(g,g.l||0);for(var J=g.length,re=0,ae=0;g.l<J;){re=g.read_shift(1),re&128&&(re=(re&127)+((g.read_shift(1)&127)<<7));var se=XLSBRecordEnum[re]||XLSBRecordEnum[65535];for(B=g.read_shift(1),q=B&127,W=1;W<4&&B&128;++W)q+=((B=g.read_shift(1))&127)<<7*W;ae=g.l+q;var ie=se.f&&se.f(g,q,L);if(g.l=ae,A(ie,se,re))return}}}function buf_array(){var g=[],A=has_buf?256:2048,L=function(se){var ie=new_buf(se);return prep_blob(ie,0),ie},B=L(A),W=function(){B&&(B.length>B.l&&(B=B.slice(0,B.l),B.l=B.length),B.length>0&&g.push(B),B=null)},q=function(se){return B&&se<B.length-B.l?B:(W(),B=L(Math.max(se+1,A)))},J=function(){return W(),bconcat(g)},re=function(se){W(),B=se,B.l==null&&(B.l=B.length),q(A)};return{next:q,push:re,end:J,_bufs:g}}function write_record(g,A,L,B){var W=+A,q;if(!isNaN(W)){B||(B=XLSBRecordEnum[W].p||(L||[]).length||0),q=1+(W>=128?1:0)+1,B>=128&&++q,B>=16384&&++q,B>=2097152&&++q;var J=g.next(q);W<=127?J.write_shift(1,W):(J.write_shift(1,(W&127)+128),J.write_shift(1,W>>7));for(var re=0;re!=4;++re)if(B>=128)J.write_shift(1,(B&127)+128),B>>=7;else{J.write_shift(1,B);break}B>0&&is_buf(L)&&g.push(L)}}function shift_cell_xls(g,A,L){var B=dup(g);if(A.s?(B.cRel&&(B.c+=A.s.c),B.rRel&&(B.r+=A.s.r)):(B.cRel&&(B.c+=A.c),B.rRel&&(B.r+=A.r)),!L||L.biff<12){for(;B.c>=256;)B.c-=256;for(;B.r>=65536;)B.r-=65536}return B}function shift_range_xls(g,A,L){var B=dup(g);return B.s=shift_cell_xls(B.s,A.s,L),B.e=shift_cell_xls(B.e,A.s,L),B}function encode_cell_xls(g,A){if(g.cRel&&g.c<0)for(g=dup(g);g.c<0;)g.c+=A>8?16384:256;if(g.rRel&&g.r<0)for(g=dup(g);g.r<0;)g.r+=A>8?1048576:A>5?65536:16384;var L=encode_cell(g);return!g.cRel&&g.cRel!=null&&(L=fix_col(L)),!g.rRel&&g.rRel!=null&&(L=fix_row(L)),L}function encode_range_xls(g,A){return g.s.r==0&&!g.s.rRel&&g.e.r==(A.biff>=12?1048575:A.biff>=8?65536:16384)&&!g.e.rRel?(g.s.cRel?"":"$")+encode_col(g.s.c)+":"+(g.e.cRel?"":"$")+encode_col(g.e.c):g.s.c==0&&!g.s.cRel&&g.e.c==(A.biff>=12?16383:255)&&!g.e.cRel?(g.s.rRel?"":"$")+encode_row(g.s.r)+":"+(g.e.rRel?"":"$")+encode_row(g.e.r):encode_cell_xls(g.s,A.biff)+":"+encode_cell_xls(g.e,A.biff)}function decode_row(g){return parseInt(unfix_row(g),10)-1}function encode_row(g){return""+(g+1)}function fix_row(g){return g.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(g){return g.replace(/\$(\d+)$/,"$1")}function decode_col(g){for(var A=unfix_col(g),L=0,B=0;B!==A.length;++B)L=26*L+A.charCodeAt(B)-64;return L-1}function encode_col(g){if(g<0)throw new Error("invalid column "+g);var A="";for(++g;g;g=Math.floor((g-1)/26))A=String.fromCharCode((g-1)%26+65)+A;return A}function fix_col(g){return g.replace(/^([A-Z])/,"$$$1")}function unfix_col(g){return g.replace(/^\$([A-Z])/,"$1")}function split_cell(g){return g.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(g){for(var A=0,L=0,B=0;B<g.length;++B){var W=g.charCodeAt(B);W>=48&&W<=57?A=10*A+(W-48):W>=65&&W<=90&&(L=26*L+(W-64))}return{c:L-1,r:A-1}}function encode_cell(g){for(var A=g.c+1,L="";A;A=(A-1)/26|0)L=String.fromCharCode((A-1)%26+65)+L;return L+(g.r+1)}function decode_range(g){var A=g.indexOf(":");return A==-1?{s:decode_cell(g),e:decode_cell(g)}:{s:decode_cell(g.slice(0,A)),e:decode_cell(g.slice(A+1))}}function encode_range(g,A){return typeof A>"u"||typeof A=="number"?encode_range(g.s,g.e):(typeof g!="string"&&(g=encode_cell(g)),typeof A!="string"&&(A=encode_cell(A)),g==A?g:g+":"+A)}function safe_decode_range(g){var A={s:{c:0,r:0},e:{c:0,r:0}},L=0,B=0,W=0,q=g.length;for(L=0;B<q&&!((W=g.charCodeAt(B)-64)<1||W>26);++B)L=26*L+W;for(A.s.c=--L,L=0;B<q&&!((W=g.charCodeAt(B)-48)<0||W>9);++B)L=10*L+W;if(A.s.r=--L,B===q||W!=10)return A.e.c=A.s.c,A.e.r=A.s.r,A;for(++B,L=0;B!=q&&!((W=g.charCodeAt(B)-64)<1||W>26);++B)L=26*L+W;for(A.e.c=--L,L=0;B!=q&&!((W=g.charCodeAt(B)-48)<0||W>9);++B)L=10*L+W;return A.e.r=--L,A}function safe_format_cell(g,A){var L=g.t=="d"&&A instanceof Date;if(g.z!=null)try{return g.w=SSF_format(g.z,L?datenum(A):A)}catch{}try{return g.w=SSF_format((g.XF||{}).numFmtId||(L?14:0),L?datenum(A):A)}catch{return""+A}}function format_cell(g,A,L){return g==null||g.t==null||g.t=="z"?"":g.w!==void 0?g.w:(g.t=="d"&&!g.z&&L&&L.dateNF&&(g.z=L.dateNF),g.t=="e"?BErr[g.v]||g.v:A==null?safe_format_cell(g,g.v):safe_format_cell(g,A))}function sheet_to_workbook(g,A){var L=A&&A.sheet?A.sheet:"Sheet1",B={};return B[L]=g,{SheetNames:[L],Sheets:B}}function sheet_add_aoa(g,A,L){var B=L||{},W=g?Array.isArray(g):B.dense,q=g||(W?[]:{}),J=0,re=0;if(q&&B.origin!=null){if(typeof B.origin=="number")J=B.origin;else{var ae=typeof B.origin=="string"?decode_cell(B.origin):B.origin;J=ae.r,re=ae.c}q["!ref"]||(q["!ref"]="A1:A1")}var se={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(q["!ref"]){var ie=safe_decode_range(q["!ref"]);se.s.c=ie.s.c,se.s.r=ie.s.r,se.e.c=Math.max(se.e.c,ie.e.c),se.e.r=Math.max(se.e.r,ie.e.r),J==-1&&(se.e.r=J=ie.e.r+1)}for(var le=0;le!=A.length;++le)if(A[le]){if(!Array.isArray(A[le]))throw new Error("aoa_to_sheet expects an array of arrays");for(var pe=0;pe!=A[le].length;++pe)if(!(typeof A[le][pe]>"u")){var he={v:A[le][pe]},ue=J+le,ce=re+pe;if(se.s.r>ue&&(se.s.r=ue),se.s.c>ce&&(se.s.c=ce),se.e.r<ue&&(se.e.r=ue),se.e.c<ce&&(se.e.c=ce),A[le][pe]&&typeof A[le][pe]=="object"&&!Array.isArray(A[le][pe])&&!(A[le][pe]instanceof Date))he=A[le][pe];else if(Array.isArray(he.v)&&(he.f=A[le][pe][1],he.v=he.v[0]),he.v===null)if(he.f)he.t="n";else if(B.nullError)he.t="e",he.v=0;else if(B.sheetStubs)he.t="z";else continue;else typeof he.v=="number"?he.t="n":typeof he.v=="boolean"?he.t="b":he.v instanceof Date?(he.z=B.dateNF||table_fmt[14],B.cellDates?(he.t="d",he.w=SSF_format(he.z,datenum(he.v))):(he.t="n",he.v=datenum(he.v),he.w=SSF_format(he.z,he.v))):he.t="s";if(W)q[ue]||(q[ue]=[]),q[ue][ce]&&q[ue][ce].z&&(he.z=q[ue][ce].z),q[ue][ce]=he;else{var fe=encode_cell({c:ce,r:ue});q[fe]&&q[fe].z&&(he.z=q[fe].z),q[fe]=he}}}return se.s.c<1e7&&(q["!ref"]=encode_range(se)),q}function aoa_to_sheet(g,A){return sheet_add_aoa(null,g,A)}function parse_Int32LE(g){return g.read_shift(4,"i")}function write_UInt32LE(g,A){return A||(A=new_buf(4)),A.write_shift(4,g),A}function parse_XLWideString(g){var A=g.read_shift(4);return A===0?"":g.read_shift(A,"dbcs")}function write_XLWideString(g,A){var L=!1;return A==null&&(L=!0,A=new_buf(4+2*g.length)),A.write_shift(4,g.length),g.length>0&&A.write_shift(0,g,"dbcs"),L?A.slice(0,A.l):A}function parse_StrRun(g){return{ich:g.read_shift(2),ifnt:g.read_shift(2)}}function write_StrRun(g,A){return A||(A=new_buf(4)),A.write_shift(2,0),A.write_shift(2,0),A}function parse_RichStr(g,A){var L=g.l,B=g.read_shift(1),W=parse_XLWideString(g),q=[],J={t:W,h:W};if((B&1)!==0){for(var re=g.read_shift(4),ae=0;ae!=re;++ae)q.push(parse_StrRun(g));J.r=q}else J.r=[{ich:0,ifnt:0}];return g.l=L+A,J}function write_RichStr(g,A){var L=!1;return A==null&&(L=!0,A=new_buf(15+4*g.t.length)),A.write_shift(1,0),write_XLWideString(g.t,A),L?A.slice(0,A.l):A}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(g,A){var L=!1;return A==null&&(L=!0,A=new_buf(23+4*g.t.length)),A.write_shift(1,1),write_XLWideString(g.t,A),A.write_shift(4,1),write_StrRun({},A),L?A.slice(0,A.l):A}function parse_XLSBCell(g){var A=g.read_shift(4),L=g.read_shift(2);return L+=g.read_shift(1)<<16,g.l++,{c:A,iStyleRef:L}}function write_XLSBCell(g,A){return A==null&&(A=new_buf(8)),A.write_shift(-4,g.c),A.write_shift(3,g.iStyleRef||g.s),A.write_shift(1,0),A}function parse_XLSBShortCell(g){var A=g.read_shift(2);return A+=g.read_shift(1)<<16,g.l++,{c:-1,iStyleRef:A}}function write_XLSBShortCell(g,A){return A==null&&(A=new_buf(4)),A.write_shift(3,g.iStyleRef||g.s),A.write_shift(1,0),A}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(g){var A=g.read_shift(4);return A===0||A===4294967295?"":g.read_shift(A,"dbcs")}function write_XLNullableWideString(g,A){var L=!1;return A==null&&(L=!0,A=new_buf(127)),A.write_shift(4,g.length>0?g.length:4294967295),g.length>0&&A.write_shift(0,g,"dbcs"),L?A.slice(0,A.l):A}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(g){var A=g.slice(g.l,g.l+4),L=A[0]&1,B=A[0]&2;g.l+=4;var W=B===0?__double([0,0,0,0,A[0]&252,A[1],A[2],A[3]],0):__readInt32LE(A,0)>>2;return L?W/100:W}function write_RkNumber(g,A){A==null&&(A=new_buf(4));var L=0,B=0,W=g*100;if(g==(g|0)&&g>=-536870912&&g<1<<29?B=1:W==(W|0)&&W>=-536870912&&W<1<<29&&(B=1,L=1),B)A.write_shift(-4,((L?W:g)<<2)+(L+2));else throw new Error("unsupported RkNumber "+g)}function parse_RfX(g){var A={s:{},e:{}};return A.s.r=g.read_shift(4),A.e.r=g.read_shift(4),A.s.c=g.read_shift(4),A.e.c=g.read_shift(4),A}function write_RfX(g,A){return A||(A=new_buf(16)),A.write_shift(4,g.s.r),A.write_shift(4,g.e.r),A.write_shift(4,g.s.c),A.write_shift(4,g.e.c),A}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(g){if(g.length-g.l<8)throw"XLS Xnum Buffer underflow";return g.read_shift(8,"f")}function write_Xnum(g,A){return(A||new_buf(8)).write_shift(8,g,"f")}function parse_BrtColor(g){var A={},L=g.read_shift(1),B=L>>>1,W=g.read_shift(1),q=g.read_shift(2,"i"),J=g.read_shift(1),re=g.read_shift(1),ae=g.read_shift(1);switch(g.l++,B){case 0:A.auto=1;break;case 1:A.index=W;var se=XLSIcv[W];se&&(A.rgb=rgb2Hex(se));break;case 2:A.rgb=rgb2Hex([J,re,ae]);break;case 3:A.theme=W;break}return q!=0&&(A.tint=q>0?q/32767:q/32768),A}function write_BrtColor(g,A){if(A||(A=new_buf(8)),!g||g.auto)return A.write_shift(4,0),A.write_shift(4,0),A;g.index!=null?(A.write_shift(1,2),A.write_shift(1,g.index)):g.theme!=null?(A.write_shift(1,6),A.write_shift(1,g.theme)):(A.write_shift(1,5),A.write_shift(1,0));var L=g.tint||0;if(L>0?L*=32767:L<0&&(L*=32768),A.write_shift(2,L),!g.rgb||g.theme!=null)A.write_shift(2,0),A.write_shift(1,0),A.write_shift(1,0);else{var B=g.rgb||"FFFFFF";typeof B=="number"&&(B=("000000"+B.toString(16)).slice(-6)),A.write_shift(1,parseInt(B.slice(0,2),16)),A.write_shift(1,parseInt(B.slice(2,4),16)),A.write_shift(1,parseInt(B.slice(4,6),16)),A.write_shift(1,255)}return A}function parse_FontFlags(g){var A=g.read_shift(1);g.l++;var L={fBold:A&1,fItalic:A&2,fUnderline:A&4,fStrikeout:A&8,fOutline:A&16,fShadow:A&32,fCondense:A&64,fExtend:A&128};return L}function write_FontFlags(g,A){A||(A=new_buf(2));var L=(g.italic?2:0)|(g.strike?8:0)|(g.outline?16:0)|(g.shadow?32:0)|(g.condense?64:0)|(g.extend?128:0);return A.write_shift(1,L),A.write_shift(1,0),A}function parse_ClipboardFormatOrString(g,A){var L={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},B=g.read_shift(4);switch(B){case 0:return"";case 4294967295:case 4294967294:return L[g.read_shift(4)]||""}if(B>400)throw new Error("Unsupported Clipboard: "+B.toString(16));return g.l-=4,g.read_shift(0,A==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(g){return parse_ClipboardFormatOrString(g,1)}function parse_ClipboardFormatOrUnicodeString(g){return parse_ClipboardFormatOrString(g,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(g){return g.map(function(A){return[A>>16&255,A>>8&255,A&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(g){var A=new_ct();if(!g||!g.match)return A;var L={};if((g.match(tagregex)||[]).forEach(function(B){var W=parsexmltag(B);switch(W[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":A.xmlns=W["xmlns"+(W[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":L[W.Extension]=W.ContentType;break;case"<Override":A[ct2type[W.ContentType]]!==void 0&&A[ct2type[W.ContentType]].push(W.PartName);break}}),A.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+A.xmlns);return A.calcchain=A.calcchains.length>0?A.calcchains[0]:"",A.sst=A.strs.length>0?A.strs[0]:"",A.style=A.styles.length>0?A.styles[0]:"",A.defaults=L,delete A.calcchains,A}function write_ct(g,A){var L=evert_arr(ct2type),B=[],W;B[B.length]=XML_HEADER,B[B.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),B=B.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(ae){return writextag("Default",null,{Extension:ae[0],ContentType:ae[1]})}));var q=function(ae){g[ae]&&g[ae].length>0&&(W=g[ae][0],B[B.length]=writextag("Override",null,{PartName:(W[0]=="/"?"":"/")+W,ContentType:CT_LIST[ae][A.bookType]||CT_LIST[ae].xlsx}))},J=function(ae){(g[ae]||[]).forEach(function(se){B[B.length]=writextag("Override",null,{PartName:(se[0]=="/"?"":"/")+se,ContentType:CT_LIST[ae][A.bookType]||CT_LIST[ae].xlsx})})},re=function(ae){(g[ae]||[]).forEach(function(se){B[B.length]=writextag("Override",null,{PartName:(se[0]=="/"?"":"/")+se,ContentType:L[ae][0]})})};return q("workbooks"),J("sheets"),J("charts"),re("themes"),["strs","styles"].forEach(q),["coreprops","extprops","custprops"].forEach(re),re("vba"),re("comments"),re("threadedcomments"),re("drawings"),J("metadata"),re("people"),B.length>2&&(B[B.length]="</Types>",B[1]=B[1].replace("/>",">")),B.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(g){var A=g.lastIndexOf("/");return g.slice(0,A+1)+"_rels/"+g.slice(A+1)+".rels"}function parse_rels(g,A){var L={"!id":{}};if(!g)return L;A.charAt(0)!=="/"&&(A="/"+A);var B={};return(g.match(tagregex)||[]).forEach(function(W){var q=parsexmltag(W);if(q[0]==="<Relationship"){var J={};J.Type=q.Type,J.Target=q.Target,J.Id=q.Id,q.TargetMode&&(J.TargetMode=q.TargetMode);var re=q.TargetMode==="External"?q.Target:resolve_path(q.Target,A);L[re]=J,B[q.Id]=J}}),L["!id"]=B,L}function write_rels(g){var A=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(g["!id"]).forEach(function(L){A[A.length]=writextag("Relationship",null,g["!id"][L])}),A.length>2&&(A[A.length]="</Relationships>",A[1]=A[1].replace("/>",">")),A.join("")}function add_rels(g,A,L,B,W,q){if(W||(W={}),g["!id"]||(g["!id"]={}),g["!idx"]||(g["!idx"]=1),A<0)for(A=g["!idx"];g["!id"]["rId"+A];++A);if(g["!idx"]=A+1,W.Id="rId"+A,W.Type=B,W.Target=L,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(W.Type)>-1&&(W.TargetMode="External"),g["!id"][W.Id])throw new Error("Cannot rewrite rId "+A);return g["!id"][W.Id]=W,g[("/"+W.Target).replace("//","/")]=W,A}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(g,A){for(var L=xlml_normalize(g),B,W;B=xlmlregex.exec(L);)switch(B[3]){case"manifest":break;case"file-entry":if(W=parsexmltag(B[0],!1),W.path=="/"&&W.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(A&&A.WTF)throw B}}function write_manifest(g){var A=[XML_HEADER];A.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),A.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var L=0;L<g.length;++L)A.push('  <manifest:file-entry manifest:full-path="'+g[L][0]+'" manifest:media-type="'+g[L][1]+`"/>
`);return A.push("</manifest:manifest>"),A.join("")}function write_rdf_type(g,A,L){return['  <rdf:Description rdf:about="'+g+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(L||"odf")+"#"+A+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(g,A){return['  <rdf:Description rdf:about="'+g+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+A+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(g){var A=[XML_HEADER];A.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var L=0;L!=g.length;++L)A.push(write_rdf_type(g[L][0],g[L][1])),A.push(write_rdf_has("",g[L][0]));return A.push(write_rdf_type("","Document","pkg")),A.push("</rdf:RDF>"),A.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var g=new Array(CORE_PROPS.length),A=0;A<CORE_PROPS.length;++A){var L=CORE_PROPS[A],B="(?:"+L[0].slice(0,L[0].indexOf(":"))+":)"+L[0].slice(L[0].indexOf(":")+1);g[A]=new RegExp("<"+B+"[^>]*>([\\s\\S]*?)</"+B+">")}return g}();function parse_core_props(g){var A={};g=utf8read(g);for(var L=0;L<CORE_PROPS.length;++L){var B=CORE_PROPS[L],W=g.match(CORE_PROPS_REGEX[L]);W!=null&&W.length>0&&(A[B[1]]=unescapexml(W[1])),B[2]==="date"&&A[B[1]]&&(A[B[1]]=parseDate(A[B[1]]))}return A}function cp_doit(g,A,L,B,W){W[g]!=null||A==null||A===""||(W[g]=A,A=escapexml(A),B[B.length]=L?writextag(g,A,L):writetag(g,A))}function write_core_props(g,A){var L=A||{},B=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],W={};if(!g&&!L.Props)return B.join("");g&&(g.CreatedDate!=null&&cp_doit("dcterms:created",typeof g.CreatedDate=="string"?g.CreatedDate:write_w3cdtf(g.CreatedDate,L.WTF),{"xsi:type":"dcterms:W3CDTF"},B,W),g.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof g.ModifiedDate=="string"?g.ModifiedDate:write_w3cdtf(g.ModifiedDate,L.WTF),{"xsi:type":"dcterms:W3CDTF"},B,W));for(var q=0;q!=CORE_PROPS.length;++q){var J=CORE_PROPS[q],re=L.Props&&L.Props[J[1]]!=null?L.Props[J[1]]:g?g[J[1]]:null;re===!0?re="1":re===!1?re="0":typeof re=="number"&&(re=String(re)),re!=null&&cp_doit(J[0],re,null,B,W)}return B.length>2&&(B[B.length]="</cp:coreProperties>",B[1]=B[1].replace("/>",">")),B.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(g,A,L,B){var W=[];if(typeof g=="string")W=parseVector(g,B);else for(var q=0;q<g.length;++q)W=W.concat(g[q].map(function(ie){return{v:ie}}));var J=typeof A=="string"?parseVector(A,B).map(function(ie){return ie.v}):A,re=0,ae=0;if(J.length>0)for(var se=0;se!==W.length;se+=2){switch(ae=+W[se+1].v,W[se].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":L.Worksheets=ae,L.SheetNames=J.slice(re,re+ae);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":L.NamedRanges=ae,L.DefinedNames=J.slice(re,re+ae);break;case"Charts":case"Diagramme":L.Chartsheets=ae,L.ChartNames=J.slice(re,re+ae);break}re+=ae}}function parse_ext_props(g,A,L){var B={};return A||(A={}),g=utf8read(g),EXT_PROPS.forEach(function(W){var q=(g.match(matchtag(W[0]))||[])[1];switch(W[2]){case"string":q&&(A[W[1]]=unescapexml(q));break;case"bool":A[W[1]]=q==="true";break;case"raw":var J=g.match(new RegExp("<"+W[0]+"[^>]*>([\\s\\S]*?)</"+W[0]+">"));J&&J.length>0&&(B[W[1]]=J[1]);break}}),B.HeadingPairs&&B.TitlesOfParts&&load_props_pairs(B.HeadingPairs,B.TitlesOfParts,A,L),A}function write_ext_props(g){var A=[],L=writextag;return g||(g={}),g.Application="SheetJS",A[A.length]=XML_HEADER,A[A.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(B){if(g[B[1]]!==void 0){var W;switch(B[2]){case"string":W=escapexml(String(g[B[1]]));break;case"bool":W=g[B[1]]?"true":"false";break}W!==void 0&&(A[A.length]=L(B[0],W))}}),A[A.length]=L("HeadingPairs",L("vt:vector",L("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+L("vt:variant",L("vt:i4",String(g.Worksheets))),{size:2,baseType:"variant"})),A[A.length]=L("TitlesOfParts",L("vt:vector",g.SheetNames.map(function(B){return"<vt:lpstr>"+escapexml(B)+"</vt:lpstr>"}).join(""),{size:g.Worksheets,baseType:"lpstr"})),A.length>2&&(A[A.length]="</Properties>",A[1]=A[1].replace("/>",">")),A.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(g,A){var L={},B="",W=g.match(custregex);if(W)for(var q=0;q!=W.length;++q){var J=W[q],re=parsexmltag(J);switch(re[0]){case"<?xml":break;case"<Properties":break;case"<property":B=unescapexml(re.name);break;case"</property>":B=null;break;default:if(J.indexOf("<vt:")===0){var ae=J.split(">"),se=ae[0].slice(4),ie=ae[1];switch(se){case"lpstr":case"bstr":case"lpwstr":L[B]=unescapexml(ie);break;case"bool":L[B]=parsexmlbool(ie);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":L[B]=parseInt(ie,10);break;case"r4":case"r8":case"decimal":L[B]=parseFloat(ie);break;case"filetime":case"date":L[B]=parseDate(ie);break;case"cy":case"error":L[B]=unescapexml(ie);break;default:if(se.slice(-1)=="/")break;A.WTF&&typeof console<"u"&&console.warn("Unexpected",J,se,ae)}}else if(J.slice(0,2)!=="</"){if(A.WTF)throw new Error(J)}}}return L}function write_cust_props(g){var A=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!g)return A.join("");var L=1;return keys(g).forEach(function(W){++L,A[A.length]=writextag("property",write_vt(g[W]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:L,name:escapexml(W)})}),A.length>2&&(A[A.length]="</Properties>",A[1]=A[1].replace("/>",">")),A.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(g,A,L){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),A=evert_XLMLDPM[A]||A,g[A]=L}function xlml_write_docprops(g,A){var L=[];return keys(XLMLDocPropsMap).map(function(B){for(var W=0;W<CORE_PROPS.length;++W)if(CORE_PROPS[W][1]==B)return CORE_PROPS[W];for(W=0;W<EXT_PROPS.length;++W)if(EXT_PROPS[W][1]==B)return EXT_PROPS[W];throw B}).forEach(function(B){if(g[B[1]]!=null){var W=A&&A.Props&&A.Props[B[1]]!=null?A.Props[B[1]]:g[B[1]];switch(B[2]){case"date":W=new Date(W).toISOString().replace(/\.\d*Z/,"Z");break}typeof W=="number"?W=String(W):W===!0||W===!1?W=W?"1":"0":W instanceof Date&&(W=new Date(W).toISOString().replace(/\.\d*Z/,"")),L.push(writetag(XLMLDocPropsMap[B[1]]||B[1],W))}}),writextag("DocumentProperties",L.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(g,A){var L=["Worksheets","SheetNames"],B="CustomDocumentProperties",W=[];return g&&keys(g).forEach(function(q){if(Object.prototype.hasOwnProperty.call(g,q)){for(var J=0;J<CORE_PROPS.length;++J)if(q==CORE_PROPS[J][1])return;for(J=0;J<EXT_PROPS.length;++J)if(q==EXT_PROPS[J][1])return;for(J=0;J<L.length;++J)if(q==L[J])return;var re=g[q],ae="string";typeof re=="number"?(ae="float",re=String(re)):re===!0||re===!1?(ae="boolean",re=re?"1":"0"):re=String(re),W.push(writextag(escapexmltag(q),re,{"dt:dt":ae}))}}),A&&keys(A).forEach(function(q){if(Object.prototype.hasOwnProperty.call(A,q)&&!(g&&Object.prototype.hasOwnProperty.call(g,q))){var J=A[q],re="string";typeof J=="number"?(re="float",J=String(J)):J===!0||J===!1?(re="boolean",J=J?"1":"0"):J instanceof Date?(re="dateTime.tz",J=J.toISOString()):J=String(J),W.push(writextag(escapexmltag(q),J,{"dt:dt":re}))}}),"<"+B+' xmlns="'+XLMLNS.o+'">'+W.join("")+"</"+B+">"}function parse_FILETIME(g){var A=g.read_shift(4),L=g.read_shift(4);return new Date((L/1e7*Math.pow(2,32)+A/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(g){var A=typeof g=="string"?new Date(Date.parse(g)):g,L=A.getTime()/1e3+11644473600,B=L%Math.pow(2,32),W=(L-B)/Math.pow(2,32);B*=1e7,W*=1e7;var q=B/Math.pow(2,32)|0;q>0&&(B=B%Math.pow(2,32),W+=q);var J=new_buf(8);return J.write_shift(4,B),J.write_shift(4,W),J}function parse_lpstr(g,A,L){var B=g.l,W=g.read_shift(0,"lpstr-cp");if(L)for(;g.l-B&3;)++g.l;return W}function parse_lpwstr(g,A,L){var B=g.read_shift(0,"lpwstr");return B}function parse_VtStringBase(g,A,L){return A===31?parse_lpwstr(g):parse_lpstr(g,A,L)}function parse_VtString(g,A,L){return parse_VtStringBase(g,A,L===!1?0:4)}function parse_VtUnalignedString(g,A){if(!A)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(g,A,0)}function parse_VtVecLpwstrValue(g){for(var A=g.read_shift(4),L=[],B=0;B!=A;++B){var W=g.l;L[B]=g.read_shift(0,"lpwstr").replace(chr0,""),g.l-W&2&&(g.l+=2)}return L}function parse_VtVecUnalignedLpstrValue(g){for(var A=g.read_shift(4),L=[],B=0;B!=A;++B)L[B]=g.read_shift(0,"lpstr-cp").replace(chr0,"");return L}function parse_VtHeadingPair(g){var A=g.l,L=parse_TypedPropertyValue(g,VT_USTR);g[g.l]==0&&g[g.l+1]==0&&g.l-A&2&&(g.l+=2);var B=parse_TypedPropertyValue(g,VT_I4);return[L,B]}function parse_VtVecHeadingPairValue(g){for(var A=g.read_shift(4),L=[],B=0;B<A/2;++B)L.push(parse_VtHeadingPair(g));return L}function parse_dictionary(g,A){for(var L=g.read_shift(4),B={},W=0;W!=L;++W){var q=g.read_shift(4),J=g.read_shift(4);B[q]=g.read_shift(J,A===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),A===1200&&J%2&&(g.l+=2)}return g.l&3&&(g.l=g.l>>3<<2),B}function parse_BLOB(g){var A=g.read_shift(4),L=g.slice(g.l,g.l+A);return g.l+=A,(A&3)>0&&(g.l+=4-(A&3)&3),L}function parse_ClipboardData(g){var A={};return A.Size=g.read_shift(4),g.l+=A.Size+3-(A.Size-1)%4,A}function parse_TypedPropertyValue(g,A,L){var B=g.read_shift(2),W,q=L||{};if(g.l+=2,A!==VT_VARIANT&&B!==A&&VT_CUSTOM.indexOf(A)===-1&&!((A&65534)==4126&&(B&65534)==4126))throw new Error("Expected type "+A+" saw "+B);switch(A===VT_VARIANT?B:A){case 2:return W=g.read_shift(2,"i"),q.raw||(g.l+=2),W;case 3:return W=g.read_shift(4,"i"),W;case 11:return g.read_shift(4)!==0;case 19:return W=g.read_shift(4),W;case 30:return parse_lpstr(g,B,4).replace(chr0,"");case 31:return parse_lpwstr(g);case 64:return parse_FILETIME(g);case 65:return parse_BLOB(g);case 71:return parse_ClipboardData(g);case 80:return parse_VtString(g,B,!q.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(g,B).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(g);case 4126:case 4127:return B==4127?parse_VtVecLpwstrValue(g):parse_VtVecUnalignedLpstrValue(g);default:throw new Error("TypedPropertyValue unrecognized type "+A+" "+B)}}function write_TypedPropertyValue(g,A){var L=new_buf(4),B=new_buf(4);switch(L.write_shift(4,g==80?31:g),g){case 3:B.write_shift(-4,A);break;case 5:B=new_buf(8),B.write_shift(8,A,"f");break;case 11:B.write_shift(4,A?1:0);break;case 64:B=write_FILETIME(A);break;case 31:case 80:for(B=new_buf(4+2*(A.length+1)+(A.length%2?0:2)),B.write_shift(4,A.length+1),B.write_shift(0,A,"dbcs");B.l!=B.length;)B.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+g+" "+A)}return bconcat([L,B])}function parse_PropertySet(g,A){var L=g.l,B=g.read_shift(4),W=g.read_shift(4),q=[],J=0,re=0,ae=-1,se={};for(J=0;J!=W;++J){var ie=g.read_shift(4),le=g.read_shift(4);q[J]=[ie,le+L]}q.sort(function(ke,xe){return ke[1]-xe[1]});var pe={};for(J=0;J!=W;++J){if(g.l!==q[J][1]){var he=!0;if(J>0&&A)switch(A[q[J-1][0]].t){case 2:g.l+2===q[J][1]&&(g.l+=2,he=!1);break;case 80:g.l<=q[J][1]&&(g.l=q[J][1],he=!1);break;case 4108:g.l<=q[J][1]&&(g.l=q[J][1],he=!1);break}if((!A||J==0)&&g.l<=q[J][1]&&(he=!1,g.l=q[J][1]),he)throw new Error("Read Error: Expected address "+q[J][1]+" at "+g.l+" :"+J)}if(A){var ue=A[q[J][0]];if(pe[ue.n]=parse_TypedPropertyValue(g,ue.t,{raw:!0}),ue.p==="version"&&(pe[ue.n]=String(pe[ue.n]>>16)+"."+("0000"+String(pe[ue.n]&65535)).slice(-4)),ue.n=="CodePage")switch(pe[ue.n]){case 0:pe[ue.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(re=pe[ue.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+pe[ue.n])}}else if(q[J][0]===1){if(re=pe.CodePage=parse_TypedPropertyValue(g,VT_I2),set_cp(re),ae!==-1){var ce=g.l;g.l=q[ae][1],se=parse_dictionary(g,re),g.l=ce}}else if(q[J][0]===0){if(re===0){ae=J,g.l=q[J+1][1];continue}se=parse_dictionary(g,re)}else{var fe=se[q[J][0]],me;switch(g[g.l]){case 65:g.l+=4,me=parse_BLOB(g);break;case 30:g.l+=4,me=parse_VtString(g,g[g.l-4]).replace(/\u0000+$/,"");break;case 31:g.l+=4,me=parse_VtString(g,g[g.l-4]).replace(/\u0000+$/,"");break;case 3:g.l+=4,me=g.read_shift(4,"i");break;case 19:g.l+=4,me=g.read_shift(4);break;case 5:g.l+=4,me=g.read_shift(8,"f");break;case 11:g.l+=4,me=parsebool(g,4);break;case 64:g.l+=4,me=parseDate(parse_FILETIME(g));break;default:throw new Error("unparsed value: "+g[g.l])}pe[fe]=me}}return g.l=L+B,pe}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(g){switch(typeof g){case"boolean":return 11;case"number":return(g|0)==g?3:5;case"string":return 31;case"object":if(g instanceof Date)return 64;break}return-1}function write_PropertySet(g,A,L){var B=new_buf(8),W=[],q=[],J=8,re=0,ae=new_buf(8),se=new_buf(8);if(ae.write_shift(4,2),ae.write_shift(4,1200),se.write_shift(4,1),q.push(ae),W.push(se),J+=8+ae.length,!A){se=new_buf(8),se.write_shift(4,0),W.unshift(se);var ie=[new_buf(4)];for(ie[0].write_shift(4,g.length),re=0;re<g.length;++re){var le=g[re][0];for(ae=new_buf(8+2*(le.length+1)+(le.length%2?0:2)),ae.write_shift(4,re+2),ae.write_shift(4,le.length+1),ae.write_shift(0,le,"dbcs");ae.l!=ae.length;)ae.write_shift(1,0);ie.push(ae)}ae=bconcat(ie),q.unshift(ae),J+=8+ae.length}for(re=0;re<g.length;++re)if(!(A&&!A[g[re][0]])&&!(XLSPSSkip.indexOf(g[re][0])>-1||PseudoPropsPairs.indexOf(g[re][0])>-1)&&g[re][1]!=null){var pe=g[re][1],he=0;if(A){he=+A[g[re][0]];var ue=L[he];if(ue.p=="version"&&typeof pe=="string"){var ce=pe.split(".");pe=(+ce[0]<<16)+(+ce[1]||0)}ae=write_TypedPropertyValue(ue.t,pe)}else{var fe=guess_property_type(pe);fe==-1&&(fe=31,pe=String(pe)),ae=write_TypedPropertyValue(fe,pe)}q.push(ae),se=new_buf(8),se.write_shift(4,A?he:2+re),W.push(se),J+=8+ae.length}var me=8*(q.length+1);for(re=0;re<q.length;++re)W[re].write_shift(4,me),me+=q[re].length;return B.write_shift(4,J),B.write_shift(4,q.length),bconcat([B].concat(W).concat(q))}function parse_PropertySetStream(g,A,L){var B=g.content;if(!B)return{};prep_blob(B,0);var W,q,J,re,ae=0;B.chk("feff","Byte Order: "),B.read_shift(2);var se=B.read_shift(4),ie=B.read_shift(16);if(ie!==CFB.utils.consts.HEADER_CLSID&&ie!==L)throw new Error("Bad PropertySet CLSID "+ie);if(W=B.read_shift(4),W!==1&&W!==2)throw new Error("Unrecognized #Sets: "+W);if(q=B.read_shift(16),re=B.read_shift(4),W===1&&re!==B.l)throw new Error("Length mismatch: "+re+" !== "+B.l);W===2&&(J=B.read_shift(16),ae=B.read_shift(4));var le=parse_PropertySet(B,A),pe={SystemIdentifier:se};for(var he in le)pe[he]=le[he];if(pe.FMTID=q,W===1)return pe;if(ae-B.l==2&&(B.l+=2),B.l!==ae)throw new Error("Length mismatch 2: "+B.l+" !== "+ae);var ue;try{ue=parse_PropertySet(B,null)}catch{}for(he in ue)pe[he]=ue[he];return pe.FMTID=[q,J],pe}function write_PropertySetStream(g,A,L,B,W,q){var J=new_buf(W?68:48),re=[J];J.write_shift(2,65534),J.write_shift(2,0),J.write_shift(4,842412599),J.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),J.write_shift(4,W?2:1),J.write_shift(16,A,"hex"),J.write_shift(4,W?68:48);var ae=write_PropertySet(g,L,B);if(re.push(ae),W){var se=write_PropertySet(W,null,null);J.write_shift(16,q,"hex"),J.write_shift(4,68+ae.length),re.push(se)}return bconcat(re)}function parsenoop2(g,A){return g.read_shift(A),null}function writezeroes(g,A){A||(A=new_buf(g));for(var L=0;L<g;++L)A.write_shift(1,0);return A}function parslurp(g,A,L){for(var B=[],W=g.l+A;g.l<W;)B.push(L(g,W-g.l));if(W!==g.l)throw new Error("Slurp error");return B}function parsebool(g,A){return g.read_shift(A)===1}function writebool(g,A){return A||(A=new_buf(2)),A.write_shift(2,+!!g),A}function parseuint16(g){return g.read_shift(2,"u")}function writeuint16(g,A){return A||(A=new_buf(2)),A.write_shift(2,g),A}function parseuint16a(g,A){return parslurp(g,A,parseuint16)}function parse_Bes(g){var A=g.read_shift(1),L=g.read_shift(1);return L===1?A:A===1}function write_Bes(g,A,L){return L||(L=new_buf(2)),L.write_shift(1,A=="e"?+g:+!!g),L.write_shift(1,A=="e"?1:0),L}function parse_ShortXLUnicodeString(g,A,L){var B=g.read_shift(L&&L.biff>=12?2:1),W="sbcs-cont";if(L&&L.biff>=8,!L||L.biff==8){var q=g.read_shift(1);q&&(W="dbcs-cont")}else L.biff==12&&(W="wstr");L.biff>=2&&L.biff<=5&&(W="cpstr");var J=B?g.read_shift(B,W):"";return J}function parse_XLUnicodeRichExtendedString(g){var A=g.read_shift(2),L=g.read_shift(1),B=L&4,W=L&8,q=1+(L&1),J=0,re,ae={};W&&(J=g.read_shift(2)),B&&(re=g.read_shift(4));var se=q==2?"dbcs-cont":"sbcs-cont",ie=A===0?"":g.read_shift(A,se);return W&&(g.l+=4*J),B&&(g.l+=re),ae.t=ie,W||(ae.raw="<t>"+ae.t+"</t>",ae.r=ae.t),ae}function write_XLUnicodeRichExtendedString(g){var A=g.t||"",L=new_buf(3);L.write_shift(2,A.length),L.write_shift(1,1);var B=new_buf(2*A.length);B.write_shift(2*A.length,A,"utf16le");var W=[L,B];return bconcat(W)}function parse_XLUnicodeStringNoCch(g,A,L){var B;if(L){if(L.biff>=2&&L.biff<=5)return g.read_shift(A,"cpstr");if(L.biff>=12)return g.read_shift(A,"dbcs-cont")}var W=g.read_shift(1);return W===0?B=g.read_shift(A,"sbcs-cont"):B=g.read_shift(A,"dbcs-cont"),B}function parse_XLUnicodeString(g,A,L){var B=g.read_shift(L&&L.biff==2?1:2);return B===0?(g.l++,""):parse_XLUnicodeStringNoCch(g,B,L)}function parse_XLUnicodeString2(g,A,L){if(L.biff>5)return parse_XLUnicodeString(g,A,L);var B=g.read_shift(1);return B===0?(g.l++,""):g.read_shift(B,L.biff<=4||!g.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(g,A,L){return L||(L=new_buf(3+2*g.length)),L.write_shift(2,g.length),L.write_shift(1,1),L.write_shift(31,g,"utf16le"),L}function parse_ControlInfo(g){var A=g.read_shift(1);g.l++;var L=g.read_shift(2);return g.l+=2,[A,L]}function parse_URLMoniker(g){var A=g.read_shift(4),L=g.l,B=!1;A>24&&(g.l+=A-24,g.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(B=!0),g.l=L);var W=g.read_shift((B?A-24:A)>>1,"utf16le").replace(chr0,"");return B&&(g.l+=24),W}function parse_FileMoniker(g){for(var A=g.read_shift(2),L="";A-- >0;)L+="../";var B=g.read_shift(0,"lpstr-ansi");if(g.l+=2,g.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var W=g.read_shift(4);if(W===0)return L+B.replace(/\\/g,"/");var q=g.read_shift(4);if(g.read_shift(2)!=3)throw new Error("Bad FileMoniker");var J=g.read_shift(q>>1,"utf16le").replace(chr0,"");return L+J}function parse_HyperlinkMoniker(g,A){var L=g.read_shift(16);switch(L){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(g);case"0303000000000000c000000000000046":return parse_FileMoniker(g);default:throw new Error("Unsupported Moniker "+L)}}function parse_HyperlinkString(g){var A=g.read_shift(4),L=A>0?g.read_shift(A,"utf16le").replace(chr0,""):"";return L}function write_HyperlinkString(g,A){A||(A=new_buf(6+g.length*2)),A.write_shift(4,1+g.length);for(var L=0;L<g.length;++L)A.write_shift(2,g.charCodeAt(L));return A.write_shift(2,0),A}function parse_Hyperlink(g,A){var L=g.l+A,B=g.read_shift(4);if(B!==2)throw new Error("Unrecognized streamVersion: "+B);var W=g.read_shift(2);g.l+=2;var q,J,re,ae,se="",ie,le;W&16&&(q=parse_HyperlinkString(g,L-g.l)),W&128&&(J=parse_HyperlinkString(g,L-g.l)),(W&257)===257&&(re=parse_HyperlinkString(g,L-g.l)),(W&257)===1&&(ae=parse_HyperlinkMoniker(g,L-g.l)),W&8&&(se=parse_HyperlinkString(g,L-g.l)),W&32&&(ie=g.read_shift(16)),W&64&&(le=parse_FILETIME(g)),g.l=L;var pe=J||re||ae||"";pe&&se&&(pe+="#"+se),pe||(pe="#"+se),W&2&&pe.charAt(0)=="/"&&pe.charAt(1)!="/"&&(pe="file://"+pe);var he={Target:pe};return ie&&(he.guid=ie),le&&(he.time=le),q&&(he.Tooltip=q),he}function write_Hyperlink(g){var A=new_buf(512),L=0,B=g.Target;B.slice(0,7)=="file://"&&(B=B.slice(7));var W=B.indexOf("#"),q=W>-1?31:23;switch(B.charAt(0)){case"#":q=28;break;case".":q&=-3;break}A.write_shift(4,2),A.write_shift(4,q);var J=[8,6815827,6619237,4849780,83];for(L=0;L<J.length;++L)A.write_shift(4,J[L]);if(q==28)B=B.slice(1),write_HyperlinkString(B,A);else if(q&2){for(J="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),L=0;L<J.length;++L)A.write_shift(1,parseInt(J[L],16));var re=W>-1?B.slice(0,W):B;for(A.write_shift(4,2*(re.length+1)),L=0;L<re.length;++L)A.write_shift(2,re.charCodeAt(L));A.write_shift(2,0),q&8&&write_HyperlinkString(W>-1?B.slice(W+1):"",A)}else{for(J="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),L=0;L<J.length;++L)A.write_shift(1,parseInt(J[L],16));for(var ae=0;B.slice(ae*3,ae*3+3)=="../"||B.slice(ae*3,ae*3+3)=="..\\";)++ae;for(A.write_shift(2,ae),A.write_shift(4,B.length-3*ae+1),L=0;L<B.length-3*ae;++L)A.write_shift(1,B.charCodeAt(L+3*ae)&255);for(A.write_shift(1,0),A.write_shift(2,65535),A.write_shift(2,57005),L=0;L<6;++L)A.write_shift(4,0)}return A.slice(0,A.l)}function parse_LongRGBA(g){var A=g.read_shift(1),L=g.read_shift(1),B=g.read_shift(1),W=g.read_shift(1);return[A,L,B,W]}function parse_LongRGB(g,A){var L=parse_LongRGBA(g);return L[3]=0,L}function parse_XLSCell(g){var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(2);return{r:A,c:L,ixfe:B}}function write_XLSCell(g,A,L,B){return B||(B=new_buf(6)),B.write_shift(2,g),B.write_shift(2,A),B.write_shift(2,L||0),B}function parse_frtHeader(g){var A=g.read_shift(2),L=g.read_shift(2);return g.l+=8,{type:A,flags:L}}function parse_OptXLUnicodeString(g,A,L){return A===0?"":parse_XLUnicodeString2(g,A,L)}function parse_XTI(g,A,L){var B=L.biff>8?4:2,W=g.read_shift(B),q=g.read_shift(B,"i"),J=g.read_shift(B,"i");return[W,q,J]}function parse_RkRec(g){var A=g.read_shift(2),L=parse_RkNumber(g);return[A,L]}function parse_AddinUdf(g,A,L){g.l+=4,A-=4;var B=g.l+A,W=parse_ShortXLUnicodeString(g,A,L),q=g.read_shift(2);if(B-=g.l,q!==B)throw new Error("Malformed AddinUdf: padding = "+B+" != "+q);return g.l+=q,W}function parse_Ref8U(g){var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(2),W=g.read_shift(2);return{s:{c:B,r:A},e:{c:W,r:L}}}function write_Ref8U(g,A){return A||(A=new_buf(8)),A.write_shift(2,g.s.r),A.write_shift(2,g.e.r),A.write_shift(2,g.s.c),A.write_shift(2,g.e.c),A}function parse_RefU(g){var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(1),W=g.read_shift(1);return{s:{c:B,r:A},e:{c:W,r:L}}}var parse_Ref=parse_RefU;function parse_FtCmo(g){g.l+=4;var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(2);return g.l+=12,[L,A,B]}function parse_FtNts(g){var A={};return g.l+=4,g.l+=16,A.fSharedNote=g.read_shift(2),g.l+=4,A}function parse_FtCf(g){var A={};return g.l+=4,g.cf=g.read_shift(2),A}function parse_FtSkip(g){g.l+=2,g.l+=g.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(g,A){for(var L=g.l+A,B=[];g.l<L;){var W=g.read_shift(2);g.l-=2;try{B.push(FtTab[W](g,L-g.l))}catch{return g.l=L,B}}return g.l!=L&&(g.l=L),B}function parse_BOF(g,A){var L={BIFFVer:0,dt:0};switch(L.BIFFVer=g.read_shift(2),A-=2,A>=2&&(L.dt=g.read_shift(2),g.l-=2),L.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(A>6)throw new Error("Unexpected BIFF Ver "+L.BIFFVer)}return g.read_shift(A),L}function write_BOF(g,A,L){var B=1536,W=16;switch(L.bookType){case"biff8":break;case"biff5":B=1280,W=8;break;case"biff4":B=4,W=6;break;case"biff3":B=3,W=6;break;case"biff2":B=2,W=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var q=new_buf(W);return q.write_shift(2,B),q.write_shift(2,A),W>4&&q.write_shift(2,29282),W>6&&q.write_shift(2,1997),W>8&&(q.write_shift(2,49161),q.write_shift(2,1),q.write_shift(2,1798),q.write_shift(2,0)),q}function parse_InterfaceHdr(g,A){return A===0||g.read_shift(2),1200}function parse_WriteAccess(g,A,L){if(L.enc)return g.l+=A,"";var B=g.l,W=parse_XLUnicodeString2(g,0,L);return g.read_shift(A+B-g.l),W}function write_WriteAccess(g,A){var L=!A||A.biff==8,B=new_buf(L?112:54);for(B.write_shift(A.biff==8?2:1,7),L&&B.write_shift(1,0),B.write_shift(4,859007059),B.write_shift(4,5458548|(L?0:536870912));B.l<B.length;)B.write_shift(1,L?0:32);return B}function parse_WsBool(g,A,L){var B=L&&L.biff==8||A==2?g.read_shift(2):(g.l+=A,0);return{fDialog:B&16,fBelow:B&64,fRight:B&128}}function parse_BoundSheet8(g,A,L){var B=g.read_shift(4),W=g.read_shift(1)&3,q=g.read_shift(1);switch(q){case 0:q="Worksheet";break;case 1:q="Macrosheet";break;case 2:q="Chartsheet";break;case 6:q="VBAModule";break}var J=parse_ShortXLUnicodeString(g,0,L);return J.length===0&&(J="Sheet1"),{pos:B,hs:W,dt:q,name:J}}function write_BoundSheet8(g,A){var L=!A||A.biff>=8?2:1,B=new_buf(8+L*g.name.length);B.write_shift(4,g.pos),B.write_shift(1,g.hs||0),B.write_shift(1,g.dt),B.write_shift(1,g.name.length),A.biff>=8&&B.write_shift(1,1),B.write_shift(L*g.name.length,g.name,A.biff<8?"sbcs":"utf16le");var W=B.slice(0,B.l);return W.l=B.l,W}function parse_SST(g,A){for(var L=g.l+A,B=g.read_shift(4),W=g.read_shift(4),q=[],J=0;J!=W&&g.l<L;++J)q.push(parse_XLUnicodeRichExtendedString(g));return q.Count=B,q.Unique=W,q}function write_SST(g,A){var L=new_buf(8);L.write_shift(4,g.Count),L.write_shift(4,g.Unique);for(var B=[],W=0;W<g.length;++W)B[W]=write_XLUnicodeRichExtendedString(g[W]);var q=bconcat([L].concat(B));return q.parts=[L.length].concat(B.map(function(J){return J.length})),q}function parse_ExtSST(g,A){var L={};return L.dsst=g.read_shift(2),g.l+=A-2,L}function parse_Row(g){var A={};A.r=g.read_shift(2),A.c=g.read_shift(2),A.cnt=g.read_shift(2)-A.c;var L=g.read_shift(2);g.l+=4;var B=g.read_shift(1);return g.l+=3,B&7&&(A.level=B&7),B&32&&(A.hidden=!0),B&64&&(A.hpt=L/20),A}function parse_ForceFullCalculation(g){var A=parse_frtHeader(g);if(A.type!=2211)throw new Error("Invalid Future Record "+A.type);var L=g.read_shift(4);return L!==0}function parse_RecalcId(g){return g.read_shift(2),g.read_shift(4)}function parse_DefaultRowHeight(g,A,L){var B=0;L&&L.biff==2||(B=g.read_shift(2));var W=g.read_shift(2);L&&L.biff==2&&(B=1-(W>>15),W&=32767);var q={Unsynced:B&1,DyZero:(B&2)>>1,ExAsc:(B&4)>>2,ExDsc:(B&8)>>3};return[q,W]}function parse_Window1(g){var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(2),W=g.read_shift(2),q=g.read_shift(2),J=g.read_shift(2),re=g.read_shift(2),ae=g.read_shift(2),se=g.read_shift(2);return{Pos:[A,L],Dim:[B,W],Flags:q,CurTab:J,FirstTab:re,Selected:ae,TabRatio:se}}function write_Window1(){var g=new_buf(18);return g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,29280),g.write_shift(2,17600),g.write_shift(2,56),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,1),g.write_shift(2,500),g}function parse_Window2(g,A,L){if(L&&L.biff>=2&&L.biff<5)return{};var B=g.read_shift(2);return{RTL:B&64}}function write_Window2(g){var A=new_buf(18),L=1718;return g&&g.RTL&&(L|=64),A.write_shift(2,L),A.write_shift(4,0),A.write_shift(4,64),A.write_shift(4,0),A.write_shift(4,0),A}function parse_Pane(){}function parse_Font(g,A,L){var B={dyHeight:g.read_shift(2),fl:g.read_shift(2)};switch(L&&L.biff||8){case 2:break;case 3:case 4:g.l+=2;break;default:g.l+=10;break}return B.name=parse_ShortXLUnicodeString(g,0,L),B}function write_Font(g,A){var L=g.name||"Arial",B=A&&A.biff==5,W=B?15+L.length:16+2*L.length,q=new_buf(W);return q.write_shift(2,g.sz*20),q.write_shift(4,0),q.write_shift(2,400),q.write_shift(4,0),q.write_shift(2,0),q.write_shift(1,L.length),B||q.write_shift(1,1),q.write_shift((B?1:2)*L.length,L,B?"sbcs":"utf16le"),q}function parse_LabelSst(g){var A=parse_XLSCell(g);return A.isst=g.read_shift(4),A}function write_LabelSst(g,A,L,B){var W=new_buf(10);return write_XLSCell(g,A,B,W),W.write_shift(4,L),W}function parse_Label(g,A,L){L.biffguess&&L.biff==2&&(L.biff=5);var B=g.l+A,W=parse_XLSCell(g);L.biff==2&&g.l++;var q=parse_XLUnicodeString(g,B-g.l,L);return W.val=q,W}function write_Label(g,A,L,B,W){var q=!W||W.biff==8,J=new_buf(8+ +q+(1+q)*L.length);return write_XLSCell(g,A,B,J),J.write_shift(2,L.length),q&&J.write_shift(1,1),J.write_shift((1+q)*L.length,L,q?"utf16le":"sbcs"),J}function parse_Format(g,A,L){var B=g.read_shift(2),W=parse_XLUnicodeString2(g,0,L);return[B,W]}function write_Format(g,A,L,B){var W=L&&L.biff==5;B||(B=new_buf(W?3+A.length:5+2*A.length)),B.write_shift(2,g),B.write_shift(W?1:2,A.length),W||B.write_shift(1,1),B.write_shift((W?1:2)*A.length,A,W?"sbcs":"utf16le");var q=B.length>B.l?B.slice(0,B.l):B;return q.l==null&&(q.l=q.length),q}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(g,A,L){var B=g.l+A,W=L.biff==8||!L.biff?4:2,q=g.read_shift(W),J=g.read_shift(W),re=g.read_shift(2),ae=g.read_shift(2);return g.l=B,{s:{r:q,c:re},e:{r:J,c:ae}}}function write_Dimensions(g,A){var L=A.biff==8||!A.biff?4:2,B=new_buf(2*L+6);return B.write_shift(L,g.s.r),B.write_shift(L,g.e.r+1),B.write_shift(2,g.s.c),B.write_shift(2,g.e.c+1),B.write_shift(2,0),B}function parse_RK(g){var A=g.read_shift(2),L=g.read_shift(2),B=parse_RkRec(g);return{r:A,c:L,ixfe:B[0],rknum:B[1]}}function parse_MulRk(g,A){for(var L=g.l+A-2,B=g.read_shift(2),W=g.read_shift(2),q=[];g.l<L;)q.push(parse_RkRec(g));if(g.l!==L)throw new Error("MulRK read error");var J=g.read_shift(2);if(q.length!=J-W+1)throw new Error("MulRK length mismatch");return{r:B,c:W,C:J,rkrec:q}}function parse_MulBlank(g,A){for(var L=g.l+A-2,B=g.read_shift(2),W=g.read_shift(2),q=[];g.l<L;)q.push(g.read_shift(2));if(g.l!==L)throw new Error("MulBlank read error");var J=g.read_shift(2);if(q.length!=J-W+1)throw new Error("MulBlank length mismatch");return{r:B,c:W,C:J,ixfe:q}}function parse_CellStyleXF(g,A,L,B){var W={},q=g.read_shift(4),J=g.read_shift(4),re=g.read_shift(4),ae=g.read_shift(2);return W.patternType=XLSFillPattern[re>>26],B.cellStyles&&(W.alc=q&7,W.fWrap=q>>3&1,W.alcV=q>>4&7,W.fJustLast=q>>7&1,W.trot=q>>8&255,W.cIndent=q>>16&15,W.fShrinkToFit=q>>20&1,W.iReadOrder=q>>22&2,W.fAtrNum=q>>26&1,W.fAtrFnt=q>>27&1,W.fAtrAlc=q>>28&1,W.fAtrBdr=q>>29&1,W.fAtrPat=q>>30&1,W.fAtrProt=q>>31&1,W.dgLeft=J&15,W.dgRight=J>>4&15,W.dgTop=J>>8&15,W.dgBottom=J>>12&15,W.icvLeft=J>>16&127,W.icvRight=J>>23&127,W.grbitDiag=J>>30&3,W.icvTop=re&127,W.icvBottom=re>>7&127,W.icvDiag=re>>14&127,W.dgDiag=re>>21&15,W.icvFore=ae&127,W.icvBack=ae>>7&127,W.fsxButton=ae>>14&1),W}function parse_XF(g,A,L){var B={};return B.ifnt=g.read_shift(2),B.numFmtId=g.read_shift(2),B.flags=g.read_shift(2),B.fStyle=B.flags>>2&1,A-=6,B.data=parse_CellStyleXF(g,A,B.fStyle,L),B}function write_XF(g,A,L,B){var W=L&&L.biff==5;B||(B=new_buf(W?16:20)),B.write_shift(2,0),g.style?(B.write_shift(2,g.numFmtId||0),B.write_shift(2,65524)):(B.write_shift(2,g.numFmtId||0),B.write_shift(2,A<<4));var q=0;return g.numFmtId>0&&W&&(q|=1024),B.write_shift(4,q),B.write_shift(4,0),W||B.write_shift(4,0),B.write_shift(2,0),B}function parse_Guts(g){g.l+=4;var A=[g.read_shift(2),g.read_shift(2)];if(A[0]!==0&&A[0]--,A[1]!==0&&A[1]--,A[0]>7||A[1]>7)throw new Error("Bad Gutters: "+A.join("|"));return A}function write_Guts(g){var A=new_buf(8);return A.write_shift(4,0),A.write_shift(2,0),A.write_shift(2,0),A}function parse_BoolErr(g,A,L){var B=parse_XLSCell(g);(L.biff==2||A==9)&&++g.l;var W=parse_Bes(g);return B.val=W,B.t=W===!0||W===!1?"b":"e",B}function write_BoolErr(g,A,L,B,W,q){var J=new_buf(8);return write_XLSCell(g,A,B,J),write_Bes(L,q,J),J}function parse_Number(g,A,L){L.biffguess&&L.biff==2&&(L.biff=5);var B=parse_XLSCell(g),W=parse_Xnum(g);return B.val=W,B}function write_Number(g,A,L,B){var W=new_buf(14);return write_XLSCell(g,A,B,W),write_Xnum(L,W),W}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(g,A,L){var B=g.l+A,W=g.read_shift(2),q=g.read_shift(2);if(L.sbcch=q,q==1025||q==14849)return[q,W];if(q<1||q>255)throw new Error("Unexpected SupBook type: "+q);for(var J=parse_XLUnicodeStringNoCch(g,q),re=[];B>g.l;)re.push(parse_XLUnicodeString(g));return[q,W,J,re]}function parse_ExternName(g,A,L){var B=g.read_shift(2),W,q={fBuiltIn:B&1,fWantAdvise:B>>>1&1,fWantPict:B>>>2&1,fOle:B>>>3&1,fOleLink:B>>>4&1,cf:B>>>5&1023,fIcon:B>>>15&1};return L.sbcch===14849&&(W=parse_AddinUdf(g,A-2,L)),q.body=W||g.read_shift(A-2),typeof W=="string"&&(q.Name=W),q}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(g,A,L){var B=g.l+A,W=g.read_shift(2),q=g.read_shift(1),J=g.read_shift(1),re=g.read_shift(L&&L.biff==2?1:2),ae=0;(!L||L.biff>=5)&&(L.biff!=5&&(g.l+=2),ae=g.read_shift(2),L.biff==5&&(g.l+=2),g.l+=4);var se=parse_XLUnicodeStringNoCch(g,J,L);W&32&&(se=XLSLblBuiltIn[se.charCodeAt(0)]);var ie=B-g.l;L&&L.biff==2&&--ie;var le=B==g.l||re===0||!(ie>0)?[]:parse_NameParsedFormula(g,ie,L,re);return{chKey:q,Name:se,itab:ae,rgce:le}}function parse_ExternSheet(g,A,L){if(L.biff<8)return parse_BIFF5ExternSheet(g,A,L);for(var B=[],W=g.l+A,q=g.read_shift(L.biff>8?4:2);q--!==0;)B.push(parse_XTI(g,L.biff>8?12:6,L));if(g.l!=W)throw new Error("Bad ExternSheet: "+g.l+" != "+W);return B}function parse_BIFF5ExternSheet(g,A,L){g[g.l+1]==3&&g[g.l]++;var B=parse_ShortXLUnicodeString(g,A,L);return B.charCodeAt(0)==3?B.slice(1):B}function parse_NameCmt(g,A,L){if(L.biff<8){g.l+=A;return}var B=g.read_shift(2),W=g.read_shift(2),q=parse_XLUnicodeStringNoCch(g,B,L),J=parse_XLUnicodeStringNoCch(g,W,L);return[q,J]}function parse_ShrFmla(g,A,L){var B=parse_RefU(g);g.l++;var W=g.read_shift(1);return A-=8,[parse_SharedParsedFormula(g,A,L),W,B]}function parse_Array(g,A,L){var B=parse_Ref(g);switch(L.biff){case 2:g.l++,A-=7;break;case 3:case 4:g.l+=2,A-=8;break;default:g.l+=6,A-=12}return[B,parse_ArrayParsedFormula(g,A,L)]}function parse_MTRSettings(g){var A=g.read_shift(4)!==0,L=g.read_shift(4)!==0,B=g.read_shift(4);return[A,L,B]}function parse_NoteSh(g,A,L){if(!(L.biff<8)){var B=g.read_shift(2),W=g.read_shift(2),q=g.read_shift(2),J=g.read_shift(2),re=parse_XLUnicodeString2(g,0,L);return L.biff<8&&g.read_shift(1),[{r:B,c:W},re,J,q]}}function parse_Note(g,A,L){return parse_NoteSh(g,A,L)}function parse_MergeCells(g,A){for(var L=[],B=g.read_shift(2);B--;)L.push(parse_Ref8U(g));return L}function write_MergeCells(g){var A=new_buf(2+g.length*8);A.write_shift(2,g.length);for(var L=0;L<g.length;++L)write_Ref8U(g[L],A);return A}function parse_Obj(g,A,L){if(L&&L.biff<8)return parse_BIFF5Obj(g,A,L);var B=parse_FtCmo(g),W=parse_FtArray(g,A-22,B[1]);return{cmo:B,ft:W}}var parse_BIFF5OT={8:function(g,A){var L=g.l+A;g.l+=10;var B=g.read_shift(2);g.l+=4,g.l+=2,g.l+=2,g.l+=2,g.l+=4;var W=g.read_shift(1);return g.l+=W,g.l=L,{fmt:B}}};function parse_BIFF5Obj(g,A,L){g.l+=4;var B=g.read_shift(2),W=g.read_shift(2),q=g.read_shift(2);g.l+=2,g.l+=2,g.l+=2,g.l+=2,g.l+=2,g.l+=2,g.l+=2,g.l+=2,g.l+=2,g.l+=6,A-=36;var J=[];return J.push((parse_BIFF5OT[B]||parsenoop)(g,A,L)),{cmo:[W,B,q],ft:J}}function parse_TxO(g,A,L){var B=g.l,W="";try{g.l+=4;var q=(L.lastobj||{cmo:[0,0]}).cmo[1],J;[0,5,7,11,12,14].indexOf(q)==-1?g.l+=6:J=parse_ControlInfo(g,6,L);var re=g.read_shift(2);g.read_shift(2),parseuint16(g,2);var ae=g.read_shift(2);g.l+=ae;for(var se=1;se<g.lens.length-1;++se){if(g.l-B!=g.lens[se])throw new Error("TxO: bad continue record");var ie=g[g.l],le=parse_XLUnicodeStringNoCch(g,g.lens[se+1]-g.lens[se]-1);if(W+=le,W.length>=(ie?re:2*re))break}if(W.length!==re&&W.length!==re*2)throw new Error("cchText: "+re+" != "+W.length);return g.l=B+A,{t:W}}catch{return g.l=B+A,{t:W}}}function parse_HLink(g,A){var L=parse_Ref8U(g);g.l+=16;var B=parse_Hyperlink(g,A-24);return[L,B]}function write_HLink(g){var A=new_buf(24),L=decode_cell(g[0]);A.write_shift(2,L.r),A.write_shift(2,L.r),A.write_shift(2,L.c),A.write_shift(2,L.c);for(var B="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),W=0;W<16;++W)A.write_shift(1,parseInt(B[W],16));return bconcat([A,write_Hyperlink(g[1])])}function parse_HLinkTooltip(g,A){g.read_shift(2);var L=parse_Ref8U(g),B=g.read_shift((A-10)/2,"dbcs-cont");return B=B.replace(chr0,""),[L,B]}function write_HLinkTooltip(g){var A=g[1].Tooltip,L=new_buf(10+2*(A.length+1));L.write_shift(2,2048);var B=decode_cell(g[0]);L.write_shift(2,B.r),L.write_shift(2,B.r),L.write_shift(2,B.c),L.write_shift(2,B.c);for(var W=0;W<A.length;++W)L.write_shift(2,A.charCodeAt(W));return L.write_shift(2,0),L}function parse_Country(g){var A=[0,0],L;return L=g.read_shift(2),A[0]=CountryEnum[L]||L,L=g.read_shift(2),A[1]=CountryEnum[L]||L,A}function write_Country(g){return g||(g=new_buf(4)),g.write_shift(2,1),g.write_shift(2,1),g}function parse_ClrtClient(g){for(var A=g.read_shift(2),L=[];A-- >0;)L.push(parse_LongRGB(g));return L}function parse_Palette(g){for(var A=g.read_shift(2),L=[];A-- >0;)L.push(parse_LongRGB(g));return L}function parse_XFCRC(g){g.l+=2;var A={cxfs:0,crc:0};return A.cxfs=g.read_shift(2),A.crc=g.read_shift(4),A}function parse_ColInfo(g,A,L){if(!L.cellStyles)return parsenoop(g,A);var B=L&&L.biff>=12?4:2,W=g.read_shift(B),q=g.read_shift(B),J=g.read_shift(B),re=g.read_shift(B),ae=g.read_shift(2);B==2&&(g.l+=2);var se={s:W,e:q,w:J,ixfe:re,flags:ae};return(L.biff>=5||!L.biff)&&(se.level=ae>>8&7),se}function write_ColInfo(g,A){var L=new_buf(12);L.write_shift(2,A),L.write_shift(2,A),L.write_shift(2,g.width*256),L.write_shift(2,0);var B=0;return g.hidden&&(B|=1),L.write_shift(1,B),B=g.level||0,L.write_shift(1,B),L.write_shift(2,0),L}function parse_Setup(g,A){var L={};return A<32||(g.l+=16,L.header=parse_Xnum(g),L.footer=parse_Xnum(g),g.l+=2),L}function parse_ShtProps(g,A,L){var B={area:!1};if(L.biff!=5)return g.l+=A,B;var W=g.read_shift(1);return g.l+=3,W&16&&(B.area=!0),B}function write_RRTabId(g){for(var A=new_buf(2*g),L=0;L<g;++L)A.write_shift(2,L+1);return A}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(g){var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(4),W={fmt:A,env:L,len:B,data:g.slice(g.l,g.l+B)};return g.l+=B,W}function parse_BIFF2STR(g,A,L){L.biffguess&&L.biff==5&&(L.biff=2);var B=parse_XLSCell(g);++g.l;var W=parse_XLUnicodeString2(g,A-7,L);return B.t="str",B.val=W,B}function parse_BIFF2NUM(g){var A=parse_XLSCell(g);++g.l;var L=parse_Xnum(g);return A.t="n",A.val=L,A}function write_BIFF2NUM(g,A,L){var B=new_buf(15);return write_BIFF2Cell(B,g,A),B.write_shift(8,L,"f"),B}function parse_BIFF2INT(g){var A=parse_XLSCell(g);++g.l;var L=g.read_shift(2);return A.t="n",A.val=L,A}function write_BIFF2INT(g,A,L){var B=new_buf(9);return write_BIFF2Cell(B,g,A),B.write_shift(2,L),B}function parse_BIFF2STRING(g){var A=g.read_shift(1);return A===0?(g.l++,""):g.read_shift(A,"sbcs-cont")}function parse_BIFF2FONTXTRA(g,A){g.l+=6,g.l+=2,g.l+=1,g.l+=3,g.l+=1,g.l+=A-13}function parse_RString(g,A,L){var B=g.l+A,W=parse_XLSCell(g),q=g.read_shift(2),J=parse_XLUnicodeStringNoCch(g,q,L);return g.l=B,W.t="str",W.val=J,W}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var g={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},A=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function L(re,ae){var se=[],ie=new_raw_buf(1);switch(ae.type){case"base64":ie=s2a(Base64_decode(re));break;case"binary":ie=s2a(re);break;case"buffer":case"array":ie=re;break}prep_blob(ie,0);var le=ie.read_shift(1),pe=!!(le&136),he=!1,ue=!1;switch(le){case 2:break;case 3:break;case 48:he=!0,pe=!0;break;case 49:he=!0,pe=!0;break;case 131:break;case 139:break;case 140:ue=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+le.toString(16))}var ce=0,fe=521;le==2&&(ce=ie.read_shift(2)),ie.l+=3,le!=2&&(ce=ie.read_shift(4)),ce>1048576&&(ce=1e6),le!=2&&(fe=ie.read_shift(2));var me=ie.read_shift(2),ke=ae.codepage||1252;le!=2&&(ie.l+=16,ie.read_shift(1),ie[ie.l]!==0&&(ke=g[ie[ie.l]]),ie.l+=1,ie.l+=2),ue&&(ie.l+=36);for(var xe=[],Le={},Se=Math.min(ie.length,le==2?521:fe-10-(he?264:0)),Te=ue?32:11;ie.l<Se&&ie[ie.l]!=13;)switch(Le={},Le.name=$cptable.utils.decode(ke,ie.slice(ie.l,ie.l+Te)).replace(/[\u0000\r\n].*$/g,""),ie.l+=Te,Le.type=String.fromCharCode(ie.read_shift(1)),le!=2&&!ue&&(Le.offset=ie.read_shift(4)),Le.len=ie.read_shift(1),le==2&&(Le.offset=ie.read_shift(2)),Le.dec=ie.read_shift(1),Le.name.length&&xe.push(Le),le!=2&&(ie.l+=ue?13:14),Le.type){case"B":(!he||Le.len!=8)&&ae.WTF&&console.log("Skipping "+Le.name+":"+Le.type);break;case"G":case"P":ae.WTF&&console.log("Skipping "+Le.name+":"+Le.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Le.type)}if(ie[ie.l]!==13&&(ie.l=fe-1),ie.read_shift(1)!==13)throw new Error("DBF Terminator not found "+ie.l+" "+ie[ie.l]);ie.l=fe;var ge=0,Ce=0;for(se[0]=[],Ce=0;Ce!=xe.length;++Ce)se[0][Ce]=xe[Ce].name;for(;ce-- >0;){if(ie[ie.l]===42){ie.l+=me;continue}for(++ie.l,se[++ge]=[],Ce=0,Ce=0;Ce!=xe.length;++Ce){var be=ie.slice(ie.l,ie.l+xe[Ce].len);ie.l+=xe[Ce].len,prep_blob(be,0);var nt=$cptable.utils.decode(ke,be);switch(xe[Ce].type){case"C":nt.trim().length&&(se[ge][Ce]=nt.replace(/\s+$/,""));break;case"D":nt.length===8?se[ge][Ce]=new Date(+nt.slice(0,4),+nt.slice(4,6)-1,+nt.slice(6,8)):se[ge][Ce]=nt;break;case"F":se[ge][Ce]=parseFloat(nt.trim());break;case"+":case"I":se[ge][Ce]=ue?be.read_shift(-4,"i")^2147483648:be.read_shift(4,"i");break;case"L":switch(nt.trim().toUpperCase()){case"Y":case"T":se[ge][Ce]=!0;break;case"N":case"F":se[ge][Ce]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+nt+"|")}break;case"M":if(!pe)throw new Error("DBF Unexpected MEMO for type "+le.toString(16));se[ge][Ce]="##MEMO##"+(ue?parseInt(nt.trim(),10):be.read_shift(4));break;case"N":nt=nt.replace(/\u0000/g,"").trim(),nt&&nt!="."&&(se[ge][Ce]=+nt||0);break;case"@":se[ge][Ce]=new Date(be.read_shift(-8,"f")-621356832e5);break;case"T":se[ge][Ce]=new Date((be.read_shift(4)-2440588)*864e5+be.read_shift(4));break;case"Y":se[ge][Ce]=be.read_shift(4,"i")/1e4+be.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":se[ge][Ce]=-be.read_shift(-8,"f");break;case"B":if(he&&xe[Ce].len==8){se[ge][Ce]=be.read_shift(8,"f");break}case"G":case"P":be.l+=xe[Ce].len;break;case"0":if(xe[Ce].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+xe[Ce].type)}}}if(le!=2&&ie.l<ie.length&&ie[ie.l++]!=26)throw new Error("DBF EOF Marker missing "+(ie.l-1)+" of "+ie.length+" "+ie[ie.l-1].toString(16));return ae&&ae.sheetRows&&(se=se.slice(0,ae.sheetRows)),ae.DBF=xe,se}function B(re,ae){var se=ae||{};se.dateNF||(se.dateNF="yyyymmdd");var ie=aoa_to_sheet(L(re,se),se);return ie["!cols"]=se.DBF.map(function(le){return{wch:le.len,DBF:le}}),delete se.DBF,ie}function W(re,ae){try{return sheet_to_workbook(B(re,ae),ae)}catch(se){if(ae&&ae.WTF)throw se}return{SheetNames:[],Sheets:{}}}var q={B:8,C:250,L:1,D:8,"?":0,"":0};function J(re,ae){var se=ae||{};if(+se.codepage>=0&&set_cp(+se.codepage),se.type=="string")throw new Error("Cannot write DBF to JS string");var ie=buf_array(),le=sheet_to_json(re,{header:1,raw:!0,cellDates:!0}),pe=le[0],he=le.slice(1),ue=re["!cols"]||[],ce=0,fe=0,me=0,ke=1;for(ce=0;ce<pe.length;++ce){if(((ue[ce]||{}).DBF||{}).name){pe[ce]=ue[ce].DBF.name,++me;continue}if(pe[ce]!=null){if(++me,typeof pe[ce]=="number"&&(pe[ce]=pe[ce].toString(10)),typeof pe[ce]!="string")throw new Error("DBF Invalid column name "+pe[ce]+" |"+typeof pe[ce]+"|");if(pe.indexOf(pe[ce])!==ce){for(fe=0;fe<1024;++fe)if(pe.indexOf(pe[ce]+"_"+fe)==-1){pe[ce]+="_"+fe;break}}}}var xe=safe_decode_range(re["!ref"]),Le=[],Se=[],Te=[];for(ce=0;ce<=xe.e.c-xe.s.c;++ce){var ge="",Ce="",be=0,nt=[];for(fe=0;fe<he.length;++fe)he[fe][ce]!=null&&nt.push(he[fe][ce]);if(nt.length==0||pe[ce]==null){Le[ce]="?";continue}for(fe=0;fe<nt.length;++fe){switch(typeof nt[fe]){case"number":Ce="B";break;case"string":Ce="C";break;case"boolean":Ce="L";break;case"object":Ce=nt[fe]instanceof Date?"D":"C";break;default:Ce="C"}be=Math.max(be,String(nt[fe]).length),ge=ge&&ge!=Ce?"C":Ce}be>250&&(be=250),Ce=((ue[ce]||{}).DBF||{}).type,Ce=="C"&&ue[ce].DBF.len>be&&(be=ue[ce].DBF.len),ge=="B"&&Ce=="N"&&(ge="N",Te[ce]=ue[ce].DBF.dec,be=ue[ce].DBF.len),Se[ce]=ge=="C"||Ce=="N"?be:q[ge]||0,ke+=Se[ce],Le[ce]=ge}var Ae=ie.next(32);for(Ae.write_shift(4,318902576),Ae.write_shift(4,he.length),Ae.write_shift(2,296+32*me),Ae.write_shift(2,ke),ce=0;ce<4;++ce)Ae.write_shift(4,0);for(Ae.write_shift(4,0|(+A[current_ansi]||3)<<8),ce=0,fe=0;ce<pe.length;++ce)if(pe[ce]!=null){var De=ie.next(32),lt=(pe[ce].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);De.write_shift(1,lt,"sbcs"),De.write_shift(1,Le[ce]=="?"?"C":Le[ce],"sbcs"),De.write_shift(4,fe),De.write_shift(1,Se[ce]||q[Le[ce]]||0),De.write_shift(1,Te[ce]||0),De.write_shift(1,2),De.write_shift(4,0),De.write_shift(1,0),De.write_shift(4,0),De.write_shift(4,0),fe+=Se[ce]||q[Le[ce]]||0}var Ct=ie.next(264);for(Ct.write_shift(4,13),ce=0;ce<65;++ce)Ct.write_shift(4,0);for(ce=0;ce<he.length;++ce){var ft=ie.next(ke);for(ft.write_shift(1,0),fe=0;fe<pe.length;++fe)if(pe[fe]!=null)switch(Le[fe]){case"L":ft.write_shift(1,he[ce][fe]==null?63:he[ce][fe]?84:70);break;case"B":ft.write_shift(8,he[ce][fe]||0,"f");break;case"N":var Et="0";for(typeof he[ce][fe]=="number"&&(Et=he[ce][fe].toFixed(Te[fe]||0)),me=0;me<Se[fe]-Et.length;++me)ft.write_shift(1,32);ft.write_shift(1,Et,"sbcs");break;case"D":he[ce][fe]?(ft.write_shift(4,("0000"+he[ce][fe].getFullYear()).slice(-4),"sbcs"),ft.write_shift(2,("00"+(he[ce][fe].getMonth()+1)).slice(-2),"sbcs"),ft.write_shift(2,("00"+he[ce][fe].getDate()).slice(-2),"sbcs")):ft.write_shift(8,"00000000","sbcs");break;case"C":var gt=String(he[ce][fe]!=null?he[ce][fe]:"").slice(0,Se[fe]);for(ft.write_shift(1,gt,"sbcs"),me=0;me<Se[fe]-gt.length;++me)ft.write_shift(1,32);break}}return ie.next(1).write_shift(1,26),ie.end()}return{to_workbook:W,to_sheet:B,from_sheet:J}}(),SYLK=function(){var g={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},A=new RegExp("\x1BN("+keys(g).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),L=function(pe,he){var ue=g[he];return typeof ue=="number"?_getansi(ue):ue},B=function(pe,he,ue){var ce=he.charCodeAt(0)-32<<4|ue.charCodeAt(0)-48;return ce==59?pe:_getansi(ce)};g["|"]=254;function W(pe,he){switch(he.type){case"base64":return q(Base64_decode(pe),he);case"binary":return q(pe,he);case"buffer":return q(has_buf&&Buffer.isBuffer(pe)?pe.toString("binary"):a2s(pe),he);case"array":return q(cc2str(pe),he)}throw new Error("Unrecognized type "+he.type)}function q(pe,he){var ue=pe.split(/[\n\r]+/),ce=-1,fe=-1,me=0,ke=0,xe=[],Le=[],Se=null,Te={},ge=[],Ce=[],be=[],nt=0,Ae;for(+he.codepage>=0&&set_cp(+he.codepage);me!==ue.length;++me){nt=0;var De=ue[me].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,B).replace(A,L),lt=De.replace(/;;/g,"\0").split(";").map(function(Pe){return Pe.replace(/\u0000/g,";")}),Ct=lt[0],ft;if(De.length>0)switch(Ct){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":lt[1].charAt(0)=="P"&&Le.push(De.slice(3).replace(/;;/g,";"));break;case"C":var Et=!1,gt=!1,bt=!1,Ie=!1,pt=-1,at=-1;for(ke=1;ke<lt.length;++ke)switch(lt[ke].charAt(0)){case"A":break;case"X":fe=parseInt(lt[ke].slice(1))-1,gt=!0;break;case"Y":for(ce=parseInt(lt[ke].slice(1))-1,gt||(fe=0),Ae=xe.length;Ae<=ce;++Ae)xe[Ae]=[];break;case"K":ft=lt[ke].slice(1),ft.charAt(0)==='"'?ft=ft.slice(1,ft.length-1):ft==="TRUE"?ft=!0:ft==="FALSE"?ft=!1:isNaN(fuzzynum(ft))?isNaN(fuzzydate(ft).getDate())||(ft=parseDate(ft)):(ft=fuzzynum(ft),Se!==null&&fmt_is_date(Se)&&(ft=numdate(ft))),Et=!0;break;case"E":Ie=!0;var Ee=rc_to_a1(lt[ke].slice(1),{r:ce,c:fe});xe[ce][fe]=[xe[ce][fe],Ee];break;case"S":bt=!0,xe[ce][fe]=[xe[ce][fe],"S5S"];break;case"G":break;case"R":pt=parseInt(lt[ke].slice(1))-1;break;case"C":at=parseInt(lt[ke].slice(1))-1;break;default:if(he&&he.WTF)throw new Error("SYLK bad record "+De)}if(Et&&(xe[ce][fe]&&xe[ce][fe].length==2?xe[ce][fe][0]=ft:xe[ce][fe]=ft,Se=null),bt){if(Ie)throw new Error("SYLK shared formula cannot have own formula");var ye=pt>-1&&xe[pt][at];if(!ye||!ye[1])throw new Error("SYLK shared formula cannot find base");xe[ce][fe][1]=shift_formula_str(ye[1],{r:ce-pt,c:fe-at})}break;case"F":var ve=0;for(ke=1;ke<lt.length;++ke)switch(lt[ke].charAt(0)){case"X":fe=parseInt(lt[ke].slice(1))-1,++ve;break;case"Y":for(ce=parseInt(lt[ke].slice(1))-1,Ae=xe.length;Ae<=ce;++Ae)xe[Ae]=[];break;case"M":nt=parseInt(lt[ke].slice(1))/20;break;case"F":break;case"G":break;case"P":Se=Le[parseInt(lt[ke].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(be=lt[ke].slice(1).split(" "),Ae=parseInt(be[0],10);Ae<=parseInt(be[1],10);++Ae)nt=parseInt(be[2],10),Ce[Ae-1]=nt===0?{hidden:!0}:{wch:nt},process_col(Ce[Ae-1]);break;case"C":fe=parseInt(lt[ke].slice(1))-1,Ce[fe]||(Ce[fe]={});break;case"R":ce=parseInt(lt[ke].slice(1))-1,ge[ce]||(ge[ce]={}),nt>0?(ge[ce].hpt=nt,ge[ce].hpx=pt2px(nt)):nt===0&&(ge[ce].hidden=!0);break;default:if(he&&he.WTF)throw new Error("SYLK bad record "+De)}ve<1&&(Se=null);break;default:if(he&&he.WTF)throw new Error("SYLK bad record "+De)}}return ge.length>0&&(Te["!rows"]=ge),Ce.length>0&&(Te["!cols"]=Ce),he&&he.sheetRows&&(xe=xe.slice(0,he.sheetRows)),[xe,Te]}function J(pe,he){var ue=W(pe,he),ce=ue[0],fe=ue[1],me=aoa_to_sheet(ce,he);return keys(fe).forEach(function(ke){me[ke]=fe[ke]}),me}function re(pe,he){return sheet_to_workbook(J(pe,he),he)}function ae(pe,he,ue,ce){var fe="C;Y"+(ue+1)+";X"+(ce+1)+";K";switch(pe.t){case"n":fe+=pe.v||0,pe.f&&!pe.F&&(fe+=";E"+a1_to_rc(pe.f,{r:ue,c:ce}));break;case"b":fe+=pe.v?"TRUE":"FALSE";break;case"e":fe+=pe.w||pe.v;break;case"d":fe+='"'+(pe.w||pe.v)+'"';break;case"s":fe+='"'+pe.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return fe}function se(pe,he){he.forEach(function(ue,ce){var fe="F;W"+(ce+1)+" "+(ce+1)+" ";ue.hidden?fe+="0":(typeof ue.width=="number"&&!ue.wpx&&(ue.wpx=width2px(ue.width)),typeof ue.wpx=="number"&&!ue.wch&&(ue.wch=px2char(ue.wpx)),typeof ue.wch=="number"&&(fe+=Math.round(ue.wch))),fe.charAt(fe.length-1)!=" "&&pe.push(fe)})}function ie(pe,he){he.forEach(function(ue,ce){var fe="F;";ue.hidden?fe+="M0;":ue.hpt?fe+="M"+20*ue.hpt+";":ue.hpx&&(fe+="M"+20*px2pt(ue.hpx)+";"),fe.length>2&&pe.push(fe+"R"+(ce+1))})}function le(pe,he){var ue=["ID;PWXL;N;E"],ce=[],fe=safe_decode_range(pe["!ref"]),me,ke=Array.isArray(pe),xe=`\r
`;ue.push("P;PGeneral"),ue.push("F;P0;DG0G8;M255"),pe["!cols"]&&se(ue,pe["!cols"]),pe["!rows"]&&ie(ue,pe["!rows"]),ue.push("B;Y"+(fe.e.r-fe.s.r+1)+";X"+(fe.e.c-fe.s.c+1)+";D"+[fe.s.c,fe.s.r,fe.e.c,fe.e.r].join(" "));for(var Le=fe.s.r;Le<=fe.e.r;++Le)for(var Se=fe.s.c;Se<=fe.e.c;++Se){var Te=encode_cell({r:Le,c:Se});me=ke?(pe[Le]||[])[Se]:pe[Te],!(!me||me.v==null&&(!me.f||me.F))&&ce.push(ae(me,pe,Le,Se))}return ue.join(xe)+xe+ce.join(xe)+xe+"E"+xe}return{to_workbook:re,to_sheet:J,from_sheet:le}}(),DIF=function(){function g(q,J){switch(J.type){case"base64":return A(Base64_decode(q),J);case"binary":return A(q,J);case"buffer":return A(has_buf&&Buffer.isBuffer(q)?q.toString("binary"):a2s(q),J);case"array":return A(cc2str(q),J)}throw new Error("Unrecognized type "+J.type)}function A(q,J){for(var re=q.split(`
`),ae=-1,se=-1,ie=0,le=[];ie!==re.length;++ie){if(re[ie].trim()==="BOT"){le[++ae]=[],se=0;continue}if(!(ae<0)){var pe=re[ie].trim().split(","),he=pe[0],ue=pe[1];++ie;for(var ce=re[ie]||"";(ce.match(/["]/g)||[]).length&1&&ie<re.length-1;)ce+=`
`+re[++ie];switch(ce=ce.trim(),+he){case-1:if(ce==="BOT"){le[++ae]=[],se=0;continue}else if(ce!=="EOD")throw new Error("Unrecognized DIF special command "+ce);break;case 0:ce==="TRUE"?le[ae][se]=!0:ce==="FALSE"?le[ae][se]=!1:isNaN(fuzzynum(ue))?isNaN(fuzzydate(ue).getDate())?le[ae][se]=ue:le[ae][se]=parseDate(ue):le[ae][se]=fuzzynum(ue),++se;break;case 1:ce=ce.slice(1,ce.length-1),ce=ce.replace(/""/g,'"'),ce&&ce.match(/^=".*"$/)&&(ce=ce.slice(2,-1)),le[ae][se++]=ce!==""?ce:null;break}if(ce==="EOD")break}}return J&&J.sheetRows&&(le=le.slice(0,J.sheetRows)),le}function L(q,J){return aoa_to_sheet(g(q,J),J)}function B(q,J){return sheet_to_workbook(L(q,J),J)}var W=function(){var q=function(ae,se,ie,le,pe){ae.push(se),ae.push(ie+","+le),ae.push('"'+pe.replace(/"/g,'""')+'"')},J=function(ae,se,ie,le){ae.push(se+","+ie),ae.push(se==1?'"'+le.replace(/"/g,'""')+'"':le)};return function(ae){var se=[],ie=safe_decode_range(ae["!ref"]),le,pe=Array.isArray(ae);q(se,"TABLE",0,1,"sheetjs"),q(se,"VECTORS",0,ie.e.r-ie.s.r+1,""),q(se,"TUPLES",0,ie.e.c-ie.s.c+1,""),q(se,"DATA",0,0,"");for(var he=ie.s.r;he<=ie.e.r;++he){J(se,-1,0,"BOT");for(var ue=ie.s.c;ue<=ie.e.c;++ue){var ce=encode_cell({r:he,c:ue});if(le=pe?(ae[he]||[])[ue]:ae[ce],!le){J(se,1,0,"");continue}switch(le.t){case"n":var fe=le.w;!fe&&le.v!=null&&(fe=le.v),fe==null?le.f&&!le.F?J(se,1,0,"="+le.f):J(se,1,0,""):J(se,0,fe,"V");break;case"b":J(se,0,le.v?1:0,le.v?"TRUE":"FALSE");break;case"s":J(se,1,0,isNaN(le.v)?le.v:'="'+le.v+'"');break;case"d":le.w||(le.w=SSF_format(le.z||table_fmt[14],datenum(parseDate(le.v)))),J(se,0,le.w,"V");break;default:J(se,1,0,"")}}}J(se,-1,0,"EOD");var me=`\r
`,ke=se.join(me);return ke}}();return{to_workbook:B,to_sheet:L,from_sheet:W}}(),ETH=function(){function g(le){return le.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function A(le){return le.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function L(le,pe){for(var he=le.split(`
`),ue=-1,ce=-1,fe=0,me=[];fe!==he.length;++fe){var ke=he[fe].trim().split(":");if(ke[0]==="cell"){var xe=decode_cell(ke[1]);if(me.length<=xe.r)for(ue=me.length;ue<=xe.r;++ue)me[ue]||(me[ue]=[]);switch(ue=xe.r,ce=xe.c,ke[2]){case"t":me[ue][ce]=g(ke[3]);break;case"v":me[ue][ce]=+ke[3];break;case"vtf":var Le=ke[ke.length-1];case"vtc":switch(ke[3]){case"nl":me[ue][ce]=!!+ke[4];break;default:me[ue][ce]=+ke[4];break}ke[2]=="vtf"&&(me[ue][ce]=[me[ue][ce],Le])}}}return pe&&pe.sheetRows&&(me=me.slice(0,pe.sheetRows)),me}function B(le,pe){return aoa_to_sheet(L(le,pe),pe)}function W(le,pe){return sheet_to_workbook(B(le,pe),pe)}var q=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),J=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,re=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),ae="--SocialCalcSpreadsheetControlSave--";function se(le){if(!le||!le["!ref"])return"";for(var pe=[],he=[],ue,ce="",fe=decode_range(le["!ref"]),me=Array.isArray(le),ke=fe.s.r;ke<=fe.e.r;++ke)for(var xe=fe.s.c;xe<=fe.e.c;++xe)if(ce=encode_cell({r:ke,c:xe}),ue=me?(le[ke]||[])[xe]:le[ce],!(!ue||ue.v==null||ue.t==="z")){switch(he=["cell",ce,"t"],ue.t){case"s":case"str":he.push(A(ue.v));break;case"n":ue.f?(he[2]="vtf",he[3]="n",he[4]=ue.v,he[5]=A(ue.f)):(he[2]="v",he[3]=ue.v);break;case"b":he[2]="vt"+(ue.f?"f":"c"),he[3]="nl",he[4]=ue.v?"1":"0",he[5]=A(ue.f||(ue.v?"TRUE":"FALSE"));break;case"d":var Le=datenum(parseDate(ue.v));he[2]="vtc",he[3]="nd",he[4]=""+Le,he[5]=ue.w||SSF_format(ue.z||table_fmt[14],Le);break;case"e":continue}pe.push(he.join(":"))}return pe.push("sheet:c:"+(fe.e.c-fe.s.c+1)+":r:"+(fe.e.r-fe.s.r+1)+":tvf:1"),pe.push("valueformat:1:text-wiki"),pe.join(`
`)}function ie(le){return[q,J,re,J,se(le),ae].join(`
`)}return{to_workbook:W,to_sheet:B,from_sheet:ie}}(),PRN=function(){function g(ie,le,pe,he,ue){ue.raw?le[pe][he]=ie:ie===""||(ie==="TRUE"?le[pe][he]=!0:ie==="FALSE"?le[pe][he]=!1:isNaN(fuzzynum(ie))?isNaN(fuzzydate(ie).getDate())?le[pe][he]=ie:le[pe][he]=parseDate(ie):le[pe][he]=fuzzynum(ie))}function A(ie,le){var pe=le||{},he=[];if(!ie||ie.length===0)return he;for(var ue=ie.split(/[\r\n]/),ce=ue.length-1;ce>=0&&ue[ce].length===0;)--ce;for(var fe=10,me=0,ke=0;ke<=ce;++ke)me=ue[ke].indexOf(" "),me==-1?me=ue[ke].length:me++,fe=Math.max(fe,me);for(ke=0;ke<=ce;++ke){he[ke]=[];var xe=0;for(g(ue[ke].slice(0,fe).trim(),he,ke,xe,pe),xe=1;xe<=(ue[ke].length-fe)/10+1;++xe)g(ue[ke].slice(fe+(xe-1)*10,fe+xe*10).trim(),he,ke,xe,pe)}return pe.sheetRows&&(he=he.slice(0,pe.sheetRows)),he}var L={44:",",9:"	",59:";",124:"|"},B={44:3,9:2,59:1,124:0};function W(ie){for(var le={},pe=!1,he=0,ue=0;he<ie.length;++he)(ue=ie.charCodeAt(he))==34?pe=!pe:!pe&&ue in L&&(le[ue]=(le[ue]||0)+1);ue=[];for(he in le)Object.prototype.hasOwnProperty.call(le,he)&&ue.push([le[he],he]);if(!ue.length){le=B;for(he in le)Object.prototype.hasOwnProperty.call(le,he)&&ue.push([le[he],he])}return ue.sort(function(ce,fe){return ce[0]-fe[0]||B[ce[1]]-B[fe[1]]}),L[ue.pop()[1]]||44}function q(ie,le){var pe=le||{},he="",ue=pe.dense?[]:{},ce={s:{c:0,r:0},e:{c:0,r:0}};ie.slice(0,4)=="sep="?ie.charCodeAt(5)==13&&ie.charCodeAt(6)==10?(he=ie.charAt(4),ie=ie.slice(7)):ie.charCodeAt(5)==13||ie.charCodeAt(5)==10?(he=ie.charAt(4),ie=ie.slice(6)):he=W(ie.slice(0,1024)):pe&&pe.FS?he=pe.FS:he=W(ie.slice(0,1024));var fe=0,me=0,ke=0,xe=0,Le=0,Se=he.charCodeAt(0),Te=!1,ge=0,Ce=ie.charCodeAt(0);ie=ie.replace(/\r\n/mg,`
`);var be=pe.dateNF!=null?dateNF_regex(pe.dateNF):null;function nt(){var Ae=ie.slice(xe,Le),De={};if(Ae.charAt(0)=='"'&&Ae.charAt(Ae.length-1)=='"'&&(Ae=Ae.slice(1,-1).replace(/""/g,'"')),Ae.length===0)De.t="z";else if(pe.raw)De.t="s",De.v=Ae;else if(Ae.trim().length===0)De.t="s",De.v=Ae;else if(Ae.charCodeAt(0)==61)Ae.charCodeAt(1)==34&&Ae.charCodeAt(Ae.length-1)==34?(De.t="s",De.v=Ae.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(Ae)?(De.t="n",De.f=Ae.slice(1)):(De.t="s",De.v=Ae);else if(Ae=="TRUE")De.t="b",De.v=!0;else if(Ae=="FALSE")De.t="b",De.v=!1;else if(!isNaN(ke=fuzzynum(Ae)))De.t="n",pe.cellText!==!1&&(De.w=Ae),De.v=ke;else if(!isNaN(fuzzydate(Ae).getDate())||be&&Ae.match(be)){De.z=pe.dateNF||table_fmt[14];var lt=0;be&&Ae.match(be)&&(Ae=dateNF_fix(Ae,pe.dateNF,Ae.match(be)||[]),lt=1),pe.cellDates?(De.t="d",De.v=parseDate(Ae,lt)):(De.t="n",De.v=datenum(parseDate(Ae,lt))),pe.cellText!==!1&&(De.w=SSF_format(De.z,De.v instanceof Date?datenum(De.v):De.v)),pe.cellNF||delete De.z}else De.t="s",De.v=Ae;if(De.t=="z"||(pe.dense?(ue[fe]||(ue[fe]=[]),ue[fe][me]=De):ue[encode_cell({c:me,r:fe})]=De),xe=Le+1,Ce=ie.charCodeAt(xe),ce.e.c<me&&(ce.e.c=me),ce.e.r<fe&&(ce.e.r=fe),ge==Se)++me;else if(me=0,++fe,pe.sheetRows&&pe.sheetRows<=fe)return!0}e:for(;Le<ie.length;++Le)switch(ge=ie.charCodeAt(Le)){case 34:Ce===34&&(Te=!Te);break;case Se:case 10:case 13:if(!Te&&nt())break e;break}return Le-xe>0&&nt(),ue["!ref"]=encode_range(ce),ue}function J(ie,le){return!(le&&le.PRN)||le.FS||ie.slice(0,4)=="sep="||ie.indexOf("	")>=0||ie.indexOf(",")>=0||ie.indexOf(";")>=0?q(ie,le):aoa_to_sheet(A(ie,le),le)}function re(ie,le){var pe="",he=le.type=="string"?[0,0,0,0]:firstbyte(ie,le);switch(le.type){case"base64":pe=Base64_decode(ie);break;case"binary":pe=ie;break;case"buffer":le.codepage==65001?pe=ie.toString("utf8"):(le.codepage,pe=has_buf&&Buffer.isBuffer(ie)?ie.toString("binary"):a2s(ie));break;case"array":pe=cc2str(ie);break;case"string":pe=ie;break;default:throw new Error("Unrecognized type "+le.type)}return he[0]==239&&he[1]==187&&he[2]==191?pe=utf8read(pe.slice(3)):le.type!="string"&&le.type!="buffer"&&le.codepage==65001?pe=utf8read(pe):le.type=="binary",pe.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(le.type=="string"?pe:utf8read(pe),le):J(pe,le)}function ae(ie,le){return sheet_to_workbook(re(ie,le),le)}function se(ie){for(var le=[],pe=safe_decode_range(ie["!ref"]),he,ue=Array.isArray(ie),ce=pe.s.r;ce<=pe.e.r;++ce){for(var fe=[],me=pe.s.c;me<=pe.e.c;++me){var ke=encode_cell({r:ce,c:me});if(he=ue?(ie[ce]||[])[me]:ie[ke],!he||he.v==null){fe.push("          ");continue}for(var xe=(he.w||(format_cell(he),he.w)||"").slice(0,10);xe.length<10;)xe+=" ";fe.push(xe+(me===0?" ":""))}le.push(fe.join(""))}return le.join(`
`)}return{to_workbook:ae,to_sheet:re,from_sheet:se}}();function read_wb_ID(g,A){var L=A||{},B=!!L.WTF;L.WTF=!0;try{var W=SYLK.to_workbook(g,L);return L.WTF=B,W}catch(q){if(L.WTF=B,!q.message.match(/SYLK bad record ID/)&&B)throw q;return PRN.to_workbook(g,A)}}var WK_=function(){function g(Ee,ye,ve){if(Ee){prep_blob(Ee,Ee.l||0);for(var Pe=ve.Enum||pt;Ee.l<Ee.length;){var rt=Ee.read_shift(2),st=Pe[rt]||Pe[65535],ot=Ee.read_shift(2),mt=Ee.l+ot,At=st.f&&st.f(Ee,ot,ve);if(Ee.l=mt,ye(At,st,rt))return}}}function A(Ee,ye){switch(ye.type){case"base64":return L(s2a(Base64_decode(Ee)),ye);case"binary":return L(s2a(Ee),ye);case"buffer":case"array":return L(Ee,ye)}throw"Unsupported type "+ye.type}function L(Ee,ye){if(!Ee)return Ee;var ve=ye||{},Pe=ve.dense?[]:{},rt="Sheet1",st="",ot=0,mt={},At=[],It=[],it={s:{r:0,c:0},e:{r:0,c:0}},Vt=ve.sheetRows||0;if(Ee[2]==0&&(Ee[3]==8||Ee[3]==9)&&Ee.length>=16&&Ee[14]==5&&Ee[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Ee[2]==2)ve.Enum=pt,g(Ee,function(Ft,ht,kt){switch(kt){case 0:ve.vers=Ft,Ft>=4096&&(ve.qpro=!0);break;case 6:it=Ft;break;case 204:Ft&&(st=Ft);break;case 222:st=Ft;break;case 15:case 51:ve.qpro||(Ft[1].v=Ft[1].v.slice(1));case 13:case 14:case 16:kt==14&&(Ft[2]&112)==112&&(Ft[2]&15)>1&&(Ft[2]&15)<15&&(Ft[1].z=ve.dateNF||table_fmt[14],ve.cellDates&&(Ft[1].t="d",Ft[1].v=numdate(Ft[1].v))),ve.qpro&&Ft[3]>ot&&(Pe["!ref"]=encode_range(it),mt[rt]=Pe,At.push(rt),Pe=ve.dense?[]:{},it={s:{r:0,c:0},e:{r:0,c:0}},ot=Ft[3],rt=st||"Sheet"+(ot+1),st="");var Dt=ve.dense?(Pe[Ft[0].r]||[])[Ft[0].c]:Pe[encode_cell(Ft[0])];if(Dt){Dt.t=Ft[1].t,Dt.v=Ft[1].v,Ft[1].z!=null&&(Dt.z=Ft[1].z),Ft[1].f!=null&&(Dt.f=Ft[1].f);break}ve.dense?(Pe[Ft[0].r]||(Pe[Ft[0].r]=[]),Pe[Ft[0].r][Ft[0].c]=Ft[1]):Pe[encode_cell(Ft[0])]=Ft[1];break}},ve);else if(Ee[2]==26||Ee[2]==14)ve.Enum=at,Ee[2]==14&&(ve.qpro=!0,Ee.l=0),g(Ee,function(Ft,ht,kt){switch(kt){case 204:rt=Ft;break;case 22:Ft[1].v=Ft[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ft[3]>ot&&(Pe["!ref"]=encode_range(it),mt[rt]=Pe,At.push(rt),Pe=ve.dense?[]:{},it={s:{r:0,c:0},e:{r:0,c:0}},ot=Ft[3],rt="Sheet"+(ot+1)),Vt>0&&Ft[0].r>=Vt)break;ve.dense?(Pe[Ft[0].r]||(Pe[Ft[0].r]=[]),Pe[Ft[0].r][Ft[0].c]=Ft[1]):Pe[encode_cell(Ft[0])]=Ft[1],it.e.c<Ft[0].c&&(it.e.c=Ft[0].c),it.e.r<Ft[0].r&&(it.e.r=Ft[0].r);break;case 27:Ft[14e3]&&(It[Ft[14e3][0]]=Ft[14e3][1]);break;case 1537:It[Ft[0]]=Ft[1],Ft[0]==ot&&(rt=Ft[1]);break}},ve);else throw new Error("Unrecognized LOTUS BOF "+Ee[2]);if(Pe["!ref"]=encode_range(it),mt[st||rt]=Pe,At.push(st||rt),!It.length)return{SheetNames:At,Sheets:mt};for(var Yt={},Zt=[],Lt=0;Lt<It.length;++Lt)mt[At[Lt]]?(Zt.push(It[Lt]||At[Lt]),Yt[It[Lt]]=mt[It[Lt]]||mt[At[Lt]]):(Zt.push(It[Lt]),Yt[It[Lt]]={"!ref":"A1"});return{SheetNames:Zt,Sheets:Yt}}function B(Ee,ye){var ve=ye||{};if(+ve.codepage>=0&&set_cp(+ve.codepage),ve.type=="string")throw new Error("Cannot write WK1 to JS string");var Pe=buf_array(),rt=safe_decode_range(Ee["!ref"]),st=Array.isArray(Ee),ot=[];write_biff_rec(Pe,0,q(1030)),write_biff_rec(Pe,6,ae(rt));for(var mt=Math.min(rt.e.r,8191),At=rt.s.r;At<=mt;++At)for(var It=encode_row(At),it=rt.s.c;it<=rt.e.c;++it){At===rt.s.r&&(ot[it]=encode_col(it));var Vt=ot[it]+It,Yt=st?(Ee[At]||[])[it]:Ee[Vt];if(!(!Yt||Yt.t=="z"))if(Yt.t=="n")(Yt.v|0)==Yt.v&&Yt.v>=-32768&&Yt.v<=32767?write_biff_rec(Pe,13,he(At,it,Yt.v)):write_biff_rec(Pe,14,ce(At,it,Yt.v));else{var Zt=format_cell(Yt);write_biff_rec(Pe,15,le(At,it,Zt.slice(0,239)))}}return write_biff_rec(Pe,1),Pe.end()}function W(Ee,ye){var ve=ye||{};if(+ve.codepage>=0&&set_cp(+ve.codepage),ve.type=="string")throw new Error("Cannot write WK3 to JS string");var Pe=buf_array();write_biff_rec(Pe,0,J(Ee));for(var rt=0,st=0;rt<Ee.SheetNames.length;++rt)(Ee.Sheets[Ee.SheetNames[rt]]||{})["!ref"]&&write_biff_rec(Pe,27,Ie(Ee.SheetNames[rt],st++));var ot=0;for(rt=0;rt<Ee.SheetNames.length;++rt){var mt=Ee.Sheets[Ee.SheetNames[rt]];if(!(!mt||!mt["!ref"])){for(var At=safe_decode_range(mt["!ref"]),It=Array.isArray(mt),it=[],Vt=Math.min(At.e.r,8191),Yt=At.s.r;Yt<=Vt;++Yt)for(var Zt=encode_row(Yt),Lt=At.s.c;Lt<=At.e.c;++Lt){Yt===At.s.r&&(it[Lt]=encode_col(Lt));var Ft=it[Lt]+Zt,ht=It?(mt[Yt]||[])[Lt]:mt[Ft];if(!(!ht||ht.t=="z"))if(ht.t=="n")write_biff_rec(Pe,23,nt(Yt,Lt,ot,ht.v));else{var kt=format_cell(ht);write_biff_rec(Pe,22,ge(Yt,Lt,ot,kt.slice(0,239)))}}++ot}}return write_biff_rec(Pe,1),Pe.end()}function q(Ee){var ye=new_buf(2);return ye.write_shift(2,Ee),ye}function J(Ee){var ye=new_buf(26);ye.write_shift(2,4096),ye.write_shift(2,4),ye.write_shift(4,0);for(var ve=0,Pe=0,rt=0,st=0;st<Ee.SheetNames.length;++st){var ot=Ee.SheetNames[st],mt=Ee.Sheets[ot];if(!(!mt||!mt["!ref"])){++rt;var At=decode_range(mt["!ref"]);ve<At.e.r&&(ve=At.e.r),Pe<At.e.c&&(Pe=At.e.c)}}return ve>8191&&(ve=8191),ye.write_shift(2,ve),ye.write_shift(1,rt),ye.write_shift(1,Pe),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(1,1),ye.write_shift(1,2),ye.write_shift(4,0),ye.write_shift(4,0),ye}function re(Ee,ye,ve){var Pe={s:{c:0,r:0},e:{c:0,r:0}};return ye==8&&ve.qpro?(Pe.s.c=Ee.read_shift(1),Ee.l++,Pe.s.r=Ee.read_shift(2),Pe.e.c=Ee.read_shift(1),Ee.l++,Pe.e.r=Ee.read_shift(2),Pe):(Pe.s.c=Ee.read_shift(2),Pe.s.r=Ee.read_shift(2),ye==12&&ve.qpro&&(Ee.l+=2),Pe.e.c=Ee.read_shift(2),Pe.e.r=Ee.read_shift(2),ye==12&&ve.qpro&&(Ee.l+=2),Pe.s.c==65535&&(Pe.s.c=Pe.e.c=Pe.s.r=Pe.e.r=0),Pe)}function ae(Ee){var ye=new_buf(8);return ye.write_shift(2,Ee.s.c),ye.write_shift(2,Ee.s.r),ye.write_shift(2,Ee.e.c),ye.write_shift(2,Ee.e.r),ye}function se(Ee,ye,ve){var Pe=[{c:0,r:0},{t:"n",v:0},0,0];return ve.qpro&&ve.vers!=20768?(Pe[0].c=Ee.read_shift(1),Pe[3]=Ee.read_shift(1),Pe[0].r=Ee.read_shift(2),Ee.l+=2):(Pe[2]=Ee.read_shift(1),Pe[0].c=Ee.read_shift(2),Pe[0].r=Ee.read_shift(2)),Pe}function ie(Ee,ye,ve){var Pe=Ee.l+ye,rt=se(Ee,ye,ve);if(rt[1].t="s",ve.vers==20768){Ee.l++;var st=Ee.read_shift(1);return rt[1].v=Ee.read_shift(st,"utf8"),rt}return ve.qpro&&Ee.l++,rt[1].v=Ee.read_shift(Pe-Ee.l,"cstr"),rt}function le(Ee,ye,ve){var Pe=new_buf(7+ve.length);Pe.write_shift(1,255),Pe.write_shift(2,ye),Pe.write_shift(2,Ee),Pe.write_shift(1,39);for(var rt=0;rt<Pe.length;++rt){var st=ve.charCodeAt(rt);Pe.write_shift(1,st>=128?95:st)}return Pe.write_shift(1,0),Pe}function pe(Ee,ye,ve){var Pe=se(Ee,ye,ve);return Pe[1].v=Ee.read_shift(2,"i"),Pe}function he(Ee,ye,ve){var Pe=new_buf(7);return Pe.write_shift(1,255),Pe.write_shift(2,ye),Pe.write_shift(2,Ee),Pe.write_shift(2,ve,"i"),Pe}function ue(Ee,ye,ve){var Pe=se(Ee,ye,ve);return Pe[1].v=Ee.read_shift(8,"f"),Pe}function ce(Ee,ye,ve){var Pe=new_buf(13);return Pe.write_shift(1,255),Pe.write_shift(2,ye),Pe.write_shift(2,Ee),Pe.write_shift(8,ve,"f"),Pe}function fe(Ee,ye,ve){var Pe=Ee.l+ye,rt=se(Ee,ye,ve);if(rt[1].v=Ee.read_shift(8,"f"),ve.qpro)Ee.l=Pe;else{var st=Ee.read_shift(2);Le(Ee.slice(Ee.l,Ee.l+st),rt),Ee.l+=st}return rt}function me(Ee,ye,ve){var Pe=ye&32768;return ye&=-32769,ye=(Pe?Ee:0)+(ye>=8192?ye-16384:ye),(Pe?"":"$")+(ve?encode_col(ye):encode_row(ye))}var ke={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},xe=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Le(Ee,ye){prep_blob(Ee,0);for(var ve=[],Pe=0,rt="",st="",ot="",mt="";Ee.l<Ee.length;){var At=Ee[Ee.l++];switch(At){case 0:ve.push(Ee.read_shift(8,"f"));break;case 1:st=me(ye[0].c,Ee.read_shift(2),!0),rt=me(ye[0].r,Ee.read_shift(2),!1),ve.push(st+rt);break;case 2:{var It=me(ye[0].c,Ee.read_shift(2),!0),it=me(ye[0].r,Ee.read_shift(2),!1);st=me(ye[0].c,Ee.read_shift(2),!0),rt=me(ye[0].r,Ee.read_shift(2),!1),ve.push(It+it+":"+st+rt)}break;case 3:if(Ee.l<Ee.length){console.error("WK1 premature formula end");return}break;case 4:ve.push("("+ve.pop()+")");break;case 5:ve.push(Ee.read_shift(2));break;case 6:{for(var Vt="";At=Ee[Ee.l++];)Vt+=String.fromCharCode(At);ve.push('"'+Vt.replace(/"/g,'""')+'"')}break;case 8:ve.push("-"+ve.pop());break;case 23:ve.push("+"+ve.pop());break;case 22:ve.push("NOT("+ve.pop()+")");break;case 20:case 21:mt=ve.pop(),ot=ve.pop(),ve.push(["AND","OR"][At-20]+"("+ot+","+mt+")");break;default:if(At<32&&xe[At])mt=ve.pop(),ot=ve.pop(),ve.push(ot+xe[At]+mt);else if(ke[At]){if(Pe=ke[At][1],Pe==69&&(Pe=Ee[Ee.l++]),Pe>ve.length){console.error("WK1 bad formula parse 0x"+At.toString(16)+":|"+ve.join("|")+"|");return}var Yt=ve.slice(-Pe);ve.length-=Pe,ve.push(ke[At][0]+"("+Yt.join(",")+")")}else return At<=7?console.error("WK1 invalid opcode "+At.toString(16)):At<=24?console.error("WK1 unsupported op "+At.toString(16)):At<=30?console.error("WK1 invalid opcode "+At.toString(16)):At<=115?console.error("WK1 unsupported function opcode "+At.toString(16)):console.error("WK1 unrecognized opcode "+At.toString(16))}}ve.length==1?ye[1].f=""+ve[0]:console.error("WK1 bad formula parse |"+ve.join("|")+"|")}function Se(Ee){var ye=[{c:0,r:0},{t:"n",v:0},0];return ye[0].r=Ee.read_shift(2),ye[3]=Ee[Ee.l++],ye[0].c=Ee[Ee.l++],ye}function Te(Ee,ye){var ve=Se(Ee);return ve[1].t="s",ve[1].v=Ee.read_shift(ye-4,"cstr"),ve}function ge(Ee,ye,ve,Pe){var rt=new_buf(6+Pe.length);rt.write_shift(2,Ee),rt.write_shift(1,ve),rt.write_shift(1,ye),rt.write_shift(1,39);for(var st=0;st<Pe.length;++st){var ot=Pe.charCodeAt(st);rt.write_shift(1,ot>=128?95:ot)}return rt.write_shift(1,0),rt}function Ce(Ee,ye){var ve=Se(Ee);ve[1].v=Ee.read_shift(2);var Pe=ve[1].v>>1;if(ve[1].v&1)switch(Pe&7){case 0:Pe=(Pe>>3)*5e3;break;case 1:Pe=(Pe>>3)*500;break;case 2:Pe=(Pe>>3)/20;break;case 3:Pe=(Pe>>3)/200;break;case 4:Pe=(Pe>>3)/2e3;break;case 5:Pe=(Pe>>3)/2e4;break;case 6:Pe=(Pe>>3)/16;break;case 7:Pe=(Pe>>3)/64;break}return ve[1].v=Pe,ve}function be(Ee,ye){var ve=Se(Ee),Pe=Ee.read_shift(4),rt=Ee.read_shift(4),st=Ee.read_shift(2);if(st==65535)return Pe===0&&rt===3221225472?(ve[1].t="e",ve[1].v=15):Pe===0&&rt===3489660928?(ve[1].t="e",ve[1].v=42):ve[1].v=0,ve;var ot=st&32768;return st=(st&32767)-16446,ve[1].v=(1-ot*2)*(rt*Math.pow(2,st+32)+Pe*Math.pow(2,st)),ve}function nt(Ee,ye,ve,Pe){var rt=new_buf(14);if(rt.write_shift(2,Ee),rt.write_shift(1,ve),rt.write_shift(1,ye),Pe==0)return rt.write_shift(4,0),rt.write_shift(4,0),rt.write_shift(2,65535),rt;var st=0,ot=0,mt=0,At=0;return Pe<0&&(st=1,Pe=-Pe),ot=Math.log2(Pe)|0,Pe/=Math.pow(2,ot-31),At=Pe>>>0,(At&2147483648)==0&&(Pe/=2,++ot,At=Pe>>>0),Pe-=At,At|=2147483648,At>>>=0,Pe*=Math.pow(2,32),mt=Pe>>>0,rt.write_shift(4,mt),rt.write_shift(4,At),ot+=16383+(st?32768:0),rt.write_shift(2,ot),rt}function Ae(Ee,ye){var ve=be(Ee);return Ee.l+=ye-14,ve}function De(Ee,ye){var ve=Se(Ee),Pe=Ee.read_shift(4);return ve[1].v=Pe>>6,ve}function lt(Ee,ye){var ve=Se(Ee),Pe=Ee.read_shift(8,"f");return ve[1].v=Pe,ve}function Ct(Ee,ye){var ve=lt(Ee);return Ee.l+=ye-10,ve}function ft(Ee,ye){return Ee[Ee.l+ye-1]==0?Ee.read_shift(ye,"cstr"):""}function Et(Ee,ye){var ve=Ee[Ee.l++];ve>ye-1&&(ve=ye-1);for(var Pe="";Pe.length<ve;)Pe+=String.fromCharCode(Ee[Ee.l++]);return Pe}function gt(Ee,ye,ve){if(!(!ve.qpro||ye<21)){var Pe=Ee.read_shift(1);Ee.l+=17,Ee.l+=1,Ee.l+=2;var rt=Ee.read_shift(ye-21,"cstr");return[Pe,rt]}}function bt(Ee,ye){for(var ve={},Pe=Ee.l+ye;Ee.l<Pe;){var rt=Ee.read_shift(2);if(rt==14e3){for(ve[rt]=[0,""],ve[rt][0]=Ee.read_shift(2);Ee[Ee.l];)ve[rt][1]+=String.fromCharCode(Ee[Ee.l]),Ee.l++;Ee.l++}}return ve}function Ie(Ee,ye){var ve=new_buf(5+Ee.length);ve.write_shift(2,14e3),ve.write_shift(2,ye);for(var Pe=0;Pe<Ee.length;++Pe){var rt=Ee.charCodeAt(Pe);ve[ve.l++]=rt>127?95:rt}return ve[ve.l++]=0,ve}var pt={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:re},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:pe},14:{n:"NUMBER",f:ue},15:{n:"LABEL",f:ie},16:{n:"FORMULA",f:fe},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:ie},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ft},222:{n:"SHEETNAMELP",f:Et},65535:{n:""}},at={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Te},23:{n:"NUMBER17",f:be},24:{n:"NUMBER18",f:Ce},25:{n:"FORMULA19",f:Ae},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:bt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:De},38:{n:"??"},39:{n:"NUMBER27",f:lt},40:{n:"FORMULA28",f:Ct},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ft},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:gt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:B,book_to_wk3:W,to_workbook:A}}();function parse_rpr(g){var A={},L=g.match(tagregex),B=0,W=!1;if(L)for(;B!=L.length;++B){var q=parsexmltag(L[B]);switch(q[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!q.val)break;case"<shadow>":case"<shadow/>":A.shadow=1;break;case"</shadow>":break;case"<charset":if(q.val=="1")break;A.cp=CS2CP[parseInt(q.val,10)];break;case"<outline":if(!q.val)break;case"<outline>":case"<outline/>":A.outline=1;break;case"</outline>":break;case"<rFont":A.name=q.val;break;case"<sz":A.sz=q.val;break;case"<strike":if(!q.val)break;case"<strike>":case"<strike/>":A.strike=1;break;case"</strike>":break;case"<u":if(!q.val)break;switch(q.val){case"double":A.uval="double";break;case"singleAccounting":A.uval="single-accounting";break;case"doubleAccounting":A.uval="double-accounting";break}case"<u>":case"<u/>":A.u=1;break;case"</u>":break;case"<b":if(q.val=="0")break;case"<b>":case"<b/>":A.b=1;break;case"</b>":break;case"<i":if(q.val=="0")break;case"<i>":case"<i/>":A.i=1;break;case"</i>":break;case"<color":q.rgb&&(A.color=q.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":A.family=q.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":A.valign=q.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":W=!0;break;case"</ext>":W=!1;break;default:if(q[0].charCodeAt(1)!==47&&!W)throw new Error("Unrecognized rich format "+q[0])}}return A}var parse_rs=function(){var g=matchtag("t"),A=matchtag("rPr");function L(q){var J=q.match(g);if(!J)return{t:"s",v:""};var re={t:"s",v:unescapexml(J[1])},ae=q.match(A);return ae&&(re.s=parse_rpr(ae[1])),re}var B=/<(?:\w+:)?r>/g,W=/<\/(?:\w+:)?r>/;return function(J){return J.replace(B,"").split(W).map(L).filter(function(re){return re.v})}}(),rs_to_html=function g(){var A=/(\r\n|\n)/g;function L(W,q,J){var re=[];W.u&&re.push("text-decoration: underline;"),W.uval&&re.push("text-underline-style:"+W.uval+";"),W.sz&&re.push("font-size:"+W.sz+"pt;"),W.outline&&re.push("text-effect: outline;"),W.shadow&&re.push("text-shadow: auto;"),q.push('<span style="'+re.join("")+'">'),W.b&&(q.push("<b>"),J.push("</b>")),W.i&&(q.push("<i>"),J.push("</i>")),W.strike&&(q.push("<s>"),J.push("</s>"));var ae=W.valign||"";return ae=="superscript"||ae=="super"?ae="sup":ae=="subscript"&&(ae="sub"),ae!=""&&(q.push("<"+ae+">"),J.push("</"+ae+">")),J.push("</span>"),W}function B(W){var q=[[],W.v,[]];return W.v?(W.s&&L(W.s,q[0],q[2]),q[0].join("")+q[1].replace(A,"<br/>")+q[2].join("")):""}return function(q){return q.map(B).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(g,A){var L=A?A.cellHTML:!0,B={};return g?(g.match(/^\s*<(?:\w+:)?t[^>]*>/)?(B.t=unescapexml(utf8read(g.slice(g.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),B.r=utf8read(g),L&&(B.h=escapehtml(B.t))):g.match(sirregex)&&(B.r=utf8read(g),B.t=unescapexml(utf8read((g.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),L&&(B.h=rs_to_html(parse_rs(B.r)))),B):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(g,A){var L=[],B="";if(!g)return L;var W=g.match(sstr0);if(W){B=W[2].replace(sstr1,"").split(sstr2);for(var q=0;q!=B.length;++q){var J=parse_si(B[q].trim(),A);J!=null&&(L[L.length]=J)}W=parsexmltag(W[1]),L.Count=W.count,L.Unique=W.uniqueCount}return L}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(g,A){if(!A.bookSST)return"";var L=[XML_HEADER];L[L.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:g.Count,uniqueCount:g.Unique});for(var B=0;B!=g.length;++B)if(g[B]!=null){var W=g[B],q="<si>";W.r?q+=W.r:(q+="<t",W.t||(W.t=""),W.t.match(straywsregex)&&(q+=' xml:space="preserve"'),q+=">"+escapexml(W.t)+"</t>"),q+="</si>",L[L.length]=q}return L.length>2&&(L[L.length]="</sst>",L[1]=L[1].replace("/>",">")),L.join("")}function parse_BrtBeginSst(g){return[g.read_shift(4),g.read_shift(4)]}function parse_sst_bin(g,A){var L=[],B=!1;return recordhopper(g,function(q,J,re){switch(re){case 159:L.Count=q[0],L.Unique=q[1];break;case 19:L.push(q);break;case 160:return!0;case 35:B=!0;break;case 36:B=!1;break;default:if(J.T,!B||A.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}),L}function write_BrtBeginSst(g,A){return A||(A=new_buf(8)),A.write_shift(4,g.Count),A.write_shift(4,g.Unique),A}var write_BrtSSTItem=write_RichStr;function write_sst_bin(g){var A=buf_array();write_record(A,159,write_BrtBeginSst(g));for(var L=0;L<g.length;++L)write_record(A,19,write_BrtSSTItem(g[L]));return write_record(A,160),A.end()}function _JS2ANSI(g){for(var A=[],L=g.split(""),B=0;B<L.length;++B)A[B]=L[B].charCodeAt(0);return A}function parse_CRYPTOVersion(g,A){var L={};return L.Major=g.read_shift(2),L.Minor=g.read_shift(2),A>=4&&(g.l+=A-4),L}function parse_DataSpaceVersionInfo(g){var A={};return A.id=g.read_shift(0,"lpp4"),A.R=parse_CRYPTOVersion(g,4),A.U=parse_CRYPTOVersion(g,4),A.W=parse_CRYPTOVersion(g,4),A}function parse_DataSpaceMapEntry(g){for(var A=g.read_shift(4),L=g.l+A-4,B={},W=g.read_shift(4),q=[];W-- >0;)q.push({t:g.read_shift(4),v:g.read_shift(0,"lpp4")});if(B.name=g.read_shift(0,"lpp4"),B.comps=q,g.l!=L)throw new Error("Bad DataSpaceMapEntry: "+g.l+" != "+L);return B}function parse_DataSpaceMap(g){var A=[];g.l+=4;for(var L=g.read_shift(4);L-- >0;)A.push(parse_DataSpaceMapEntry(g));return A}function parse_DataSpaceDefinition(g){var A=[];g.l+=4;for(var L=g.read_shift(4);L-- >0;)A.push(g.read_shift(0,"lpp4"));return A}function parse_TransformInfoHeader(g){var A={};return g.read_shift(4),g.l+=4,A.id=g.read_shift(0,"lpp4"),A.name=g.read_shift(0,"lpp4"),A.R=parse_CRYPTOVersion(g,4),A.U=parse_CRYPTOVersion(g,4),A.W=parse_CRYPTOVersion(g,4),A}function parse_Primary(g){var A=parse_TransformInfoHeader(g);if(A.ename=g.read_shift(0,"8lpp4"),A.blksz=g.read_shift(4),A.cmode=g.read_shift(4),g.read_shift(4)!=4)throw new Error("Bad !Primary record");return A}function parse_EncryptionHeader(g,A){var L=g.l+A,B={};B.Flags=g.read_shift(4)&63,g.l+=4,B.AlgID=g.read_shift(4);var W=!1;switch(B.AlgID){case 26126:case 26127:case 26128:W=B.Flags==36;break;case 26625:W=B.Flags==4;break;case 0:W=B.Flags==16||B.Flags==4||B.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+B.AlgID}if(!W)throw new Error("Encryption Flags/AlgID mismatch");return B.AlgIDHash=g.read_shift(4),B.KeySize=g.read_shift(4),B.ProviderType=g.read_shift(4),g.l+=8,B.CSPName=g.read_shift(L-g.l>>1,"utf16le"),g.l=L,B}function parse_EncryptionVerifier(g,A){var L={},B=g.l+A;return g.l+=4,L.Salt=g.slice(g.l,g.l+16),g.l+=16,L.Verifier=g.slice(g.l,g.l+16),g.l+=16,g.read_shift(4),L.VerifierHash=g.slice(g.l,B),g.l=B,L}function parse_EncryptionInfo(g){var A=parse_CRYPTOVersion(g);switch(A.Minor){case 2:return[A.Minor,parse_EncInfoStd(g)];case 3:return[A.Minor,parse_EncInfoExt()];case 4:return[A.Minor,parse_EncInfoAgl(g)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+A.Minor)}function parse_EncInfoStd(g){var A=g.read_shift(4);if((A&63)!=36)throw new Error("EncryptionInfo mismatch");var L=g.read_shift(4),B=parse_EncryptionHeader(g,L),W=parse_EncryptionVerifier(g,g.length-g.l);return{t:"Std",h:B,v:W}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(g){var A=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];g.l+=4;var L=g.read_shift(g.length-g.l,"utf8"),B={};return L.replace(tagregex,function(q){var J=parsexmltag(q);switch(strip_ns(J[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":A.forEach(function(re){B[re]=J[re]});break;case"<dataIntegrity":B.encryptedHmacKey=J.encryptedHmacKey,B.encryptedHmacValue=J.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":B.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":B.uri=J.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":B.encs.push(J);break;default:throw J[0]}}),B}function parse_RC4CryptoHeader(g,A){var L={},B=L.EncryptionVersionInfo=parse_CRYPTOVersion(g,4);if(A-=4,B.Minor!=2)throw new Error("unrecognized minor version code: "+B.Minor);if(B.Major>4||B.Major<2)throw new Error("unrecognized major version code: "+B.Major);L.Flags=g.read_shift(4),A-=4;var W=g.read_shift(4);return A-=4,L.EncryptionHeader=parse_EncryptionHeader(g,W),A-=W,L.EncryptionVerifier=parse_EncryptionVerifier(g,A),L}function parse_RC4Header(g){var A={},L=A.EncryptionVersionInfo=parse_CRYPTOVersion(g,4);if(L.Major!=1||L.Minor!=1)throw"unrecognized version code "+L.Major+" : "+L.Minor;return A.Salt=g.read_shift(16),A.EncryptedVerifier=g.read_shift(16),A.EncryptedVerifierHash=g.read_shift(16),A}function crypto_CreatePasswordVerifier_Method1(g){var A=0,L,B=_JS2ANSI(g),W=B.length+1,q,J,re,ae,se;for(L=new_raw_buf(W),L[0]=B.length,q=1;q!=W;++q)L[q]=B[q-1];for(q=W-1;q>=0;--q)J=L[q],re=(A&16384)===0?0:1,ae=A<<1&32767,se=re|ae,A=se^J;return A^52811}var crypto_CreateXorArray_Method1=function(){var g=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],A=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],L=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],B=function(J){return(J/2|J*128)&255},W=function(J,re){return B(J^re)},q=function(J){for(var re=A[J.length-1],ae=104,se=J.length-1;se>=0;--se)for(var ie=J[se],le=0;le!=7;++le)ie&64&&(re^=L[ae]),ie*=2,--ae;return re};return function(J){for(var re=_JS2ANSI(J),ae=q(re),se=re.length,ie=new_raw_buf(16),le=0;le!=16;++le)ie[le]=0;var pe,he,ue;for((se&1)===1&&(pe=ae>>8,ie[se]=W(g[0],pe),--se,pe=ae&255,he=re[re.length-1],ie[se]=W(he,pe));se>0;)--se,pe=ae>>8,ie[se]=W(re[se],pe),--se,pe=ae&255,ie[se]=W(re[se],pe);for(se=15,ue=15-re.length;ue>0;)pe=ae>>8,ie[se]=W(g[ue],pe),--se,--ue,pe=ae&255,ie[se]=W(re[se],pe),--se,--ue;return ie}}(),crypto_DecryptData_Method1=function(g,A,L,B,W){W||(W=A),B||(B=crypto_CreateXorArray_Method1(g));var q,J;for(q=0;q!=A.length;++q)J=A[q],J^=B[L],J=(J>>5|J<<3)&255,W[q]=J,++L;return[W,L,B]},crypto_MakeXorDecryptor=function(g){var A=0,L=crypto_CreateXorArray_Method1(g);return function(B){var W=crypto_DecryptData_Method1("",B,A,L);return A=W[1],W[0]}};function parse_XORObfuscation(g,A,L,B){var W={key:parseuint16(g),verificationBytes:parseuint16(g)};return L.password&&(W.verifier=crypto_CreatePasswordVerifier_Method1(L.password)),B.valid=W.verificationBytes===W.verifier,B.valid&&(B.insitu=crypto_MakeXorDecryptor(L.password)),W}function parse_FilePassHeader(g,A,L){var B=L||{};return B.Info=g.read_shift(2),g.l-=2,B.Info===1?B.Data=parse_RC4Header(g):B.Data=parse_RC4CryptoHeader(g,A),B}function parse_FilePass(g,A,L){var B={Type:L.biff>=8?g.read_shift(2):0};return B.Type?parse_FilePassHeader(g,A-2,B):parse_XORObfuscation(g,L.biff>=8?A:A-2,L,B),B}var RTF=function(){function g(W,q){switch(q.type){case"base64":return A(Base64_decode(W),q);case"binary":return A(W,q);case"buffer":return A(has_buf&&Buffer.isBuffer(W)?W.toString("binary"):a2s(W),q);case"array":return A(cc2str(W),q)}throw new Error("Unrecognized type "+q.type)}function A(W,q){var J=q||{},re=J.dense?[]:{},ae=W.match(/\\trowd.*?\\row\b/g);if(!ae.length)throw new Error("RTF missing table");var se={s:{c:0,r:0},e:{c:0,r:ae.length-1}};return ae.forEach(function(ie,le){Array.isArray(re)&&(re[le]=[]);for(var pe=/\\\w+\b/g,he=0,ue,ce=-1;ue=pe.exec(ie);){switch(ue[0]){case"\\cell":var fe=ie.slice(he,pe.lastIndex-ue[0].length);if(fe[0]==" "&&(fe=fe.slice(1)),++ce,fe.length){var me={v:fe,t:"s"};Array.isArray(re)?re[le][ce]=me:re[encode_cell({r:le,c:ce})]=me}break}he=pe.lastIndex}ce>se.e.c&&(se.e.c=ce)}),re["!ref"]=encode_range(se),re}function L(W,q){return sheet_to_workbook(g(W,q),q)}function B(W){for(var q=["{\\rtf1\\ansi"],J=safe_decode_range(W["!ref"]),re,ae=Array.isArray(W),se=J.s.r;se<=J.e.r;++se){q.push("\\trowd\\trautofit1");for(var ie=J.s.c;ie<=J.e.c;++ie)q.push("\\cellx"+(ie+1));for(q.push("\\pard\\intbl"),ie=J.s.c;ie<=J.e.c;++ie){var le=encode_cell({r:se,c:ie});re=ae?(W[se]||[])[ie]:W[le],!(!re||re.v==null&&(!re.f||re.F))&&(q.push(" "+(re.w||(format_cell(re),re.w))),q.push("\\cell"))}q.push("\\pard\\intbl\\row")}return q.join("")+"}"}return{to_workbook:L,to_sheet:g,from_sheet:B}}();function hex2RGB(g){var A=g.slice(g[0]==="#"?1:0).slice(0,6);return[parseInt(A.slice(0,2),16),parseInt(A.slice(2,4),16),parseInt(A.slice(4,6),16)]}function rgb2Hex(g){for(var A=0,L=1;A!=3;++A)L=L*256+(g[A]>255?255:g[A]<0?0:g[A]);return L.toString(16).toUpperCase().slice(1)}function rgb2HSL(g){var A=g[0]/255,L=g[1]/255,B=g[2]/255,W=Math.max(A,L,B),q=Math.min(A,L,B),J=W-q;if(J===0)return[0,0,A];var re=0,ae=0,se=W+q;switch(ae=J/(se>1?2-se:se),W){case A:re=((L-B)/J+6)%6;break;case L:re=(B-A)/J+2;break;case B:re=(A-L)/J+4;break}return[re/6,ae,se/2]}function hsl2RGB(g){var A=g[0],L=g[1],B=g[2],W=L*2*(B<.5?B:1-B),q=B-W/2,J=[q,q,q],re=6*A,ae;if(L!==0)switch(re|0){case 0:case 6:ae=W*re,J[0]+=W,J[1]+=ae;break;case 1:ae=W*(2-re),J[0]+=ae,J[1]+=W;break;case 2:ae=W*(re-2),J[1]+=W,J[2]+=ae;break;case 3:ae=W*(4-re),J[1]+=ae,J[2]+=W;break;case 4:ae=W*(re-4),J[2]+=W,J[0]+=ae;break;case 5:ae=W*(6-re),J[2]+=ae,J[0]+=W;break}for(var se=0;se!=3;++se)J[se]=Math.round(J[se]*255);return J}function rgb_tint(g,A){if(A===0)return g;var L=rgb2HSL(hex2RGB(g));return A<0?L[2]=L[2]*(1+A):L[2]=1-(1-L[2])*(1-A),rgb2Hex(hsl2RGB(L))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(g){return Math.floor((g+Math.round(128/MDW)/256)*MDW)}function px2char(g){return Math.floor((g-5)/MDW*100+.5)/100}function char2width(g){return Math.round((g*MDW+5)/MDW*256)/256}function cycle_width(g){return char2width(px2char(width2px(g)))}function find_mdw_colw(g){var A=Math.abs(g-cycle_width(g)),L=MDW;if(A>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(g-cycle_width(g))<=A&&(A=Math.abs(g-cycle_width(g)),L=MDW);MDW=L}function process_col(g){g.width?(g.wpx=width2px(g.width),g.wch=px2char(g.wpx),g.MDW=MDW):g.wpx?(g.wch=px2char(g.wpx),g.width=char2width(g.wch),g.MDW=MDW):typeof g.wch=="number"&&(g.width=char2width(g.wch),g.wpx=width2px(g.width),g.MDW=MDW),g.customWidth&&delete g.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(g){return g*96/PPI}function pt2px(g){return g*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(g,A,L,B){A.Borders=[];var W={},q=!1;(g[0].match(tagregex)||[]).forEach(function(J){var re=parsexmltag(J);switch(strip_ns(re[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":W={},re.diagonalUp&&(W.diagonalUp=parsexmlbool(re.diagonalUp)),re.diagonalDown&&(W.diagonalDown=parsexmlbool(re.diagonalDown)),A.Borders.push(W);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(B&&B.WTF&&!q)throw new Error("unrecognized "+re[0]+" in borders")}})}function parse_fills(g,A,L,B){A.Fills=[];var W={},q=!1;(g[0].match(tagregex)||[]).forEach(function(J){var re=parsexmltag(J);switch(strip_ns(re[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":W={},A.Fills.push(W);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":A.Fills.push(W),W={};break;case"<patternFill":case"<patternFill>":re.patternType&&(W.patternType=re.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":W.bgColor||(W.bgColor={}),re.indexed&&(W.bgColor.indexed=parseInt(re.indexed,10)),re.theme&&(W.bgColor.theme=parseInt(re.theme,10)),re.tint&&(W.bgColor.tint=parseFloat(re.tint)),re.rgb&&(W.bgColor.rgb=re.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":W.fgColor||(W.fgColor={}),re.theme&&(W.fgColor.theme=parseInt(re.theme,10)),re.tint&&(W.fgColor.tint=parseFloat(re.tint)),re.rgb!=null&&(W.fgColor.rgb=re.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(B&&B.WTF&&!q)throw new Error("unrecognized "+re[0]+" in fills")}})}function parse_fonts(g,A,L,B){A.Fonts=[];var W={},q=!1;(g[0].match(tagregex)||[]).forEach(function(J){var re=parsexmltag(J);switch(strip_ns(re[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":A.Fonts.push(W),W={};break;case"<name":re.val&&(W.name=utf8read(re.val));break;case"<name/>":case"</name>":break;case"<b":W.bold=re.val?parsexmlbool(re.val):1;break;case"<b/>":W.bold=1;break;case"<i":W.italic=re.val?parsexmlbool(re.val):1;break;case"<i/>":W.italic=1;break;case"<u":switch(re.val){case"none":W.underline=0;break;case"single":W.underline=1;break;case"double":W.underline=2;break;case"singleAccounting":W.underline=33;break;case"doubleAccounting":W.underline=34;break}break;case"<u/>":W.underline=1;break;case"<strike":W.strike=re.val?parsexmlbool(re.val):1;break;case"<strike/>":W.strike=1;break;case"<outline":W.outline=re.val?parsexmlbool(re.val):1;break;case"<outline/>":W.outline=1;break;case"<shadow":W.shadow=re.val?parsexmlbool(re.val):1;break;case"<shadow/>":W.shadow=1;break;case"<condense":W.condense=re.val?parsexmlbool(re.val):1;break;case"<condense/>":W.condense=1;break;case"<extend":W.extend=re.val?parsexmlbool(re.val):1;break;case"<extend/>":W.extend=1;break;case"<sz":re.val&&(W.sz=+re.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":re.val&&(W.vertAlign=re.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":re.val&&(W.family=parseInt(re.val,10));break;case"<family/>":case"</family>":break;case"<scheme":re.val&&(W.scheme=re.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(re.val=="1")break;re.codepage=CS2CP[parseInt(re.val,10)];break;case"<color":if(W.color||(W.color={}),re.auto&&(W.color.auto=parsexmlbool(re.auto)),re.rgb)W.color.rgb=re.rgb.slice(-6);else if(re.indexed){W.color.index=parseInt(re.indexed,10);var ae=XLSIcv[W.color.index];W.color.index==81&&(ae=XLSIcv[1]),ae||(ae=XLSIcv[1]),W.color.rgb=ae[0].toString(16)+ae[1].toString(16)+ae[2].toString(16)}else re.theme&&(W.color.theme=parseInt(re.theme,10),re.tint&&(W.color.tint=parseFloat(re.tint)),re.theme&&L.themeElements&&L.themeElements.clrScheme&&(W.color.rgb=rgb_tint(L.themeElements.clrScheme[W.color.theme].rgb,W.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":q=!0;break;case"</AlternateContent>":q=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(B&&B.WTF&&!q)throw new Error("unrecognized "+re[0]+" in fonts")}})}function parse_numFmts(g,A,L){A.NumberFmt=[];for(var B=keys(table_fmt),W=0;W<B.length;++W)A.NumberFmt[B[W]]=table_fmt[B[W]];var q=g[0].match(tagregex);if(q)for(W=0;W<q.length;++W){var J=parsexmltag(q[W]);switch(strip_ns(J[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var re=unescapexml(utf8read(J.formatCode)),ae=parseInt(J.numFmtId,10);if(A.NumberFmt[ae]=re,ae>0){if(ae>392){for(ae=392;ae>60&&A.NumberFmt[ae]!=null;--ae);A.NumberFmt[ae]=re}SSF_load(re,ae)}}break;case"</numFmt>":break;default:if(L.WTF)throw new Error("unrecognized "+J[0]+" in numFmts")}}}function write_numFmts(g){var A=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(L){for(var B=L[0];B<=L[1];++B)g[B]!=null&&(A[A.length]=writextag("numFmt",null,{numFmtId:B,formatCode:escapexml(g[B])}))}),A.length===1?"":(A[A.length]="</numFmts>",A[0]=writextag("numFmts",null,{count:A.length-2}).replace("/>",">"),A.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(g,A,L){A.CellXf=[];var B,W=!1;(g[0].match(tagregex)||[]).forEach(function(q){var J=parsexmltag(q),re=0;switch(strip_ns(J[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(B=J,delete B[0],re=0;re<cellXF_uint.length;++re)B[cellXF_uint[re]]&&(B[cellXF_uint[re]]=parseInt(B[cellXF_uint[re]],10));for(re=0;re<cellXF_bool.length;++re)B[cellXF_bool[re]]&&(B[cellXF_bool[re]]=parsexmlbool(B[cellXF_bool[re]]));if(A.NumberFmt&&B.numFmtId>392){for(re=392;re>60;--re)if(A.NumberFmt[B.numFmtId]==A.NumberFmt[re]){B.numFmtId=re;break}}A.CellXf.push(B);break;case"</xf>":break;case"<alignment":case"<alignment/>":var ae={};J.vertical&&(ae.vertical=J.vertical),J.horizontal&&(ae.horizontal=J.horizontal),J.textRotation!=null&&(ae.textRotation=J.textRotation),J.indent&&(ae.indent=J.indent),J.wrapText&&(ae.wrapText=parsexmlbool(J.wrapText)),B.alignment=ae;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":W=!0;break;case"</AlternateContent>":W=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":W=!0;break;case"</ext>":W=!1;break;default:if(L&&L.WTF&&!W)throw new Error("unrecognized "+J[0]+" in cellXfs")}})}function write_cellXfs(g){var A=[];return A[A.length]=writextag("cellXfs",null),g.forEach(function(L){A[A.length]=writextag("xf",null,L)}),A[A.length]="</cellXfs>",A.length===2?"":(A[0]=writextag("cellXfs",null,{count:A.length-2}).replace("/>",">"),A.join(""))}var parse_sty_xml=function g(){var A=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,L=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,B=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,W=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,q=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(re,ae,se){var ie={};if(!re)return ie;re=re.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var le;return(le=re.match(A))&&parse_numFmts(le,ie,se),(le=re.match(W))&&parse_fonts(le,ie,ae,se),(le=re.match(B))&&parse_fills(le,ie,ae,se),(le=re.match(q))&&parse_borders(le,ie,ae,se),(le=re.match(L))&&parse_cellXfs(le,ie,se),ie}}();function write_sty_xml(g,A){var L=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],B;return g.SSF&&(B=write_numFmts(g.SSF))!=null&&(L[L.length]=B),L[L.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',L[L.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',L[L.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',L[L.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(B=write_cellXfs(A.cellXfs))&&(L[L.length]=B),L[L.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',L[L.length]='<dxfs count="0"/>',L[L.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',L.length>2&&(L[L.length]="</styleSheet>",L[1]=L[1].replace("/>",">")),L.join("")}function parse_BrtFmt(g,A){var L=g.read_shift(2),B=parse_XLWideString(g);return[L,B]}function write_BrtFmt(g,A,L){L||(L=new_buf(6+4*A.length)),L.write_shift(2,g),write_XLWideString(A,L);var B=L.length>L.l?L.slice(0,L.l):L;return L.l==null&&(L.l=L.length),B}function parse_BrtFont(g,A,L){var B={};B.sz=g.read_shift(2)/20;var W=parse_FontFlags(g);W.fItalic&&(B.italic=1),W.fCondense&&(B.condense=1),W.fExtend&&(B.extend=1),W.fShadow&&(B.shadow=1),W.fOutline&&(B.outline=1),W.fStrikeout&&(B.strike=1);var q=g.read_shift(2);switch(q===700&&(B.bold=1),g.read_shift(2)){case 1:B.vertAlign="superscript";break;case 2:B.vertAlign="subscript";break}var J=g.read_shift(1);J!=0&&(B.underline=J);var re=g.read_shift(1);re>0&&(B.family=re);var ae=g.read_shift(1);switch(ae>0&&(B.charset=ae),g.l++,B.color=parse_BrtColor(g),g.read_shift(1)){case 1:B.scheme="major";break;case 2:B.scheme="minor";break}return B.name=parse_XLWideString(g),B}function write_BrtFont(g,A){A||(A=new_buf(25+4*32)),A.write_shift(2,g.sz*20),write_FontFlags(g,A),A.write_shift(2,g.bold?700:400);var L=0;g.vertAlign=="superscript"?L=1:g.vertAlign=="subscript"&&(L=2),A.write_shift(2,L),A.write_shift(1,g.underline||0),A.write_shift(1,g.family||0),A.write_shift(1,g.charset||0),A.write_shift(1,0),write_BrtColor(g.color,A);var B=0;return B=2,A.write_shift(1,B),write_XLWideString(g.name,A),A.length>A.l?A.slice(0,A.l):A}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(g,A){A||(A=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var L=rev_XLSBFillPTNames[g.patternType];L==null&&(L=40),A.write_shift(4,L);var B=0;if(L!=40)for(write_BrtColor({auto:1},A),write_BrtColor({auto:1},A);B<12;++B)A.write_shift(4,0);else{for(;B<4;++B)A.write_shift(4,0);for(;B<12;++B)A.write_shift(4,0)}return A.length>A.l?A.slice(0,A.l):A}function parse_BrtXF(g,A){var L=g.l+A,B=g.read_shift(2),W=g.read_shift(2);return g.l=L,{ixfe:B,numFmtId:W}}function write_BrtXF(g,A,L){L||(L=new_buf(16)),L.write_shift(2,A||0),L.write_shift(2,g.numFmtId||0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,0),L.write_shift(1,0);var B=0;return L.write_shift(1,B),L.write_shift(1,0),L.write_shift(1,0),L.write_shift(1,0),L}function write_Blxf(g,A){return A||(A=new_buf(10)),A.write_shift(1,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),A}var parse_BrtBorder=parsenoop;function write_BrtBorder(g,A){return A||(A=new_buf(51)),A.write_shift(1,0),write_Blxf(null,A),write_Blxf(null,A),write_Blxf(null,A),write_Blxf(null,A),write_Blxf(null,A),A.length>A.l?A.slice(0,A.l):A}function write_BrtStyle(g,A){return A||(A=new_buf(12+4*10)),A.write_shift(4,g.xfId),A.write_shift(2,1),A.write_shift(1,0),A.write_shift(1,0),write_XLNullableWideString(g.name||"",A),A.length>A.l?A.slice(0,A.l):A}function write_BrtBeginTableStyles(g,A,L){var B=new_buf(2052);return B.write_shift(4,g),write_XLNullableWideString(A,B),write_XLNullableWideString(L,B),B.length>B.l?B.slice(0,B.l):B}function parse_sty_bin(g,A,L){var B={};B.NumberFmt=[];for(var W in table_fmt)B.NumberFmt[W]=table_fmt[W];B.CellXf=[],B.Fonts=[];var q=[],J=!1;return recordhopper(g,function(ae,se,ie){switch(ie){case 44:B.NumberFmt[ae[0]]=ae[1],SSF_load(ae[1],ae[0]);break;case 43:B.Fonts.push(ae),ae.color.theme!=null&&A&&A.themeElements&&A.themeElements.clrScheme&&(ae.color.rgb=rgb_tint(A.themeElements.clrScheme[ae.color.theme].rgb,ae.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:q[q.length-1]==617&&B.CellXf.push(ae);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:J=!0;break;case 36:J=!1;break;case 37:q.push(ie),J=!0;break;case 38:q.pop(),J=!1;break;default:if(se.T>0)q.push(ie);else if(se.T<0)q.pop();else if(!J||L.WTF&&q[q.length-1]!=37)throw new Error("Unexpected record 0x"+ie.toString(16))}}),B}function write_FMTS_bin(g,A){if(A){var L=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(B){for(var W=B[0];W<=B[1];++W)A[W]!=null&&++L}),L!=0&&(write_record(g,615,write_UInt32LE(L)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(B){for(var W=B[0];W<=B[1];++W)A[W]!=null&&write_record(g,44,write_BrtFmt(W,A[W]))}),write_record(g,616))}}function write_FONTS_bin(g){var A=1;write_record(g,611,write_UInt32LE(A)),write_record(g,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(g,612)}function write_FILLS_bin(g){var A=2;write_record(g,603,write_UInt32LE(A)),write_record(g,45,write_BrtFill({patternType:"none"})),write_record(g,45,write_BrtFill({patternType:"gray125"})),write_record(g,604)}function write_BORDERS_bin(g){var A=1;write_record(g,613,write_UInt32LE(A)),write_record(g,46,write_BrtBorder()),write_record(g,614)}function write_CELLSTYLEXFS_bin(g){var A=1;write_record(g,626,write_UInt32LE(A)),write_record(g,47,write_BrtXF({numFmtId:0},65535)),write_record(g,627)}function write_CELLXFS_bin(g,A){write_record(g,617,write_UInt32LE(A.length)),A.forEach(function(L){write_record(g,47,write_BrtXF(L,0))}),write_record(g,618)}function write_STYLES_bin(g){var A=1;write_record(g,619,write_UInt32LE(A)),write_record(g,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(g,620)}function write_DXFS_bin(g){var A=0;write_record(g,505,write_UInt32LE(A)),write_record(g,506)}function write_TABLESTYLES_bin(g){var A=0;write_record(g,508,write_BrtBeginTableStyles(A,"TableStyleMedium9","PivotStyleMedium4")),write_record(g,509)}function write_sty_bin(g,A){var L=buf_array();return write_record(L,278),write_FMTS_bin(L,g.SSF),write_FONTS_bin(L),write_FILLS_bin(L),write_BORDERS_bin(L),write_CELLSTYLEXFS_bin(L),write_CELLXFS_bin(L,A.cellXfs),write_STYLES_bin(L),write_DXFS_bin(L),write_TABLESTYLES_bin(L),write_record(L,279),L.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(g,A,L){A.themeElements.clrScheme=[];var B={};(g[0].match(tagregex)||[]).forEach(function(W){var q=parsexmltag(W);switch(q[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":B.rgb=q.val;break;case"<a:sysClr":B.rgb=q.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":q[0].charAt(1)==="/"?(A.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(q[0])]=B,B={}):B.name=q[0].slice(3,q[0].length-1);break;default:if(L&&L.WTF)throw new Error("Unrecognized "+q[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(g,A,L){A.themeElements={};var B;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(W){if(!(B=g.match(W[1])))throw new Error(W[0]+" not found in themeElements");W[2](B,A,L)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(g,A){(!g||g.length===0)&&(g=write_theme());var L,B={};if(!(L=g.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(L[0],B,A),B.raw=g,B}function write_theme(g,A){if(A&&A.themeXLSX)return A.themeXLSX;if(g&&typeof g.raw=="string")return g.raw;var L=[XML_HEADER];return L[L.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',L[L.length]="<a:themeElements>",L[L.length]='<a:clrScheme name="Office">',L[L.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',L[L.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',L[L.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',L[L.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',L[L.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',L[L.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',L[L.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',L[L.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',L[L.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',L[L.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',L[L.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',L[L.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',L[L.length]="</a:clrScheme>",L[L.length]='<a:fontScheme name="Office">',L[L.length]="<a:majorFont>",L[L.length]='<a:latin typeface="Cambria"/>',L[L.length]='<a:ea typeface=""/>',L[L.length]='<a:cs typeface=""/>',L[L.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',L[L.length]='<a:font script="Hang" typeface="맑은 고딕"/>',L[L.length]='<a:font script="Hans" typeface="宋体"/>',L[L.length]='<a:font script="Hant" typeface="新細明體"/>',L[L.length]='<a:font script="Arab" typeface="Times New Roman"/>',L[L.length]='<a:font script="Hebr" typeface="Times New Roman"/>',L[L.length]='<a:font script="Thai" typeface="Tahoma"/>',L[L.length]='<a:font script="Ethi" typeface="Nyala"/>',L[L.length]='<a:font script="Beng" typeface="Vrinda"/>',L[L.length]='<a:font script="Gujr" typeface="Shruti"/>',L[L.length]='<a:font script="Khmr" typeface="MoolBoran"/>',L[L.length]='<a:font script="Knda" typeface="Tunga"/>',L[L.length]='<a:font script="Guru" typeface="Raavi"/>',L[L.length]='<a:font script="Cans" typeface="Euphemia"/>',L[L.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',L[L.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',L[L.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',L[L.length]='<a:font script="Thaa" typeface="MV Boli"/>',L[L.length]='<a:font script="Deva" typeface="Mangal"/>',L[L.length]='<a:font script="Telu" typeface="Gautami"/>',L[L.length]='<a:font script="Taml" typeface="Latha"/>',L[L.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',L[L.length]='<a:font script="Orya" typeface="Kalinga"/>',L[L.length]='<a:font script="Mlym" typeface="Kartika"/>',L[L.length]='<a:font script="Laoo" typeface="DokChampa"/>',L[L.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',L[L.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',L[L.length]='<a:font script="Viet" typeface="Times New Roman"/>',L[L.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',L[L.length]='<a:font script="Geor" typeface="Sylfaen"/>',L[L.length]="</a:majorFont>",L[L.length]="<a:minorFont>",L[L.length]='<a:latin typeface="Calibri"/>',L[L.length]='<a:ea typeface=""/>',L[L.length]='<a:cs typeface=""/>',L[L.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',L[L.length]='<a:font script="Hang" typeface="맑은 고딕"/>',L[L.length]='<a:font script="Hans" typeface="宋体"/>',L[L.length]='<a:font script="Hant" typeface="新細明體"/>',L[L.length]='<a:font script="Arab" typeface="Arial"/>',L[L.length]='<a:font script="Hebr" typeface="Arial"/>',L[L.length]='<a:font script="Thai" typeface="Tahoma"/>',L[L.length]='<a:font script="Ethi" typeface="Nyala"/>',L[L.length]='<a:font script="Beng" typeface="Vrinda"/>',L[L.length]='<a:font script="Gujr" typeface="Shruti"/>',L[L.length]='<a:font script="Khmr" typeface="DaunPenh"/>',L[L.length]='<a:font script="Knda" typeface="Tunga"/>',L[L.length]='<a:font script="Guru" typeface="Raavi"/>',L[L.length]='<a:font script="Cans" typeface="Euphemia"/>',L[L.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',L[L.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',L[L.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',L[L.length]='<a:font script="Thaa" typeface="MV Boli"/>',L[L.length]='<a:font script="Deva" typeface="Mangal"/>',L[L.length]='<a:font script="Telu" typeface="Gautami"/>',L[L.length]='<a:font script="Taml" typeface="Latha"/>',L[L.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',L[L.length]='<a:font script="Orya" typeface="Kalinga"/>',L[L.length]='<a:font script="Mlym" typeface="Kartika"/>',L[L.length]='<a:font script="Laoo" typeface="DokChampa"/>',L[L.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',L[L.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',L[L.length]='<a:font script="Viet" typeface="Arial"/>',L[L.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',L[L.length]='<a:font script="Geor" typeface="Sylfaen"/>',L[L.length]="</a:minorFont>",L[L.length]="</a:fontScheme>",L[L.length]='<a:fmtScheme name="Office">',L[L.length]="<a:fillStyleLst>",L[L.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',L[L.length]='<a:gradFill rotWithShape="1">',L[L.length]="<a:gsLst>",L[L.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',L[L.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',L[L.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',L[L.length]="</a:gsLst>",L[L.length]='<a:lin ang="16200000" scaled="1"/>',L[L.length]="</a:gradFill>",L[L.length]='<a:gradFill rotWithShape="1">',L[L.length]="<a:gsLst>",L[L.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',L[L.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',L[L.length]="</a:gsLst>",L[L.length]='<a:lin ang="16200000" scaled="0"/>',L[L.length]="</a:gradFill>",L[L.length]="</a:fillStyleLst>",L[L.length]="<a:lnStyleLst>",L[L.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',L[L.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',L[L.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',L[L.length]="</a:lnStyleLst>",L[L.length]="<a:effectStyleLst>",L[L.length]="<a:effectStyle>",L[L.length]="<a:effectLst>",L[L.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',L[L.length]="</a:effectLst>",L[L.length]="</a:effectStyle>",L[L.length]="<a:effectStyle>",L[L.length]="<a:effectLst>",L[L.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',L[L.length]="</a:effectLst>",L[L.length]="</a:effectStyle>",L[L.length]="<a:effectStyle>",L[L.length]="<a:effectLst>",L[L.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',L[L.length]="</a:effectLst>",L[L.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',L[L.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',L[L.length]="</a:effectStyle>",L[L.length]="</a:effectStyleLst>",L[L.length]="<a:bgFillStyleLst>",L[L.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',L[L.length]='<a:gradFill rotWithShape="1">',L[L.length]="<a:gsLst>",L[L.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',L[L.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',L[L.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',L[L.length]="</a:gsLst>",L[L.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',L[L.length]="</a:gradFill>",L[L.length]='<a:gradFill rotWithShape="1">',L[L.length]="<a:gsLst>",L[L.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',L[L.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',L[L.length]="</a:gsLst>",L[L.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',L[L.length]="</a:gradFill>",L[L.length]="</a:bgFillStyleLst>",L[L.length]="</a:fmtScheme>",L[L.length]="</a:themeElements>",L[L.length]="<a:objectDefaults>",L[L.length]="<a:spDef>",L[L.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',L[L.length]="</a:spDef>",L[L.length]="<a:lnDef>",L[L.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',L[L.length]="</a:lnDef>",L[L.length]="</a:objectDefaults>",L[L.length]="<a:extraClrSchemeLst/>",L[L.length]="</a:theme>",L.join("")}function parse_Theme(g,A,L){var B=g.l+A,W=g.read_shift(4);if(W!==124226){if(!L.cellStyles){g.l=B;return}var q=g.slice(g.l);g.l=B;var J;try{J=zip_read(q,{type:"array"})}catch{return}var re=getzipstr(J,"theme/theme/theme1.xml",!0);if(re)return parse_theme_xml(re,L)}}function parse_ColorTheme(g){return g.read_shift(4)}function parse_FullColorExt(g){var A={};switch(A.xclrType=g.read_shift(2),A.nTintShade=g.read_shift(2),A.xclrType){case 0:g.l+=4;break;case 1:A.xclrValue=parse_IcvXF(g,4);break;case 2:A.xclrValue=parse_LongRGBA(g);break;case 3:A.xclrValue=parse_ColorTheme(g);break;case 4:g.l+=4;break}return g.l+=8,A}function parse_IcvXF(g,A){return parsenoop(g,A)}function parse_XFExtGradient(g,A){return parsenoop(g,A)}function parse_ExtProp(g){var A=g.read_shift(2),L=g.read_shift(2)-4,B=[A];switch(A){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:B[1]=parse_FullColorExt(g);break;case 6:B[1]=parse_XFExtGradient(g,L);break;case 14:case 15:B[1]=g.read_shift(L===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+A+" "+L)}return B}function parse_XFExt(g,A){var L=g.l+A;g.l+=2;var B=g.read_shift(2);g.l+=2;for(var W=g.read_shift(2),q=[];W-- >0;)q.push(parse_ExtProp(g,L-g.l));return{ixfe:B,ext:q}}function update_xfext(g,A){A.forEach(function(L){L[0]})}function parse_BrtMdtinfo(g,A){return{flags:g.read_shift(4),version:g.read_shift(4),name:parse_XLWideString(g)}}function write_BrtMdtinfo(g){var A=new_buf(12+2*g.name.length);return A.write_shift(4,g.flags),A.write_shift(4,g.version),write_XLWideString(g.name,A),A.slice(0,A.l)}function parse_BrtMdb(g){for(var A=[],L=g.read_shift(4);L-- >0;)A.push([g.read_shift(4),g.read_shift(4)]);return A}function write_BrtMdb(g){var A=new_buf(4+8*g.length);A.write_shift(4,g.length);for(var L=0;L<g.length;++L)A.write_shift(4,g[L][0]),A.write_shift(4,g[L][1]);return A}function write_BrtBeginEsfmd(g,A){var L=new_buf(8+2*A.length);return L.write_shift(4,g),write_XLWideString(A,L),L.slice(0,L.l)}function parse_BrtBeginEsmdb(g){return g.l+=4,g.read_shift(4)!=0}function write_BrtBeginEsmdb(g,A){var L=new_buf(8);return L.write_shift(4,g),L.write_shift(4,1),L}function parse_xlmeta_bin(g,A,L){var B={Types:[],Cell:[],Value:[]},W=L||{},q=[],J=!1,re=2;return recordhopper(g,function(ae,se,ie){switch(ie){case 335:B.Types.push({name:ae.name});break;case 51:ae.forEach(function(le){re==1?B.Cell.push({type:B.Types[le[0]-1].name,index:le[1]}):re==0&&B.Value.push({type:B.Types[le[0]-1].name,index:le[1]})});break;case 337:re=ae?1:0;break;case 338:re=2;break;case 35:q.push(ie),J=!0;break;case 36:q.pop(),J=!1;break;default:if(!se.T){if(!J||W.WTF&&q[q.length-1]!=35)throw new Error("Unexpected record 0x"+ie.toString(16))}}}),B}function write_xlmeta_bin(){var g=buf_array();return write_record(g,332),write_record(g,334,write_UInt32LE(1)),write_record(g,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(g,336),write_record(g,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(g,52),write_record(g,35,write_UInt32LE(514)),write_record(g,4096,write_UInt32LE(0)),write_record(g,4097,writeuint16(1)),write_record(g,36),write_record(g,53),write_record(g,340),write_record(g,337,write_BrtBeginEsmdb(1)),write_record(g,51,write_BrtMdb([[1,0]])),write_record(g,338),write_record(g,333),g.end()}function parse_xlmeta_xml(g,A,L){var B={Types:[],Cell:[],Value:[]};if(!g)return B;var W=!1,q=2,J;return g.replace(tagregex,function(re){var ae=parsexmltag(re);switch(strip_ns(ae[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":B.Types.push({name:ae.name});break;case"</metadataType>":break;case"<futureMetadata":for(var se=0;se<B.Types.length;++se)B.Types[se].name==ae.name&&(J=B.Types[se]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":q==1?B.Cell.push({type:B.Types[ae.t-1].name,index:+ae.v}):q==0&&B.Value.push({type:B.Types[ae.t-1].name,index:+ae.v});break;case"</rc>":break;case"<cellMetadata":q=1;break;case"</cellMetadata>":q=2;break;case"<valueMetadata":q=0;break;case"</valueMetadata>":q=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":W=!0;break;case"</ext>":W=!1;break;case"<rvb":if(!J)break;J.offsets||(J.offsets=[]),J.offsets.push(+ae.i);break;default:if(!W&&L.WTF)throw new Error("unrecognized "+ae[0]+" in metadata")}return re}),B}function write_xlmeta_xml(){var g=[XML_HEADER];return g.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),g.join("")}function parse_cc_xml(g){var A=[];if(!g)return A;var L=1;return(g.match(tagregex)||[]).forEach(function(B){var W=parsexmltag(B);switch(W[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete W[0],W.i?L=W.i:W.i=L,A.push(W);break}}),A}function parse_BrtCalcChainItem$(g){var A={};A.i=g.read_shift(4);var L={};L.r=g.read_shift(4),L.c=g.read_shift(4),A.r=encode_cell(L);var B=g.read_shift(1);return B&2&&(A.l="1"),B&8&&(A.a="1"),A}function parse_cc_bin(g,A,L){var B=[];return recordhopper(g,function(q,J,re){switch(re){case 63:B.push(q);break;default:if(!J.T)throw new Error("Unexpected record 0x"+re.toString(16))}}),B}function parse_xlink_xml(){}function parse_xlink_bin(g,A,L,B){if(!g)return g;var W=B||{},q=!1;recordhopper(g,function(re,ae,se){switch(se){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:q=!0;break;case 36:q=!1;break;default:if(!ae.T){if(!q||W.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},W)}function parse_drawing(g,A){if(!g)return"??";var L=(g.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return A["!id"][L].Target}var _shapeid=1024;function write_comments_vml(g,A){for(var L=[21600,21600],B=["m0,0l0",L[1],L[0],L[1],L[0],"0xe"].join(","),W=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:g}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:L.join(","),path:B})];_shapeid<g*1e3;)_shapeid+=1e3;return A.forEach(function(q){var J=decode_cell(q[0]),re={color2:"#BEFF82",type:"gradient"};re.type=="gradient"&&(re.angle="-180");var ae=re.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,se=writextag("v:fill",ae,re),ie={on:"t",obscured:"t"};++_shapeid,W=W.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(q[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",se,writextag("v:shadow",null,ie),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[J.c+1,0,J.r+1,0,J.c+3,20,J.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(J.r)),writetag("x:Column",String(J.c)),q[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),W.push("</xml>"),W.join("")}function sheet_insert_comments(g,A,L,B){var W=Array.isArray(g),q;A.forEach(function(J){var re=decode_cell(J.ref);if(W?(g[re.r]||(g[re.r]=[]),q=g[re.r][re.c]):q=g[J.ref],!q){q={t:"z"},W?g[re.r][re.c]=q:g[J.ref]=q;var ae=safe_decode_range(g["!ref"]||"BDWGO1000001:A1");ae.s.r>re.r&&(ae.s.r=re.r),ae.e.r<re.r&&(ae.e.r=re.r),ae.s.c>re.c&&(ae.s.c=re.c),ae.e.c<re.c&&(ae.e.c=re.c);var se=encode_range(ae);se!==g["!ref"]&&(g["!ref"]=se)}q.c||(q.c=[]);var ie={a:J.author,t:J.t,r:J.r,T:L};J.h&&(ie.h=J.h);for(var le=q.c.length-1;le>=0;--le){if(!L&&q.c[le].T)return;L&&!q.c[le].T&&q.c.splice(le,1)}if(L&&B){for(le=0;le<B.length;++le)if(ie.a==B[le].id){ie.a=B[le].name||ie.a;break}}q.c.push(ie)})}function parse_comments_xml(g,A){if(g.match(/<(?:\w+:)?comments *\/>/))return[];var L=[],B=[],W=g.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);W&&W[1]&&W[1].split(/<\/\w*:?author>/).forEach(function(J){if(!(J===""||J.trim()==="")){var re=J.match(/<(?:\w+:)?author[^>]*>(.*)/);re&&L.push(re[1])}});var q=g.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return q&&q[1]&&q[1].split(/<\/\w*:?comment>/).forEach(function(J){if(!(J===""||J.trim()==="")){var re=J.match(/<(?:\w+:)?comment[^>]*>/);if(re){var ae=parsexmltag(re[0]),se={author:ae.authorId&&L[ae.authorId]||"sheetjsghost",ref:ae.ref,guid:ae.guid},ie=decode_cell(ae.ref);if(!(A.sheetRows&&A.sheetRows<=ie.r)){var le=J.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),pe=!!le&&!!le[1]&&parse_si(le[1])||{r:"",t:"",h:""};se.r=pe.r,pe.r=="<t></t>"&&(pe.t=pe.h=""),se.t=(pe.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),A.cellHTML&&(se.h=pe.h),B.push(se)}}}}),B}function write_comments_xml(g){var A=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],L=[];return A.push("<authors>"),g.forEach(function(B){B[1].forEach(function(W){var q=escapexml(W.a);L.indexOf(q)==-1&&(L.push(q),A.push("<author>"+q+"</author>")),W.T&&W.ID&&L.indexOf("tc="+W.ID)==-1&&(L.push("tc="+W.ID),A.push("<author>tc="+W.ID+"</author>"))})}),L.length==0&&(L.push("SheetJ5"),A.push("<author>SheetJ5</author>")),A.push("</authors>"),A.push("<commentList>"),g.forEach(function(B){var W=0,q=[];if(B[1][0]&&B[1][0].T&&B[1][0].ID?W=L.indexOf("tc="+B[1][0].ID):B[1].forEach(function(ae){ae.a&&(W=L.indexOf(escapexml(ae.a))),q.push(ae.t||"")}),A.push('<comment ref="'+B[0]+'" authorId="'+W+'"><text>'),q.length<=1)A.push(writetag("t",escapexml(q[0]||"")));else{for(var J=`Comment:
    `+q[0]+`
`,re=1;re<q.length;++re)J+=`Reply:
    `+q[re]+`
`;A.push(writetag("t",escapexml(J)))}A.push("</text></comment>")}),A.push("</commentList>"),A.length>2&&(A[A.length]="</comments>",A[1]=A[1].replace("/>",">")),A.join("")}function parse_tcmnt_xml(g,A){var L=[],B=!1,W={},q=0;return g.replace(tagregex,function(re,ae){var se=parsexmltag(re);switch(strip_ns(se[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":W={author:se.personId,guid:se.id,ref:se.ref,T:1};break;case"</threadedComment>":W.t!=null&&L.push(W);break;case"<text>":case"<text":q=ae+re.length;break;case"</text>":W.t=g.slice(q,ae).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":B=!0;break;case"</mentions>":B=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(!B&&A.WTF)throw new Error("unrecognized "+se[0]+" in threaded comments")}return re}),L}function write_tcmnt_xml(g,A,L){var B=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return g.forEach(function(W){var q="";(W[1]||[]).forEach(function(J,re){if(!J.T){delete J.ID;return}J.a&&A.indexOf(J.a)==-1&&A.push(J.a);var ae={ref:W[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+L.tcid++).slice(-12)+"}"};re==0?q=ae.id:ae.parentId=q,J.ID=ae.id,J.a&&(ae.personId="{54EE7950-7262-4200-6969-"+("000000000000"+A.indexOf(J.a)).slice(-12)+"}"),B.push(writextag("threadedComment",writetag("text",J.t||""),ae))})}),B.push("</ThreadedComments>"),B.join("")}function parse_people_xml(g,A){var L=[],B=!1;return g.replace(tagregex,function(q){var J=parsexmltag(q);switch(strip_ns(J[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":L.push({name:J.displayname,id:J.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(!B&&A.WTF)throw new Error("unrecognized "+J[0]+" in threaded comments")}return q}),L}function write_people_xml(g){var A=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return g.forEach(function(L,B){A.push(writextag("person",null,{displayName:L,id:"{54EE7950-7262-4200-6969-"+("000000000000"+B).slice(-12)+"}",userId:L,providerId:"None"}))}),A.push("</personList>"),A.join("")}function parse_BrtBeginComment(g){var A={};A.iauthor=g.read_shift(4);var L=parse_UncheckedRfX(g);return A.rfx=L.s,A.ref=encode_cell(L.s),g.l+=16,A}function write_BrtBeginComment(g,A){return A==null&&(A=new_buf(36)),A.write_shift(4,g[1].iauthor),write_UncheckedRfX(g[0],A),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(g){return write_XLWideString(g.slice(0,54))}function parse_comments_bin(g,A){var L=[],B=[],W={},q=!1;return recordhopper(g,function(re,ae,se){switch(se){case 632:B.push(re);break;case 635:W=re;break;case 637:W.t=re.t,W.h=re.h,W.r=re.r;break;case 636:if(W.author=B[W.iauthor],delete W.iauthor,A.sheetRows&&W.rfx&&A.sheetRows<=W.rfx.r)break;W.t||(W.t=""),delete W.rfx,L.push(W);break;case 3072:break;case 35:q=!0;break;case 36:q=!1;break;case 37:break;case 38:break;default:if(!ae.T){if(!q||A.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}}),L}function write_comments_bin(g){var A=buf_array(),L=[];return write_record(A,628),write_record(A,630),g.forEach(function(B){B[1].forEach(function(W){L.indexOf(W.a)>-1||(L.push(W.a.slice(0,54)),write_record(A,632,write_BrtCommentAuthor(W.a)))})}),write_record(A,631),write_record(A,633),g.forEach(function(B){B[1].forEach(function(W){W.iauthor=L.indexOf(W.a);var q={s:decode_cell(B[0]),e:decode_cell(B[0])};write_record(A,635,write_BrtBeginComment([q,W])),W.t&&W.t.length>0&&write_record(A,637,write_BrtCommentText(W)),write_record(A,636),delete W.iauthor})}),write_record(A,634),write_record(A,629),A.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(g){var A=CFB.utils.cfb_new({root:"R"});return g.FullPaths.forEach(function(L,B){if(!(L.slice(-1)==="/"||!L.match(/_VBA_PROJECT_CUR/))){var W=L.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(A,W,g.FileIndex[B].content)}}),CFB.write(A)}function fill_vba_xls(g,A){A.FullPaths.forEach(function(L,B){if(B!=0){var W=L.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");W.slice(-1)!=="/"&&CFB.utils.cfb_add(g,W,A.FileIndex[B].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var g=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,A={r:0,c:0};function L(B,W,q,J){var re=!1,ae=!1;q.length==0?ae=!0:q.charAt(0)=="["&&(ae=!0,q=q.slice(1,-1)),J.length==0?re=!0:J.charAt(0)=="["&&(re=!0,J=J.slice(1,-1));var se=q.length>0?parseInt(q,10)|0:0,ie=J.length>0?parseInt(J,10)|0:0;return re?ie+=A.c:--ie,ae?se+=A.r:--se,W+(re?"":"$")+encode_col(ie)+(ae?"":"$")+encode_row(se)}return function(W,q){return A=q,W.replace(g,L)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(A,L){return A.replace(crefregex,function(B,W,q,J,re,ae){var se=decode_col(J)-(q?0:L.c),ie=decode_row(ae)-(re?0:L.r),le=ie==0?"":re?ie+1:"["+ie+"]",pe=se==0?"":q?se+1:"["+se+"]";return W+"R"+le+"C"+pe})}}();function shift_formula_str(g,A){return g.replace(crefregex,function(L,B,W,q,J,re){return B+(W=="$"?W+q:encode_col(decode_col(q)+A.c))+(J=="$"?J+re:encode_row(decode_row(re)+A.r))})}function shift_formula_xlsx(g,A,L){var B=decode_range(A),W=B.s,q=decode_cell(L),J={r:q.r-W.r,c:q.c-W.c};return shift_formula_str(g,J)}function fuzzyfmla(g){return g.length!=1}function _xlfn(g){return g.replace(/_xlfn\./g,"")}function parseread1(g){g.l+=1}function parse_ColRelU(g,A){var L=g.read_shift(2);return[L&16383,L>>14&1,L>>15&1]}function parse_RgceArea(g,A,L){var B=2;if(L){if(L.biff>=2&&L.biff<=5)return parse_RgceArea_BIFF2(g);L.biff==12&&(B=4)}var W=g.read_shift(B),q=g.read_shift(B),J=parse_ColRelU(g),re=parse_ColRelU(g);return{s:{r:W,c:J[0],cRel:J[1],rRel:J[2]},e:{r:q,c:re[0],cRel:re[1],rRel:re[2]}}}function parse_RgceArea_BIFF2(g){var A=parse_ColRelU(g),L=parse_ColRelU(g),B=g.read_shift(1),W=g.read_shift(1);return{s:{r:A[0],c:B,cRel:A[1],rRel:A[2]},e:{r:L[0],c:W,cRel:L[1],rRel:L[2]}}}function parse_RgceAreaRel(g,A,L){if(L.biff<8)return parse_RgceArea_BIFF2(g);var B=g.read_shift(L.biff==12?4:2),W=g.read_shift(L.biff==12?4:2),q=parse_ColRelU(g),J=parse_ColRelU(g);return{s:{r:B,c:q[0],cRel:q[1],rRel:q[2]},e:{r:W,c:J[0],cRel:J[1],rRel:J[2]}}}function parse_RgceLoc(g,A,L){if(L&&L.biff>=2&&L.biff<=5)return parse_RgceLoc_BIFF2(g);var B=g.read_shift(L&&L.biff==12?4:2),W=parse_ColRelU(g);return{r:B,c:W[0],cRel:W[1],rRel:W[2]}}function parse_RgceLoc_BIFF2(g){var A=parse_ColRelU(g),L=g.read_shift(1);return{r:A[0],c:L,cRel:A[1],rRel:A[2]}}function parse_RgceElfLoc(g){var A=g.read_shift(2),L=g.read_shift(2);return{r:A,c:L&255,fQuoted:!!(L&16384),cRel:L>>15,rRel:L>>15}}function parse_RgceLocRel(g,A,L){var B=L&&L.biff?L.biff:8;if(B>=2&&B<=5)return parse_RgceLocRel_BIFF2(g);var W=g.read_shift(B>=12?4:2),q=g.read_shift(2),J=(q&16384)>>14,re=(q&32768)>>15;if(q&=16383,re==1)for(;W>524287;)W-=1048576;if(J==1)for(;q>8191;)q=q-16384;return{r:W,c:q,cRel:J,rRel:re}}function parse_RgceLocRel_BIFF2(g){var A=g.read_shift(2),L=g.read_shift(1),B=(A&32768)>>15,W=(A&16384)>>14;return A&=16383,B==1&&A>=8192&&(A=A-16384),W==1&&L>=128&&(L=L-256),{r:A,c:L,cRel:W,rRel:B}}function parse_PtgArea(g,A,L){var B=(g[g.l++]&96)>>5,W=parse_RgceArea(g,L.biff>=2&&L.biff<=5?6:8,L);return[B,W]}function parse_PtgArea3d(g,A,L){var B=(g[g.l++]&96)>>5,W=g.read_shift(2,"i"),q=8;if(L)switch(L.biff){case 5:g.l+=12,q=6;break;case 12:q=12;break}var J=parse_RgceArea(g,q,L);return[B,W,J]}function parse_PtgAreaErr(g,A,L){var B=(g[g.l++]&96)>>5;return g.l+=L&&L.biff>8?12:L.biff<8?6:8,[B]}function parse_PtgAreaErr3d(g,A,L){var B=(g[g.l++]&96)>>5,W=g.read_shift(2),q=8;if(L)switch(L.biff){case 5:g.l+=12,q=6;break;case 12:q=12;break}return g.l+=q,[B,W]}function parse_PtgAreaN(g,A,L){var B=(g[g.l++]&96)>>5,W=parse_RgceAreaRel(g,A-1,L);return[B,W]}function parse_PtgArray(g,A,L){var B=(g[g.l++]&96)>>5;return g.l+=L.biff==2?6:L.biff==12?14:7,[B]}function parse_PtgAttrBaxcel(g){var A=g[g.l+1]&1,L=1;return g.l+=4,[A,L]}function parse_PtgAttrChoose(g,A,L){g.l+=2;for(var B=g.read_shift(L&&L.biff==2?1:2),W=[],q=0;q<=B;++q)W.push(g.read_shift(L&&L.biff==2?1:2));return W}function parse_PtgAttrGoto(g,A,L){var B=g[g.l+1]&255?1:0;return g.l+=2,[B,g.read_shift(L&&L.biff==2?1:2)]}function parse_PtgAttrIf(g,A,L){var B=g[g.l+1]&255?1:0;return g.l+=2,[B,g.read_shift(L&&L.biff==2?1:2)]}function parse_PtgAttrIfError(g){var A=g[g.l+1]&255?1:0;return g.l+=2,[A,g.read_shift(2)]}function parse_PtgAttrSemi(g,A,L){var B=g[g.l+1]&255?1:0;return g.l+=L&&L.biff==2?3:4,[B]}function parse_PtgAttrSpaceType(g){var A=g.read_shift(1),L=g.read_shift(1);return[A,L]}function parse_PtgAttrSpace(g){return g.read_shift(2),parse_PtgAttrSpaceType(g)}function parse_PtgAttrSpaceSemi(g){return g.read_shift(2),parse_PtgAttrSpaceType(g)}function parse_PtgRef(g,A,L){var B=(g[g.l]&96)>>5;g.l+=1;var W=parse_RgceLoc(g,0,L);return[B,W]}function parse_PtgRefN(g,A,L){var B=(g[g.l]&96)>>5;g.l+=1;var W=parse_RgceLocRel(g,0,L);return[B,W]}function parse_PtgRef3d(g,A,L){var B=(g[g.l]&96)>>5;g.l+=1;var W=g.read_shift(2);L&&L.biff==5&&(g.l+=12);var q=parse_RgceLoc(g,0,L);return[B,W,q]}function parse_PtgFunc(g,A,L){var B=(g[g.l]&96)>>5;g.l+=1;var W=g.read_shift(L&&L.biff<=3?1:2);return[FtabArgc[W],Ftab[W],B]}function parse_PtgFuncVar(g,A,L){var B=g[g.l++],W=g.read_shift(1),q=L&&L.biff<=3?[B==88?-1:0,g.read_shift(1)]:parsetab(g);return[W,(q[0]===0?Ftab:Cetab)[q[1]]]}function parsetab(g){return[g[g.l+1]>>7,g.read_shift(2)&32767]}function parse_PtgAttrSum(g,A,L){g.l+=L&&L.biff==2?3:4}function parse_PtgExp(g,A,L){if(g.l++,L&&L.biff==12)return[g.read_shift(4,"i"),0];var B=g.read_shift(2),W=g.read_shift(L&&L.biff==2?1:2);return[B,W]}function parse_PtgErr(g){return g.l++,BErr[g.read_shift(1)]}function parse_PtgInt(g){return g.l++,g.read_shift(2)}function parse_PtgBool(g){return g.l++,g.read_shift(1)!==0}function parse_PtgNum(g){return g.l++,parse_Xnum(g)}function parse_PtgStr(g,A,L){return g.l++,parse_ShortXLUnicodeString(g,A-1,L)}function parse_SerAr(g,A){var L=[g.read_shift(1)];if(A==12)switch(L[0]){case 2:L[0]=4;break;case 4:L[0]=16;break;case 0:L[0]=1;break;case 1:L[0]=2;break}switch(L[0]){case 4:L[1]=parsebool(g,1)?"TRUE":"FALSE",A!=12&&(g.l+=7);break;case 37:case 16:L[1]=BErr[g[g.l]],g.l+=A==12?4:8;break;case 0:g.l+=8;break;case 1:L[1]=parse_Xnum(g);break;case 2:L[1]=parse_XLUnicodeString2(g,0,{biff:A>0&&A<8?2:A});break;default:throw new Error("Bad SerAr: "+L[0])}return L}function parse_PtgExtraMem(g,A,L){for(var B=g.read_shift(L.biff==12?4:2),W=[],q=0;q!=B;++q)W.push((L.biff==12?parse_UncheckedRfX:parse_Ref8U)(g));return W}function parse_PtgExtraArray(g,A,L){var B=0,W=0;L.biff==12?(B=g.read_shift(4),W=g.read_shift(4)):(W=1+g.read_shift(1),B=1+g.read_shift(2)),L.biff>=2&&L.biff<8&&(--B,--W==0&&(W=256));for(var q=0,J=[];q!=B&&(J[q]=[]);++q)for(var re=0;re!=W;++re)J[q][re]=parse_SerAr(g,L.biff);return J}function parse_PtgName(g,A,L){var B=g.read_shift(1)>>>5&3,W=!L||L.biff>=8?4:2,q=g.read_shift(W);switch(L.biff){case 2:g.l+=5;break;case 3:case 4:g.l+=8;break;case 5:g.l+=12;break}return[B,0,q]}function parse_PtgNameX(g,A,L){if(L.biff==5)return parse_PtgNameX_BIFF5(g);var B=g.read_shift(1)>>>5&3,W=g.read_shift(2),q=g.read_shift(4);return[B,W,q]}function parse_PtgNameX_BIFF5(g){var A=g.read_shift(1)>>>5&3,L=g.read_shift(2,"i");g.l+=8;var B=g.read_shift(2);return g.l+=12,[A,L,B]}function parse_PtgMemArea(g,A,L){var B=g.read_shift(1)>>>5&3;g.l+=L&&L.biff==2?3:4;var W=g.read_shift(L&&L.biff==2?1:2);return[B,W]}function parse_PtgMemFunc(g,A,L){var B=g.read_shift(1)>>>5&3,W=g.read_shift(L&&L.biff==2?1:2);return[B,W]}function parse_PtgRefErr(g,A,L){var B=g.read_shift(1)>>>5&3;return g.l+=4,L.biff<8&&g.l--,L.biff==12&&(g.l+=2),[B]}function parse_PtgRefErr3d(g,A,L){var B=(g[g.l++]&96)>>5,W=g.read_shift(2),q=4;if(L)switch(L.biff){case 5:q=15;break;case 12:q=6;break}return g.l+=q,[B,W]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(g,A,L){return g.l+=2,[parse_RgceElfLoc(g)]}function parse_PtgElfNoop(g){return g.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(g){return g.l+=2,[parseuint16(g),g.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(g){g.l+=2;var A=g.read_shift(2),L=g.read_shift(2),B=g.read_shift(4),W=g.read_shift(2),q=g.read_shift(2),J=PtgListRT[L>>2&31];return{ixti:A,coltype:L&3,rt:J,idx:B,c:W,C:q}}function parse_PtgSxName(g){return g.l+=2,[g.read_shift(4)]}function parse_PtgSheet(g,A,L){return g.l+=5,g.l+=2,g.l+=L.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(g,A,L){return g.l+=L.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(g){var A=g.read_shift(1)>>>5&3,L=g.read_shift(2);return[A,L]}function parse_PtgMemNoMemN(g){var A=g.read_shift(1)>>>5&3,L=g.read_shift(2);return[A,L]}function parse_PtgAttrNoop(g){return g.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(g,A,L,B){if(B.biff<8)return parsenoop(g,A);for(var W=g.l+A,q=[],J=0;J!==L.length;++J)switch(L[J][0]){case"PtgArray":L[J][1]=parse_PtgExtraArray(g,0,B),q.push(L[J][1]);break;case"PtgMemArea":L[J][2]=parse_PtgExtraMem(g,L[J][1],B),q.push(L[J][2]);break;case"PtgExp":B&&B.biff==12&&(L[J][1][1]=g.read_shift(4),q.push(L[J][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+L[J][0]}return A=W-g.l,A!==0&&q.push(parsenoop(g,A)),q}function parse_Rgce(g,A,L){for(var B=g.l+A,W,q,J=[];B!=g.l;)A=B-g.l,q=g[g.l],W=PtgTypes[q]||PtgTypes[PtgDupes[q]],(q===24||q===25)&&(W=(q===24?Ptg18:Ptg19)[g[g.l+1]]),!W||!W.f?parsenoop(g,A):J.push([W.n,W.f(g,A,L)]);return J}function stringify_array(g){for(var A=[],L=0;L<g.length;++L){for(var B=g[L],W=[],q=0;q<B.length;++q){var J=B[q];if(J)switch(J[0]){case 2:W.push('"'+J[1].replace(/"/g,'""')+'"');break;default:W.push(J[1])}else W.push("")}A.push(W.join(","))}return A.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(g,A){if(!g&&!(A&&A.biff<=5&&A.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(g)?"'"+g+"'":g}function get_ixti_raw(g,A,L){if(!g)return"SH33TJSERR0";if(L.biff>8&&(!g.XTI||!g.XTI[A]))return g.SheetNames[A];if(!g.XTI)return"SH33TJSERR6";var B=g.XTI[A];if(L.biff<8)return A>1e4&&(A-=65536),A<0&&(A=-A),A==0?"":g.XTI[A-1];if(!B)return"SH33TJSERR1";var W="";if(L.biff>8)switch(g[B[0]][0]){case 357:return W=B[1]==-1?"#REF":g.SheetNames[B[1]],B[1]==B[2]?W:W+":"+g.SheetNames[B[2]];case 358:return L.SID!=null?g.SheetNames[L.SID]:"SH33TJSSAME"+g[B[0]][0];case 355:default:return"SH33TJSSRC"+g[B[0]][0]}switch(g[B[0]][0][0]){case 1025:return W=B[1]==-1?"#REF":g.SheetNames[B[1]]||"SH33TJSERR3",B[1]==B[2]?W:W+":"+g.SheetNames[B[2]];case 14849:return g[B[0]].slice(1).map(function(q){return q.Name}).join(";;");default:return g[B[0]][0][3]?(W=B[1]==-1?"#REF":g[B[0]][0][3][B[1]]||"SH33TJSERR4",B[1]==B[2]?W:W+":"+g[B[0]][0][3][B[2]]):"SH33TJSERR2"}}function get_ixti(g,A,L){var B=get_ixti_raw(g,A,L);return B=="#REF"?B:formula_quote_sheet_name(B,L)}function stringify_formula(g,A,L,B,W){var q=W&&W.biff||8,J={s:{c:0,r:0}},re=[],ae,se,ie,le=0,pe=0,he,ue="";if(!g[0]||!g[0][0])return"";for(var ce=-1,fe="",me=0,ke=g[0].length;me<ke;++me){var xe=g[0][me];switch(xe[0]){case"PtgUminus":re.push("-"+re.pop());break;case"PtgUplus":re.push("+"+re.pop());break;case"PtgPercent":re.push(re.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(ae=re.pop(),se=re.pop(),ce>=0){switch(g[0][ce][1][0]){case 0:fe=fill(" ",g[0][ce][1][1]);break;case 1:fe=fill("\r",g[0][ce][1][1]);break;default:if(fe="",W.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[0][ce][1][0])}se=se+fe,ce=-1}re.push(se+PtgBinOp[xe[0]]+ae);break;case"PtgIsect":ae=re.pop(),se=re.pop(),re.push(se+" "+ae);break;case"PtgUnion":ae=re.pop(),se=re.pop(),re.push(se+","+ae);break;case"PtgRange":ae=re.pop(),se=re.pop(),re.push(se+":"+ae);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":ie=shift_cell_xls(xe[1][1],J,W),re.push(encode_cell_xls(ie,q));break;case"PtgRefN":ie=L?shift_cell_xls(xe[1][1],L,W):xe[1][1],re.push(encode_cell_xls(ie,q));break;case"PtgRef3d":le=xe[1][1],ie=shift_cell_xls(xe[1][2],J,W),ue=get_ixti(B,le,W),re.push(ue+"!"+encode_cell_xls(ie,q));break;case"PtgFunc":case"PtgFuncVar":var Le=xe[1][0],Se=xe[1][1];Le||(Le=0),Le&=127;var Te=Le==0?[]:re.slice(-Le);re.length-=Le,Se==="User"&&(Se=Te.shift()),re.push(Se+"("+Te.join(",")+")");break;case"PtgBool":re.push(xe[1]?"TRUE":"FALSE");break;case"PtgInt":re.push(xe[1]);break;case"PtgNum":re.push(String(xe[1]));break;case"PtgStr":re.push('"'+xe[1].replace(/"/g,'""')+'"');break;case"PtgErr":re.push(xe[1]);break;case"PtgAreaN":he=shift_range_xls(xe[1][1],L?{s:L}:J,W),re.push(encode_range_xls(he,W));break;case"PtgArea":he=shift_range_xls(xe[1][1],J,W),re.push(encode_range_xls(he,W));break;case"PtgArea3d":le=xe[1][1],he=xe[1][2],ue=get_ixti(B,le,W),re.push(ue+"!"+encode_range_xls(he,W));break;case"PtgAttrSum":re.push("SUM("+re.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":pe=xe[1][2];var ge=(B.names||[])[pe-1]||(B[0]||[])[pe],Ce=ge?ge.Name:"SH33TJSNAME"+String(pe);Ce&&Ce.slice(0,6)=="_xlfn."&&!W.xlfn&&(Ce=Ce.slice(6)),re.push(Ce);break;case"PtgNameX":var be=xe[1][1];pe=xe[1][2];var nt;if(W.biff<=5)be<0&&(be=-be),B[be]&&(nt=B[be][pe]);else{var Ae="";if(((B[be]||[])[0]||[])[0]==14849||(((B[be]||[])[0]||[])[0]==1025?B[be][pe]&&B[be][pe].itab>0&&(Ae=B.SheetNames[B[be][pe].itab-1]+"!"):Ae=B.SheetNames[pe-1]+"!"),B[be]&&B[be][pe])Ae+=B[be][pe].Name;else if(B[0]&&B[0][pe])Ae+=B[0][pe].Name;else{var De=(get_ixti_raw(B,be,W)||"").split(";;");De[pe-1]?Ae=De[pe-1]:Ae+="SH33TJSERRX"}re.push(Ae);break}nt||(nt={Name:"SH33TJSERRY"}),re.push(nt.Name);break;case"PtgParen":var lt="(",Ct=")";if(ce>=0){switch(fe="",g[0][ce][1][0]){case 2:lt=fill(" ",g[0][ce][1][1])+lt;break;case 3:lt=fill("\r",g[0][ce][1][1])+lt;break;case 4:Ct=fill(" ",g[0][ce][1][1])+Ct;break;case 5:Ct=fill("\r",g[0][ce][1][1])+Ct;break;default:if(W.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[0][ce][1][0])}ce=-1}re.push(lt+re.pop()+Ct);break;case"PtgRefErr":re.push("#REF!");break;case"PtgRefErr3d":re.push("#REF!");break;case"PtgExp":ie={c:xe[1][1],r:xe[1][0]};var ft={c:L.c,r:L.r};if(B.sharedf[encode_cell(ie)]){var Et=B.sharedf[encode_cell(ie)];re.push(stringify_formula(Et,J,ft,B,W))}else{var gt=!1;for(ae=0;ae!=B.arrayf.length;++ae)if(se=B.arrayf[ae],!(ie.c<se[0].s.c||ie.c>se[0].e.c)&&!(ie.r<se[0].s.r||ie.r>se[0].e.r)){re.push(stringify_formula(se[1],J,ft,B,W)),gt=!0;break}gt||re.push(xe[1])}break;case"PtgArray":re.push("{"+stringify_array(xe[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":ce=me;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":re.push("");break;case"PtgAreaErr":re.push("#REF!");break;case"PtgAreaErr3d":re.push("#REF!");break;case"PtgList":re.push("Table"+xe[1].idx+"[#"+xe[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(xe));default:throw new Error("Unrecognized Formula Token: "+String(xe))}var bt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(W.biff!=3&&ce>=0&&bt.indexOf(g[0][me][0])==-1){xe=g[0][ce];var Ie=!0;switch(xe[1][0]){case 4:Ie=!1;case 0:fe=fill(" ",xe[1][1]);break;case 5:Ie=!1;case 1:fe=fill("\r",xe[1][1]);break;default:if(fe="",W.WTF)throw new Error("Unexpected PtgAttrSpaceType "+xe[1][0])}re.push((Ie?fe:"")+re.pop()+(Ie?"":fe)),ce=-1}}if(re.length>1&&W.WTF)throw new Error("bad formula stack");return re[0]}function parse_ArrayParsedFormula(g,A,L){var B=g.l+A,W=L.biff==2?1:2,q,J=g.read_shift(W);if(J==65535)return[[],parsenoop(g,A-2)];var re=parse_Rgce(g,J,L);return A!==J+W&&(q=parse_RgbExtra(g,A-J-W,re,L)),g.l=B,[re,q]}function parse_XLSCellParsedFormula(g,A,L){var B=g.l+A,W=L.biff==2?1:2,q,J=g.read_shift(W);if(J==65535)return[[],parsenoop(g,A-2)];var re=parse_Rgce(g,J,L);return A!==J+W&&(q=parse_RgbExtra(g,A-J-W,re,L)),g.l=B,[re,q]}function parse_NameParsedFormula(g,A,L,B){var W=g.l+A,q=parse_Rgce(g,B,L),J;return W!==g.l&&(J=parse_RgbExtra(g,W-g.l,q,L)),[q,J]}function parse_SharedParsedFormula(g,A,L){var B=g.l+A,W,q=g.read_shift(2),J=parse_Rgce(g,q,L);return q==65535?[[],parsenoop(g,A-2)]:(A!==q+2&&(W=parse_RgbExtra(g,B-q-2,J,L)),[J,W])}function parse_FormulaValue(g){var A;if(__readUInt16LE(g,g.l+6)!==65535)return[parse_Xnum(g),"n"];switch(g[g.l]){case 0:return g.l+=8,["String","s"];case 1:return A=g[g.l+2]===1,g.l+=8,[A,"b"];case 2:return A=g[g.l+2],g.l+=8,[A,"e"];case 3:return g.l+=8,["","s"]}return[]}function write_FormulaValue(g){if(g==null){var A=new_buf(8);return A.write_shift(1,3),A.write_shift(1,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,65535),A}else if(typeof g=="number")return write_Xnum(g);return write_Xnum(0)}function parse_Formula(g,A,L){var B=g.l+A,W=parse_XLSCell(g);L.biff==2&&++g.l;var q=parse_FormulaValue(g),J=g.read_shift(1);L.biff!=2&&(g.read_shift(1),L.biff>=5&&g.read_shift(4));var re=parse_XLSCellParsedFormula(g,B-g.l,L);return{cell:W,val:q[0],formula:re,shared:J>>3&1,tt:q[1]}}function write_Formula(g,A,L,B,W){var q=write_XLSCell(A,L,W),J=write_FormulaValue(g.v),re=new_buf(6),ae=33;re.write_shift(2,ae),re.write_shift(4,0);for(var se=new_buf(g.bf.length),ie=0;ie<g.bf.length;++ie)se[ie]=g.bf[ie];var le=bconcat([q,J,re,se]);return le}function parse_XLSBParsedFormula(g,A,L){var B=g.read_shift(4),W=parse_Rgce(g,B,L),q=g.read_shift(4),J=q>0?parse_RgbExtra(g,q,W,L):null;return[W,J]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(g){return g.slice(0,3)=="of:"&&(g=g.slice(3)),g.charCodeAt(0)==61&&(g=g.slice(1),g.charCodeAt(0)==61&&(g=g.slice(1))),g=g.replace(/COM\.MICROSOFT\./g,""),g=g.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(A,L){return L.replace(/\./g,"")}),g=g.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),g.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(g){var A="of:="+g.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return A.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(g){var A=g.split(":"),L=A[0].split(".")[0];return[L,A[0].split(".")[1]+(A.length>1?":"+(A[1].split(".")[1]||A[1].split(".")[0]):"")]}function csf_to_ods_3D(g){return g.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(g,A,L){var B=0,W=g.length;if(L){if(browser_has_Map?L.has(A):Object.prototype.hasOwnProperty.call(L,A)){for(var q=browser_has_Map?L.get(A):L[A];B<q.length;++B)if(g[q[B]].t===A)return g.Count++,q[B]}}else for(;B<W;++B)if(g[B].t===A)return g.Count++,B;return g[W]={t:A},g.Count++,g.Unique++,L&&(browser_has_Map?(L.has(A)||L.set(A,[]),L.get(A).push(W)):(Object.prototype.hasOwnProperty.call(L,A)||(L[A]=[]),L[A].push(W))),W}function col_obj_w(g,A){var L={min:g+1,max:g+1},B=-1;return A.MDW&&(MDW=A.MDW),A.width!=null?L.customWidth=1:A.wpx!=null?B=px2char(A.wpx):A.wch!=null&&(B=A.wch),B>-1?(L.width=char2width(B),L.customWidth=1):A.width!=null&&(L.width=A.width),A.hidden&&(L.hidden=!0),A.level!=null&&(L.outlineLevel=L.level=A.level),L}function default_margins(g,A){if(g){var L=[.7,.7,.75,.75,.3,.3];A=="xlml"&&(L=[1,1,1,1,.5,.5]),g.left==null&&(g.left=L[0]),g.right==null&&(g.right=L[1]),g.top==null&&(g.top=L[2]),g.bottom==null&&(g.bottom=L[3]),g.header==null&&(g.header=L[4]),g.footer==null&&(g.footer=L[5])}}function get_cell_style(g,A,L){var B=L.revssf[A.z!=null?A.z:"General"],W=60,q=g.length;if(B==null&&L.ssf){for(;W<392;++W)if(L.ssf[W]==null){SSF_load(A.z,W),L.ssf[W]=A.z,L.revssf[A.z]=B=W;break}}for(W=0;W!=q;++W)if(g[W].numFmtId===B)return W;return g[q]={numFmtId:B,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},q}function safe_format(g,A,L,B,W,q){try{B.cellNF&&(g.z=table_fmt[A])}catch(re){if(B.WTF)throw re}if(!(g.t==="z"&&!B.cellStyles)){if(g.t==="d"&&typeof g.v=="string"&&(g.v=parseDate(g.v)),(!B||B.cellText!==!1)&&g.t!=="z")try{if(table_fmt[A]==null&&SSF_load(SSFImplicit[A]||"General",A),g.t==="e")g.w=g.w||BErr[g.v];else if(A===0)if(g.t==="n")(g.v|0)===g.v?g.w=g.v.toString(10):g.w=SSF_general_num(g.v);else if(g.t==="d"){var J=datenum(g.v);(J|0)===J?g.w=J.toString(10):g.w=SSF_general_num(J)}else{if(g.v===void 0)return"";g.w=SSF_general(g.v,_ssfopts)}else g.t==="d"?g.w=SSF_format(A,datenum(g.v),_ssfopts):g.w=SSF_format(A,g.v,_ssfopts)}catch(re){if(B.WTF)throw re}if(B.cellStyles&&L!=null)try{g.s=q.Fills[L],g.s.fgColor&&g.s.fgColor.theme&&!g.s.fgColor.rgb&&(g.s.fgColor.rgb=rgb_tint(W.themeElements.clrScheme[g.s.fgColor.theme].rgb,g.s.fgColor.tint||0),B.WTF&&(g.s.fgColor.raw_rgb=W.themeElements.clrScheme[g.s.fgColor.theme].rgb)),g.s.bgColor&&g.s.bgColor.theme&&(g.s.bgColor.rgb=rgb_tint(W.themeElements.clrScheme[g.s.bgColor.theme].rgb,g.s.bgColor.tint||0),B.WTF&&(g.s.bgColor.raw_rgb=W.themeElements.clrScheme[g.s.bgColor.theme].rgb))}catch(re){if(B.WTF&&q.Fills)throw re}}}function check_ws(g,A,L){if(g&&g["!ref"]){var B=safe_decode_range(g["!ref"]);if(B.e.c<B.s.c||B.e.r<B.s.r)throw new Error("Bad range ("+L+"): "+g["!ref"])}}function parse_ws_xml_dim(g,A){var L=safe_decode_range(A);L.s.r<=L.e.r&&L.s.c<=L.e.c&&L.s.r>=0&&L.s.c>=0&&(g["!ref"]=encode_range(L))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(g,A,L,B,W,q,J){if(!g)return g;B||(B={"!id":{}});var re=A.dense?[]:{},ae={s:{r:2e6,c:2e6},e:{r:0,c:0}},se="",ie="",le=g.match(sheetdataregex);le?(se=g.slice(0,le.index),ie=g.slice(le.index+le[0].length)):se=ie=g;var pe=se.match(sheetprregex);pe?parse_ws_xml_sheetpr(pe[0],re,W,L):(pe=se.match(sheetprregex2))&&parse_ws_xml_sheetpr2(pe[0],pe[1]||"",re,W,L);var he=(se.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(he>0){var ue=se.slice(he,he+50).match(dimregex);ue&&parse_ws_xml_dim(re,ue[1])}var ce=se.match(svsregex);ce&&ce[1]&&parse_ws_xml_sheetviews(ce[1],W);var fe=[];if(A.cellStyles){var me=se.match(colregex);me&&parse_ws_xml_cols(fe,me)}le&&parse_ws_xml_data(le[1],re,A,ae,q,J);var ke=ie.match(afregex);ke&&(re["!autofilter"]=parse_ws_xml_autofilter(ke[0]));var xe=[],Le=ie.match(mergecregex);if(Le)for(he=0;he!=Le.length;++he)xe[he]=safe_decode_range(Le[he].slice(Le[he].indexOf('"')+1));var Se=ie.match(hlinkregex);Se&&parse_ws_xml_hlinks(re,Se,B);var Te=ie.match(marginregex);if(Te&&(re["!margins"]=parse_ws_xml_margins(parsexmltag(Te[0]))),!re["!ref"]&&ae.e.c>=ae.s.c&&ae.e.r>=ae.s.r&&(re["!ref"]=encode_range(ae)),A.sheetRows>0&&re["!ref"]){var ge=safe_decode_range(re["!ref"]);A.sheetRows<=+ge.e.r&&(ge.e.r=A.sheetRows-1,ge.e.r>ae.e.r&&(ge.e.r=ae.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>ae.e.c&&(ge.e.c=ae.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),re["!fullref"]=re["!ref"],re["!ref"]=encode_range(ge))}return fe.length>0&&(re["!cols"]=fe),xe.length>0&&(re["!merges"]=xe),re}function write_ws_xml_merges(g){if(g.length===0)return"";for(var A='<mergeCells count="'+g.length+'">',L=0;L!=g.length;++L)A+='<mergeCell ref="'+encode_range(g[L])+'"/>';return A+"</mergeCells>"}function parse_ws_xml_sheetpr(g,A,L,B){var W=parsexmltag(g);L.Sheets[B]||(L.Sheets[B]={}),W.codeName&&(L.Sheets[B].CodeName=unescapexml(utf8read(W.codeName)))}function parse_ws_xml_sheetpr2(g,A,L,B,W){parse_ws_xml_sheetpr(g.slice(0,g.indexOf(">")),L,B,W)}function write_ws_xml_sheetpr(g,A,L,B,W){var q=!1,J={},re=null;if(B.bookType!=="xlsx"&&A.vbaraw){var ae=A.SheetNames[L];try{A.Workbook&&(ae=A.Workbook.Sheets[L].CodeName||ae)}catch{}q=!0,J.codeName=utf8write(escapexml(ae))}if(g&&g["!outline"]){var se={summaryBelow:1,summaryRight:1};g["!outline"].above&&(se.summaryBelow=0),g["!outline"].left&&(se.summaryRight=0),re=(re||"")+writextag("outlinePr",null,se)}!q&&!re||(W[W.length]=writextag("sheetPr",re,J))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(g){var A={sheet:1};return sheetprot_deffalse.forEach(function(L){g[L]!=null&&g[L]&&(A[L]="1")}),sheetprot_deftrue.forEach(function(L){g[L]!=null&&!g[L]&&(A[L]="0")}),g.password&&(A.password=crypto_CreatePasswordVerifier_Method1(g.password).toString(16).toUpperCase()),writextag("sheetProtection",null,A)}function parse_ws_xml_hlinks(g,A,L){for(var B=Array.isArray(g),W=0;W!=A.length;++W){var q=parsexmltag(utf8read(A[W]),!0);if(!q.ref)return;var J=((L||{})["!id"]||[])[q.id];J?(q.Target=J.Target,q.location&&(q.Target+="#"+unescapexml(q.location))):(q.Target="#"+unescapexml(q.location),J={Target:q.Target,TargetMode:"Internal"}),q.Rel=J,q.tooltip&&(q.Tooltip=q.tooltip,delete q.tooltip);for(var re=safe_decode_range(q.ref),ae=re.s.r;ae<=re.e.r;++ae)for(var se=re.s.c;se<=re.e.c;++se){var ie=encode_cell({c:se,r:ae});B?(g[ae]||(g[ae]=[]),g[ae][se]||(g[ae][se]={t:"z",v:void 0}),g[ae][se].l=q):(g[ie]||(g[ie]={t:"z",v:void 0}),g[ie].l=q)}}}function parse_ws_xml_margins(g){var A={};return["left","right","top","bottom","header","footer"].forEach(function(L){g[L]&&(A[L]=parseFloat(g[L]))}),A}function write_ws_xml_margins(g){return default_margins(g),writextag("pageMargins",null,g)}function parse_ws_xml_cols(g,A){for(var L=!1,B=0;B!=A.length;++B){var W=parsexmltag(A[B],!0);W.hidden&&(W.hidden=parsexmlbool(W.hidden));var q=parseInt(W.min,10)-1,J=parseInt(W.max,10)-1;for(W.outlineLevel&&(W.level=+W.outlineLevel||0),delete W.min,delete W.max,W.width=+W.width,!L&&W.width&&(L=!0,find_mdw_colw(W.width)),process_col(W);q<=J;)g[q++]=dup(W)}}function write_ws_xml_cols(g,A){for(var L=["<cols>"],B,W=0;W!=A.length;++W)(B=A[W])&&(L[L.length]=writextag("col",null,col_obj_w(W,B)));return L[L.length]="</cols>",L.join("")}function parse_ws_xml_autofilter(g){var A={ref:(g.match(/ref="([^"]*)"/)||[])[1]};return A}function write_ws_xml_autofilter(g,A,L,B){var W=typeof g.ref=="string"?g.ref:encode_range(g.ref);L.Workbook||(L.Workbook={Sheets:[]}),L.Workbook.Names||(L.Workbook.Names=[]);var q=L.Workbook.Names,J=decode_range(W);J.s.r==J.e.r&&(J.e.r=decode_range(A["!ref"]).e.r,W=encode_range(J));for(var re=0;re<q.length;++re){var ae=q[re];if(ae.Name=="_xlnm._FilterDatabase"&&ae.Sheet==B){ae.Ref="'"+L.SheetNames[B]+"'!"+W;break}}return re==q.length&&q.push({Name:"_xlnm._FilterDatabase",Sheet:B,Ref:"'"+L.SheetNames[B]+"'!"+W}),writextag("autoFilter",null,{ref:W})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(g,A){A.Views||(A.Views=[{}]),(g.match(sviewregex)||[]).forEach(function(L,B){var W=parsexmltag(L);A.Views[B]||(A.Views[B]={}),+W.zoomScale&&(A.Views[B].zoom=+W.zoomScale),parsexmlbool(W.rightToLeft)&&(A.Views[B].RTL=!0)})}function write_ws_xml_sheetviews(g,A,L,B){var W={workbookViewId:"0"};return(((B||{}).Workbook||{}).Views||[])[0]&&(W.rightToLeft=B.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,W),{})}function write_ws_xml_cell(g,A,L,B){if(g.c&&L["!comments"].push([A,g.c]),g.v===void 0&&typeof g.f!="string"||g.t==="z"&&!g.f)return"";var W="",q=g.t,J=g.v;if(g.t!=="z")switch(g.t){case"b":W=g.v?"1":"0";break;case"n":W=""+g.v;break;case"e":W=BErr[g.v];break;case"d":B&&B.cellDates?W=parseDate(g.v,-1).toISOString():(g=dup(g),g.t="n",W=""+(g.v=datenum(parseDate(g.v)))),typeof g.z>"u"&&(g.z=table_fmt[14]);break;default:W=g.v;break}var re=writetag("v",escapexml(W)),ae={r:A},se=get_cell_style(B.cellXfs,g,B);switch(se!==0&&(ae.s=se),g.t){case"n":break;case"d":ae.t="d";break;case"b":ae.t="b";break;case"e":ae.t="e";break;case"z":break;default:if(g.v==null){delete g.t;break}if(g.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(B&&B.bookSST){re=writetag("v",""+get_sst_id(B.Strings,g.v,B.revStrings)),ae.t="s";break}ae.t="str";break}if(g.t!=q&&(g.t=q,g.v=J),typeof g.f=="string"&&g.f){var ie=g.F&&g.F.slice(0,A.length)==A?{t:"array",ref:g.F}:null;re=writextag("f",escapexml(g.f),ie)+(g.v!=null?re:"")}return g.l&&L["!links"].push([A,g.l]),g.D&&(ae.cm=1),writextag("c",re,ae)}var parse_ws_xml_data=function(){var g=/<(?:\w+:)?c[ \/>]/,A=/<\/(?:\w+:)?row>/,L=/r=["']([^"']*)["']/,B=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,W=/ref=["']([^"']*)["']/,q=matchtag("v"),J=matchtag("f");return function(ae,se,ie,le,pe,he){for(var ue=0,ce="",fe=[],me=[],ke=0,xe=0,Le=0,Se="",Te,ge,Ce=0,be=0,nt,Ae,De=0,lt=0,Ct=Array.isArray(he.CellXf),ft,Et=[],gt=[],bt=Array.isArray(se),Ie=[],pt={},at=!1,Ee=!!ie.sheetStubs,ye=ae.split(A),ve=0,Pe=ye.length;ve!=Pe;++ve){ce=ye[ve].trim();var rt=ce.length;if(rt!==0){var st=0;e:for(ue=0;ue<rt;++ue)switch(ce[ue]){case">":if(ce[ue-1]!="/"){++ue;break e}if(ie&&ie.cellStyles){if(ge=parsexmltag(ce.slice(st,ue),!0),Ce=ge.r!=null?parseInt(ge.r,10):Ce+1,be=-1,ie.sheetRows&&ie.sheetRows<Ce)continue;pt={},at=!1,ge.ht&&(at=!0,pt.hpt=parseFloat(ge.ht),pt.hpx=pt2px(pt.hpt)),ge.hidden=="1"&&(at=!0,pt.hidden=!0),ge.outlineLevel!=null&&(at=!0,pt.level=+ge.outlineLevel),at&&(Ie[Ce-1]=pt)}break;case"<":st=ue;break}if(st>=ue)break;if(ge=parsexmltag(ce.slice(st,ue),!0),Ce=ge.r!=null?parseInt(ge.r,10):Ce+1,be=-1,!(ie.sheetRows&&ie.sheetRows<Ce)){le.s.r>Ce-1&&(le.s.r=Ce-1),le.e.r<Ce-1&&(le.e.r=Ce-1),ie&&ie.cellStyles&&(pt={},at=!1,ge.ht&&(at=!0,pt.hpt=parseFloat(ge.ht),pt.hpx=pt2px(pt.hpt)),ge.hidden=="1"&&(at=!0,pt.hidden=!0),ge.outlineLevel!=null&&(at=!0,pt.level=+ge.outlineLevel),at&&(Ie[Ce-1]=pt)),fe=ce.slice(ue).split(g);for(var ot=0;ot!=fe.length&&fe[ot].trim().charAt(0)=="<";++ot);for(fe=fe.slice(ot),ue=0;ue!=fe.length;++ue)if(ce=fe[ue].trim(),ce.length!==0){if(me=ce.match(L),ke=ue,xe=0,Le=0,ce="<c "+(ce.slice(0,1)=="<"?">":"")+ce,me!=null&&me.length===2){for(ke=0,Se=me[1],xe=0;xe!=Se.length&&!((Le=Se.charCodeAt(xe)-64)<1||Le>26);++xe)ke=26*ke+Le;--ke,be=ke}else++be;for(xe=0;xe!=ce.length&&ce.charCodeAt(xe)!==62;++xe);if(++xe,ge=parsexmltag(ce.slice(0,xe),!0),ge.r||(ge.r=encode_cell({r:Ce-1,c:be})),Se=ce.slice(xe),Te={t:""},(me=Se.match(q))!=null&&me[1]!==""&&(Te.v=unescapexml(me[1])),ie.cellFormula){if((me=Se.match(J))!=null&&me[1]!==""){if(Te.f=unescapexml(utf8read(me[1])).replace(/\r\n/g,`
`),ie.xlfn||(Te.f=_xlfn(Te.f)),me[0].indexOf('t="array"')>-1)Te.F=(Se.match(W)||[])[1],Te.F.indexOf(":")>-1&&Et.push([safe_decode_range(Te.F),Te.F]);else if(me[0].indexOf('t="shared"')>-1){Ae=parsexmltag(me[0]);var mt=unescapexml(utf8read(me[1]));ie.xlfn||(mt=_xlfn(mt)),gt[parseInt(Ae.si,10)]=[Ae,mt,ge.r]}}else(me=Se.match(/<f[^>]*\/>/))&&(Ae=parsexmltag(me[0]),gt[Ae.si]&&(Te.f=shift_formula_xlsx(gt[Ae.si][1],gt[Ae.si][2],ge.r)));var At=decode_cell(ge.r);for(xe=0;xe<Et.length;++xe)At.r>=Et[xe][0].s.r&&At.r<=Et[xe][0].e.r&&At.c>=Et[xe][0].s.c&&At.c<=Et[xe][0].e.c&&(Te.F=Et[xe][1])}if(ge.t==null&&Te.v===void 0)if(Te.f||Te.F)Te.v=0,Te.t="n";else if(Ee)Te.t="z";else continue;else Te.t=ge.t||"n";switch(le.s.c>be&&(le.s.c=be),le.e.c<be&&(le.e.c=be),Te.t){case"n":if(Te.v==""||Te.v==null){if(!Ee)continue;Te.t="z"}else Te.v=parseFloat(Te.v);break;case"s":if(typeof Te.v>"u"){if(!Ee)continue;Te.t="z"}else nt=strs[parseInt(Te.v,10)],Te.v=nt.t,Te.r=nt.r,ie.cellHTML&&(Te.h=nt.h);break;case"str":Te.t="s",Te.v=Te.v!=null?utf8read(Te.v):"",ie.cellHTML&&(Te.h=escapehtml(Te.v));break;case"inlineStr":me=Se.match(B),Te.t="s",me!=null&&(nt=parse_si(me[1]))?(Te.v=nt.t,ie.cellHTML&&(Te.h=nt.h)):Te.v="";break;case"b":Te.v=parsexmlbool(Te.v);break;case"d":ie.cellDates?Te.v=parseDate(Te.v,1):(Te.v=datenum(parseDate(Te.v,1)),Te.t="n");break;case"e":(!ie||ie.cellText!==!1)&&(Te.w=Te.v),Te.v=RBErr[Te.v];break}if(De=lt=0,ft=null,Ct&&ge.s!==void 0&&(ft=he.CellXf[ge.s],ft!=null&&(ft.numFmtId!=null&&(De=ft.numFmtId),ie.cellStyles&&ft.fillId!=null&&(lt=ft.fillId))),safe_format(Te,De,lt,ie,pe,he),ie.cellDates&&Ct&&Te.t=="n"&&fmt_is_date(table_fmt[De])&&(Te.t="d",Te.v=numdate(Te.v)),ge.cm&&ie.xlmeta){var It=(ie.xlmeta.Cell||[])[+ge.cm-1];It&&It.type=="XLDAPR"&&(Te.D=!0)}if(bt){var it=decode_cell(ge.r);se[it.r]||(se[it.r]=[]),se[it.r][it.c]=Te}else se[ge.r]=Te}}}}Ie.length>0&&(se["!rows"]=Ie)}}();function write_ws_xml_data(g,A,L,B){var W=[],q=[],J=safe_decode_range(g["!ref"]),re="",ae,se="",ie=[],le=0,pe=0,he=g["!rows"],ue=Array.isArray(g),ce={r:se},fe,me=-1;for(pe=J.s.c;pe<=J.e.c;++pe)ie[pe]=encode_col(pe);for(le=J.s.r;le<=J.e.r;++le){for(q=[],se=encode_row(le),pe=J.s.c;pe<=J.e.c;++pe){ae=ie[pe]+se;var ke=ue?(g[le]||[])[pe]:g[ae];ke!==void 0&&(re=write_ws_xml_cell(ke,ae,g,A))!=null&&q.push(re)}(q.length>0||he&&he[le])&&(ce={r:se},he&&he[le]&&(fe=he[le],fe.hidden&&(ce.hidden=1),me=-1,fe.hpx?me=px2pt(fe.hpx):fe.hpt&&(me=fe.hpt),me>-1&&(ce.ht=me,ce.customHeight=1),fe.level&&(ce.outlineLevel=fe.level)),W[W.length]=writextag("row",q.join(""),ce))}if(he)for(;le<he.length;++le)he&&he[le]&&(ce={r:le+1},fe=he[le],fe.hidden&&(ce.hidden=1),me=-1,fe.hpx?me=px2pt(fe.hpx):fe.hpt&&(me=fe.hpt),me>-1&&(ce.ht=me,ce.customHeight=1),fe.level&&(ce.outlineLevel=fe.level),W[W.length]=writextag("row","",ce));return W.join("")}function write_ws_xml(g,A,L,B){var W=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],q=L.SheetNames[g],J=0,re="",ae=L.Sheets[q];ae==null&&(ae={});var se=ae["!ref"]||"A1",ie=safe_decode_range(se);if(ie.e.c>16383||ie.e.r>1048575){if(A.WTF)throw new Error("Range "+se+" exceeds format limit A1:XFD1048576");ie.e.c=Math.min(ie.e.c,16383),ie.e.r=Math.min(ie.e.c,1048575),se=encode_range(ie)}B||(B={}),ae["!comments"]=[];var le=[];write_ws_xml_sheetpr(ae,L,g,A,W),W[W.length]=writextag("dimension",null,{ref:se}),W[W.length]=write_ws_xml_sheetviews(ae,A,g,L),A.sheetFormat&&(W[W.length]=writextag("sheetFormatPr",null,{defaultRowHeight:A.sheetFormat.defaultRowHeight||"16",baseColWidth:A.sheetFormat.baseColWidth||"10",outlineLevelRow:A.sheetFormat.outlineLevelRow||"7"})),ae["!cols"]!=null&&ae["!cols"].length>0&&(W[W.length]=write_ws_xml_cols(ae,ae["!cols"])),W[J=W.length]="<sheetData/>",ae["!links"]=[],ae["!ref"]!=null&&(re=write_ws_xml_data(ae,A),re.length>0&&(W[W.length]=re)),W.length>J+1&&(W[W.length]="</sheetData>",W[J]=W[J].replace("/>",">")),ae["!protect"]&&(W[W.length]=write_ws_xml_protection(ae["!protect"])),ae["!autofilter"]!=null&&(W[W.length]=write_ws_xml_autofilter(ae["!autofilter"],ae,L,g)),ae["!merges"]!=null&&ae["!merges"].length>0&&(W[W.length]=write_ws_xml_merges(ae["!merges"]));var pe=-1,he,ue=-1;return ae["!links"].length>0&&(W[W.length]="<hyperlinks>",ae["!links"].forEach(function(ce){ce[1].Target&&(he={ref:ce[0]},ce[1].Target.charAt(0)!="#"&&(ue=add_rels(B,-1,escapexml(ce[1].Target).replace(/#.*$/,""),RELS.HLINK),he["r:id"]="rId"+ue),(pe=ce[1].Target.indexOf("#"))>-1&&(he.location=escapexml(ce[1].Target.slice(pe+1))),ce[1].Tooltip&&(he.tooltip=escapexml(ce[1].Tooltip)),W[W.length]=writextag("hyperlink",null,he))}),W[W.length]="</hyperlinks>"),delete ae["!links"],ae["!margins"]!=null&&(W[W.length]=write_ws_xml_margins(ae["!margins"])),(!A||A.ignoreEC||A.ignoreEC==null)&&(W[W.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:se}))),le.length>0&&(ue=add_rels(B,-1,"../drawings/drawing"+(g+1)+".xml",RELS.DRAW),W[W.length]=writextag("drawing",null,{"r:id":"rId"+ue}),ae["!drawing"]=le),ae["!comments"].length>0&&(ue=add_rels(B,-1,"../drawings/vmlDrawing"+(g+1)+".vml",RELS.VML),W[W.length]=writextag("legacyDrawing",null,{"r:id":"rId"+ue}),ae["!legacy"]=ue),W.length>1&&(W[W.length]="</worksheet>",W[1]=W[1].replace("/>",">")),W.join("")}function parse_BrtRowHdr(g,A){var L={},B=g.l+A;L.r=g.read_shift(4),g.l+=4;var W=g.read_shift(2);g.l+=1;var q=g.read_shift(1);return g.l=B,q&7&&(L.level=q&7),q&16&&(L.hidden=!0),q&32&&(L.hpt=W/20),L}function write_BrtRowHdr(g,A,L){var B=new_buf(145),W=(L["!rows"]||[])[g]||{};B.write_shift(4,g),B.write_shift(4,0);var q=320;W.hpx?q=px2pt(W.hpx)*20:W.hpt&&(q=W.hpt*20),B.write_shift(2,q),B.write_shift(1,0);var J=0;W.level&&(J|=W.level),W.hidden&&(J|=16),(W.hpx||W.hpt)&&(J|=32),B.write_shift(1,J),B.write_shift(1,0);var re=0,ae=B.l;B.l+=4;for(var se={r:g,c:0},ie=0;ie<16;++ie)if(!(A.s.c>ie+1<<10||A.e.c<ie<<10)){for(var le=-1,pe=-1,he=ie<<10;he<ie+1<<10;++he){se.c=he;var ue=Array.isArray(L)?(L[se.r]||[])[se.c]:L[encode_cell(se)];ue&&(le<0&&(le=he),pe=he)}le<0||(++re,B.write_shift(4,le),B.write_shift(4,pe))}var ce=B.l;return B.l=ae,B.write_shift(4,re),B.l=ce,B.length>B.l?B.slice(0,B.l):B}function write_row_header(g,A,L,B){var W=write_BrtRowHdr(B,L,A);(W.length>17||(A["!rows"]||[])[B])&&write_record(g,0,W)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(g,A){var L={},B=g[g.l];return++g.l,L.above=!(B&64),L.left=!(B&128),g.l+=18,L.name=parse_XLSBCodeName(g),L}function write_BrtWsProp(g,A,L){L==null&&(L=new_buf(84+4*g.length));var B=192;A&&(A.above&&(B&=-65),A.left&&(B&=-129)),L.write_shift(1,B);for(var W=1;W<3;++W)L.write_shift(1,0);return write_BrtColor({auto:1},L),L.write_shift(-4,-1),L.write_shift(-4,-1),write_XLSBCodeName(g,L),L.slice(0,L.l)}function parse_BrtCellBlank(g){var A=parse_XLSBCell(g);return[A]}function write_BrtCellBlank(g,A,L){return L==null&&(L=new_buf(8)),write_XLSBCell(A,L)}function parse_BrtShortBlank(g){var A=parse_XLSBShortCell(g);return[A]}function write_BrtShortBlank(g,A,L){return L==null&&(L=new_buf(4)),write_XLSBShortCell(A,L)}function parse_BrtCellBool(g){var A=parse_XLSBCell(g),L=g.read_shift(1);return[A,L,"b"]}function write_BrtCellBool(g,A,L){return L==null&&(L=new_buf(9)),write_XLSBCell(A,L),L.write_shift(1,g.v?1:0),L}function parse_BrtShortBool(g){var A=parse_XLSBShortCell(g),L=g.read_shift(1);return[A,L,"b"]}function write_BrtShortBool(g,A,L){return L==null&&(L=new_buf(5)),write_XLSBShortCell(A,L),L.write_shift(1,g.v?1:0),L}function parse_BrtCellError(g){var A=parse_XLSBCell(g),L=g.read_shift(1);return[A,L,"e"]}function write_BrtCellError(g,A,L){return L==null&&(L=new_buf(9)),write_XLSBCell(A,L),L.write_shift(1,g.v),L}function parse_BrtShortError(g){var A=parse_XLSBShortCell(g),L=g.read_shift(1);return[A,L,"e"]}function write_BrtShortError(g,A,L){return L==null&&(L=new_buf(8)),write_XLSBShortCell(A,L),L.write_shift(1,g.v),L.write_shift(2,0),L.write_shift(1,0),L}function parse_BrtCellIsst(g){var A=parse_XLSBCell(g),L=g.read_shift(4);return[A,L,"s"]}function write_BrtCellIsst(g,A,L){return L==null&&(L=new_buf(12)),write_XLSBCell(A,L),L.write_shift(4,A.v),L}function parse_BrtShortIsst(g){var A=parse_XLSBShortCell(g),L=g.read_shift(4);return[A,L,"s"]}function write_BrtShortIsst(g,A,L){return L==null&&(L=new_buf(8)),write_XLSBShortCell(A,L),L.write_shift(4,A.v),L}function parse_BrtCellReal(g){var A=parse_XLSBCell(g),L=parse_Xnum(g);return[A,L,"n"]}function write_BrtCellReal(g,A,L){return L==null&&(L=new_buf(16)),write_XLSBCell(A,L),write_Xnum(g.v,L),L}function parse_BrtShortReal(g){var A=parse_XLSBShortCell(g),L=parse_Xnum(g);return[A,L,"n"]}function write_BrtShortReal(g,A,L){return L==null&&(L=new_buf(12)),write_XLSBShortCell(A,L),write_Xnum(g.v,L),L}function parse_BrtCellRk(g){var A=parse_XLSBCell(g),L=parse_RkNumber(g);return[A,L,"n"]}function write_BrtCellRk(g,A,L){return L==null&&(L=new_buf(12)),write_XLSBCell(A,L),write_RkNumber(g.v,L),L}function parse_BrtShortRk(g){var A=parse_XLSBShortCell(g),L=parse_RkNumber(g);return[A,L,"n"]}function write_BrtShortRk(g,A,L){return L==null&&(L=new_buf(8)),write_XLSBShortCell(A,L),write_RkNumber(g.v,L),L}function parse_BrtCellRString(g){var A=parse_XLSBCell(g),L=parse_RichStr(g);return[A,L,"is"]}function parse_BrtCellSt(g){var A=parse_XLSBCell(g),L=parse_XLWideString(g);return[A,L,"str"]}function write_BrtCellSt(g,A,L){return L==null&&(L=new_buf(12+4*g.v.length)),write_XLSBCell(A,L),write_XLWideString(g.v,L),L.length>L.l?L.slice(0,L.l):L}function parse_BrtShortSt(g){var A=parse_XLSBShortCell(g),L=parse_XLWideString(g);return[A,L,"str"]}function write_BrtShortSt(g,A,L){return L==null&&(L=new_buf(8+4*g.v.length)),write_XLSBShortCell(A,L),write_XLWideString(g.v,L),L.length>L.l?L.slice(0,L.l):L}function parse_BrtFmlaBool(g,A,L){var B=g.l+A,W=parse_XLSBCell(g);W.r=L["!row"];var q=g.read_shift(1),J=[W,q,"b"];if(L.cellFormula){g.l+=2;var re=parse_XLSBCellParsedFormula(g,B-g.l,L);J[3]=stringify_formula(re,null,W,L.supbooks,L)}else g.l=B;return J}function parse_BrtFmlaError(g,A,L){var B=g.l+A,W=parse_XLSBCell(g);W.r=L["!row"];var q=g.read_shift(1),J=[W,q,"e"];if(L.cellFormula){g.l+=2;var re=parse_XLSBCellParsedFormula(g,B-g.l,L);J[3]=stringify_formula(re,null,W,L.supbooks,L)}else g.l=B;return J}function parse_BrtFmlaNum(g,A,L){var B=g.l+A,W=parse_XLSBCell(g);W.r=L["!row"];var q=parse_Xnum(g),J=[W,q,"n"];if(L.cellFormula){g.l+=2;var re=parse_XLSBCellParsedFormula(g,B-g.l,L);J[3]=stringify_formula(re,null,W,L.supbooks,L)}else g.l=B;return J}function parse_BrtFmlaString(g,A,L){var B=g.l+A,W=parse_XLSBCell(g);W.r=L["!row"];var q=parse_XLWideString(g),J=[W,q,"str"];if(L.cellFormula){g.l+=2;var re=parse_XLSBCellParsedFormula(g,B-g.l,L);J[3]=stringify_formula(re,null,W,L.supbooks,L)}else g.l=B;return J}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(g,A){return A==null&&(A=new_buf(4)),A.write_shift(4,g),A}function parse_BrtHLink(g,A){var L=g.l+A,B=parse_UncheckedRfX(g),W=parse_XLNullableWideString(g),q=parse_XLWideString(g),J=parse_XLWideString(g),re=parse_XLWideString(g);g.l=L;var ae={rfx:B,relId:W,loc:q,display:re};return J&&(ae.Tooltip=J),ae}function write_BrtHLink(g,A){var L=new_buf(50+4*(g[1].Target.length+(g[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(g[0]),e:decode_cell(g[0])},L),write_RelID("rId"+A,L);var B=g[1].Target.indexOf("#"),W=B==-1?"":g[1].Target.slice(B+1);return write_XLWideString(W||"",L),write_XLWideString(g[1].Tooltip||"",L),write_XLWideString("",L),L.slice(0,L.l)}function parse_BrtPane(){}function parse_BrtArrFmla(g,A,L){var B=g.l+A,W=parse_RfX(g),q=g.read_shift(1),J=[W];if(J[2]=q,L.cellFormula){var re=parse_XLSBArrayParsedFormula(g,B-g.l,L);J[1]=re}else g.l=B;return J}function parse_BrtShrFmla(g,A,L){var B=g.l+A,W=parse_UncheckedRfX(g),q=[W];if(L.cellFormula){var J=parse_XLSBSharedParsedFormula(g,B-g.l,L);q[1]=J,g.l=B}else g.l=B;return q}function write_BrtColInfo(g,A,L){L==null&&(L=new_buf(18));var B=col_obj_w(g,A);L.write_shift(-4,g),L.write_shift(-4,g),L.write_shift(4,(B.width||10)*256),L.write_shift(4,0);var W=0;return A.hidden&&(W|=1),typeof B.width=="number"&&(W|=2),A.level&&(W|=A.level<<8),L.write_shift(2,W),L}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(g){var A={};return BrtMarginKeys.forEach(function(L){A[L]=parse_Xnum(g)}),A}function write_BrtMargins(g,A){return A==null&&(A=new_buf(6*8)),default_margins(g),BrtMarginKeys.forEach(function(L){write_Xnum(g[L],A)}),A}function parse_BrtBeginWsView(g){var A=g.read_shift(2);return g.l+=28,{RTL:A&32}}function write_BrtBeginWsView(g,A,L){L==null&&(L=new_buf(30));var B=924;return(((A||{}).Views||[])[0]||{}).RTL&&(B|=32),L.write_shift(2,B),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(1,0),L.write_shift(2,0),L.write_shift(2,100),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L}function write_BrtCellIgnoreEC(g){var A=new_buf(24);return A.write_shift(4,4),A.write_shift(4,1),write_UncheckedRfX(g,A),A}function write_BrtSheetProtection(g,A){return A==null&&(A=new_buf(16*4+2)),A.write_shift(2,g.password?crypto_CreatePasswordVerifier_Method1(g.password):0),A.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(L){L[1]?A.write_shift(4,g[L[0]]!=null&&!g[L[0]]?1:0):A.write_shift(4,g[L[0]]!=null&&g[L[0]]?0:1)}),A}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(g,A,L,B,W,q,J){if(!g)return g;var re=A||{};B||(B={"!id":{}});var ae=re.dense?[]:{},se,ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},le=!1,pe=!1,he,ue,ce,fe,me,ke,xe,Le,Se,Te=[];re.biff=12,re["!row"]=0;var ge=0,Ce=!1,be=[],nt={},Ae=re.supbooks||W.supbooks||[[]];if(Ae.sharedf=nt,Ae.arrayf=be,Ae.SheetNames=W.SheetNames||W.Sheets.map(function(bt){return bt.name}),!re.supbooks&&(re.supbooks=Ae,W.Names))for(var De=0;De<W.Names.length;++De)Ae[0][De+1]=W.Names[De];var lt=[],Ct=[],ft=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var Et;if(recordhopper(g,function(Ie,pt,at){if(!pe)switch(at){case 148:se=Ie;break;case 0:he=Ie,re.sheetRows&&re.sheetRows<=he.r&&(pe=!0),Le=encode_row(fe=he.r),re["!row"]=he.r,(Ie.hidden||Ie.hpt||Ie.level!=null)&&(Ie.hpt&&(Ie.hpx=pt2px(Ie.hpt)),Ct[Ie.r]=Ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(ue={t:Ie[2]},Ie[2]){case"n":ue.v=Ie[1];break;case"s":xe=strs[Ie[1]],ue.v=xe.t,ue.r=xe.r;break;case"b":ue.v=!!Ie[1];break;case"e":ue.v=Ie[1],re.cellText!==!1&&(ue.w=BErr[ue.v]);break;case"str":ue.t="s",ue.v=Ie[1];break;case"is":ue.t="s",ue.v=Ie[1].t;break}if((ce=J.CellXf[Ie[0].iStyleRef])&&safe_format(ue,ce.numFmtId,null,re,q,J),me=Ie[0].c==-1?me+1:Ie[0].c,re.dense?(ae[fe]||(ae[fe]=[]),ae[fe][me]=ue):ae[encode_col(me)+Le]=ue,re.cellFormula){for(Ce=!1,ge=0;ge<be.length;++ge){var Ee=be[ge];he.r>=Ee[0].s.r&&he.r<=Ee[0].e.r&&me>=Ee[0].s.c&&me<=Ee[0].e.c&&(ue.F=encode_range(Ee[0]),Ce=!0)}!Ce&&Ie.length>3&&(ue.f=Ie[3])}if(ie.s.r>he.r&&(ie.s.r=he.r),ie.s.c>me&&(ie.s.c=me),ie.e.r<he.r&&(ie.e.r=he.r),ie.e.c<me&&(ie.e.c=me),re.cellDates&&ce&&ue.t=="n"&&fmt_is_date(table_fmt[ce.numFmtId])){var ye=SSF_parse_date_code(ue.v);ye&&(ue.t="d",ue.v=new Date(ye.y,ye.m-1,ye.d,ye.H,ye.M,ye.S,ye.u))}Et&&(Et.type=="XLDAPR"&&(ue.D=!0),Et=void 0);break;case 1:case 12:if(!re.sheetStubs||le)break;ue={t:"z",v:void 0},me=Ie[0].c==-1?me+1:Ie[0].c,re.dense?(ae[fe]||(ae[fe]=[]),ae[fe][me]=ue):ae[encode_col(me)+Le]=ue,ie.s.r>he.r&&(ie.s.r=he.r),ie.s.c>me&&(ie.s.c=me),ie.e.r<he.r&&(ie.e.r=he.r),ie.e.c<me&&(ie.e.c=me),Et&&(Et.type=="XLDAPR"&&(ue.D=!0),Et=void 0);break;case 176:Te.push(Ie);break;case 49:Et=((re.xlmeta||{}).Cell||[])[Ie-1];break;case 494:var ve=B["!id"][Ie.relId];for(ve?(Ie.Target=ve.Target,Ie.loc&&(Ie.Target+="#"+Ie.loc),Ie.Rel=ve):Ie.relId==""&&(Ie.Target="#"+Ie.loc),fe=Ie.rfx.s.r;fe<=Ie.rfx.e.r;++fe)for(me=Ie.rfx.s.c;me<=Ie.rfx.e.c;++me)re.dense?(ae[fe]||(ae[fe]=[]),ae[fe][me]||(ae[fe][me]={t:"z",v:void 0}),ae[fe][me].l=Ie):(ke=encode_cell({c:me,r:fe}),ae[ke]||(ae[ke]={t:"z",v:void 0}),ae[ke].l=Ie);break;case 426:if(!re.cellFormula)break;be.push(Ie),Se=re.dense?ae[fe][me]:ae[encode_col(me)+Le],Se.f=stringify_formula(Ie[1],ie,{r:he.r,c:me},Ae,re),Se.F=encode_range(Ie[0]);break;case 427:if(!re.cellFormula)break;nt[encode_cell(Ie[0].s)]=Ie[1],Se=re.dense?ae[fe][me]:ae[encode_col(me)+Le],Se.f=stringify_formula(Ie[1],ie,{r:he.r,c:me},Ae,re);break;case 60:if(!re.cellStyles)break;for(;Ie.e>=Ie.s;)lt[Ie.e--]={width:Ie.w/256,hidden:!!(Ie.flags&1),level:Ie.level},ft||(ft=!0,find_mdw_colw(Ie.w/256)),process_col(lt[Ie.e+1]);break;case 161:ae["!autofilter"]={ref:encode_range(Ie)};break;case 476:ae["!margins"]=Ie;break;case 147:W.Sheets[L]||(W.Sheets[L]={}),Ie.name&&(W.Sheets[L].CodeName=Ie.name),(Ie.above||Ie.left)&&(ae["!outline"]={above:Ie.above,left:Ie.left});break;case 137:W.Views||(W.Views=[{}]),W.Views[0]||(W.Views[0]={}),Ie.RTL&&(W.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:le=!0;break;case 36:le=!1;break;case 37:le=!0;break;case 38:le=!1;break;default:if(!pt.T){if(!le||re.WTF)throw new Error("Unexpected record 0x"+at.toString(16))}}},re),delete re.supbooks,delete re["!row"],!ae["!ref"]&&(ie.s.r<2e6||se&&(se.e.r>0||se.e.c>0||se.s.r>0||se.s.c>0))&&(ae["!ref"]=encode_range(se||ie)),re.sheetRows&&ae["!ref"]){var gt=safe_decode_range(ae["!ref"]);re.sheetRows<=+gt.e.r&&(gt.e.r=re.sheetRows-1,gt.e.r>ie.e.r&&(gt.e.r=ie.e.r),gt.e.r<gt.s.r&&(gt.s.r=gt.e.r),gt.e.c>ie.e.c&&(gt.e.c=ie.e.c),gt.e.c<gt.s.c&&(gt.s.c=gt.e.c),ae["!fullref"]=ae["!ref"],ae["!ref"]=encode_range(gt))}return Te.length>0&&(ae["!merges"]=Te),lt.length>0&&(ae["!cols"]=lt),Ct.length>0&&(ae["!rows"]=Ct),ae}function write_ws_bin_cell(g,A,L,B,W,q,J){if(A.v===void 0)return!1;var re="";switch(A.t){case"b":re=A.v?"1":"0";break;case"d":A=dup(A),A.z=A.z||table_fmt[14],A.v=datenum(parseDate(A.v)),A.t="n";break;case"n":case"e":re=""+A.v;break;default:re=A.v;break}var ae={r:L,c:B};switch(ae.s=get_cell_style(W.cellXfs,A,W),A.l&&q["!links"].push([encode_cell(ae),A.l]),A.c&&q["!comments"].push([encode_cell(ae),A.c]),A.t){case"s":case"str":return W.bookSST?(re=get_sst_id(W.Strings,A.v,W.revStrings),ae.t="s",ae.v=re,J?write_record(g,18,write_BrtShortIsst(A,ae)):write_record(g,7,write_BrtCellIsst(A,ae))):(ae.t="str",J?write_record(g,17,write_BrtShortSt(A,ae)):write_record(g,6,write_BrtCellSt(A,ae))),!0;case"n":return A.v==(A.v|0)&&A.v>-1e3&&A.v<1e3?J?write_record(g,13,write_BrtShortRk(A,ae)):write_record(g,2,write_BrtCellRk(A,ae)):J?write_record(g,16,write_BrtShortReal(A,ae)):write_record(g,5,write_BrtCellReal(A,ae)),!0;case"b":return ae.t="b",J?write_record(g,15,write_BrtShortBool(A,ae)):write_record(g,4,write_BrtCellBool(A,ae)),!0;case"e":return ae.t="e",J?write_record(g,14,write_BrtShortError(A,ae)):write_record(g,3,write_BrtCellError(A,ae)),!0}return J?write_record(g,12,write_BrtShortBlank(A,ae)):write_record(g,1,write_BrtCellBlank(A,ae)),!0}function write_CELLTABLE(g,A,L,B){var W=safe_decode_range(A["!ref"]||"A1"),q,J="",re=[];write_record(g,145);var ae=Array.isArray(A),se=W.e.r;A["!rows"]&&(se=Math.max(W.e.r,A["!rows"].length-1));for(var ie=W.s.r;ie<=se;++ie){J=encode_row(ie),write_row_header(g,A,W,ie);var le=!1;if(ie<=W.e.r)for(var pe=W.s.c;pe<=W.e.c;++pe){ie===W.s.r&&(re[pe]=encode_col(pe)),q=re[pe]+J;var he=ae?(A[ie]||[])[pe]:A[q];if(!he){le=!1;continue}le=write_ws_bin_cell(g,he,ie,pe,B,A,le)}}write_record(g,146)}function write_MERGECELLS(g,A){!A||!A["!merges"]||(write_record(g,177,write_BrtBeginMergeCells(A["!merges"].length)),A["!merges"].forEach(function(L){write_record(g,176,write_BrtMergeCell(L))}),write_record(g,178))}function write_COLINFOS(g,A){!A||!A["!cols"]||(write_record(g,390),A["!cols"].forEach(function(L,B){L&&write_record(g,60,write_BrtColInfo(B,L))}),write_record(g,391))}function write_IGNOREECS(g,A){!A||!A["!ref"]||(write_record(g,648),write_record(g,649,write_BrtCellIgnoreEC(safe_decode_range(A["!ref"]))),write_record(g,650))}function write_HLINKS(g,A,L){A["!links"].forEach(function(B){if(B[1].Target){var W=add_rels(L,-1,B[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(g,494,write_BrtHLink(B,W))}}),delete A["!links"]}function write_LEGACYDRAWING(g,A,L,B){if(A["!comments"].length>0){var W=add_rels(B,-1,"../drawings/vmlDrawing"+(L+1)+".vml",RELS.VML);write_record(g,551,write_RelID("rId"+W)),A["!legacy"]=W}}function write_AUTOFILTER(g,A,L,B){if(A["!autofilter"]){var W=A["!autofilter"],q=typeof W.ref=="string"?W.ref:encode_range(W.ref);L.Workbook||(L.Workbook={Sheets:[]}),L.Workbook.Names||(L.Workbook.Names=[]);var J=L.Workbook.Names,re=decode_range(q);re.s.r==re.e.r&&(re.e.r=decode_range(A["!ref"]).e.r,q=encode_range(re));for(var ae=0;ae<J.length;++ae){var se=J[ae];if(se.Name=="_xlnm._FilterDatabase"&&se.Sheet==B){se.Ref="'"+L.SheetNames[B]+"'!"+q;break}}ae==J.length&&J.push({Name:"_xlnm._FilterDatabase",Sheet:B,Ref:"'"+L.SheetNames[B]+"'!"+q}),write_record(g,161,write_UncheckedRfX(safe_decode_range(q))),write_record(g,162)}}function write_WSVIEWS2(g,A,L){write_record(g,133),write_record(g,137,write_BrtBeginWsView(A,L)),write_record(g,138),write_record(g,134)}function write_SHEETPROTECT(g,A){A["!protect"]&&write_record(g,535,write_BrtSheetProtection(A["!protect"]))}function write_ws_bin(g,A,L,B){var W=buf_array(),q=L.SheetNames[g],J=L.Sheets[q]||{},re=q;try{L&&L.Workbook&&(re=L.Workbook.Sheets[g].CodeName||re)}catch{}var ae=safe_decode_range(J["!ref"]||"A1");if(ae.e.c>16383||ae.e.r>1048575){if(A.WTF)throw new Error("Range "+(J["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");ae.e.c=Math.min(ae.e.c,16383),ae.e.r=Math.min(ae.e.c,1048575)}return J["!links"]=[],J["!comments"]=[],write_record(W,129),(L.vbaraw||J["!outline"])&&write_record(W,147,write_BrtWsProp(re,J["!outline"])),write_record(W,148,write_BrtWsDim(ae)),write_WSVIEWS2(W,J,L.Workbook),write_COLINFOS(W,J),write_CELLTABLE(W,J,g,A),write_SHEETPROTECT(W,J),write_AUTOFILTER(W,J,L,g),write_MERGECELLS(W,J),write_HLINKS(W,J,B),J["!margins"]&&write_record(W,476,write_BrtMargins(J["!margins"])),(!A||A.ignoreEC||A.ignoreEC==null)&&write_IGNOREECS(W,J),write_LEGACYDRAWING(W,J,g,B),write_record(W,130),W.end()}function parse_Cache(g){var A=[],L=g.match(/^<c:numCache>/),B;(g.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(q){var J=q.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);J&&(A[+J[1]]=L?+J[2]:J[2])});var W=unescapexml((g.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(g.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(q){B=q.replace(/<.*?>/g,"")}),[A,W,B]}function parse_chart(g,A,L,B,W,q){var J=q||{"!type":"chart"};if(!g)return q;var re=0,ae=0,se="A",ie={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(g.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(le){var pe=parse_Cache(le);ie.s.r=ie.s.c=0,ie.e.c=re,se=encode_col(re),pe[0].forEach(function(he,ue){J[se+encode_row(ue)]={t:"n",v:he,z:pe[1]},ae=ue}),ie.e.r<ae&&(ie.e.r=ae),++re}),re>0&&(J["!ref"]=encode_range(ie)),J}function parse_cs_xml(g,A,L,B,W){if(!g)return g;B||(B={"!id":{}});var q={"!type":"chart","!drawel":null,"!rel":""},J,re=g.match(sheetprregex);return re&&parse_ws_xml_sheetpr(re[0],q,W,L),(J=g.match(/drawing r:id="(.*?)"/))&&(q["!rel"]=J[1]),B["!id"][q["!rel"]]&&(q["!drawel"]=B["!id"][q["!rel"]]),q}function parse_BrtCsProp(g,A){g.l+=10;var L=parse_XLWideString(g);return{name:L}}function parse_cs_bin(g,A,L,B,W){if(!g)return g;B||(B={"!id":{}});var q={"!type":"chart","!drawel":null,"!rel":""},J=!1;return recordhopper(g,function(ae,se,ie){switch(ie){case 550:q["!rel"]=ae;break;case 651:W.Sheets[L]||(W.Sheets[L]={}),ae.name&&(W.Sheets[L].CodeName=ae.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:J=!0;break;case 36:J=!1;break;case 37:break;case 38:break;default:if(!(se.T>0)){if(!(se.T<0)){if(!J||A.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}}},A),B["!id"][q["!rel"]]&&(q["!drawel"]=B["!id"][q["!rel"]]),q}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(g,A){for(var L=0;L!=g.length;++L)for(var B=g[L],W=0;W!=A.length;++W){var q=A[W];if(B[q[0]]==null)B[q[0]]=q[1];else switch(q[2]){case"bool":typeof B[q[0]]=="string"&&(B[q[0]]=parsexmlbool(B[q[0]]));break;case"int":typeof B[q[0]]=="string"&&(B[q[0]]=parseInt(B[q[0]],10));break}}}function push_defaults(g,A){for(var L=0;L!=A.length;++L){var B=A[L];if(g[B[0]]==null)g[B[0]]=B[1];else switch(B[2]){case"bool":typeof g[B[0]]=="string"&&(g[B[0]]=parsexmlbool(g[B[0]]));break;case"int":typeof g[B[0]]=="string"&&(g[B[0]]=parseInt(g[B[0]],10));break}}}function parse_wb_defaults(g){push_defaults(g.WBProps,WBPropsDef),push_defaults(g.CalcPr,CalcPrDef),push_defaults_array(g.WBView,WBViewDef),push_defaults_array(g.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(g.WBProps.date1904)}function safe1904(g){return!g.Workbook||!g.Workbook.WBProps?"false":parsexmlbool(g.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(g,A){if(g.length>31)throw new Error("Sheet names cannot exceed 31 chars");var L=!0;return badchars.forEach(function(B){if(g.indexOf(B)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),L}function check_wb_names(g,A,L){g.forEach(function(B,W){check_ws_name(B);for(var q=0;q<W;++q)if(B==g[q])throw new Error("Duplicate Sheet Name: "+B);if(L){var J=A&&A[W]&&A[W].CodeName||B;if(J.charCodeAt(0)==95&&J.length>22)throw new Error("Bad Code Name: Worksheet"+J)}})}function check_wb(g){if(!g||!g.SheetNames||!g.Sheets)throw new Error("Invalid Workbook");if(!g.SheetNames.length)throw new Error("Workbook is empty");var A=g.Workbook&&g.Workbook.Sheets||[];check_wb_names(g.SheetNames,A,!!g.vbaraw);for(var L=0;L<g.SheetNames.length;++L)check_ws(g.Sheets[g.SheetNames[L]],g.SheetNames[L],L)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(g,A){if(!g)throw new Error("Could not find file");var L={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},B=!1,W="xmlns",q={},J=0;if(g.replace(tagregex,function(ae,se){var ie=parsexmltag(ae);switch(strip_ns(ie[0])){case"<?xml":break;case"<workbook":ae.match(wbnsregex)&&(W="xmlns"+ae.match(/<(\w+):/)[1]),L.xmlns=ie[W];break;case"</workbook>":break;case"<fileVersion":delete ie[0],L.AppVersion=ie;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(le){if(ie[le[0]]!=null)switch(le[2]){case"bool":L.WBProps[le[0]]=parsexmlbool(ie[le[0]]);break;case"int":L.WBProps[le[0]]=parseInt(ie[le[0]],10);break;default:L.WBProps[le[0]]=ie[le[0]]}}),ie.codeName&&(L.WBProps.CodeName=utf8read(ie.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete ie[0],L.WBView.push(ie);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(ie.state){case"hidden":ie.Hidden=1;break;case"veryHidden":ie.Hidden=2;break;default:ie.Hidden=0}delete ie.state,ie.name=unescapexml(utf8read(ie.name)),delete ie[0],L.Sheets.push(ie);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":B=!0;break;case"</definedNames>":B=!1;break;case"<definedName":q={},q.Name=utf8read(ie.name),ie.comment&&(q.Comment=ie.comment),ie.localSheetId&&(q.Sheet=+ie.localSheetId),parsexmlbool(ie.hidden||"0")&&(q.Hidden=!0),J=se+ae.length;break;case"</definedName>":q.Ref=unescapexml(utf8read(g.slice(J,se))),L.Names.push(q);break;case"<definedName/>":break;case"<calcPr":delete ie[0],L.CalcPr=ie;break;case"<calcPr/>":delete ie[0],L.CalcPr=ie;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":B=!0;break;case"</AlternateContent>":B=!1;break;case"<revisionPtr":break;default:if(!B&&A.WTF)throw new Error("unrecognized "+ie[0]+" in workbook")}return ae}),XMLNS_main.indexOf(L.xmlns)===-1)throw new Error("Unknown Namespace: "+L.xmlns);return parse_wb_defaults(L),L}function write_wb_xml(g){var A=[XML_HEADER];A[A.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var L=g.Workbook&&(g.Workbook.Names||[]).length>0,B={codeName:"ThisWorkbook"};g.Workbook&&g.Workbook.WBProps&&(WBPropsDef.forEach(function(re){g.Workbook.WBProps[re[0]]!=null&&g.Workbook.WBProps[re[0]]!=re[1]&&(B[re[0]]=g.Workbook.WBProps[re[0]])}),g.Workbook.WBProps.CodeName&&(B.codeName=g.Workbook.WBProps.CodeName,delete B.CodeName)),A[A.length]=writextag("workbookPr",null,B);var W=g.Workbook&&g.Workbook.Sheets||[],q=0;if(W&&W[0]&&W[0].Hidden){for(A[A.length]="<bookViews>",q=0;q!=g.SheetNames.length&&!(!W[q]||!W[q].Hidden);++q);q==g.SheetNames.length&&(q=0),A[A.length]='<workbookView firstSheet="'+q+'" activeTab="'+q+'"/>',A[A.length]="</bookViews>"}for(A[A.length]="<sheets>",q=0;q!=g.SheetNames.length;++q){var J={name:escapexml(g.SheetNames[q].slice(0,31))};if(J.sheetId=""+(q+1),J["r:id"]="rId"+(q+1),W[q])switch(W[q].Hidden){case 1:J.state="hidden";break;case 2:J.state="veryHidden";break}A[A.length]=writextag("sheet",null,J)}return A[A.length]="</sheets>",L&&(A[A.length]="<definedNames>",g.Workbook&&g.Workbook.Names&&g.Workbook.Names.forEach(function(re){var ae={name:re.Name};re.Comment&&(ae.comment=re.Comment),re.Sheet!=null&&(ae.localSheetId=""+re.Sheet),re.Hidden&&(ae.hidden="1"),re.Ref&&(A[A.length]=writextag("definedName",escapexml(re.Ref),ae))}),A[A.length]="</definedNames>"),A.length>2&&(A[A.length]="</workbook>",A[1]=A[1].replace("/>",">")),A.join("")}function parse_BrtBundleSh(g,A){var L={};return L.Hidden=g.read_shift(4),L.iTabID=g.read_shift(4),L.strRelID=parse_RelID(g),L.name=parse_XLWideString(g),L}function write_BrtBundleSh(g,A){return A||(A=new_buf(127)),A.write_shift(4,g.Hidden),A.write_shift(4,g.iTabID),write_RelID(g.strRelID,A),write_XLWideString(g.name.slice(0,31),A),A.length>A.l?A.slice(0,A.l):A}function parse_BrtWbProp(g,A){var L={},B=g.read_shift(4);L.defaultThemeVersion=g.read_shift(4);var W=A>8?parse_XLWideString(g):"";return W.length>0&&(L.CodeName=W),L.autoCompressPictures=!!(B&65536),L.backupFile=!!(B&64),L.checkCompatibility=!!(B&4096),L.date1904=!!(B&1),L.filterPrivacy=!!(B&8),L.hidePivotFieldList=!!(B&1024),L.promptedSolutions=!!(B&16),L.publishItems=!!(B&2048),L.refreshAllConnections=!!(B&262144),L.saveExternalLinkValues=!!(B&128),L.showBorderUnselectedTables=!!(B&4),L.showInkAnnotation=!!(B&32),L.showObjects=["all","placeholders","none"][B>>13&3],L.showPivotChartFilter=!!(B&32768),L.updateLinks=["userSet","never","always"][B>>8&3],L}function write_BrtWbProp(g,A){A||(A=new_buf(72));var L=0;return g&&g.filterPrivacy&&(L|=8),A.write_shift(4,L),A.write_shift(4,0),write_XLSBCodeName(g&&g.CodeName||"ThisWorkbook",A),A.slice(0,A.l)}function parse_BrtFRTArchID$(g,A){var L={};return g.read_shift(4),L.ArchID=g.read_shift(4),g.l+=A-8,L}function parse_BrtName(g,A,L){var B=g.l+A;g.l+=4,g.l+=1;var W=g.read_shift(4),q=parse_XLNameWideString(g),J=parse_XLSBNameParsedFormula(g,0,L),re=parse_XLNullableWideString(g);g.l=B;var ae={Name:q,Ptg:J};return W<268435455&&(ae.Sheet=W),re&&(ae.Comment=re),ae}function parse_wb_bin(g,A){var L={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},B=[],W=!1;A||(A={}),A.biff=12;var q=[],J=[[]];return J.SheetNames=[],J.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(g,function(ae,se,ie){switch(ie){case 156:J.SheetNames.push(ae.name),L.Sheets.push(ae);break;case 153:L.WBProps=ae;break;case 39:ae.Sheet!=null&&(A.SID=ae.Sheet),ae.Ref=stringify_formula(ae.Ptg,null,null,J,A),delete A.SID,delete ae.Ptg,q.push(ae);break;case 1036:break;case 357:case 358:case 355:case 667:J[0].length?J.push([ie,ae]):J[0]=[ie,ae],J[J.length-1].XTI=[];break;case 362:J.length===0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(ae),J.XTI=J.XTI.concat(ae);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:B.push(ie),W=!0;break;case 36:B.pop(),W=!1;break;case 37:B.push(ie),W=!0;break;case 38:B.pop(),W=!1;break;case 16:break;default:if(!se.T){if(!W||A.WTF&&B[B.length-1]!=37&&B[B.length-1]!=35)throw new Error("Unexpected record 0x"+ie.toString(16))}}},A),parse_wb_defaults(L),L.Names=q,L.supbooks=J,L}function write_BUNDLESHS(g,A){write_record(g,143);for(var L=0;L!=A.SheetNames.length;++L){var B=A.Workbook&&A.Workbook.Sheets&&A.Workbook.Sheets[L]&&A.Workbook.Sheets[L].Hidden||0,W={Hidden:B,iTabID:L+1,strRelID:"rId"+(L+1),name:A.SheetNames[L]};write_record(g,156,write_BrtBundleSh(W))}write_record(g,144)}function write_BrtFileVersion(g,A){A||(A=new_buf(127));for(var L=0;L!=4;++L)A.write_shift(4,0);return write_XLWideString("SheetJS",A),write_XLWideString(XLSX.version,A),write_XLWideString(XLSX.version,A),write_XLWideString("7262",A),A.length>A.l?A.slice(0,A.l):A}function write_BrtBookView(g,A){A||(A=new_buf(29)),A.write_shift(-4,0),A.write_shift(-4,460),A.write_shift(4,28800),A.write_shift(4,17600),A.write_shift(4,500),A.write_shift(4,g),A.write_shift(4,g);var L=120;return A.write_shift(1,L),A.length>A.l?A.slice(0,A.l):A}function write_BOOKVIEWS(g,A){if(!(!A.Workbook||!A.Workbook.Sheets)){for(var L=A.Workbook.Sheets,B=0,W=-1,q=-1;B<L.length;++B)!L[B]||!L[B].Hidden&&W==-1?W=B:L[B].Hidden==1&&q==-1&&(q=B);q>W||(write_record(g,135),write_record(g,158,write_BrtBookView(W)),write_record(g,136))}}function write_wb_bin(g,A){var L=buf_array();return write_record(L,131),write_record(L,128,write_BrtFileVersion()),write_record(L,153,write_BrtWbProp(g.Workbook&&g.Workbook.WBProps||null)),write_BOOKVIEWS(L,g),write_BUNDLESHS(L,g),write_record(L,132),L.end()}function parse_wb(g,A,L){return A.slice(-4)===".bin"?parse_wb_bin(g,L):parse_wb_xml(g,L)}function parse_ws(g,A,L,B,W,q,J,re){return A.slice(-4)===".bin"?parse_ws_bin(g,B,L,W,q,J,re):parse_ws_xml(g,B,L,W,q,J,re)}function parse_cs(g,A,L,B,W,q,J,re){return A.slice(-4)===".bin"?parse_cs_bin(g,B,L,W,q):parse_cs_xml(g,B,L,W,q)}function parse_ms(g,A,L,B,W,q,J,re){return A.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(g,A,L,B,W,q,J,re){return A.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(g,A,L,B){return A.slice(-4)===".bin"?parse_sty_bin(g,L,B):parse_sty_xml(g,L,B)}function parse_theme(g,A,L){return parse_theme_xml(g,L)}function parse_sst(g,A,L){return A.slice(-4)===".bin"?parse_sst_bin(g,L):parse_sst_xml(g,L)}function parse_cmnt(g,A,L){return A.slice(-4)===".bin"?parse_comments_bin(g,L):parse_comments_xml(g,L)}function parse_cc(g,A,L){return A.slice(-4)===".bin"?parse_cc_bin(g):parse_cc_xml(g)}function parse_xlink(g,A,L,B){return L.slice(-4)===".bin"?parse_xlink_bin(g,A,L,B):void 0}function parse_xlmeta(g,A,L){return A.slice(-4)===".bin"?parse_xlmeta_bin(g,A,L):parse_xlmeta_xml(g,A,L)}function write_wb(g,A,L){return(A.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(g)}function write_ws(g,A,L,B,W){return(A.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(g,L,B,W)}function write_sty(g,A,L){return(A.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(g,L)}function write_sst(g,A,L){return(A.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(g,L)}function write_cmnt(g,A,L){return(A.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(g)}function write_xlmeta(g){return(g.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(g,A){var L=g.split(/\s+/),B=[];if(B[0]=L[0],L.length===1)return B;var W=g.match(attregexg2),q,J,re,ae;if(W)for(ae=0;ae!=W.length;++ae)q=W[ae].match(attregex2),(J=q[1].indexOf(":"))===-1?B[q[1]]=q[2].slice(1,q[2].length-1):(q[1].slice(0,6)==="xmlns:"?re="xmlns"+q[1].slice(6):re=q[1].slice(J+1),B[re]=q[2].slice(1,q[2].length-1));return B}function xlml_parsexmltagobj(g){var A=g.split(/\s+/),L={};if(A.length===1)return L;var B=g.match(attregexg2),W,q,J,re;if(B)for(re=0;re!=B.length;++re)W=B[re].match(attregex2),(q=W[1].indexOf(":"))===-1?L[W[1]]=W[2].slice(1,W[2].length-1):(W[1].slice(0,6)==="xmlns:"?J="xmlns"+W[1].slice(6):J=W[1].slice(q+1),L[J]=W[2].slice(1,W[2].length-1));return L}var XLMLFormatMap;function xlml_format(g,A){var L=XLMLFormatMap[g]||unescapexml(g);return L==="General"?SSF_general(A):SSF_format(L,A)}function xlml_set_custprop(g,A,L,B){var W=B;switch((L[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":W=parsexmlbool(B);break;case"i2":case"int":W=parseInt(B,10);break;case"r4":case"float":W=parseFloat(B);break;case"date":case"dateTime.tz":W=parseDate(B);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+L[0])}g[unescapexml(A)]=W}function safe_format_xlml(g,A,L){if(g.t!=="z"){if(!L||L.cellText!==!1)try{g.t==="e"?g.w=g.w||BErr[g.v]:A==="General"?g.t==="n"?(g.v|0)===g.v?g.w=g.v.toString(10):g.w=SSF_general_num(g.v):g.w=SSF_general(g.v):g.w=xlml_format(A||"General",g.v)}catch(q){if(L.WTF)throw q}try{var B=XLMLFormatMap[A]||A||"General";if(L.cellNF&&(g.z=B),L.cellDates&&g.t=="n"&&fmt_is_date(B)){var W=SSF_parse_date_code(g.v);W&&(g.t="d",g.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}}catch(q){if(L.WTF)throw q}}}function process_style_xlml(g,A,L){if(L.cellStyles&&A.Interior){var B=A.Interior;B.Pattern&&(B.patternType=XLMLPatternTypeMap[B.Pattern]||B.Pattern)}g[A.ID]=A}function parse_xlml_data(g,A,L,B,W,q,J,re,ae,se){var ie="General",le=B.StyleID,pe={};se=se||{};var he=[],ue=0;for(le===void 0&&re&&(le=re.StyleID),le===void 0&&J&&(le=J.StyleID);q[le]!==void 0&&(q[le].nf&&(ie=q[le].nf),q[le].Interior&&he.push(q[le].Interior),!!q[le].Parent);)le=q[le].Parent;switch(L.Type){case"Boolean":B.t="b",B.v=parsexmlbool(g);break;case"String":B.t="s",B.r=xlml_fixstr(unescapexml(g)),B.v=g.indexOf("<")>-1?unescapexml(A||g).replace(/<.*?>/g,""):B.r;break;case"DateTime":g.slice(-1)!="Z"&&(g+="Z"),B.v=(parseDate(g)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),B.v!==B.v?B.v=unescapexml(g):B.v<60&&(B.v=B.v-1),(!ie||ie=="General")&&(ie="yyyy-mm-dd");case"Number":B.v===void 0&&(B.v=+g),B.t||(B.t="n");break;case"Error":B.t="e",B.v=RBErr[g],se.cellText!==!1&&(B.w=g);break;default:g==""&&A==""?B.t="z":(B.t="s",B.v=xlml_fixstr(A||g));break}if(safe_format_xlml(B,ie,se),se.cellFormula!==!1)if(B.Formula){var ce=unescapexml(B.Formula);ce.charCodeAt(0)==61&&(ce=ce.slice(1)),B.f=rc_to_a1(ce,W),delete B.Formula,B.ArrayRange=="RC"?B.F=rc_to_a1("RC:RC",W):B.ArrayRange&&(B.F=rc_to_a1(B.ArrayRange,W),ae.push([safe_decode_range(B.F),B.F]))}else for(ue=0;ue<ae.length;++ue)W.r>=ae[ue][0].s.r&&W.r<=ae[ue][0].e.r&&W.c>=ae[ue][0].s.c&&W.c<=ae[ue][0].e.c&&(B.F=ae[ue][1]);se.cellStyles&&(he.forEach(function(fe){!pe.patternType&&fe.patternType&&(pe.patternType=fe.patternType)}),B.s=pe),B.StyleID!==void 0&&(B.ixfe=B.StyleID)}function xlml_clean_comment(g){g.t=g.v||"",g.t=g.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),g.v=g.w=g.ixfe=void 0}function parse_xlml_xml(g,A){var L=A||{};make_ssf();var B=debom(xlml_normalize(g));(L.type=="binary"||L.type=="array"||L.type=="base64")&&(B=utf8read(B));var W=B.slice(0,1024).toLowerCase(),q=!1;if(W=W.replace(/".*?"/g,""),(W.indexOf(">")&1023)>Math.min(W.indexOf(",")&1023,W.indexOf(";")&1023)){var J=dup(L);return J.type="string",PRN.to_workbook(B,J)}if(W.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ht){W.indexOf("<"+ht)>=0&&(q=!0)}),q)return html_to_workbook(B,L);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var re,ae=[],se,ie={},le=[],pe=L.dense?[]:{},he="",ue={},ce={},fe=xlml_parsexmltag('<Data ss:Type="String">'),me=0,ke=0,xe=0,Le={s:{r:2e6,c:2e6},e:{r:0,c:0}},Se={},Te={},ge="",Ce=0,be=[],nt={},Ae={},De=0,lt=[],Ct=[],ft={},Et=[],gt,bt=!1,Ie=[],pt=[],at={},Ee=0,ye=0,ve={Sheets:[],WBProps:{date1904:!1}},Pe={};xlmlregex.lastIndex=0,B=B.replace(/<!--([\s\S]*?)-->/mg,"");for(var rt="";re=xlmlregex.exec(B);)switch(re[3]=(rt=re[3]).toLowerCase()){case"data":if(rt=="data"){if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"))}else re[0].charAt(re[0].length-2)!=="/"&&ae.push([re[3],!0]);break}if(ae[ae.length-1][1])break;re[1]==="/"?parse_xlml_data(B.slice(me,re.index),ge,fe,ae[ae.length-1][0]=="comment"?ft:ue,{c:ke,r:xe},Se,Et[ke],ce,Ie,L):(ge="",fe=xlml_parsexmltag(re[0]),me=re.index+re[0].length);break;case"cell":if(re[1]==="/")if(Ct.length>0&&(ue.c=Ct),(!L.sheetRows||L.sheetRows>xe)&&ue.v!==void 0&&(L.dense?(pe[xe]||(pe[xe]=[]),pe[xe][ke]=ue):pe[encode_col(ke)+encode_row(xe)]=ue),ue.HRef&&(ue.l={Target:unescapexml(ue.HRef)},ue.HRefScreenTip&&(ue.l.Tooltip=ue.HRefScreenTip),delete ue.HRef,delete ue.HRefScreenTip),(ue.MergeAcross||ue.MergeDown)&&(Ee=ke+(parseInt(ue.MergeAcross,10)|0),ye=xe+(parseInt(ue.MergeDown,10)|0),be.push({s:{c:ke,r:xe},e:{c:Ee,r:ye}})),!L.sheetStubs)ue.MergeAcross?ke=Ee+1:++ke;else if(ue.MergeAcross||ue.MergeDown){for(var st=ke;st<=Ee;++st)for(var ot=xe;ot<=ye;++ot)(st>ke||ot>xe)&&(L.dense?(pe[ot]||(pe[ot]=[]),pe[ot][st]={t:"z"}):pe[encode_col(st)+encode_row(ot)]={t:"z"});ke=Ee+1}else++ke;else ue=xlml_parsexmltagobj(re[0]),ue.Index&&(ke=+ue.Index-1),ke<Le.s.c&&(Le.s.c=ke),ke>Le.e.c&&(Le.e.c=ke),re[0].slice(-2)==="/>"&&++ke,Ct=[];break;case"row":re[1]==="/"||re[0].slice(-2)==="/>"?(xe<Le.s.r&&(Le.s.r=xe),xe>Le.e.r&&(Le.e.r=xe),re[0].slice(-2)==="/>"&&(ce=xlml_parsexmltag(re[0]),ce.Index&&(xe=+ce.Index-1)),ke=0,++xe):(ce=xlml_parsexmltag(re[0]),ce.Index&&(xe=+ce.Index-1),at={},(ce.AutoFitHeight=="0"||ce.Height)&&(at.hpx=parseInt(ce.Height,10),at.hpt=px2pt(at.hpx),pt[xe]=at),ce.Hidden=="1"&&(at.hidden=!0,pt[xe]=at));break;case"worksheet":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"));le.push(he),Le.s.r<=Le.e.r&&Le.s.c<=Le.e.c&&(pe["!ref"]=encode_range(Le),L.sheetRows&&L.sheetRows<=Le.e.r&&(pe["!fullref"]=pe["!ref"],Le.e.r=L.sheetRows-1,pe["!ref"]=encode_range(Le))),be.length&&(pe["!merges"]=be),Et.length>0&&(pe["!cols"]=Et),pt.length>0&&(pe["!rows"]=pt),ie[he]=pe}else Le={s:{r:2e6,c:2e6},e:{r:0,c:0}},xe=ke=0,ae.push([re[3],!1]),se=xlml_parsexmltag(re[0]),he=unescapexml(se.Name),pe=L.dense?[]:{},be=[],Ie=[],pt=[],Pe={name:he,Hidden:0},ve.Sheets.push(Pe);break;case"table":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"))}else{if(re[0].slice(-2)=="/>")break;ae.push([re[3],!1]),Et=[],bt=!1}break;case"style":re[1]==="/"?process_style_xlml(Se,Te,L):Te=xlml_parsexmltag(re[0]);break;case"numberformat":Te.nf=unescapexml(xlml_parsexmltag(re[0]).Format||"General"),XLMLFormatMap[Te.nf]&&(Te.nf=XLMLFormatMap[Te.nf]);for(var mt=0;mt!=392&&table_fmt[mt]!=Te.nf;++mt);if(mt==392){for(mt=57;mt!=392;++mt)if(table_fmt[mt]==null){SSF_load(Te.nf,mt);break}}break;case"column":if(ae[ae.length-1][0]!=="table")break;if(gt=xlml_parsexmltag(re[0]),gt.Hidden&&(gt.hidden=!0,delete gt.Hidden),gt.Width&&(gt.wpx=parseInt(gt.Width,10)),!bt&&gt.wpx>10){bt=!0,MDW=DEF_MDW;for(var At=0;At<Et.length;++At)Et[At]&&process_col(Et[At])}bt&&process_col(gt),Et[gt.Index-1||Et.length]=gt;for(var It=0;It<+gt.Span;++It)Et[Et.length]=dup(gt);break;case"namedrange":if(re[1]==="/")break;ve.Names||(ve.Names=[]);var it=parsexmltag(re[0]),Vt={Name:it.Name,Ref:rc_to_a1(it.RefersTo.slice(1),{r:0,c:0})};ve.Sheets.length>0&&(Vt.Sheet=ve.Sheets.length-1),ve.Names.push(Vt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(re[0].slice(-2)==="/>")break;re[1]==="/"?ge+=B.slice(Ce,re.index):Ce=re.index+re[0].length;break;case"interior":if(!L.cellStyles)break;Te.Interior=xlml_parsexmltag(re[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(re[0].slice(-2)==="/>")break;re[1]==="/"?xlml_set_prop(nt,rt,B.slice(De,re.index)):De=re.index+re[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"))}else ae.push([re[3],!1]);break;case"comment":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"));xlml_clean_comment(ft),Ct.push(ft)}else ae.push([re[3],!1]),se=xlml_parsexmltag(re[0]),ft={a:se.Author};break;case"autofilter":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"))}else if(re[0].charAt(re[0].length-2)!=="/"){var Yt=xlml_parsexmltag(re[0]);pe["!autofilter"]={ref:rc_to_a1(Yt.Range).replace(/\$/g,"")},ae.push([re[3],!0])}break;case"name":break;case"datavalidation":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"))}else re[0].charAt(re[0].length-2)!=="/"&&ae.push([re[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(re[1]==="/"){if((se=ae.pop())[0]!==re[3])throw new Error("Bad state: "+se.join("|"))}else re[0].charAt(re[0].length-2)!=="/"&&ae.push([re[3],!0]);break;case"null":break;default:if(ae.length==0&&re[3]=="document"||ae.length==0&&re[3]=="uof")return parse_fods(B,L);var Zt=!0;switch(ae[ae.length-1][0]){case"officedocumentsettings":switch(re[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Zt=!1}break;case"componentoptions":switch(re[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Zt=!1}break;case"excelworkbook":switch(re[3]){case"date1904":ve.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Zt=!1}break;case"workbookoptions":switch(re[3]){case"owcversion":break;case"height":break;case"width":break;default:Zt=!1}break;case"worksheetoptions":switch(re[3]){case"visible":if(re[0].slice(-2)!=="/>")if(re[1]==="/")switch(B.slice(De,re.index)){case"SheetHidden":Pe.Hidden=1;break;case"SheetVeryHidden":Pe.Hidden=2;break}else De=re.index+re[0].length;break;case"header":pe["!margins"]||default_margins(pe["!margins"]={},"xlml"),isNaN(+parsexmltag(re[0]).Margin)||(pe["!margins"].header=+parsexmltag(re[0]).Margin);break;case"footer":pe["!margins"]||default_margins(pe["!margins"]={},"xlml"),isNaN(+parsexmltag(re[0]).Margin)||(pe["!margins"].footer=+parsexmltag(re[0]).Margin);break;case"pagemargins":var Lt=parsexmltag(re[0]);pe["!margins"]||default_margins(pe["!margins"]={},"xlml"),isNaN(+Lt.Top)||(pe["!margins"].top=+Lt.Top),isNaN(+Lt.Left)||(pe["!margins"].left=+Lt.Left),isNaN(+Lt.Right)||(pe["!margins"].right=+Lt.Right),isNaN(+Lt.Bottom)||(pe["!margins"].bottom=+Lt.Bottom);break;case"displayrighttoleft":ve.Views||(ve.Views=[]),ve.Views[0]||(ve.Views[0]={}),ve.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":pe["!outline"]||(pe["!outline"]={}),pe["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":pe["!outline"]||(pe["!outline"]={}),pe["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Zt=!1}break;case"pivottable":case"pivotcache":switch(re[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Zt=!1}break;case"pagebreaks":switch(re[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Zt=!1}break;case"autofilter":switch(re[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Zt=!1}break;case"querytable":switch(re[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Zt=!1}break;case"datavalidation":switch(re[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Zt=!1}break;case"sorting":case"conditionalformatting":switch(re[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Zt=!1}break;case"mapinfo":case"schema":case"data":switch(re[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Zt=!1}break;case"smarttags":break;default:Zt=!1;break}if(Zt||re[3].match(/!\[CDATA/))break;if(!ae[ae.length-1][1])throw"Unrecognized tag: "+re[3]+"|"+ae.join("|");if(ae[ae.length-1][0]==="customdocumentproperties"){if(re[0].slice(-2)==="/>")break;re[1]==="/"?xlml_set_custprop(Ae,rt,lt,B.slice(De,re.index)):(lt=re,De=re.index+re[0].length);break}if(L.WTF)throw"Unrecognized tag: "+re[3]+"|"+ae.join("|")}var Ft={};return!L.bookSheets&&!L.bookProps&&(Ft.Sheets=ie),Ft.SheetNames=le,Ft.Workbook=ve,Ft.SSF=dup(table_fmt),Ft.Props=nt,Ft.Custprops=Ae,Ft}function parse_xlml(g,A){switch(fix_read_opts(A=A||{}),A.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(g),A);case"binary":case"buffer":case"file":return parse_xlml_xml(g,A);case"array":return parse_xlml_xml(a2s(g),A)}}function write_props_xlml(g,A){var L=[];return g.Props&&L.push(xlml_write_docprops(g.Props,A)),g.Custprops&&L.push(xlml_write_custprops(g.Props,g.Custprops)),L.join("")}function write_wb_xlml(){return""}function write_sty_xlml(g,A){var L=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return A.cellXfs.forEach(function(B,W){var q=[];q.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[B.numFmtId])}));var J={"ss:ID":"s"+(21+W)};L.push(writextag("Style",q.join(""),J))}),writextag("Styles",L.join(""))}function write_name_xlml(g){return writextag("NamedRange",null,{"ss:Name":g.Name,"ss:RefersTo":"="+a1_to_rc(g.Ref,{r:0,c:0})})}function write_names_xlml(g){if(!((g||{}).Workbook||{}).Names)return"";for(var A=g.Workbook.Names,L=[],B=0;B<A.length;++B){var W=A[B];W.Sheet==null&&(W.Name.match(/^_xlfn\./)||L.push(write_name_xlml(W)))}return writextag("Names",L.join(""))}function write_ws_xlml_names(g,A,L,B){if(!g||!((B||{}).Workbook||{}).Names)return"";for(var W=B.Workbook.Names,q=[],J=0;J<W.length;++J){var re=W[J];re.Sheet==L&&(re.Name.match(/^_xlfn\./)||q.push(write_name_xlml(re)))}return q.join("")}function write_ws_xlml_wsopts(g,A,L,B){if(!g)return"";var W=[];if(g["!margins"]&&(W.push("<PageSetup>"),g["!margins"].header&&W.push(writextag("Header",null,{"x:Margin":g["!margins"].header})),g["!margins"].footer&&W.push(writextag("Footer",null,{"x:Margin":g["!margins"].footer})),W.push(writextag("PageMargins",null,{"x:Bottom":g["!margins"].bottom||"0.75","x:Left":g["!margins"].left||"0.7","x:Right":g["!margins"].right||"0.7","x:Top":g["!margins"].top||"0.75"})),W.push("</PageSetup>")),B&&B.Workbook&&B.Workbook.Sheets&&B.Workbook.Sheets[L])if(B.Workbook.Sheets[L].Hidden)W.push(writextag("Visible",B.Workbook.Sheets[L].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var q=0;q<L&&!(B.Workbook.Sheets[q]&&!B.Workbook.Sheets[q].Hidden);++q);q==L&&W.push("<Selected/>")}return((((B||{}).Workbook||{}).Views||[])[0]||{}).RTL&&W.push("<DisplayRightToLeft/>"),g["!protect"]&&(W.push(writetag("ProtectContents","True")),g["!protect"].objects&&W.push(writetag("ProtectObjects","True")),g["!protect"].scenarios&&W.push(writetag("ProtectScenarios","True")),g["!protect"].selectLockedCells!=null&&!g["!protect"].selectLockedCells?W.push(writetag("EnableSelection","NoSelection")):g["!protect"].selectUnlockedCells!=null&&!g["!protect"].selectUnlockedCells&&W.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(J){g["!protect"][J[0]]&&W.push("<"+J[1]+"/>")})),W.length==0?"":writextag("WorksheetOptions",W.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(g){return g.map(function(A){var L=xlml_unfixstr(A.t||""),B=writextag("ss:Data",L,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",B,{"ss:Author":A.a})}).join("")}function write_ws_xlml_cell(g,A,L,B,W,q,J){if(!g||g.v==null&&g.f==null)return"";var re={};if(g.f&&(re["ss:Formula"]="="+escapexml(a1_to_rc(g.f,J))),g.F&&g.F.slice(0,A.length)==A){var ae=decode_cell(g.F.slice(A.length+1));re["ss:ArrayRange"]="RC:R"+(ae.r==J.r?"":"["+(ae.r-J.r)+"]")+"C"+(ae.c==J.c?"":"["+(ae.c-J.c)+"]")}if(g.l&&g.l.Target&&(re["ss:HRef"]=escapexml(g.l.Target),g.l.Tooltip&&(re["x:HRefScreenTip"]=escapexml(g.l.Tooltip))),L["!merges"])for(var se=L["!merges"],ie=0;ie!=se.length;++ie)se[ie].s.c!=J.c||se[ie].s.r!=J.r||(se[ie].e.c>se[ie].s.c&&(re["ss:MergeAcross"]=se[ie].e.c-se[ie].s.c),se[ie].e.r>se[ie].s.r&&(re["ss:MergeDown"]=se[ie].e.r-se[ie].s.r));var le="",pe="";switch(g.t){case"z":if(!B.sheetStubs)return"";break;case"n":le="Number",pe=String(g.v);break;case"b":le="Boolean",pe=g.v?"1":"0";break;case"e":le="Error",pe=BErr[g.v];break;case"d":le="DateTime",pe=new Date(g.v).toISOString(),g.z==null&&(g.z=g.z||table_fmt[14]);break;case"s":le="String",pe=escapexlml(g.v||"");break}var he=get_cell_style(B.cellXfs,g,B);re["ss:StyleID"]="s"+(21+he),re["ss:Index"]=J.c+1;var ue=g.v!=null?pe:"",ce=g.t=="z"?"":'<Data ss:Type="'+le+'">'+ue+"</Data>";return(g.c||[]).length>0&&(ce+=write_ws_xlml_comment(g.c)),writextag("Cell",ce,re)}function write_ws_xlml_row(g,A){var L='<Row ss:Index="'+(g+1)+'"';return A&&(A.hpt&&!A.hpx&&(A.hpx=pt2px(A.hpt)),A.hpx&&(L+=' ss:AutoFitHeight="0" ss:Height="'+A.hpx+'"'),A.hidden&&(L+=' ss:Hidden="1"')),L+">"}function write_ws_xlml_table(g,A,L,B){if(!g["!ref"])return"";var W=safe_decode_range(g["!ref"]),q=g["!merges"]||[],J=0,re=[];g["!cols"]&&g["!cols"].forEach(function(fe,me){process_col(fe);var ke=!!fe.width,xe=col_obj_w(me,fe),Le={"ss:Index":me+1};ke&&(Le["ss:Width"]=width2px(xe.width)),fe.hidden&&(Le["ss:Hidden"]="1"),re.push(writextag("Column",null,Le))});for(var ae=Array.isArray(g),se=W.s.r;se<=W.e.r;++se){for(var ie=[write_ws_xlml_row(se,(g["!rows"]||[])[se])],le=W.s.c;le<=W.e.c;++le){var pe=!1;for(J=0;J!=q.length;++J)if(!(q[J].s.c>le)&&!(q[J].s.r>se)&&!(q[J].e.c<le)&&!(q[J].e.r<se)){(q[J].s.c!=le||q[J].s.r!=se)&&(pe=!0);break}if(!pe){var he={r:se,c:le},ue=encode_cell(he),ce=ae?(g[se]||[])[le]:g[ue];ie.push(write_ws_xlml_cell(ce,ue,g,A,L,B,he))}}ie.push("</Row>"),ie.length>2&&re.push(ie.join(""))}return re.join("")}function write_ws_xlml(g,A,L){var B=[],W=L.SheetNames[g],q=L.Sheets[W],J=q?write_ws_xlml_names(q,A,g,L):"";return J.length>0&&B.push("<Names>"+J+"</Names>"),J=q?write_ws_xlml_table(q,A,g,L):"",J.length>0&&B.push("<Table>"+J+"</Table>"),B.push(write_ws_xlml_wsopts(q,A,g,L)),B.join("")}function write_xlml(g,A){A||(A={}),g.SSF||(g.SSF=dup(table_fmt)),g.SSF&&(make_ssf(),SSF_load_table(g.SSF),A.revssf=evert_num(g.SSF),A.revssf[g.SSF[65535]]=0,A.ssf=g.SSF,A.cellXfs=[],get_cell_style(A.cellXfs,{},{revssf:{General:0}}));var L=[];L.push(write_props_xlml(g,A)),L.push(write_wb_xlml()),L.push(""),L.push("");for(var B=0;B<g.SheetNames.length;++B)L.push(writextag("Worksheet",write_ws_xlml(B,A,g),{"ss:Name":escapexml(g.SheetNames[B])}));return L[2]=write_sty_xlml(g,A),L[3]=write_names_xlml(g),XML_HEADER+writextag("Workbook",L.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(g){var A={},L=g.content;if(L.l=28,A.AnsiUserType=L.read_shift(0,"lpstr-ansi"),A.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(L),L.length-L.l<=4)return A;var B=L.read_shift(4);if(B==0||B>40||(L.l-=4,A.Reserved1=L.read_shift(0,"lpstr-ansi"),L.length-L.l<=4)||(B=L.read_shift(4),B!==1907505652)||(A.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(L),B=L.read_shift(4),B==0||B>40))return A;L.l-=4,A.Reserved2=L.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(g,A,L,B,W){var q=B,J=[],re=L.slice(L.l,L.l+q);if(W&&W.enc&&W.enc.insitu&&re.length>0)switch(g){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:W.enc.insitu(re)}J.push(re),L.l+=q;for(var ae=__readUInt16LE(L,L.l),se=XLSRecordEnum[ae],ie=0;se!=null&&CONTINUE_RT.indexOf(ae)>-1;)q=__readUInt16LE(L,L.l+2),ie=L.l+4,ae==2066?ie+=4:(ae==2165||ae==2175)&&(ie+=12),re=L.slice(ie,L.l+4+q),J.push(re),L.l+=4+q,se=XLSRecordEnum[ae=__readUInt16LE(L,L.l)];var le=bconcat(J);prep_blob(le,0);var pe=0;le.lens=[];for(var he=0;he<J.length;++he)le.lens.push(pe),pe+=J[he].length;if(le.length<B)throw"XLS Record 0x"+g.toString(16)+" Truncated: "+le.length+" < "+B;return A.f(le,le.length,W)}function safe_format_xf(g,A,L){if(g.t!=="z"&&g.XF){var B=0;try{B=g.z||g.XF.numFmtId||0,A.cellNF&&(g.z=table_fmt[B])}catch(q){if(A.WTF)throw q}if(!A||A.cellText!==!1)try{g.t==="e"?g.w=g.w||BErr[g.v]:B===0||B=="General"?g.t==="n"?(g.v|0)===g.v?g.w=g.v.toString(10):g.w=SSF_general_num(g.v):g.w=SSF_general(g.v):g.w=SSF_format(B,g.v,{date1904:!!L,dateNF:A&&A.dateNF})}catch(q){if(A.WTF)throw q}if(A.cellDates&&B&&g.t=="n"&&fmt_is_date(table_fmt[B]||String(B))){var W=SSF_parse_date_code(g.v);W&&(g.t="d",g.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}}}function make_cell(g,A,L){return{v:g,ixfe:A,t:L}}function parse_workbook(g,A){var L={opts:{}},B={},W=A.dense?[]:{},q={},J={},re=null,ae=[],se="",ie={},le,pe="",he,ue,ce,fe,me={},ke=[],xe,Le,Se=[],Te=[],ge={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Ce={},be=function(vr){return vr<8?XLSIcv[vr]:vr<64&&Te[vr-8]||XLSIcv[vr]},nt=function(vr,dr,br){var Ir=dr.XF.data;if(!(!Ir||!Ir.patternType||!br||!br.cellStyles)){dr.s={},dr.s.patternType=Ir.patternType;var zr;(zr=rgb2Hex(be(Ir.icvFore)))&&(dr.s.fgColor={rgb:zr}),(zr=rgb2Hex(be(Ir.icvBack)))&&(dr.s.bgColor={rgb:zr})}},Ae=function(vr,dr,br){if(!(at>1)&&!(br.sheetRows&&vr.r>=br.sheetRows)){if(br.cellStyles&&dr.XF&&dr.XF.data&&nt(vr,dr,br),delete dr.ixfe,delete dr.XF,le=vr,pe=encode_cell(vr),(!J||!J.s||!J.e)&&(J={s:{r:0,c:0},e:{r:0,c:0}}),vr.r<J.s.r&&(J.s.r=vr.r),vr.c<J.s.c&&(J.s.c=vr.c),vr.r+1>J.e.r&&(J.e.r=vr.r+1),vr.c+1>J.e.c&&(J.e.c=vr.c+1),br.cellFormula&&dr.f){for(var Ir=0;Ir<ke.length;++Ir)if(!(ke[Ir][0].s.c>vr.c||ke[Ir][0].s.r>vr.r)&&!(ke[Ir][0].e.c<vr.c||ke[Ir][0].e.r<vr.r)){dr.F=encode_range(ke[Ir][0]),(ke[Ir][0].s.c!=vr.c||ke[Ir][0].s.r!=vr.r)&&delete dr.f,dr.f&&(dr.f=""+stringify_formula(ke[Ir][1],J,vr,Ie,De));break}}br.dense?(W[vr.r]||(W[vr.r]=[]),W[vr.r][vr.c]=dr):W[pe]=dr}},De={enc:!1,sbcch:0,snames:[],sharedf:me,arrayf:ke,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!A&&!!A.cellStyles,WTF:!!A&&!!A.wtf};A.password&&(De.password=A.password);var lt,Ct=[],ft=[],Et=[],gt=[],bt=!1,Ie=[];Ie.SheetNames=De.snames,Ie.sharedf=De.sharedf,Ie.arrayf=De.arrayf,Ie.names=[],Ie.XTI=[];var pt=0,at=0,Ee=0,ye=[],ve=[],Pe;De.codepage=1200,set_cp(1200);for(var rt=!1;g.l<g.length-1;){var st=g.l,ot=g.read_shift(2);if(ot===0&&pt===10)break;var mt=g.l===g.length?0:g.read_shift(2),At=XLSRecordEnum[ot];if(At&&At.f){if(A.bookSheets&&pt===133&&ot!==133)break;if(pt=ot,At.r===2||At.r==12){var It=g.read_shift(2);if(mt-=2,!De.enc&&It!==ot&&((It&255)<<8|It>>8)!==ot)throw new Error("rt mismatch: "+It+"!="+ot);At.r==12&&(g.l+=10,mt-=10)}var it={};if(ot===10?it=At.f(g,mt,De):it=slurp(ot,At,g,mt,De),at==0&&[9,521,1033,2057].indexOf(pt)===-1)continue;switch(ot){case 34:L.opts.Date1904=ge.WBProps.date1904=it;break;case 134:L.opts.WriteProtect=!0;break;case 47:if(De.enc||(g.l=0),De.enc=it,!A.password)throw new Error("File is password-protected");if(it.valid==null)throw new Error("Encryption scheme unsupported");if(!it.valid)throw new Error("Password is incorrect");break;case 92:De.lastuser=it;break;case 66:var Vt=Number(it);switch(Vt){case 21010:Vt=1200;break;case 32768:Vt=1e4;break;case 32769:Vt=1252;break}set_cp(De.codepage=Vt),rt=!0;break;case 317:De.rrtabid=it;break;case 25:De.winlocked=it;break;case 439:L.opts.RefreshAll=it;break;case 12:L.opts.CalcCount=it;break;case 16:L.opts.CalcDelta=it;break;case 17:L.opts.CalcIter=it;break;case 13:L.opts.CalcMode=it;break;case 14:L.opts.CalcPrecision=it;break;case 95:L.opts.CalcSaveRecalc=it;break;case 15:De.CalcRefMode=it;break;case 2211:L.opts.FullCalc=it;break;case 129:it.fDialog&&(W["!type"]="dialog"),it.fBelow||((W["!outline"]||(W["!outline"]={})).above=!0),it.fRight||((W["!outline"]||(W["!outline"]={})).left=!0);break;case 224:Se.push(it);break;case 430:Ie.push([it]),Ie[Ie.length-1].XTI=[];break;case 35:case 547:Ie[Ie.length-1].push(it);break;case 24:case 536:Pe={Name:it.Name,Ref:stringify_formula(it.rgce,J,null,Ie,De)},it.itab>0&&(Pe.Sheet=it.itab-1),Ie.names.push(Pe),Ie[0]||(Ie[0]=[],Ie[0].XTI=[]),Ie[Ie.length-1].push(it),it.Name=="_xlnm._FilterDatabase"&&it.itab>0&&it.rgce&&it.rgce[0]&&it.rgce[0][0]&&it.rgce[0][0][0]=="PtgArea3d"&&(ve[it.itab-1]={ref:encode_range(it.rgce[0][0][1][2])});break;case 22:De.ExternCount=it;break;case 23:Ie.length==0&&(Ie[0]=[],Ie[0].XTI=[]),Ie[Ie.length-1].XTI=Ie[Ie.length-1].XTI.concat(it),Ie.XTI=Ie.XTI.concat(it);break;case 2196:if(De.biff<8)break;Pe!=null&&(Pe.Comment=it[1]);break;case 18:W["!protect"]=it;break;case 19:it!==0&&De.WTF&&console.error("Password verifier: "+it);break;case 133:q[it.pos]=it,De.snames.push(it.name);break;case 10:{if(--at)break;if(J.e){if(J.e.r>0&&J.e.c>0){if(J.e.r--,J.e.c--,W["!ref"]=encode_range(J),A.sheetRows&&A.sheetRows<=J.e.r){var Yt=J.e.r;J.e.r=A.sheetRows-1,W["!fullref"]=W["!ref"],W["!ref"]=encode_range(J),J.e.r=Yt}J.e.r++,J.e.c++}Ct.length>0&&(W["!merges"]=Ct),ft.length>0&&(W["!objects"]=ft),Et.length>0&&(W["!cols"]=Et),gt.length>0&&(W["!rows"]=gt),ge.Sheets.push(Ce)}se===""?ie=W:B[se]=W,W=A.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(De.biff===8&&(De.biff={9:2,521:3,1033:4}[ot]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[it.BIFFVer]||8),De.biffguess=it.BIFFVer==0,it.BIFFVer==0&&it.dt==4096&&(De.biff=5,rt=!0,set_cp(De.codepage=28591)),De.biff==8&&it.BIFFVer==0&&it.dt==16&&(De.biff=2),at++)break;if(W=A.dense?[]:{},De.biff<8&&!rt&&(rt=!0,set_cp(De.codepage=A.codepage||1252)),De.biff<5||it.BIFFVer==0&&it.dt==4096){se===""&&(se="Sheet1"),J={s:{r:0,c:0},e:{r:0,c:0}};var Zt={pos:g.l-mt,name:se};q[Zt.pos]=Zt,De.snames.push(se)}else se=(q[st]||{name:""}).name;it.dt==32&&(W["!type"]="chart"),it.dt==64&&(W["!type"]="macro"),Ct=[],ft=[],De.arrayf=ke=[],Et=[],gt=[],bt=!1,Ce={Hidden:(q[st]||{hs:0}).hs,name:se}}break;case 515:case 3:case 2:W["!type"]=="chart"&&(A.dense?(W[it.r]||[])[it.c]:W[encode_cell({c:it.c,r:it.r})])&&++it.c,xe={ixfe:it.ixfe,XF:Se[it.ixfe]||{},v:it.val,t:"n"},Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:it.c,r:it.r},xe,A);break;case 5:case 517:xe={ixfe:it.ixfe,XF:Se[it.ixfe],v:it.val,t:it.t},Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:it.c,r:it.r},xe,A);break;case 638:xe={ixfe:it.ixfe,XF:Se[it.ixfe],v:it.rknum,t:"n"},Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:it.c,r:it.r},xe,A);break;case 189:for(var Lt=it.c;Lt<=it.C;++Lt){var Ft=it.rkrec[Lt-it.c][0];xe={ixfe:Ft,XF:Se[Ft],v:it.rkrec[Lt-it.c][1],t:"n"},Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:Lt,r:it.r},xe,A)}break;case 6:case 518:case 1030:{if(it.val=="String"){re=it;break}if(xe=make_cell(it.val,it.cell.ixfe,it.tt),xe.XF=Se[xe.ixfe],A.cellFormula){var ht=it.formula;if(ht&&ht[0]&&ht[0][0]&&ht[0][0][0]=="PtgExp"){var kt=ht[0][0][1][0],Dt=ht[0][0][1][1],Bt=encode_cell({r:kt,c:Dt});me[Bt]?xe.f=""+stringify_formula(it.formula,J,it.cell,Ie,De):xe.F=((A.dense?(W[kt]||[])[Dt]:W[Bt])||{}).F}else xe.f=""+stringify_formula(it.formula,J,it.cell,Ie,De)}Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae(it.cell,xe,A),re=it}break;case 7:case 519:if(re)re.val=it,xe=make_cell(it,re.cell.ixfe,"s"),xe.XF=Se[xe.ixfe],A.cellFormula&&(xe.f=""+stringify_formula(re.formula,J,re.cell,Ie,De)),Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae(re.cell,xe,A),re=null;else throw new Error("String record expects Formula");break;case 33:case 545:{ke.push(it);var Qt=encode_cell(it[0].s);if(he=A.dense?(W[it[0].s.r]||[])[it[0].s.c]:W[Qt],A.cellFormula&&he){if(!re||!Qt||!he)break;he.f=""+stringify_formula(it[1],J,it[0],Ie,De),he.F=encode_range(it[0])}}break;case 1212:{if(!A.cellFormula)break;if(pe){if(!re)break;me[encode_cell(re.cell)]=it[0],he=A.dense?(W[re.cell.r]||[])[re.cell.c]:W[encode_cell(re.cell)],(he||{}).f=""+stringify_formula(it[0],J,le,Ie,De)}}break;case 253:xe=make_cell(ae[it.isst].t,it.ixfe,"s"),ae[it.isst].h&&(xe.h=ae[it.isst].h),xe.XF=Se[xe.ixfe],Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:it.c,r:it.r},xe,A);break;case 513:A.sheetStubs&&(xe={ixfe:it.ixfe,XF:Se[it.ixfe],t:"z"},Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:it.c,r:it.r},xe,A));break;case 190:if(A.sheetStubs)for(var or=it.c;or<=it.C;++or){var ar=it.ixfe[or-it.c];xe={ixfe:ar,XF:Se[ar],t:"z"},Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:or,r:it.r},xe,A)}break;case 214:case 516:case 4:xe=make_cell(it.val,it.ixfe,"s"),xe.XF=Se[xe.ixfe],Ee>0&&(xe.z=ye[xe.ixfe>>8&63]),safe_format_xf(xe,A,L.opts.Date1904),Ae({c:it.c,r:it.r},xe,A);break;case 0:case 512:at===1&&(J=it);break;case 252:ae=it;break;case 1054:if(De.biff==4){ye[Ee++]=it[1];for(var Nt=0;Nt<Ee+163&&table_fmt[Nt]!=it[1];++Nt);Nt>=163&&SSF_load(it[1],Ee+163)}else SSF_load(it[1],it[0]);break;case 30:{ye[Ee++]=it;for(var fr=0;fr<Ee+163&&table_fmt[fr]!=it;++fr);fr>=163&&SSF_load(it,Ee+163)}break;case 229:Ct=Ct.concat(it);break;case 93:ft[it.cmo[0]]=De.lastobj=it;break;case 438:De.lastobj.TxO=it;break;case 127:De.lastobj.ImData=it;break;case 440:for(fe=it[0].s.r;fe<=it[0].e.r;++fe)for(ce=it[0].s.c;ce<=it[0].e.c;++ce)he=A.dense?(W[fe]||[])[ce]:W[encode_cell({c:ce,r:fe})],he&&(he.l=it[1]);break;case 2048:for(fe=it[0].s.r;fe<=it[0].e.r;++fe)for(ce=it[0].s.c;ce<=it[0].e.c;++ce)he=A.dense?(W[fe]||[])[ce]:W[encode_cell({c:ce,r:fe})],he&&he.l&&(he.l.Tooltip=it[1]);break;case 28:{if(De.biff<=5&&De.biff>=2)break;he=A.dense?(W[it[0].r]||[])[it[0].c]:W[encode_cell(it[0])];var ur=ft[it[2]];he||(A.dense?(W[it[0].r]||(W[it[0].r]=[]),he=W[it[0].r][it[0].c]={t:"z"}):he=W[encode_cell(it[0])]={t:"z"},J.e.r=Math.max(J.e.r,it[0].r),J.s.r=Math.min(J.s.r,it[0].r),J.e.c=Math.max(J.e.c,it[0].c),J.s.c=Math.min(J.s.c,it[0].c)),he.c||(he.c=[]),ue={a:it[1],t:ur.TxO.t},he.c.push(ue)}break;case 2173:update_xfext(Se[it.ixfe],it.ext);break;case 125:{if(!De.cellStyles)break;for(;it.e>=it.s;)Et[it.e--]={width:it.w/256,level:it.level||0,hidden:!!(it.flags&1)},bt||(bt=!0,find_mdw_colw(it.w/256)),process_col(Et[it.e+1])}break;case 520:{var Pr={};it.level!=null&&(gt[it.r]=Pr,Pr.level=it.level),it.hidden&&(gt[it.r]=Pr,Pr.hidden=!0),it.hpt&&(gt[it.r]=Pr,Pr.hpt=it.hpt,Pr.hpx=pt2px(it.hpt))}break;case 38:case 39:case 40:case 41:W["!margins"]||default_margins(W["!margins"]={}),W["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ot]]=it;break;case 161:W["!margins"]||default_margins(W["!margins"]={}),W["!margins"].header=it.header,W["!margins"].footer=it.footer;break;case 574:it.RTL&&(ge.Views[0].RTL=!0);break;case 146:Te=it;break;case 2198:lt=it;break;case 140:Le=it;break;case 442:se?Ce.CodeName=it||Ce.name:ge.WBProps.CodeName=it||"ThisWorkbook";break}}else At||console.error("Missing Info for XLS Record 0x"+ot.toString(16)),g.l+=mt}return L.SheetNames=keys(q).sort(function(Rr,vr){return Number(Rr)-Number(vr)}).map(function(Rr){return q[Rr].name}),A.bookSheets||(L.Sheets=B),!L.SheetNames.length&&ie["!ref"]?(L.SheetNames.push("Sheet1"),L.Sheets&&(L.Sheets.Sheet1=ie)):L.Preamble=ie,L.Sheets&&ve.forEach(function(Rr,vr){L.Sheets[L.SheetNames[vr]]["!autofilter"]=Rr}),L.Strings=ae,L.SSF=dup(table_fmt),De.enc&&(L.Encryption=De.enc),lt&&(L.Themes=lt),L.Metadata={},Le!==void 0&&(L.Metadata.Country=Le),Ie.names.length>0&&(ge.Names=Ie.names),L.Workbook=ge,L}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(g,A,L){var B=CFB.find(g,"/!DocumentSummaryInformation");if(B&&B.size>0)try{var W=parse_PropertySetStream(B,DocSummaryPIDDSI,PSCLSID.DSI);for(var q in W)A[q]=W[q]}catch(se){if(L.WTF)throw se}var J=CFB.find(g,"/!SummaryInformation");if(J&&J.size>0)try{var re=parse_PropertySetStream(J,SummaryPIDSI,PSCLSID.SI);for(var ae in re)A[ae]==null&&(A[ae]=re[ae])}catch(se){if(L.WTF)throw se}A.HeadingPairs&&A.TitlesOfParts&&(load_props_pairs(A.HeadingPairs,A.TitlesOfParts,A,L),delete A.HeadingPairs,delete A.TitlesOfParts)}function write_xls_props(g,A){var L=[],B=[],W=[],q=0,J,re=evert_key(DocSummaryPIDDSI,"n"),ae=evert_key(SummaryPIDSI,"n");if(g.Props)for(J=keys(g.Props),q=0;q<J.length;++q)(Object.prototype.hasOwnProperty.call(re,J[q])?L:Object.prototype.hasOwnProperty.call(ae,J[q])?B:W).push([J[q],g.Props[J[q]]]);if(g.Custprops)for(J=keys(g.Custprops),q=0;q<J.length;++q)Object.prototype.hasOwnProperty.call(g.Props||{},J[q])||(Object.prototype.hasOwnProperty.call(re,J[q])?L:Object.prototype.hasOwnProperty.call(ae,J[q])?B:W).push([J[q],g.Custprops[J[q]]]);var se=[];for(q=0;q<W.length;++q)XLSPSSkip.indexOf(W[q][0])>-1||PseudoPropsPairs.indexOf(W[q][0])>-1||W[q][1]!=null&&se.push(W[q]);B.length&&CFB.utils.cfb_add(A,"/SummaryInformation",write_PropertySetStream(B,PSCLSID.SI,ae,SummaryPIDSI)),(L.length||se.length)&&CFB.utils.cfb_add(A,"/DocumentSummaryInformation",write_PropertySetStream(L,PSCLSID.DSI,re,DocSummaryPIDDSI,se.length?se:null,PSCLSID.UDI))}function parse_xlscfb(g,A){A||(A={}),fix_read_opts(A),reset_cp(),A.codepage&&set_ansi(A.codepage);var L,B;if(g.FullPaths){if(CFB.find(g,"/encryption"))throw new Error("File is password-protected");L=CFB.find(g,"!CompObj"),B=CFB.find(g,"/Workbook")||CFB.find(g,"/Book")}else{switch(A.type){case"base64":g=s2a(Base64_decode(g));break;case"binary":g=s2a(g);break;case"buffer":break;case"array":Array.isArray(g)||(g=Array.prototype.slice.call(g));break}prep_blob(g,0),B={content:g}}var W,q;if(L&&parse_compobj(L),A.bookProps&&!A.bookSheets)W={};else{var J=has_buf?"buffer":"array";if(B&&B.content)W=parse_workbook(B.content,A);else if((q=CFB.find(g,"PerfectOffice_MAIN"))&&q.content)W=WK_.to_workbook(q.content,(A.type=J,A));else if((q=CFB.find(g,"NativeContent_MAIN"))&&q.content)W=WK_.to_workbook(q.content,(A.type=J,A));else throw(q=CFB.find(g,"MN0"))&&q.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");A.bookVBA&&g.FullPaths&&CFB.find(g,"/_VBA_PROJECT_CUR/VBA/dir")&&(W.vbaraw=make_vba_xls(g))}var re={};return g.FullPaths&&parse_xls_props(g,re,A),W.Props=W.Custprops=re,A.bookFiles&&(W.cfb=g),W}function write_xlscfb(g,A){var L=A||{},B=CFB.utils.cfb_new({root:"R"}),W="/Workbook";switch(L.bookType||"xls"){case"xls":L.bookType="biff8";case"xla":L.bookType||(L.bookType="xla");case"biff8":W="/Workbook",L.biff=8;break;case"biff5":W="/Book",L.biff=5;break;default:throw new Error("invalid type "+L.bookType+" for XLS CFB")}return CFB.utils.cfb_add(B,W,write_biff_buf(g,L)),L.biff==8&&(g.Props||g.Custprops)&&write_xls_props(g,B),L.biff==8&&g.vbaraw&&fill_vba_xls(B,CFB.read(g.vbaraw,{type:typeof g.vbaraw=="string"?"binary":"buffer"})),B}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(g,A,L,B){var W=A;if(!isNaN(W)){var q=B||(L||[]).length||0,J=g.next(4);J.write_shift(2,W),J.write_shift(2,q),q>0&&is_buf(L)&&g.push(L)}}function write_biff_continue(g,A,L,B){var W=(L||[]).length||0;if(W<=8224)return write_biff_rec(g,A,L,W);var q=A;if(!isNaN(q)){for(var J=L.parts||[],re=0,ae=0,se=0;se+(J[re]||8224)<=8224;)se+=J[re]||8224,re++;var ie=g.next(4);for(ie.write_shift(2,q),ie.write_shift(2,se),g.push(L.slice(ae,ae+se)),ae+=se;ae<W;){for(ie=g.next(4),ie.write_shift(2,60),se=0;se+(J[re]||8224)<=8224;)se+=J[re]||8224,re++;ie.write_shift(2,se),g.push(L.slice(ae,ae+se)),ae+=se}}}function write_BIFF2Cell(g,A,L){return g||(g=new_buf(7)),g.write_shift(2,A),g.write_shift(2,L),g.write_shift(2,0),g.write_shift(1,0),g}function write_BIFF2BERR(g,A,L,B){var W=new_buf(9);return write_BIFF2Cell(W,g,A),write_Bes(L,B||"b",W),W}function write_BIFF2LABEL(g,A,L){var B=new_buf(8+2*L.length);return write_BIFF2Cell(B,g,A),B.write_shift(1,L.length),B.write_shift(L.length,L,"sbcs"),B.l<B.length?B.slice(0,B.l):B}function write_ws_biff2_cell(g,A,L,B){if(A.v!=null)switch(A.t){case"d":case"n":var W=A.t=="d"?datenum(parseDate(A.v)):A.v;W==(W|0)&&W>=0&&W<65536?write_biff_rec(g,2,write_BIFF2INT(L,B,W)):write_biff_rec(g,3,write_BIFF2NUM(L,B,W));return;case"b":case"e":write_biff_rec(g,5,write_BIFF2BERR(L,B,A.v,A.t));return;case"s":case"str":write_biff_rec(g,4,write_BIFF2LABEL(L,B,(A.v||"").slice(0,255)));return}write_biff_rec(g,1,write_BIFF2Cell(null,L,B))}function write_ws_biff2(g,A,L,B){var W=Array.isArray(A),q=safe_decode_range(A["!ref"]||"A1"),J,re="",ae=[];if(q.e.c>255||q.e.r>16383){if(B.WTF)throw new Error("Range "+(A["!ref"]||"A1")+" exceeds format limit A1:IV16384");q.e.c=Math.min(q.e.c,255),q.e.r=Math.min(q.e.c,16383),J=encode_range(q)}for(var se=q.s.r;se<=q.e.r;++se){re=encode_row(se);for(var ie=q.s.c;ie<=q.e.c;++ie){se===q.s.r&&(ae[ie]=encode_col(ie)),J=ae[ie]+re;var le=W?(A[se]||[])[ie]:A[J];le&&write_ws_biff2_cell(g,le,se,ie)}}}function write_biff2_buf(g,A){for(var L=A||{},B=buf_array(),W=0,q=0;q<g.SheetNames.length;++q)g.SheetNames[q]==L.sheet&&(W=q);if(W==0&&L.sheet&&g.SheetNames[0]!=L.sheet)throw new Error("Sheet not found: "+L.sheet);return write_biff_rec(B,L.biff==4?1033:L.biff==3?521:9,write_BOF(g,16,L)),write_ws_biff2(B,g.Sheets[g.SheetNames[W]],W,L),write_biff_rec(B,10),B.end()}function write_FONTS_biff8(g,A,L){write_biff_rec(g,49,write_Font({sz:12,name:"Arial"},L))}function write_FMTS_biff8(g,A,L){A&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(B){for(var W=B[0];W<=B[1];++W)A[W]!=null&&write_biff_rec(g,1054,write_Format(W,A[W],L))})}function write_FEAT(g,A){var L=new_buf(19);L.write_shift(4,2151),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(2,3),L.write_shift(1,1),L.write_shift(4,0),write_biff_rec(g,2151,L),L=new_buf(39),L.write_shift(4,2152),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(2,3),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(2,1),L.write_shift(4,4),L.write_shift(2,0),write_Ref8U(safe_decode_range(A["!ref"]||"A1"),L),L.write_shift(4,4),write_biff_rec(g,2152,L)}function write_CELLXFS_biff8(g,A){for(var L=0;L<16;++L)write_biff_rec(g,224,write_XF({numFmtId:0,style:!0},0,A));A.cellXfs.forEach(function(B){write_biff_rec(g,224,write_XF(B,0,A))})}function write_ws_biff8_hlinks(g,A){for(var L=0;L<A["!links"].length;++L){var B=A["!links"][L];write_biff_rec(g,440,write_HLink(B)),B[1].Tooltip&&write_biff_rec(g,2048,write_HLinkTooltip(B))}delete A["!links"]}function write_ws_cols_biff8(g,A){if(A){var L=0;A.forEach(function(B,W){++L<=256&&B&&write_biff_rec(g,125,write_ColInfo(col_obj_w(W,B),W))})}}function write_ws_biff8_cell(g,A,L,B,W){var q=16+get_cell_style(W.cellXfs,A,W);if(A.v==null&&!A.bf){write_biff_rec(g,513,write_XLSCell(L,B,q));return}if(A.bf)write_biff_rec(g,6,write_Formula(A,L,B,W,q));else switch(A.t){case"d":case"n":var J=A.t=="d"?datenum(parseDate(A.v)):A.v;write_biff_rec(g,515,write_Number(L,B,J,q));break;case"b":case"e":write_biff_rec(g,517,write_BoolErr(L,B,A.v,q,W,A.t));break;case"s":case"str":if(W.bookSST){var re=get_sst_id(W.Strings,A.v,W.revStrings);write_biff_rec(g,253,write_LabelSst(L,B,re,q))}else write_biff_rec(g,516,write_Label(L,B,(A.v||"").slice(0,255),q,W));break;default:write_biff_rec(g,513,write_XLSCell(L,B,q))}}function write_ws_biff8(g,A,L){var B=buf_array(),W=L.SheetNames[g],q=L.Sheets[W]||{},J=(L||{}).Workbook||{},re=(J.Sheets||[])[g]||{},ae=Array.isArray(q),se=A.biff==8,ie,le="",pe=[],he=safe_decode_range(q["!ref"]||"A1"),ue=se?65536:16384;if(he.e.c>255||he.e.r>=ue){if(A.WTF)throw new Error("Range "+(q["!ref"]||"A1")+" exceeds format limit A1:IV16384");he.e.c=Math.min(he.e.c,255),he.e.r=Math.min(he.e.c,ue-1)}write_biff_rec(B,2057,write_BOF(L,16,A)),write_biff_rec(B,13,writeuint16(1)),write_biff_rec(B,12,writeuint16(100)),write_biff_rec(B,15,writebool(!0)),write_biff_rec(B,17,writebool(!1)),write_biff_rec(B,16,write_Xnum(.001)),write_biff_rec(B,95,writebool(!0)),write_biff_rec(B,42,writebool(!1)),write_biff_rec(B,43,writebool(!1)),write_biff_rec(B,130,writeuint16(1)),write_biff_rec(B,128,write_Guts()),write_biff_rec(B,131,writebool(!1)),write_biff_rec(B,132,writebool(!1)),se&&write_ws_cols_biff8(B,q["!cols"]),write_biff_rec(B,512,write_Dimensions(he,A)),se&&(q["!links"]=[]);for(var ce=he.s.r;ce<=he.e.r;++ce){le=encode_row(ce);for(var fe=he.s.c;fe<=he.e.c;++fe){ce===he.s.r&&(pe[fe]=encode_col(fe)),ie=pe[fe]+le;var me=ae?(q[ce]||[])[fe]:q[ie];me&&(write_ws_biff8_cell(B,me,ce,fe,A),se&&me.l&&q["!links"].push([ie,me.l]))}}var ke=re.CodeName||re.name||W;return se&&write_biff_rec(B,574,write_Window2((J.Views||[])[0])),se&&(q["!merges"]||[]).length&&write_biff_rec(B,229,write_MergeCells(q["!merges"])),se&&write_ws_biff8_hlinks(B,q),write_biff_rec(B,442,write_XLUnicodeString(ke)),se&&write_FEAT(B,q),write_biff_rec(B,10),B.end()}function write_biff8_global(g,A,L){var B=buf_array(),W=(g||{}).Workbook||{},q=W.Sheets||[],J=W.WBProps||{},re=L.biff==8,ae=L.biff==5;if(write_biff_rec(B,2057,write_BOF(g,5,L)),L.bookType=="xla"&&write_biff_rec(B,135),write_biff_rec(B,225,re?writeuint16(1200):null),write_biff_rec(B,193,writezeroes(2)),ae&&write_biff_rec(B,191),ae&&write_biff_rec(B,192),write_biff_rec(B,226),write_biff_rec(B,92,write_WriteAccess("SheetJS",L)),write_biff_rec(B,66,writeuint16(re?1200:1252)),re&&write_biff_rec(B,353,writeuint16(0)),re&&write_biff_rec(B,448),write_biff_rec(B,317,write_RRTabId(g.SheetNames.length)),re&&g.vbaraw&&write_biff_rec(B,211),re&&g.vbaraw){var se=J.CodeName||"ThisWorkbook";write_biff_rec(B,442,write_XLUnicodeString(se))}write_biff_rec(B,156,writeuint16(17)),write_biff_rec(B,25,writebool(!1)),write_biff_rec(B,18,writebool(!1)),write_biff_rec(B,19,writeuint16(0)),re&&write_biff_rec(B,431,writebool(!1)),re&&write_biff_rec(B,444,writeuint16(0)),write_biff_rec(B,61,write_Window1()),write_biff_rec(B,64,writebool(!1)),write_biff_rec(B,141,writeuint16(0)),write_biff_rec(B,34,writebool(safe1904(g)=="true")),write_biff_rec(B,14,writebool(!0)),re&&write_biff_rec(B,439,writebool(!1)),write_biff_rec(B,218,writeuint16(0)),write_FONTS_biff8(B,g,L),write_FMTS_biff8(B,g.SSF,L),write_CELLXFS_biff8(B,L),re&&write_biff_rec(B,352,writebool(!1));var ie=B.end(),le=buf_array();re&&write_biff_rec(le,140,write_Country()),re&&L.Strings&&write_biff_continue(le,252,write_SST(L.Strings)),write_biff_rec(le,10);var pe=le.end(),he=buf_array(),ue=0,ce=0;for(ce=0;ce<g.SheetNames.length;++ce)ue+=(re?12:11)+(re?2:1)*g.SheetNames[ce].length;var fe=ie.length+ue+pe.length;for(ce=0;ce<g.SheetNames.length;++ce){var me=q[ce]||{};write_biff_rec(he,133,write_BoundSheet8({pos:fe,hs:me.Hidden||0,dt:0,name:g.SheetNames[ce]},L)),fe+=A[ce].length}var ke=he.end();if(ue!=ke.length)throw new Error("BS8 "+ue+" != "+ke.length);var xe=[];return ie.length&&xe.push(ie),ke.length&&xe.push(ke),pe.length&&xe.push(pe),bconcat(xe)}function write_biff8_buf(g,A){var L=A||{},B=[];g&&!g.SSF&&(g.SSF=dup(table_fmt)),g&&g.SSF&&(make_ssf(),SSF_load_table(g.SSF),L.revssf=evert_num(g.SSF),L.revssf[g.SSF[65535]]=0,L.ssf=g.SSF),L.Strings=[],L.Strings.Count=0,L.Strings.Unique=0,fix_write_opts(L),L.cellXfs=[],get_cell_style(L.cellXfs,{},{revssf:{General:0}}),g.Props||(g.Props={});for(var W=0;W<g.SheetNames.length;++W)B[B.length]=write_ws_biff8(W,L,g);return B.unshift(write_biff8_global(g,B,L)),bconcat(B)}function write_biff_buf(g,A){for(var L=0;L<=g.SheetNames.length;++L){var B=g.Sheets[g.SheetNames[L]];if(!(!B||!B["!ref"])){var W=decode_range(B["!ref"]);W.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+g.SheetNames[L]+"' extends beyond column IV (255).  Data may be lost.")}}var q=A||{};switch(q.biff||2){case 8:case 5:return write_biff8_buf(g,A);case 4:case 3:case 2:return write_biff2_buf(g,A)}throw new Error("invalid type "+q.bookType+" for BIFF")}function html_to_sheet(g,A){var L=A||{},B=L.dense?[]:{};g=g.replace(/<!--.*?-->/g,"");var W=g.match(/<table/i);if(!W)throw new Error("Invalid HTML: could not find <table>");var q=g.match(/<\/table/i),J=W.index,re=q&&q.index||g.length,ae=split_regex(g.slice(J,re),/(:?<tr[^>]*>)/i,"<tr>"),se=-1,ie=0,le=0,pe=0,he={s:{r:1e7,c:1e7},e:{r:0,c:0}},ue=[];for(J=0;J<ae.length;++J){var ce=ae[J].trim(),fe=ce.slice(0,3).toLowerCase();if(fe=="<tr"){if(++se,L.sheetRows&&L.sheetRows<=se){--se;break}ie=0;continue}if(!(fe!="<td"&&fe!="<th")){var me=ce.split(/<\/t[dh]>/i);for(re=0;re<me.length;++re){var ke=me[re].trim();if(ke.match(/<t[dh]/i)){for(var xe=ke,Le=0;xe.charAt(0)=="<"&&(Le=xe.indexOf(">"))>-1;)xe=xe.slice(Le+1);for(var Se=0;Se<ue.length;++Se){var Te=ue[Se];Te.s.c==ie&&Te.s.r<se&&se<=Te.e.r&&(ie=Te.e.c+1,Se=-1)}var ge=parsexmltag(ke.slice(0,ke.indexOf(">")));pe=ge.colspan?+ge.colspan:1,((le=+ge.rowspan)>1||pe>1)&&ue.push({s:{r:se,c:ie},e:{r:se+(le||1)-1,c:ie+pe-1}});var Ce=ge.t||ge["data-t"]||"";if(!xe.length){ie+=pe;continue}if(xe=htmldecode(xe),he.s.r>se&&(he.s.r=se),he.e.r<se&&(he.e.r=se),he.s.c>ie&&(he.s.c=ie),he.e.c<ie&&(he.e.c=ie),!xe.length){ie+=pe;continue}var be={t:"s",v:xe};L.raw||!xe.trim().length||Ce=="s"||(xe==="TRUE"?be={t:"b",v:!0}:xe==="FALSE"?be={t:"b",v:!1}:isNaN(fuzzynum(xe))?isNaN(fuzzydate(xe).getDate())||(be={t:"d",v:parseDate(xe)},L.cellDates||(be={t:"n",v:datenum(be.v)}),be.z=L.dateNF||table_fmt[14]):be={t:"n",v:fuzzynum(xe)}),L.dense?(B[se]||(B[se]=[]),B[se][ie]=be):B[encode_cell({r:se,c:ie})]=be,ie+=pe}}}}return B["!ref"]=encode_range(he),ue.length&&(B["!merges"]=ue),B}function make_html_row(g,A,L,B){for(var W=g["!merges"]||[],q=[],J=A.s.c;J<=A.e.c;++J){for(var re=0,ae=0,se=0;se<W.length;++se)if(!(W[se].s.r>L||W[se].s.c>J)&&!(W[se].e.r<L||W[se].e.c<J)){if(W[se].s.r<L||W[se].s.c<J){re=-1;break}re=W[se].e.r-W[se].s.r+1,ae=W[se].e.c-W[se].s.c+1;break}if(!(re<0)){var ie=encode_cell({r:L,c:J}),le=B.dense?(g[L]||[])[J]:g[ie],pe=le&&le.v!=null&&(le.h||escapehtml(le.w||(format_cell(le),le.w)||""))||"",he={};re>1&&(he.rowspan=re),ae>1&&(he.colspan=ae),B.editable?pe='<span contenteditable="true">'+pe+"</span>":le&&(he["data-t"]=le&&le.t||"z",le.v!=null&&(he["data-v"]=le.v),le.z!=null&&(he["data-z"]=le.z),le.l&&(le.l.Target||"#").charAt(0)!="#"&&(pe='<a href="'+le.l.Target+'">'+pe+"</a>")),he.id=(B.id||"sjs")+"-"+ie,q.push(writextag("td",pe,he))}}var ue="<tr>";return ue+q.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(g,A){var L=g.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!L||L.length==0)throw new Error("Invalid HTML: could not find <table>");if(L.length==1)return sheet_to_workbook(html_to_sheet(L[0],A),A);var B=book_new();return L.forEach(function(W,q){book_append_sheet(B,html_to_sheet(W,A),"Sheet"+(q+1))}),B}function make_html_preamble(g,A,L){var B=[];return B.join("")+"<table"+(L&&L.id?' id="'+L.id+'"':"")+">"}function sheet_to_html(g,A){var L=A||{},B=L.header!=null?L.header:HTML_BEGIN,W=L.footer!=null?L.footer:HTML_END,q=[B],J=decode_range(g["!ref"]);L.dense=Array.isArray(g),q.push(make_html_preamble(g,J,L));for(var re=J.s.r;re<=J.e.r;++re)q.push(make_html_row(g,J,re,L));return q.push("</table>"+W),q.join("")}function sheet_add_dom(g,A,L){var B=L||{},W=0,q=0;if(B.origin!=null)if(typeof B.origin=="number")W=B.origin;else{var J=typeof B.origin=="string"?decode_cell(B.origin):B.origin;W=J.r,q=J.c}var re=A.getElementsByTagName("tr"),ae=Math.min(B.sheetRows||1e7,re.length),se={s:{r:0,c:0},e:{r:W,c:q}};if(g["!ref"]){var ie=decode_range(g["!ref"]);se.s.r=Math.min(se.s.r,ie.s.r),se.s.c=Math.min(se.s.c,ie.s.c),se.e.r=Math.max(se.e.r,ie.e.r),se.e.c=Math.max(se.e.c,ie.e.c),W==-1&&(se.e.r=W=ie.e.r+1)}var le=[],pe=0,he=g["!rows"]||(g["!rows"]=[]),ue=0,ce=0,fe=0,me=0,ke=0,xe=0;for(g["!cols"]||(g["!cols"]=[]);ue<re.length&&ce<ae;++ue){var Le=re[ue];if(is_dom_element_hidden(Le)){if(B.display)continue;he[ce]={hidden:!0}}var Se=Le.children;for(fe=me=0;fe<Se.length;++fe){var Te=Se[fe];if(!(B.display&&is_dom_element_hidden(Te))){var ge=Te.hasAttribute("data-v")?Te.getAttribute("data-v"):Te.hasAttribute("v")?Te.getAttribute("v"):htmldecode(Te.innerHTML),Ce=Te.getAttribute("data-z")||Te.getAttribute("z");for(pe=0;pe<le.length;++pe){var be=le[pe];be.s.c==me+q&&be.s.r<ce+W&&ce+W<=be.e.r&&(me=be.e.c+1-q,pe=-1)}xe=+Te.getAttribute("colspan")||1,((ke=+Te.getAttribute("rowspan")||1)>1||xe>1)&&le.push({s:{r:ce+W,c:me+q},e:{r:ce+W+(ke||1)-1,c:me+q+(xe||1)-1}});var nt={t:"s",v:ge},Ae=Te.getAttribute("data-t")||Te.getAttribute("t")||"";ge!=null&&(ge.length==0?nt.t=Ae||"z":B.raw||ge.trim().length==0||Ae=="s"||(ge==="TRUE"?nt={t:"b",v:!0}:ge==="FALSE"?nt={t:"b",v:!1}:isNaN(fuzzynum(ge))?isNaN(fuzzydate(ge).getDate())||(nt={t:"d",v:parseDate(ge)},B.cellDates||(nt={t:"n",v:datenum(nt.v)}),nt.z=B.dateNF||table_fmt[14]):nt={t:"n",v:fuzzynum(ge)})),nt.z===void 0&&Ce!=null&&(nt.z=Ce);var De="",lt=Te.getElementsByTagName("A");if(lt&&lt.length)for(var Ct=0;Ct<lt.length&&!(lt[Ct].hasAttribute("href")&&(De=lt[Ct].getAttribute("href"),De.charAt(0)!="#"));++Ct);De&&De.charAt(0)!="#"&&(nt.l={Target:De}),B.dense?(g[ce+W]||(g[ce+W]=[]),g[ce+W][me+q]=nt):g[encode_cell({c:me+q,r:ce+W})]=nt,se.e.c<me+q&&(se.e.c=me+q),me+=xe}}++ce}return le.length&&(g["!merges"]=(g["!merges"]||[]).concat(le)),se.e.r=Math.max(se.e.r,ce-1+W),g["!ref"]=encode_range(se),ce>=ae&&(g["!fullref"]=encode_range((se.e.r=re.length-ue+ce-1+W,se))),g}function parse_dom_table(g,A){var L=A||{},B=L.dense?[]:{};return sheet_add_dom(B,g,A)}function table_to_book(g,A){return sheet_to_workbook(parse_dom_table(g,A),A)}function is_dom_element_hidden(g){var A="",L=get_get_computed_style_function(g);return L&&(A=L(g).getPropertyValue("display")),A||(A=g.style&&g.style.display),A==="none"}function get_get_computed_style_function(g){return g.ownerDocument.defaultView&&typeof g.ownerDocument.defaultView.getComputedStyle=="function"?g.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(g){var A=g.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(B,W){return Array(parseInt(W,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),L=unescapexml(A.replace(/<[^>]*>/g,""));return[L]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(g,A){var L=A||{},B=xlml_normalize(g),W=[],q,J,re={name:""},ae="",se=0,ie,le,pe={},he=[],ue=L.dense?[]:{},ce,fe,me={value:""},ke="",xe=0,Le=[],Se=-1,Te=-1,ge={s:{r:1e6,c:1e7},e:{r:0,c:0}},Ce=0,be={},nt=[],Ae={},De=0,lt=0,Ct=[],ft=1,Et=1,gt=[],bt={Names:[]},Ie={},pt=["",""],at=[],Ee={},ye="",ve=0,Pe=!1,rt=!1,st=0;for(xlmlregex.lastIndex=0,B=B.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");ce=xlmlregex.exec(B);)switch(ce[3]=ce[3].replace(/_.*$/,"")){case"table":case"工作表":ce[1]==="/"?(ge.e.c>=ge.s.c&&ge.e.r>=ge.s.r?ue["!ref"]=encode_range(ge):ue["!ref"]="A1:A1",L.sheetRows>0&&L.sheetRows<=ge.e.r&&(ue["!fullref"]=ue["!ref"],ge.e.r=L.sheetRows-1,ue["!ref"]=encode_range(ge)),nt.length&&(ue["!merges"]=nt),Ct.length&&(ue["!rows"]=Ct),ie.name=ie.名称||ie.name,typeof JSON<"u"&&JSON.stringify(ie),he.push(ie.name),pe[ie.name]=ue,rt=!1):ce[0].charAt(ce[0].length-2)!=="/"&&(ie=parsexmltag(ce[0],!1),Se=Te=-1,ge.s.r=ge.s.c=1e7,ge.e.r=ge.e.c=0,ue=L.dense?[]:{},nt=[],Ct=[],rt=!0);break;case"table-row-group":ce[1]==="/"?--Ce:++Ce;break;case"table-row":case"行":if(ce[1]==="/"){Se+=ft,ft=1;break}if(le=parsexmltag(ce[0],!1),le.行号?Se=le.行号-1:Se==-1&&(Se=0),ft=+le["number-rows-repeated"]||1,ft<10)for(st=0;st<ft;++st)Ce>0&&(Ct[Se+st]={level:Ce});Te=-1;break;case"covered-table-cell":ce[1]!=="/"&&++Te,L.sheetStubs&&(L.dense?(ue[Se]||(ue[Se]=[]),ue[Se][Te]={t:"z"}):ue[encode_cell({r:Se,c:Te})]={t:"z"}),ke="",Le=[];break;case"table-cell":case"数据":if(ce[0].charAt(ce[0].length-2)==="/")++Te,me=parsexmltag(ce[0],!1),Et=parseInt(me["number-columns-repeated"]||"1",10),fe={t:"z",v:null},me.formula&&L.cellFormula!=!1&&(fe.f=ods_to_csf_formula(unescapexml(me.formula))),(me.数据类型||me["value-type"])=="string"&&(fe.t="s",fe.v=unescapexml(me["string-value"]||""),L.dense?(ue[Se]||(ue[Se]=[]),ue[Se][Te]=fe):ue[encode_cell({r:Se,c:Te})]=fe),Te+=Et-1;else if(ce[1]!=="/"){++Te,ke="",xe=0,Le=[],Et=1;var ot=ft?Se+ft-1:Se;if(Te>ge.e.c&&(ge.e.c=Te),Te<ge.s.c&&(ge.s.c=Te),Se<ge.s.r&&(ge.s.r=Se),ot>ge.e.r&&(ge.e.r=ot),me=parsexmltag(ce[0],!1),at=[],Ee={},fe={t:me.数据类型||me["value-type"],v:null},L.cellFormula)if(me.formula&&(me.formula=unescapexml(me.formula)),me["number-matrix-columns-spanned"]&&me["number-matrix-rows-spanned"]&&(De=parseInt(me["number-matrix-rows-spanned"],10)||0,lt=parseInt(me["number-matrix-columns-spanned"],10)||0,Ae={s:{r:Se,c:Te},e:{r:Se+De-1,c:Te+lt-1}},fe.F=encode_range(Ae),gt.push([Ae,fe.F])),me.formula)fe.f=ods_to_csf_formula(me.formula);else for(st=0;st<gt.length;++st)Se>=gt[st][0].s.r&&Se<=gt[st][0].e.r&&Te>=gt[st][0].s.c&&Te<=gt[st][0].e.c&&(fe.F=gt[st][1]);switch((me["number-columns-spanned"]||me["number-rows-spanned"])&&(De=parseInt(me["number-rows-spanned"],10)||0,lt=parseInt(me["number-columns-spanned"],10)||0,Ae={s:{r:Se,c:Te},e:{r:Se+De-1,c:Te+lt-1}},nt.push(Ae)),me["number-columns-repeated"]&&(Et=parseInt(me["number-columns-repeated"],10)),fe.t){case"boolean":fe.t="b",fe.v=parsexmlbool(me["boolean-value"]);break;case"float":fe.t="n",fe.v=parseFloat(me.value);break;case"percentage":fe.t="n",fe.v=parseFloat(me.value);break;case"currency":fe.t="n",fe.v=parseFloat(me.value);break;case"date":fe.t="d",fe.v=parseDate(me["date-value"]),L.cellDates||(fe.t="n",fe.v=datenum(fe.v)),fe.z="m/d/yy";break;case"time":fe.t="n",fe.v=parse_isodur(me["time-value"])/86400,L.cellDates&&(fe.t="d",fe.v=numdate(fe.v)),fe.z="HH:MM:SS";break;case"number":fe.t="n",fe.v=parseFloat(me.数据数值);break;default:if(fe.t==="string"||fe.t==="text"||!fe.t)fe.t="s",me["string-value"]!=null&&(ke=unescapexml(me["string-value"]),Le=[]);else throw new Error("Unsupported value type "+fe.t)}}else{if(Pe=!1,fe.t==="s"&&(fe.v=ke||"",Le.length&&(fe.R=Le),Pe=xe==0),Ie.Target&&(fe.l=Ie),at.length>0&&(fe.c=at,at=[]),ke&&L.cellText!==!1&&(fe.w=ke),Pe&&(fe.t="z",delete fe.v),(!Pe||L.sheetStubs)&&!(L.sheetRows&&L.sheetRows<=Se))for(var mt=0;mt<ft;++mt){if(Et=parseInt(me["number-columns-repeated"]||"1",10),L.dense)for(ue[Se+mt]||(ue[Se+mt]=[]),ue[Se+mt][Te]=mt==0?fe:dup(fe);--Et>0;)ue[Se+mt][Te+Et]=dup(fe);else for(ue[encode_cell({r:Se+mt,c:Te})]=fe;--Et>0;)ue[encode_cell({r:Se+mt,c:Te+Et})]=dup(fe);ge.e.c<=Te&&(ge.e.c=Te)}Et=parseInt(me["number-columns-repeated"]||"1",10),Te+=Et-1,Et=0,fe={},ke="",Le=[]}Ie={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(ce[1]==="/"){if((q=W.pop())[0]!==ce[3])throw"Bad state: "+q}else ce[0].charAt(ce[0].length-2)!=="/"&&W.push([ce[3],!0]);break;case"annotation":if(ce[1]==="/"){if((q=W.pop())[0]!==ce[3])throw"Bad state: "+q;Ee.t=ke,Le.length&&(Ee.R=Le),Ee.a=ye,at.push(Ee)}else ce[0].charAt(ce[0].length-2)!=="/"&&W.push([ce[3],!1]);ye="",ve=0,ke="",xe=0,Le=[];break;case"creator":ce[1]==="/"?ye=B.slice(ve,ce.index):ve=ce.index+ce[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(ce[1]==="/"){if((q=W.pop())[0]!==ce[3])throw"Bad state: "+q}else ce[0].charAt(ce[0].length-2)!=="/"&&W.push([ce[3],!1]);ke="",xe=0,Le=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(ce[1]==="/"){if(be[re.name]=ae,(q=W.pop())[0]!==ce[3])throw"Bad state: "+q}else ce[0].charAt(ce[0].length-2)!=="/"&&(ae="",re=parsexmltag(ce[0],!1),W.push([ce[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(W[W.length-1][0]){case"time-style":case"date-style":J=parsexmltag(ce[0],!1),ae+=number_formats_ods[ce[3]][J.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(W[W.length-1][0]){case"time-style":case"date-style":J=parsexmltag(ce[0],!1),ae+=number_formats_ods[ce[3]][J.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(ce[0].slice(-2)==="/>")break;if(ce[1]==="/")switch(W[W.length-1][0]){case"number-style":case"date-style":case"time-style":ae+=B.slice(se,ce.index);break}else se=ce.index+ce[0].length;break;case"named-range":J=parsexmltag(ce[0],!1),pt=ods_to_csf_3D(J["cell-range-address"]);var At={Name:J.name,Ref:pt[0]+"!"+pt[1]};rt&&(At.Sheet=he.length),bt.Names.push(At);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(W[W.length-1][0])>-1)break;if(ce[1]==="/"&&(!me||!me["string-value"])){var It=parse_text_p(B.slice(xe,ce.index));ke=(ke.length>0?ke+`
`:"")+It[0]}else parsexmltag(ce[0],!1),xe=ce.index+ce[0].length;break;case"s":break;case"database-range":if(ce[1]==="/")break;try{pt=ods_to_csf_3D(parsexmltag(ce[0])["target-range-address"]),pe[pt[0]]["!autofilter"]={ref:pt[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(ce[1]!=="/"){if(Ie=parsexmltag(ce[0],!1),!Ie.href)break;Ie.Target=unescapexml(Ie.href),delete Ie.href,Ie.Target.charAt(0)=="#"&&Ie.Target.indexOf(".")>-1?(pt=ods_to_csf_3D(Ie.Target.slice(1)),Ie.Target="#"+pt[0]+"!"+pt[1]):Ie.Target.match(/^\.\.[\\\/]/)&&(Ie.Target=Ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(ce[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(L.WTF)throw new Error(ce)}}var it={Sheets:pe,SheetNames:he,Workbook:bt};return L.bookSheets&&delete it.Sheets,it}function parse_ods(g,A){A=A||{},safegetzipfile(g,"META-INF/manifest.xml")&&parse_manifest(getzipdata(g,"META-INF/manifest.xml"),A);var L=getzipstr(g,"content.xml");if(!L)throw new Error("Missing content.xml in ODS / UOF file");var B=parse_content_xml(utf8read(L),A);return safegetzipfile(g,"meta.xml")&&(B.Props=parse_core_props(getzipdata(g,"meta.xml"))),B}function parse_fods(g,A){return parse_content_xml(g,A)}var write_styles_ods=function(){var g=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),A="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+g+"</office:document-styles>";return function(){return XML_HEADER+A}}(),write_content_ods=function(){var g=function(q){return escapexml(q).replace(/  +/g,function(J){return'<text:s text:c="'+J.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},A=`          <table:table-cell />
`,L=`          <table:covered-table-cell/>
`,B=function(q,J,re){var ae=[];ae.push('      <table:table table:name="'+escapexml(J.SheetNames[re])+`" table:style-name="ta1">
`);var se=0,ie=0,le=decode_range(q["!ref"]||"A1"),pe=q["!merges"]||[],he=0,ue=Array.isArray(q);if(q["!cols"])for(ie=0;ie<=le.e.c;++ie)ae.push("        <table:table-column"+(q["!cols"][ie]?' table:style-name="co'+q["!cols"][ie].ods+'"':"")+`></table:table-column>
`);var ce="",fe=q["!rows"]||[];for(se=0;se<le.s.r;++se)ce=fe[se]?' table:style-name="ro'+fe[se].ods+'"':"",ae.push("        <table:table-row"+ce+`></table:table-row>
`);for(;se<=le.e.r;++se){for(ce=fe[se]?' table:style-name="ro'+fe[se].ods+'"':"",ae.push("        <table:table-row"+ce+`>
`),ie=0;ie<le.s.c;++ie)ae.push(A);for(;ie<=le.e.c;++ie){var me=!1,ke={},xe="";for(he=0;he!=pe.length;++he)if(!(pe[he].s.c>ie)&&!(pe[he].s.r>se)&&!(pe[he].e.c<ie)&&!(pe[he].e.r<se)){(pe[he].s.c!=ie||pe[he].s.r!=se)&&(me=!0),ke["table:number-columns-spanned"]=pe[he].e.c-pe[he].s.c+1,ke["table:number-rows-spanned"]=pe[he].e.r-pe[he].s.r+1;break}if(me){ae.push(L);continue}var Le=encode_cell({r:se,c:ie}),Se=ue?(q[se]||[])[ie]:q[Le];if(Se&&Se.f&&(ke["table:formula"]=escapexml(csf_to_ods_formula(Se.f)),Se.F&&Se.F.slice(0,Le.length)==Le)){var Te=decode_range(Se.F);ke["table:number-matrix-columns-spanned"]=Te.e.c-Te.s.c+1,ke["table:number-matrix-rows-spanned"]=Te.e.r-Te.s.r+1}if(!Se){ae.push(A);continue}switch(Se.t){case"b":xe=Se.v?"TRUE":"FALSE",ke["office:value-type"]="boolean",ke["office:boolean-value"]=Se.v?"true":"false";break;case"n":xe=Se.w||String(Se.v||0),ke["office:value-type"]="float",ke["office:value"]=Se.v||0;break;case"s":case"str":xe=Se.v==null?"":Se.v,ke["office:value-type"]="string";break;case"d":xe=Se.w||parseDate(Se.v).toISOString(),ke["office:value-type"]="date",ke["office:date-value"]=parseDate(Se.v).toISOString(),ke["table:style-name"]="ce1";break;default:ae.push(A);continue}var ge=g(xe);if(Se.l&&Se.l.Target){var Ce=Se.l.Target;Ce=Ce.charAt(0)=="#"?"#"+csf_to_ods_3D(Ce.slice(1)):Ce,Ce.charAt(0)!="#"&&!Ce.match(/^\w+:/)&&(Ce="../"+Ce),ge=writextag("text:a",ge,{"xlink:href":Ce.replace(/&/g,"&amp;")})}ae.push("          "+writextag("table:table-cell",writextag("text:p",ge,{}),ke)+`
`)}ae.push(`        </table:table-row>
`)}return ae.push(`      </table:table>
`),ae.join("")},W=function(q,J){q.push(` <office:automatic-styles>
`),q.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),q.push(`   <number:month number:style="long"/>
`),q.push(`   <number:text>/</number:text>
`),q.push(`   <number:day number:style="long"/>
`),q.push(`   <number:text>/</number:text>
`),q.push(`   <number:year/>
`),q.push(`  </number:date-style>
`);var re=0;J.SheetNames.map(function(se){return J.Sheets[se]}).forEach(function(se){if(se&&se["!cols"]){for(var ie=0;ie<se["!cols"].length;++ie)if(se["!cols"][ie]){var le=se["!cols"][ie];if(le.width==null&&le.wpx==null&&le.wch==null)continue;process_col(le),le.ods=re;var pe=se["!cols"][ie].wpx+"px";q.push('  <style:style style:name="co'+re+`" style:family="table-column">
`),q.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+pe+`"/>
`),q.push(`  </style:style>
`),++re}}});var ae=0;J.SheetNames.map(function(se){return J.Sheets[se]}).forEach(function(se){if(se&&se["!rows"]){for(var ie=0;ie<se["!rows"].length;++ie)if(se["!rows"][ie]){se["!rows"][ie].ods=ae;var le=se["!rows"][ie].hpx+"px";q.push('  <style:style style:name="ro'+ae+`" style:family="table-row">
`),q.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+le+`"/>
`),q.push(`  </style:style>
`),++ae}}}),q.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),q.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),q.push(`  </style:style>
`),q.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),q.push(` </office:automatic-styles>
`)};return function(J,re){var ae=[XML_HEADER],se=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),ie=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});re.bookType=="fods"?(ae.push("<office:document"+se+ie+`>
`),ae.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):ae.push("<office:document-content"+se+`>
`),W(ae,J),ae.push(`  <office:body>
`),ae.push(`    <office:spreadsheet>
`);for(var le=0;le!=J.SheetNames.length;++le)ae.push(B(J.Sheets[J.SheetNames[le]],J,le));return ae.push(`    </office:spreadsheet>
`),ae.push(`  </office:body>
`),re.bookType=="fods"?ae.push("</office:document>"):ae.push("</office:document-content>"),ae.join("")}}();function write_ods(g,A){if(A.bookType=="fods")return write_content_ods(g,A);var L=zip_new(),B="",W=[],q=[];return B="mimetype",zip_add_file(L,B,"application/vnd.oasis.opendocument.spreadsheet"),B="content.xml",zip_add_file(L,B,write_content_ods(g,A)),W.push([B,"text/xml"]),q.push([B,"ContentFile"]),B="styles.xml",zip_add_file(L,B,write_styles_ods(g,A)),W.push([B,"text/xml"]),q.push([B,"StylesFile"]),B="meta.xml",zip_add_file(L,B,XML_HEADER+write_meta_ods()),W.push([B,"text/xml"]),q.push([B,"MetadataFile"]),B="manifest.rdf",zip_add_file(L,B,write_rdf(q)),W.push([B,"application/rdf+xml"]),B="META-INF/manifest.xml",zip_add_file(L,B,write_manifest(W)),L}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(g){return new DataView(g.buffer,g.byteOffset,g.byteLength)}function u8str(g){return typeof TextDecoder<"u"?new TextDecoder().decode(g):utf8read(a2s(g))}function stru8(g){return typeof TextEncoder<"u"?new TextEncoder().encode(g):s2a(utf8write(g))}function u8contains(g,A){e:for(var L=0;L<=g.length-A.length;++L){for(var B=0;B<A.length;++B)if(g[L+B]!=A[B])continue e;return!0}return!1}function u8concat(g){var A=g.reduce(function(W,q){return W+q.length},0),L=new Uint8Array(A),B=0;return g.forEach(function(W){L.set(W,B),B+=W.length}),L}function popcnt(g){return g-=g>>1&1431655765,g=(g&858993459)+(g>>2&858993459),(g+(g>>4)&252645135)*16843009>>>24}function readDecimal128LE(g,A){for(var L=(g[A+15]&127)<<7|g[A+14]>>1,B=g[A+14]&1,W=A+13;W>=A;--W)B=B*256+g[W];return(g[A+15]&128?-B:B)*Math.pow(10,L-6176)}function writeDecimal128LE(g,A,L){var B=Math.floor(L==0?0:Math.LOG10E*Math.log(Math.abs(L)))+6176-20,W=L/Math.pow(10,B-6176);g[A+15]|=B>>7,g[A+14]|=(B&127)<<1;for(var q=0;W>=1;++q,W/=256)g[A+q]=W&255;g[A+15]|=L>=0?0:128}function parse_varint49(g,A){var L=A?A[0]:0,B=g[L]&127;e:if(g[L++]>=128&&(B|=(g[L]&127)<<7,g[L++]<128||(B|=(g[L]&127)<<14,g[L++]<128)||(B|=(g[L]&127)<<21,g[L++]<128)||(B+=(g[L]&127)*Math.pow(2,28),++L,g[L++]<128)||(B+=(g[L]&127)*Math.pow(2,35),++L,g[L++]<128)||(B+=(g[L]&127)*Math.pow(2,42),++L,g[L++]<128)))break e;return A&&(A[0]=L),B}function write_varint49(g){var A=new Uint8Array(7);A[0]=g&127;var L=1;e:if(g>127){if(A[L-1]|=128,A[L]=g>>7&127,++L,g<=16383||(A[L-1]|=128,A[L]=g>>14&127,++L,g<=2097151)||(A[L-1]|=128,A[L]=g>>21&127,++L,g<=268435455)||(A[L-1]|=128,A[L]=g/256>>>21&127,++L,g<=34359738367)||(A[L-1]|=128,A[L]=g/65536>>>21&127,++L,g<=4398046511103))break e;A[L-1]|=128,A[L]=g/16777216>>>21&127,++L}return A.slice(0,L)}function varint_to_i32(g){var A=0,L=g[A]&127;e:if(g[A++]>=128){if(L|=(g[A]&127)<<7,g[A++]<128||(L|=(g[A]&127)<<14,g[A++]<128)||(L|=(g[A]&127)<<21,g[A++]<128))break e;L|=(g[A]&127)<<28}return L}function parse_shallow(g){for(var A=[],L=[0];L[0]<g.length;){var B=L[0],W=parse_varint49(g,L),q=W&7;W=Math.floor(W/8);var J=0,re;if(W==0)break;switch(q){case 0:{for(var ae=L[0];g[L[0]++]>=128;);re=g.slice(ae,L[0])}break;case 5:J=4,re=g.slice(L[0],L[0]+J),L[0]+=J;break;case 1:J=8,re=g.slice(L[0],L[0]+J),L[0]+=J;break;case 2:J=parse_varint49(g,L),re=g.slice(L[0],L[0]+J),L[0]+=J;break;case 3:case 4:default:throw new Error("PB Type ".concat(q," for Field ").concat(W," at offset ").concat(B))}var se={data:re,type:q};A[W]==null?A[W]=[se]:A[W].push(se)}return A}function write_shallow(g){var A=[];return g.forEach(function(L,B){L.forEach(function(W){W.data&&(A.push(write_varint49(B*8+W.type)),W.type==2&&A.push(write_varint49(W.data.length)),A.push(W.data))})}),u8concat(A)}function mappa(g,A){return(g==null?void 0:g.map(function(L){return A(L.data)}))||[]}function parse_iwa_file(g){for(var A,L=[],B=[0];B[0]<g.length;){var W=parse_varint49(g,B),q=parse_shallow(g.slice(B[0],B[0]+W));B[0]+=W;var J={id:varint_to_i32(q[1][0].data),messages:[]};q[2].forEach(function(re){var ae=parse_shallow(re.data),se=varint_to_i32(ae[3][0].data);J.messages.push({meta:ae,data:g.slice(B[0],B[0]+se)}),B[0]+=se}),(A=q[3])!=null&&A[0]&&(J.merge=varint_to_i32(q[3][0].data)>>>0>0),L.push(J)}return L}function write_iwa_file(g){var A=[];return g.forEach(function(L){var B=[];B[1]=[{data:write_varint49(L.id),type:0}],B[2]=[],L.merge!=null&&(B[3]=[{data:write_varint49(+!!L.merge),type:0}]);var W=[];L.messages.forEach(function(J){W.push(J.data),J.meta[3]=[{type:0,data:write_varint49(J.data.length)}],B[2].push({data:write_shallow(J.meta),type:2})});var q=write_shallow(B);A.push(write_varint49(q.length)),A.push(q),W.forEach(function(J){return A.push(J)})}),u8concat(A)}function parse_snappy_chunk(g,A){if(g!=0)throw new Error("Unexpected Snappy chunk type ".concat(g));for(var L=[0],B=parse_varint49(A,L),W=[];L[0]<A.length;){var q=A[L[0]]&3;if(q==0){var J=A[L[0]++]>>2;if(J<60)++J;else{var re=J-59;J=A[L[0]],re>1&&(J|=A[L[0]+1]<<8),re>2&&(J|=A[L[0]+2]<<16),re>3&&(J|=A[L[0]+3]<<24),J>>>=0,J++,L[0]+=re}W.push(A.slice(L[0],L[0]+J)),L[0]+=J;continue}else{var ae=0,se=0;if(q==1?(se=(A[L[0]]>>2&7)+4,ae=(A[L[0]++]&224)<<3,ae|=A[L[0]++]):(se=(A[L[0]++]>>2)+1,q==2?(ae=A[L[0]]|A[L[0]+1]<<8,L[0]+=2):(ae=(A[L[0]]|A[L[0]+1]<<8|A[L[0]+2]<<16|A[L[0]+3]<<24)>>>0,L[0]+=4)),W=[u8concat(W)],ae==0)throw new Error("Invalid offset 0");if(ae>W[0].length)throw new Error("Invalid offset beyond length");if(se>=ae)for(W.push(W[0].slice(-ae)),se-=ae;se>=W[W.length-1].length;)W.push(W[W.length-1]),se-=W[W.length-1].length;W.push(W[0].slice(-ae,-ae+se))}}var ie=u8concat(W);if(ie.length!=B)throw new Error("Unexpected length: ".concat(ie.length," != ").concat(B));return ie}function decompress_iwa_file(g){for(var A=[],L=0;L<g.length;){var B=g[L++],W=g[L]|g[L+1]<<8|g[L+2]<<16;L+=3,A.push(parse_snappy_chunk(B,g.slice(L,L+W))),L+=W}if(L!==g.length)throw new Error("data is not a valid framed stream!");return u8concat(A)}function compress_iwa_file(g){for(var A=[],L=0;L<g.length;){var B=Math.min(g.length-L,268435455),W=new Uint8Array(4);A.push(W);var q=write_varint49(B),J=q.length;A.push(q),B<=60?(J++,A.push(new Uint8Array([B-1<<2]))):B<=256?(J+=2,A.push(new Uint8Array([240,B-1&255]))):B<=65536?(J+=3,A.push(new Uint8Array([244,B-1&255,B-1>>8&255]))):B<=16777216?(J+=4,A.push(new Uint8Array([248,B-1&255,B-1>>8&255,B-1>>16&255]))):B<=4294967296&&(J+=5,A.push(new Uint8Array([252,B-1&255,B-1>>8&255,B-1>>16&255,B-1>>>24&255]))),A.push(g.slice(L,L+B)),J+=B,W[0]=0,W[1]=J&255,W[2]=J>>8&255,W[3]=J>>16&255,L+=B}return u8concat(A)}function parse_old_storage(g,A,L,B){var W=u8_to_dataview(g),q=W.getUint32(4,!0),J=(B>1?12:8)+popcnt(q&(B>1?3470:398))*4,re=-1,ae=-1,se=NaN,ie=new Date(2001,0,1);q&512&&(re=W.getUint32(J,!0),J+=4),J+=popcnt(q&(B>1?12288:4096))*4,q&16&&(ae=W.getUint32(J,!0),J+=4),q&32&&(se=W.getFloat64(J,!0),J+=8),q&64&&(ie.setTime(ie.getTime()+W.getFloat64(J,!0)*1e3),J+=8);var le;switch(g[2]){case 0:break;case 2:le={t:"n",v:se};break;case 3:le={t:"s",v:A[ae]};break;case 5:le={t:"d",v:ie};break;case 6:le={t:"b",v:se>0};break;case 7:le={t:"n",v:se/86400};break;case 8:le={t:"e",v:0};break;case 9:if(re>-1)le={t:"s",v:L[re]};else if(ae>-1)le={t:"s",v:A[ae]};else if(!isNaN(se))le={t:"n",v:se};else throw new Error("Unsupported cell type ".concat(g.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(g.slice(0,4)))}return le}function parse_new_storage(g,A,L){var B=u8_to_dataview(g),W=B.getUint32(8,!0),q=12,J=-1,re=-1,ae=NaN,se=NaN,ie=new Date(2001,0,1);W&1&&(ae=readDecimal128LE(g,q),q+=16),W&2&&(se=B.getFloat64(q,!0),q+=8),W&4&&(ie.setTime(ie.getTime()+B.getFloat64(q,!0)*1e3),q+=8),W&8&&(re=B.getUint32(q,!0),q+=4),W&16&&(J=B.getUint32(q,!0),q+=4);var le;switch(g[1]){case 0:break;case 2:le={t:"n",v:ae};break;case 3:le={t:"s",v:A[re]};break;case 5:le={t:"d",v:ie};break;case 6:le={t:"b",v:se>0};break;case 7:le={t:"n",v:se/86400};break;case 8:le={t:"e",v:0};break;case 9:if(J>-1)le={t:"s",v:L[J]};else throw new Error("Unsupported cell type ".concat(g[1]," : ").concat(W&31," : ").concat(g.slice(0,4)));break;case 10:le={t:"n",v:ae};break;default:throw new Error("Unsupported cell type ".concat(g[1]," : ").concat(W&31," : ").concat(g.slice(0,4)))}return le}function write_new_storage(g,A){var L=new Uint8Array(32),B=u8_to_dataview(L),W=12,q=0;switch(L[0]=5,g.t){case"n":L[1]=2,writeDecimal128LE(L,W,g.v),q|=1,W+=16;break;case"b":L[1]=6,B.setFloat64(W,g.v?1:0,!0),q|=2,W+=8;break;case"s":if(A.indexOf(g.v)==-1)throw new Error("Value ".concat(g.v," missing from SST!"));L[1]=3,B.setUint32(W,A.indexOf(g.v),!0),q|=8,W+=4;break;default:throw"unsupported cell type "+g.t}return B.setUint32(8,q,!0),L.slice(0,W)}function write_old_storage(g,A){var L=new Uint8Array(32),B=u8_to_dataview(L),W=12,q=0;switch(L[0]=3,g.t){case"n":L[2]=2,B.setFloat64(W,g.v,!0),q|=32,W+=8;break;case"b":L[2]=6,B.setFloat64(W,g.v?1:0,!0),q|=32,W+=8;break;case"s":if(A.indexOf(g.v)==-1)throw new Error("Value ".concat(g.v," missing from SST!"));L[2]=3,B.setUint32(W,A.indexOf(g.v),!0),q|=16,W+=4;break;default:throw"unsupported cell type "+g.t}return B.setUint32(4,q,!0),L.slice(0,W)}function parse_cell_storage(g,A,L){switch(g[0]){case 0:case 1:case 2:case 3:return parse_old_storage(g,A,L,g[0]);case 5:return parse_new_storage(g,A,L);default:throw new Error("Unsupported payload version ".concat(g[0]))}}function parse_TSP_Reference(g){var A=parse_shallow(g);return parse_varint49(A[1][0].data)}function parse_TST_TableDataList(g,A){var L=parse_shallow(A.data),B=varint_to_i32(L[1][0].data),W=L[3],q=[];return(W||[]).forEach(function(J){var re=parse_shallow(J.data),ae=varint_to_i32(re[1][0].data)>>>0;switch(B){case 1:q[ae]=u8str(re[3][0].data);break;case 8:{var se=g[parse_TSP_Reference(re[9][0].data)][0],ie=parse_shallow(se.data),le=g[parse_TSP_Reference(ie[1][0].data)][0],pe=varint_to_i32(le.meta[1][0].data);if(pe!=2001)throw new Error("2000 unexpected reference to ".concat(pe));var he=parse_shallow(le.data);q[ae]=he[3].map(function(ue){return u8str(ue.data)}).join("")}break}}),q}function parse_TST_TileRowInfo(g,A){var L,B,W,q,J,re,ae,se,ie,le,pe,he,ue,ce,fe=parse_shallow(g),me=varint_to_i32(fe[1][0].data)>>>0,ke=varint_to_i32(fe[2][0].data)>>>0,xe=((B=(L=fe[8])==null?void 0:L[0])==null?void 0:B.data)&&varint_to_i32(fe[8][0].data)>0||!1,Le,Se;if((q=(W=fe[7])==null?void 0:W[0])!=null&&q.data&&A!=0)Le=(re=(J=fe[7])==null?void 0:J[0])==null?void 0:re.data,Se=(se=(ae=fe[6])==null?void 0:ae[0])==null?void 0:se.data;else if((le=(ie=fe[4])==null?void 0:ie[0])!=null&&le.data&&A!=1)Le=(he=(pe=fe[4])==null?void 0:pe[0])==null?void 0:he.data,Se=(ce=(ue=fe[3])==null?void 0:ue[0])==null?void 0:ce.data;else throw"NUMBERS Tile missing ".concat(A," cell storage");for(var Te=xe?4:1,ge=u8_to_dataview(Le),Ce=[],be=0;be<Le.length/2;++be){var nt=ge.getUint16(be*2,!0);nt<65535&&Ce.push([be,nt])}if(Ce.length!=ke)throw"Expected ".concat(ke," cells, found ").concat(Ce.length);var Ae=[];for(be=0;be<Ce.length-1;++be)Ae[Ce[be][0]]=Se.subarray(Ce[be][1]*Te,Ce[be+1][1]*Te);return Ce.length>=1&&(Ae[Ce[Ce.length-1][0]]=Se.subarray(Ce[Ce.length-1][1]*Te)),{R:me,cells:Ae}}function parse_TST_Tile(g,A){var L,B=parse_shallow(A.data),W=(L=B==null?void 0:B[7])!=null&&L[0]?varint_to_i32(B[7][0].data)>>>0>0?1:0:-1,q=mappa(B[5],function(J){return parse_TST_TileRowInfo(J,W)});return{nrows:varint_to_i32(B[4][0].data)>>>0,data:q.reduce(function(J,re){return J[re.R]||(J[re.R]=[]),re.cells.forEach(function(ae,se){if(J[re.R][se])throw new Error("Duplicate cell r=".concat(re.R," c=").concat(se));J[re.R][se]=ae}),J},[])}}function parse_TST_TableModelArchive(g,A,L){var B,W=parse_shallow(A.data),q={s:{r:0,c:0},e:{r:0,c:0}};if(q.e.r=(varint_to_i32(W[6][0].data)>>>0)-1,q.e.r<0)throw new Error("Invalid row varint ".concat(W[6][0].data));if(q.e.c=(varint_to_i32(W[7][0].data)>>>0)-1,q.e.c<0)throw new Error("Invalid col varint ".concat(W[7][0].data));L["!ref"]=encode_range(q);var J=parse_shallow(W[4][0].data),re=parse_TST_TableDataList(g,g[parse_TSP_Reference(J[4][0].data)][0]),ae=(B=J[17])!=null&&B[0]?parse_TST_TableDataList(g,g[parse_TSP_Reference(J[17][0].data)][0]):[],se=parse_shallow(J[3][0].data),ie=0;se[1].forEach(function(le){var pe=parse_shallow(le.data),he=g[parse_TSP_Reference(pe[2][0].data)][0],ue=varint_to_i32(he.meta[1][0].data);if(ue!=6002)throw new Error("6001 unexpected reference to ".concat(ue));var ce=parse_TST_Tile(g,he);ce.data.forEach(function(fe,me){fe.forEach(function(ke,xe){var Le=encode_cell({r:ie+me,c:xe}),Se=parse_cell_storage(ke,re,ae);Se&&(L[Le]=Se)})}),ie+=ce.nrows})}function parse_TST_TableInfoArchive(g,A){var L=parse_shallow(A.data),B={"!ref":"A1"},W=g[parse_TSP_Reference(L[2][0].data)],q=varint_to_i32(W[0].meta[1][0].data);if(q!=6001)throw new Error("6000 unexpected reference to ".concat(q));return parse_TST_TableModelArchive(g,W[0],B),B}function parse_TN_SheetArchive(g,A){var L,B=parse_shallow(A.data),W={name:(L=B[1])!=null&&L[0]?u8str(B[1][0].data):"",sheets:[]},q=mappa(B[2],parse_TSP_Reference);return q.forEach(function(J){g[J].forEach(function(re){var ae=varint_to_i32(re.meta[1][0].data);ae==6e3&&W.sheets.push(parse_TST_TableInfoArchive(g,re))})}),W}function parse_TN_DocumentArchive(g,A){var L=book_new(),B=parse_shallow(A.data),W=mappa(B[1],parse_TSP_Reference);if(W.forEach(function(q){g[q].forEach(function(J){var re=varint_to_i32(J.meta[1][0].data);if(re==2){var ae=parse_TN_SheetArchive(g,J);ae.sheets.forEach(function(se,ie){book_append_sheet(L,se,ie==0?ae.name:ae.name+"_"+ie,!0)})}})}),L.SheetNames.length==0)throw new Error("Empty NUMBERS file");return L}function parse_numbers_iwa(g){var A,L,B,W,q={},J=[];if(g.FullPaths.forEach(function(ae){if(ae.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),g.FileIndex.forEach(function(ae){if(ae.name.match(/\.iwa$/)){var se;try{se=decompress_iwa_file(ae.content)}catch(le){return console.log("?? "+ae.content.length+" "+(le.message||le))}var ie;try{ie=parse_iwa_file(se)}catch(le){return console.log("## "+(le.message||le))}ie.forEach(function(le){q[le.id]=le.messages,J.push(le.id)})}}),!J.length)throw new Error("File has no messages");var re=((W=(B=(L=(A=q==null?void 0:q[1])==null?void 0:A[0])==null?void 0:L.meta)==null?void 0:B[1])==null?void 0:W[0].data)&&varint_to_i32(q[1][0].meta[1][0].data)==1&&q[1][0];if(re||J.forEach(function(ae){q[ae].forEach(function(se){var ie=varint_to_i32(se.meta[1][0].data)>>>0;if(ie==1)if(!re)re=se;else throw new Error("Document has multiple roots")})}),!re)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(q,re)}function write_tile_row(g,A,L){var B,W,q,J;if(!((B=g[6])!=null&&B[0])||!((W=g[7])!=null&&W[0]))throw"Mutation only works on post-BNC storages!";var re=((J=(q=g[8])==null?void 0:q[0])==null?void 0:J.data)&&varint_to_i32(g[8][0].data)>0||!1;if(re)throw"Math only works with normal offsets";for(var ae=0,se=u8_to_dataview(g[7][0].data),ie=0,le=[],pe=u8_to_dataview(g[4][0].data),he=0,ue=[],ce=0;ce<A.length;++ce){if(A[ce]==null){se.setUint16(ce*2,65535,!0),pe.setUint16(ce*2,65535);continue}se.setUint16(ce*2,ie,!0),pe.setUint16(ce*2,he,!0);var fe,me;switch(typeof A[ce]){case"string":fe=write_new_storage({t:"s",v:A[ce]},L),me=write_old_storage({t:"s",v:A[ce]},L);break;case"number":fe=write_new_storage({t:"n",v:A[ce]},L),me=write_old_storage({t:"n",v:A[ce]},L);break;case"boolean":fe=write_new_storage({t:"b",v:A[ce]},L),me=write_old_storage({t:"b",v:A[ce]},L);break;default:throw new Error("Unsupported value "+A[ce])}le.push(fe),ie+=fe.length,ue.push(me),he+=me.length,++ae}for(g[2][0].data=write_varint49(ae);ce<g[7][0].data.length/2;++ce)se.setUint16(ce*2,65535,!0),pe.setUint16(ce*2,65535,!0);return g[6][0].data=u8concat(le),g[3][0].data=u8concat(ue),ae}function write_numbers_iwa(g,A){if(!A||!A.numbers)throw new Error("Must pass a `numbers` option -- check the README");var L=g.Sheets[g.SheetNames[0]];g.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var B=decode_range(L["!ref"]);B.s.r=B.s.c=0;var W=!1;B.e.c>9&&(W=!0,B.e.c=9),B.e.r>49&&(W=!0,B.e.r=49),W&&console.error("The Numbers writer is currently limited to ".concat(encode_range(B)));var q=sheet_to_json(L,{range:B,header:1}),J=["~Sh33tJ5~"];q.forEach(function(ye){return ye.forEach(function(ve){typeof ve=="string"&&J.push(ve)})});var re={},ae=[],se=CFB.read(A.numbers,{type:"base64"});se.FileIndex.map(function(ye,ve){return[ye,se.FullPaths[ve]]}).forEach(function(ye){var ve=ye[0],Pe=ye[1];if(ve.type==2&&ve.name.match(/\.iwa/)){var rt=ve.content,st=decompress_iwa_file(rt),ot=parse_iwa_file(st);ot.forEach(function(mt){ae.push(mt.id),re[mt.id]={deps:[],location:Pe,type:varint_to_i32(mt.messages[0].meta[1][0].data)}})}}),ae.sort(function(ye,ve){return ye-ve});var ie=ae.filter(function(ye){return ye>1}).map(function(ye){return[ye,write_varint49(ye)]});se.FileIndex.map(function(ye,ve){return[ye,se.FullPaths[ve]]}).forEach(function(ye){var ve=ye[0];if(ye[1],!!ve.name.match(/\.iwa/)){var Pe=parse_iwa_file(decompress_iwa_file(ve.content));Pe.forEach(function(rt){rt.messages.forEach(function(st){ie.forEach(function(ot){rt.messages.some(function(mt){return varint_to_i32(mt.meta[1][0].data)!=11006&&u8contains(mt.data,ot[1])})&&re[ot[0]].deps.push(rt.id)})})})}});for(var le=CFB.find(se,re[1].location),pe=parse_iwa_file(decompress_iwa_file(le.content)),he,ue=0;ue<pe.length;++ue){var ce=pe[ue];ce.id==1&&(he=ce)}var fe=parse_TSP_Reference(parse_shallow(he.messages[0].data)[1][0].data);for(le=CFB.find(se,re[fe].location),pe=parse_iwa_file(decompress_iwa_file(le.content)),ue=0;ue<pe.length;++ue)ce=pe[ue],ce.id==fe&&(he=ce);for(fe=parse_TSP_Reference(parse_shallow(he.messages[0].data)[2][0].data),le=CFB.find(se,re[fe].location),pe=parse_iwa_file(decompress_iwa_file(le.content)),ue=0;ue<pe.length;++ue)ce=pe[ue],ce.id==fe&&(he=ce);for(fe=parse_TSP_Reference(parse_shallow(he.messages[0].data)[2][0].data),le=CFB.find(se,re[fe].location),pe=parse_iwa_file(decompress_iwa_file(le.content)),ue=0;ue<pe.length;++ue)ce=pe[ue],ce.id==fe&&(he=ce);var me=parse_shallow(he.messages[0].data);{me[6][0].data=write_varint49(B.e.r+1),me[7][0].data=write_varint49(B.e.c+1);var ke=parse_TSP_Reference(me[46][0].data),xe=CFB.find(se,re[ke].location),Le=parse_iwa_file(decompress_iwa_file(xe.content));{for(var Se=0;Se<Le.length&&Le[Se].id!=ke;++Se);if(Le[Se].id!=ke)throw"Bad ColumnRowUIDMapArchive";var Te=parse_shallow(Le[Se].messages[0].data);Te[1]=[],Te[2]=[],Te[3]=[];for(var ge=0;ge<=B.e.c;++ge){var Ce=[];Ce[1]=Ce[2]=[{type:0,data:write_varint49(ge+420690)}],Te[1].push({type:2,data:write_shallow(Ce)}),Te[2].push({type:0,data:write_varint49(ge)}),Te[3].push({type:0,data:write_varint49(ge)})}Te[4]=[],Te[5]=[],Te[6]=[];for(var be=0;be<=B.e.r;++be)Ce=[],Ce[1]=Ce[2]=[{type:0,data:write_varint49(be+726270)}],Te[4].push({type:2,data:write_shallow(Ce)}),Te[5].push({type:0,data:write_varint49(be)}),Te[6].push({type:0,data:write_varint49(be)});Le[Se].messages[0].data=write_shallow(Te)}xe.content=compress_iwa_file(write_iwa_file(Le)),xe.size=xe.content.length,delete me[46];var nt=parse_shallow(me[4][0].data);{nt[7][0].data=write_varint49(B.e.r+1);var Ae=parse_shallow(nt[1][0].data),De=parse_TSP_Reference(Ae[2][0].data);xe=CFB.find(se,re[De].location),Le=parse_iwa_file(decompress_iwa_file(xe.content));{if(Le[0].id!=De)throw"Bad HeaderStorageBucket";var lt=parse_shallow(Le[0].messages[0].data);for(be=0;be<q.length;++be){var Ct=parse_shallow(lt[2][0].data);Ct[1][0].data=write_varint49(be),Ct[4][0].data=write_varint49(q[be].length),lt[2][be]={type:lt[2][0].type,data:write_shallow(Ct)}}Le[0].messages[0].data=write_shallow(lt)}xe.content=compress_iwa_file(write_iwa_file(Le)),xe.size=xe.content.length;var ft=parse_TSP_Reference(nt[2][0].data);xe=CFB.find(se,re[ft].location),Le=parse_iwa_file(decompress_iwa_file(xe.content));{if(Le[0].id!=ft)throw"Bad HeaderStorageBucket";for(lt=parse_shallow(Le[0].messages[0].data),ge=0;ge<=B.e.c;++ge)Ct=parse_shallow(lt[2][0].data),Ct[1][0].data=write_varint49(ge),Ct[4][0].data=write_varint49(B.e.r+1),lt[2][ge]={type:lt[2][0].type,data:write_shallow(Ct)};Le[0].messages[0].data=write_shallow(lt)}xe.content=compress_iwa_file(write_iwa_file(Le)),xe.size=xe.content.length;var Et=parse_TSP_Reference(nt[4][0].data);(function(){for(var ye=CFB.find(se,re[Et].location),ve=parse_iwa_file(decompress_iwa_file(ye.content)),Pe,rt=0;rt<ve.length;++rt){var st=ve[rt];st.id==Et&&(Pe=st)}var ot=parse_shallow(Pe.messages[0].data);{ot[3]=[];var mt=[];J.forEach(function(it,Vt){mt[1]=[{type:0,data:write_varint49(Vt)}],mt[2]=[{type:0,data:write_varint49(1)}],mt[3]=[{type:2,data:stru8(it)}],ot[3].push({type:2,data:write_shallow(mt)})})}Pe.messages[0].data=write_shallow(ot);var At=write_iwa_file(ve),It=compress_iwa_file(At);ye.content=It,ye.size=ye.content.length})();var gt=parse_shallow(nt[3][0].data);{var bt=gt[1][0];delete gt[2];var Ie=parse_shallow(bt.data);{var pt=parse_TSP_Reference(Ie[2][0].data);(function(){for(var ye=CFB.find(se,re[pt].location),ve=parse_iwa_file(decompress_iwa_file(ye.content)),Pe,rt=0;rt<ve.length;++rt){var st=ve[rt];st.id==pt&&(Pe=st)}var ot=parse_shallow(Pe.messages[0].data);{delete ot[6],delete gt[7];var mt=new Uint8Array(ot[5][0].data);ot[5]=[];for(var At=0,It=0;It<=B.e.r;++It){var it=parse_shallow(mt);At+=write_tile_row(it,q[It],J),it[1][0].data=write_varint49(It),ot[5].push({data:write_shallow(it),type:2})}ot[1]=[{type:0,data:write_varint49(B.e.c+1)}],ot[2]=[{type:0,data:write_varint49(B.e.r+1)}],ot[3]=[{type:0,data:write_varint49(At)}],ot[4]=[{type:0,data:write_varint49(B.e.r+1)}]}Pe.messages[0].data=write_shallow(ot);var Vt=write_iwa_file(ve),Yt=compress_iwa_file(Vt);ye.content=Yt,ye.size=ye.content.length})()}bt.data=write_shallow(Ie)}nt[3][0].data=write_shallow(gt)}me[4][0].data=write_shallow(nt)}he.messages[0].data=write_shallow(me);var at=write_iwa_file(pe),Ee=compress_iwa_file(at);return le.content=Ee,le.size=le.content.length,se}function fix_opts_func(g){return function(L){for(var B=0;B!=g.length;++B){var W=g[B];L[W[0]]===void 0&&(L[W[0]]=W[1]),W[2]==="n"&&(L[W[0]]=Number(L[W[0]]))}}}function fix_read_opts(g){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(g)}function fix_write_opts(g){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(g)}function get_sheet_type(g){return RELS.WS.indexOf(g)>-1?"sheet":g==RELS.CS?"chart":g==RELS.DS?"dialog":g==RELS.MS?"macro":g&&g.length?g:"sheet"}function safe_parse_wbrels(g,A){if(!g)return 0;try{g=A.map(function(B){return B.id||(B.id=B.strRelID),[B.name,g["!id"][B.id].Target,get_sheet_type(g["!id"][B.id].Type)]})}catch{return null}return!g||g.length===0?null:g}function safe_parse_sheet(g,A,L,B,W,q,J,re,ae,se,ie,le){try{q[B]=parse_rels(getzipstr(g,L,!0),A);var pe=getzipdata(g,A),he;switch(re){case"sheet":he=parse_ws(pe,A,W,ae,q[B],se,ie,le);break;case"chart":if(he=parse_cs(pe,A,W,ae,q[B],se,ie,le),!he||!he["!drawel"])break;var ue=resolve_path(he["!drawel"].Target,A),ce=get_rels_path(ue),fe=parse_drawing(getzipstr(g,ue,!0),parse_rels(getzipstr(g,ce,!0),ue)),me=resolve_path(fe,ue),ke=get_rels_path(me);he=parse_chart(getzipstr(g,me,!0),me,ae,parse_rels(getzipstr(g,ke,!0),me),se,he);break;case"macro":he=parse_ms(pe,A,W,ae,q[B],se,ie,le);break;case"dialog":he=parse_ds(pe,A,W,ae,q[B],se,ie,le);break;default:throw new Error("Unrecognized sheet type "+re)}J[B]=he;var xe=[];q&&q[B]&&keys(q[B]).forEach(function(Le){var Se="";if(q[B][Le].Type==RELS.CMNT){Se=resolve_path(q[B][Le].Target,A);var Te=parse_cmnt(getzipdata(g,Se,!0),Se,ae);if(!Te||!Te.length)return;sheet_insert_comments(he,Te,!1)}q[B][Le].Type==RELS.TCMNT&&(Se=resolve_path(q[B][Le].Target,A),xe=xe.concat(parse_tcmnt_xml(getzipdata(g,Se,!0),ae)))}),xe&&xe.length&&sheet_insert_comments(he,xe,!0,ae.people||[])}catch(Le){if(ae.WTF)throw Le}}function strip_front_slash(g){return g.charAt(0)=="/"?g.slice(1):g}function parse_zip(g,A){if(make_ssf(),A=A||{},fix_read_opts(A),safegetzipfile(g,"META-INF/manifest.xml")||safegetzipfile(g,"objectdata.xml"))return parse_ods(g,A);if(safegetzipfile(g,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(g.FileIndex)return parse_numbers_iwa(g);var L=CFB.utils.cfb_new();return zipentries(g).forEach(function(Ct){zip_add_file(L,Ct,getzipbin(g,Ct))}),parse_numbers_iwa(L)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(g,"[Content_Types].xml"))throw safegetzipfile(g,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(g,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var B=zipentries(g),W=parse_ct(getzipstr(g,"[Content_Types].xml")),q=!1,J,re;if(W.workbooks.length===0&&(re="xl/workbook.xml",getzipdata(g,re,!0)&&W.workbooks.push(re)),W.workbooks.length===0){if(re="xl/workbook.bin",!getzipdata(g,re,!0))throw new Error("Could not find workbook");W.workbooks.push(re),q=!0}W.workbooks[0].slice(-3)=="bin"&&(q=!0);var ae={},se={};if(!A.bookSheets&&!A.bookProps){if(strs=[],W.sst)try{strs=parse_sst(getzipdata(g,strip_front_slash(W.sst)),W.sst,A)}catch(Ct){if(A.WTF)throw Ct}A.cellStyles&&W.themes.length&&(ae=parse_theme(getzipstr(g,W.themes[0].replace(/^\//,""),!0)||"",W.themes[0],A)),W.style&&(se=parse_sty(getzipdata(g,strip_front_slash(W.style)),W.style,ae,A))}W.links.map(function(Ct){try{var ft=parse_rels(getzipstr(g,get_rels_path(strip_front_slash(Ct))),Ct);return parse_xlink(getzipdata(g,strip_front_slash(Ct)),ft,Ct,A)}catch{}});var ie=parse_wb(getzipdata(g,strip_front_slash(W.workbooks[0])),W.workbooks[0],A),le={},pe="";W.coreprops.length&&(pe=getzipdata(g,strip_front_slash(W.coreprops[0]),!0),pe&&(le=parse_core_props(pe)),W.extprops.length!==0&&(pe=getzipdata(g,strip_front_slash(W.extprops[0]),!0),pe&&parse_ext_props(pe,le,A)));var he={};(!A.bookSheets||A.bookProps)&&W.custprops.length!==0&&(pe=getzipstr(g,strip_front_slash(W.custprops[0]),!0),pe&&(he=parse_cust_props(pe,A)));var ue={};if((A.bookSheets||A.bookProps)&&(ie.Sheets?J=ie.Sheets.map(function(ft){return ft.name}):le.Worksheets&&le.SheetNames.length>0&&(J=le.SheetNames),A.bookProps&&(ue.Props=le,ue.Custprops=he),A.bookSheets&&typeof J<"u"&&(ue.SheetNames=J),A.bookSheets?ue.SheetNames:A.bookProps))return ue;J={};var ce={};A.bookDeps&&W.calcchain&&(ce=parse_cc(getzipdata(g,strip_front_slash(W.calcchain)),W.calcchain));var fe=0,me={},ke,xe;{var Le=ie.Sheets;le.Worksheets=Le.length,le.SheetNames=[];for(var Se=0;Se!=Le.length;++Se)le.SheetNames[Se]=Le[Se].name}var Te=q?"bin":"xml",ge=W.workbooks[0].lastIndexOf("/"),Ce=(W.workbooks[0].slice(0,ge+1)+"_rels/"+W.workbooks[0].slice(ge+1)+".rels").replace(/^\//,"");safegetzipfile(g,Ce)||(Ce="xl/_rels/workbook."+Te+".rels");var be=parse_rels(getzipstr(g,Ce,!0),Ce.replace(/_rels.*/,"s5s"));(W.metadata||[]).length>=1&&(A.xlmeta=parse_xlmeta(getzipdata(g,strip_front_slash(W.metadata[0])),W.metadata[0],A)),(W.people||[]).length>=1&&(A.people=parse_people_xml(getzipdata(g,strip_front_slash(W.people[0])),A)),be&&(be=safe_parse_wbrels(be,ie.Sheets));var nt=getzipdata(g,"xl/worksheets/sheet.xml",!0)?1:0;e:for(fe=0;fe!=le.Worksheets;++fe){var Ae="sheet";if(be&&be[fe]?(ke="xl/"+be[fe][1].replace(/[\/]?xl\//,""),safegetzipfile(g,ke)||(ke=be[fe][1]),safegetzipfile(g,ke)||(ke=Ce.replace(/_rels\/.*$/,"")+be[fe][1]),Ae=be[fe][2]):(ke="xl/worksheets/sheet"+(fe+1-nt)+"."+Te,ke=ke.replace(/sheet0\./,"sheet.")),xe=ke.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),A&&A.sheets!=null)switch(typeof A.sheets){case"number":if(fe!=A.sheets)continue e;break;case"string":if(le.SheetNames[fe].toLowerCase()!=A.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(A.sheets)){for(var De=!1,lt=0;lt!=A.sheets.length;++lt)typeof A.sheets[lt]=="number"&&A.sheets[lt]==fe&&(De=1),typeof A.sheets[lt]=="string"&&A.sheets[lt].toLowerCase()==le.SheetNames[fe].toLowerCase()&&(De=1);if(!De)continue e}}safe_parse_sheet(g,ke,xe,le.SheetNames[fe],fe,me,J,Ae,A,ie,ae,se)}return ue={Directory:W,Workbook:ie,Props:le,Custprops:he,Deps:ce,Sheets:J,SheetNames:le.SheetNames,Strings:strs,Styles:se,Themes:ae,SSF:dup(table_fmt)},A&&A.bookFiles&&(g.files?(ue.keys=B,ue.files=g.files):(ue.keys=[],ue.files={},g.FullPaths.forEach(function(Ct,ft){Ct=Ct.replace(/^Root Entry[\/]/,""),ue.keys.push(Ct),ue.files[Ct]=g.FileIndex[ft]}))),A&&A.bookVBA&&(W.vba.length>0?ue.vbaraw=getzipdata(g,strip_front_slash(W.vba[0]),!0):W.defaults&&W.defaults.bin===CT_VBA&&(ue.vbaraw=getzipdata(g,"xl/vbaProject.bin",!0))),ue}function parse_xlsxcfb(g,A){var L=A||{},B="Workbook",W=CFB.find(g,B);try{if(B="/!DataSpaces/Version",W=CFB.find(g,B),!W||!W.content)throw new Error("ECMA-376 Encrypted file missing "+B);if(parse_DataSpaceVersionInfo(W.content),B="/!DataSpaces/DataSpaceMap",W=CFB.find(g,B),!W||!W.content)throw new Error("ECMA-376 Encrypted file missing "+B);var q=parse_DataSpaceMap(W.content);if(q.length!==1||q[0].comps.length!==1||q[0].comps[0].t!==0||q[0].name!=="StrongEncryptionDataSpace"||q[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+B);if(B="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",W=CFB.find(g,B),!W||!W.content)throw new Error("ECMA-376 Encrypted file missing "+B);var J=parse_DataSpaceDefinition(W.content);if(J.length!=1||J[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+B);if(B="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",W=CFB.find(g,B),!W||!W.content)throw new Error("ECMA-376 Encrypted file missing "+B);parse_Primary(W.content)}catch{}if(B="/EncryptionInfo",W=CFB.find(g,B),!W||!W.content)throw new Error("ECMA-376 Encrypted file missing "+B);var re=parse_EncryptionInfo(W.content);if(B="/EncryptedPackage",W=CFB.find(g,B),!W||!W.content)throw new Error("ECMA-376 Encrypted file missing "+B);if(re[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(re[1],W.content,L.password||"",L);if(re[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(re[1],W.content,L.password||"",L);throw new Error("File is password-protected")}function write_zip(g,A){return A.bookType=="ods"?write_ods(g,A):A.bookType=="numbers"?write_numbers_iwa(g,A):A.bookType=="xlsb"?write_zip_xlsxb(g,A):write_zip_xlsx(g,A)}function write_zip_xlsxb(g,A){_shapeid=1024,g&&!g.SSF&&(g.SSF=dup(table_fmt)),g&&g.SSF&&(make_ssf(),SSF_load_table(g.SSF),A.revssf=evert_num(g.SSF),A.revssf[g.SSF[65535]]=0,A.ssf=g.SSF),A.rels={},A.wbrels={},A.Strings=[],A.Strings.Count=0,A.Strings.Unique=0,browser_has_Map?A.revStrings=new Map:(A.revStrings={},A.revStrings.foo=[],delete A.revStrings.foo);var L=A.bookType=="xlsb"?"bin":"xml",B=VBAFMTS.indexOf(A.bookType)>-1,W=new_ct();fix_write_opts(A=A||{});var q=zip_new(),J="",re=0;if(A.cellXfs=[],get_cell_style(A.cellXfs,{},{revssf:{General:0}}),g.Props||(g.Props={}),J="docProps/core.xml",zip_add_file(q,J,write_core_props(g.Props,A)),W.coreprops.push(J),add_rels(A.rels,2,J,RELS.CORE_PROPS),J="docProps/app.xml",!(g.Props&&g.Props.SheetNames))if(!g.Workbook||!g.Workbook.Sheets)g.Props.SheetNames=g.SheetNames;else{for(var ae=[],se=0;se<g.SheetNames.length;++se)(g.Workbook.Sheets[se]||{}).Hidden!=2&&ae.push(g.SheetNames[se]);g.Props.SheetNames=ae}for(g.Props.Worksheets=g.Props.SheetNames.length,zip_add_file(q,J,write_ext_props(g.Props)),W.extprops.push(J),add_rels(A.rels,3,J,RELS.EXT_PROPS),g.Custprops!==g.Props&&keys(g.Custprops||{}).length>0&&(J="docProps/custom.xml",zip_add_file(q,J,write_cust_props(g.Custprops)),W.custprops.push(J),add_rels(A.rels,4,J,RELS.CUST_PROPS)),re=1;re<=g.SheetNames.length;++re){var ie={"!id":{}},le=g.Sheets[g.SheetNames[re-1]],pe=(le||{})["!type"]||"sheet";switch(pe){case"chart":default:J="xl/worksheets/sheet"+re+"."+L,zip_add_file(q,J,write_ws(re-1,J,A,g,ie)),W.sheets.push(J),add_rels(A.wbrels,-1,"worksheets/sheet"+re+"."+L,RELS.WS[0])}if(le){var he=le["!comments"],ue=!1,ce="";he&&he.length>0&&(ce="xl/comments"+re+"."+L,zip_add_file(q,ce,write_cmnt(he,ce)),W.comments.push(ce),add_rels(ie,-1,"../comments"+re+"."+L,RELS.CMNT),ue=!0),le["!legacy"]&&ue&&zip_add_file(q,"xl/drawings/vmlDrawing"+re+".vml",write_comments_vml(re,le["!comments"])),delete le["!comments"],delete le["!legacy"]}ie["!id"].rId1&&zip_add_file(q,get_rels_path(J),write_rels(ie))}return A.Strings!=null&&A.Strings.length>0&&(J="xl/sharedStrings."+L,zip_add_file(q,J,write_sst(A.Strings,J,A)),W.strs.push(J),add_rels(A.wbrels,-1,"sharedStrings."+L,RELS.SST)),J="xl/workbook."+L,zip_add_file(q,J,write_wb(g,J)),W.workbooks.push(J),add_rels(A.rels,1,J,RELS.WB),J="xl/theme/theme1.xml",zip_add_file(q,J,write_theme(g.Themes,A)),W.themes.push(J),add_rels(A.wbrels,-1,"theme/theme1.xml",RELS.THEME),J="xl/styles."+L,zip_add_file(q,J,write_sty(g,J,A)),W.styles.push(J),add_rels(A.wbrels,-1,"styles."+L,RELS.STY),g.vbaraw&&B&&(J="xl/vbaProject.bin",zip_add_file(q,J,g.vbaraw),W.vba.push(J),add_rels(A.wbrels,-1,"vbaProject.bin",RELS.VBA)),J="xl/metadata."+L,zip_add_file(q,J,write_xlmeta(J)),W.metadata.push(J),add_rels(A.wbrels,-1,"metadata."+L,RELS.XLMETA),zip_add_file(q,"[Content_Types].xml",write_ct(W,A)),zip_add_file(q,"_rels/.rels",write_rels(A.rels)),zip_add_file(q,"xl/_rels/workbook."+L+".rels",write_rels(A.wbrels)),delete A.revssf,delete A.ssf,q}function write_zip_xlsx(g,A){_shapeid=1024,g&&!g.SSF&&(g.SSF=dup(table_fmt)),g&&g.SSF&&(make_ssf(),SSF_load_table(g.SSF),A.revssf=evert_num(g.SSF),A.revssf[g.SSF[65535]]=0,A.ssf=g.SSF),A.rels={},A.wbrels={},A.Strings=[],A.Strings.Count=0,A.Strings.Unique=0,browser_has_Map?A.revStrings=new Map:(A.revStrings={},A.revStrings.foo=[],delete A.revStrings.foo);var L="xml",B=VBAFMTS.indexOf(A.bookType)>-1,W=new_ct();fix_write_opts(A=A||{});var q=zip_new(),J="",re=0;if(A.cellXfs=[],get_cell_style(A.cellXfs,{},{revssf:{General:0}}),g.Props||(g.Props={}),J="docProps/core.xml",zip_add_file(q,J,write_core_props(g.Props,A)),W.coreprops.push(J),add_rels(A.rels,2,J,RELS.CORE_PROPS),J="docProps/app.xml",!(g.Props&&g.Props.SheetNames))if(!g.Workbook||!g.Workbook.Sheets)g.Props.SheetNames=g.SheetNames;else{for(var ae=[],se=0;se<g.SheetNames.length;++se)(g.Workbook.Sheets[se]||{}).Hidden!=2&&ae.push(g.SheetNames[se]);g.Props.SheetNames=ae}g.Props.Worksheets=g.Props.SheetNames.length,zip_add_file(q,J,write_ext_props(g.Props)),W.extprops.push(J),add_rels(A.rels,3,J,RELS.EXT_PROPS),g.Custprops!==g.Props&&keys(g.Custprops||{}).length>0&&(J="docProps/custom.xml",zip_add_file(q,J,write_cust_props(g.Custprops)),W.custprops.push(J),add_rels(A.rels,4,J,RELS.CUST_PROPS));var ie=["SheetJ5"];for(A.tcid=0,re=1;re<=g.SheetNames.length;++re){var le={"!id":{}},pe=g.Sheets[g.SheetNames[re-1]],he=(pe||{})["!type"]||"sheet";switch(he){case"chart":default:J="xl/worksheets/sheet"+re+"."+L,zip_add_file(q,J,write_ws_xml(re-1,A,g,le)),W.sheets.push(J),add_rels(A.wbrels,-1,"worksheets/sheet"+re+"."+L,RELS.WS[0])}if(pe){var ue=pe["!comments"],ce=!1,fe="";if(ue&&ue.length>0){var me=!1;ue.forEach(function(ke){ke[1].forEach(function(xe){xe.T==!0&&(me=!0)})}),me&&(fe="xl/threadedComments/threadedComment"+re+"."+L,zip_add_file(q,fe,write_tcmnt_xml(ue,ie,A)),W.threadedcomments.push(fe),add_rels(le,-1,"../threadedComments/threadedComment"+re+"."+L,RELS.TCMNT)),fe="xl/comments"+re+"."+L,zip_add_file(q,fe,write_comments_xml(ue)),W.comments.push(fe),add_rels(le,-1,"../comments"+re+"."+L,RELS.CMNT),ce=!0}pe["!legacy"]&&ce&&zip_add_file(q,"xl/drawings/vmlDrawing"+re+".vml",write_comments_vml(re,pe["!comments"])),delete pe["!comments"],delete pe["!legacy"]}le["!id"].rId1&&zip_add_file(q,get_rels_path(J),write_rels(le))}return A.Strings!=null&&A.Strings.length>0&&(J="xl/sharedStrings."+L,zip_add_file(q,J,write_sst_xml(A.Strings,A)),W.strs.push(J),add_rels(A.wbrels,-1,"sharedStrings."+L,RELS.SST)),J="xl/workbook."+L,zip_add_file(q,J,write_wb_xml(g)),W.workbooks.push(J),add_rels(A.rels,1,J,RELS.WB),J="xl/theme/theme1.xml",zip_add_file(q,J,write_theme(g.Themes,A)),W.themes.push(J),add_rels(A.wbrels,-1,"theme/theme1.xml",RELS.THEME),J="xl/styles."+L,zip_add_file(q,J,write_sty_xml(g,A)),W.styles.push(J),add_rels(A.wbrels,-1,"styles."+L,RELS.STY),g.vbaraw&&B&&(J="xl/vbaProject.bin",zip_add_file(q,J,g.vbaraw),W.vba.push(J),add_rels(A.wbrels,-1,"vbaProject.bin",RELS.VBA)),J="xl/metadata."+L,zip_add_file(q,J,write_xlmeta_xml()),W.metadata.push(J),add_rels(A.wbrels,-1,"metadata."+L,RELS.XLMETA),ie.length>1&&(J="xl/persons/person.xml",zip_add_file(q,J,write_people_xml(ie)),W.people.push(J),add_rels(A.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(q,"[Content_Types].xml",write_ct(W,A)),zip_add_file(q,"_rels/.rels",write_rels(A.rels)),zip_add_file(q,"xl/_rels/workbook."+L+".rels",write_rels(A.wbrels)),delete A.revssf,delete A.ssf,q}function firstbyte(g,A){var L="";switch((A||{}).type||"base64"){case"buffer":return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7]];case"base64":L=Base64_decode(g.slice(0,12));break;case"binary":L=g;break;case"array":return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7]];default:throw new Error("Unrecognized type "+(A&&A.type||"undefined"))}return[L.charCodeAt(0),L.charCodeAt(1),L.charCodeAt(2),L.charCodeAt(3),L.charCodeAt(4),L.charCodeAt(5),L.charCodeAt(6),L.charCodeAt(7)]}function read_cfb(g,A){return CFB.find(g,"EncryptedPackage")?parse_xlsxcfb(g,A):parse_xlscfb(g,A)}function read_zip(g,A){var L,B=g,W=A||{};return W.type||(W.type=has_buf&&Buffer.isBuffer(g)?"buffer":"base64"),L=zip_read(B,W),parse_zip(L,W)}function read_plaintext(g,A){var L=0;e:for(;L<g.length;)switch(g.charCodeAt(L)){case 10:case 13:case 32:++L;break;case 60:return parse_xlml(g.slice(L),A);default:break e}return PRN.to_workbook(g,A)}function read_plaintext_raw(g,A){var L="",B=firstbyte(g,A);switch(A.type){case"base64":L=Base64_decode(g);break;case"binary":L=g;break;case"buffer":L=g.toString("binary");break;case"array":L=cc2str(g);break;default:throw new Error("Unrecognized type "+A.type)}return B[0]==239&&B[1]==187&&B[2]==191&&(L=utf8read(L)),A.type="binary",read_plaintext(L,A)}function read_utf16(g,A){var L=g;return A.type=="base64"&&(L=Base64_decode(L)),L=$cptable.utils.decode(1200,L.slice(2),"str"),A.type="binary",read_plaintext(L,A)}function bstrify(g){return g.match(/[^\x00-\x7F]/)?utf8write(g):g}function read_prn(g,A,L,B){return B?(L.type="string",PRN.to_workbook(g,L)):PRN.to_workbook(A,L)}function readSync(g,A){reset_cp();var L=A||{};if(typeof ArrayBuffer<"u"&&g instanceof ArrayBuffer)return readSync(new Uint8Array(g),(L=dup(L),L.type="array",L));typeof Uint8Array<"u"&&g instanceof Uint8Array&&!L.type&&(L.type=typeof Deno<"u"?"buffer":"array");var B=g,W=[0,0,0,0],q=!1;if(L.cellStyles&&(L.cellNF=!0,L.sheetStubs=!0),_ssfopts={},L.dateNF&&(_ssfopts.dateNF=L.dateNF),L.type||(L.type=has_buf&&Buffer.isBuffer(g)?"buffer":"base64"),L.type=="file"&&(L.type=has_buf?"buffer":"binary",B=read_binary(g),typeof Uint8Array<"u"&&!has_buf&&(L.type="array")),L.type=="string"&&(q=!0,L.type="binary",L.codepage=65001,B=bstrify(g)),L.type=="array"&&typeof Uint8Array<"u"&&g instanceof Uint8Array&&typeof ArrayBuffer<"u"){var J=new ArrayBuffer(3),re=new Uint8Array(J);if(re.foo="bar",!re.foo)return L=dup(L),L.type="array",readSync(ab2a(B),L)}switch((W=firstbyte(B,L))[0]){case 208:if(W[1]===207&&W[2]===17&&W[3]===224&&W[4]===161&&W[5]===177&&W[6]===26&&W[7]===225)return read_cfb(CFB.read(B,L),L);break;case 9:if(W[1]<=8)return parse_xlscfb(B,L);break;case 60:return parse_xlml(B,L);case 73:if(W[1]===73&&W[2]===42&&W[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(W[1]===68)return read_wb_ID(B,L);break;case 84:if(W[1]===65&&W[2]===66&&W[3]===76)return DIF.to_workbook(B,L);break;case 80:return W[1]===75&&W[2]<9&&W[3]<9?read_zip(B,L):read_prn(g,B,L,q);case 239:return W[3]===60?parse_xlml(B,L):read_prn(g,B,L,q);case 255:if(W[1]===254)return read_utf16(B,L);if(W[1]===0&&W[2]===2&&W[3]===0)return WK_.to_workbook(B,L);break;case 0:if(W[1]===0&&(W[2]>=2&&W[3]===0||W[2]===0&&(W[3]===8||W[3]===9)))return WK_.to_workbook(B,L);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(B,L);case 123:if(W[1]===92&&W[2]===114&&W[3]===116)return RTF.to_workbook(B,L);break;case 10:case 13:case 32:return read_plaintext_raw(B,L);case 137:if(W[1]===80&&W[2]===78&&W[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(W[0])>-1&&W[2]<=12&&W[3]<=31?DBF.to_workbook(B,L):read_prn(g,B,L,q)}function write_cfb_ctr(g,A){switch(A.type){case"base64":case"binary":break;case"buffer":case"array":A.type="";break;case"file":return write_dl(A.file,CFB.write(g,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+A.bookType+"' files");default:throw new Error("Unrecognized type "+A.type)}return CFB.write(g,A)}function write_zip_type(g,A){var L=dup(A||{}),B=write_zip(g,L);return write_zip_denouement(B,L)}function write_zip_denouement(g,A){var L={},B=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(A.compression&&(L.compression="DEFLATE"),A.password)L.type=B;else switch(A.type){case"base64":L.type="base64";break;case"binary":L.type="string";break;case"string":throw new Error("'string' output type invalid for '"+A.bookType+"' files");case"buffer":case"file":L.type=B;break;default:throw new Error("Unrecognized type "+A.type)}var W=g.FullPaths?CFB.write(g,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[L.type]||L.type,compression:!!A.compression}):g.generate(L);if(typeof Deno<"u"&&typeof W=="string"){if(A.type=="binary"||A.type=="base64")return W;W=new Uint8Array(s2ab(W))}return A.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(W,A.password),A):A.type==="file"?write_dl(A.file,W):A.type=="string"?utf8read(W):W}function write_cfb_type(g,A){var L=A||{},B=write_xlscfb(g,L);return write_cfb_ctr(B,L)}function write_string_type(g,A,L){L||(L="");var B=L+g;switch(A.type){case"base64":return Base64_encode(utf8write(B));case"binary":return utf8write(B);case"string":return g;case"file":return write_dl(A.file,B,"utf8");case"buffer":return has_buf?Buffer_from(B,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(B):write_string_type(B,{type:"binary"}).split("").map(function(W){return W.charCodeAt(0)})}throw new Error("Unrecognized type "+A.type)}function write_stxt_type(g,A){switch(A.type){case"base64":return Base64_encode(g);case"binary":return g;case"string":return g;case"file":return write_dl(A.file,g,"binary");case"buffer":return has_buf?Buffer_from(g,"binary"):g.split("").map(function(L){return L.charCodeAt(0)})}throw new Error("Unrecognized type "+A.type)}function write_binary_type(g,A){switch(A.type){case"string":case"base64":case"binary":for(var L="",B=0;B<g.length;++B)L+=String.fromCharCode(g[B]);return A.type=="base64"?Base64_encode(L):A.type=="string"?utf8read(L):L;case"file":return write_dl(A.file,g);case"buffer":return g;default:throw new Error("Unrecognized type "+A.type)}}function writeSync(g,A){reset_cp(),check_wb(g);var L=dup(A||{});if(L.cellStyles&&(L.cellNF=!0,L.sheetStubs=!0),L.type=="array"){L.type="binary";var B=writeSync(g,L);return L.type="array",s2ab(B)}var W=0;if(L.sheet&&(typeof L.sheet=="number"?W=L.sheet:W=g.SheetNames.indexOf(L.sheet),!g.SheetNames[W]))throw new Error("Sheet not found: "+L.sheet+" : "+typeof L.sheet);switch(L.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(g,L),L);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(g.Sheets[g.SheetNames[W]],L),L);case"htm":case"html":return write_string_type(sheet_to_html(g.Sheets[g.SheetNames[W]],L),L);case"txt":return write_stxt_type(sheet_to_txt(g.Sheets[g.SheetNames[W]],L),L);case"csv":return write_string_type(sheet_to_csv(g.Sheets[g.SheetNames[W]],L),L,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(g.Sheets[g.SheetNames[W]],L),L);case"dbf":return write_binary_type(DBF.from_sheet(g.Sheets[g.SheetNames[W]],L),L);case"prn":return write_string_type(PRN.from_sheet(g.Sheets[g.SheetNames[W]],L),L);case"rtf":return write_string_type(RTF.from_sheet(g.Sheets[g.SheetNames[W]],L),L);case"eth":return write_string_type(ETH.from_sheet(g.Sheets[g.SheetNames[W]],L),L);case"fods":return write_string_type(write_ods(g,L),L);case"wk1":return write_binary_type(WK_.sheet_to_wk1(g.Sheets[g.SheetNames[W]],L),L);case"wk3":return write_binary_type(WK_.book_to_wk3(g,L),L);case"biff2":L.biff||(L.biff=2);case"biff3":L.biff||(L.biff=3);case"biff4":return L.biff||(L.biff=4),write_binary_type(write_biff_buf(g,L),L);case"biff5":L.biff||(L.biff=5);case"biff8":case"xla":case"xls":return L.biff||(L.biff=8),write_cfb_type(g,L);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(g,L);default:throw new Error("Unrecognized bookType |"+L.bookType+"|")}}function resolve_book_type(g){if(!g.bookType){var A={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},L=g.file.slice(g.file.lastIndexOf(".")).toLowerCase();L.match(/^\.[a-z]+$/)&&(g.bookType=L.slice(1)),g.bookType=A[g.bookType]||g.bookType}}function writeFileSync(g,A,L){var B=L||{};return B.type="file",B.file=A,resolve_book_type(B),writeSync(g,B)}function make_json_row(g,A,L,B,W,q,J,re){var ae=encode_row(L),se=re.defval,ie=re.raw||!Object.prototype.hasOwnProperty.call(re,"raw"),le=!0,pe=W===1?[]:{};if(W!==1)if(Object.defineProperty)try{Object.defineProperty(pe,"__rowNum__",{value:L,enumerable:!1})}catch{pe.__rowNum__=L}else pe.__rowNum__=L;if(!J||g[L])for(var he=A.s.c;he<=A.e.c;++he){var ue=J?g[L][he]:g[B[he]+ae];if(ue===void 0||ue.t===void 0){if(se===void 0)continue;q[he]!=null&&(pe[q[he]]=se);continue}var ce=ue.v;switch(ue.t){case"z":if(ce==null)break;continue;case"e":ce=ce==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+ue.t)}if(q[he]!=null){if(ce==null)if(ue.t=="e"&&ce===null)pe[q[he]]=null;else if(se!==void 0)pe[q[he]]=se;else if(ie&&ce===null)pe[q[he]]=null;else continue;else pe[q[he]]=ie&&(ue.t!=="n"||ue.t==="n"&&re.rawNumbers!==!1)?ce:format_cell(ue,ce,re);ce!=null&&(le=!1)}}return{row:pe,isempty:le}}function sheet_to_json(g,A){if(g==null||g["!ref"]==null)return[];var L={t:"n",v:0},B=0,W=1,q=[],J=0,re="",ae={s:{r:0,c:0},e:{r:0,c:0}},se=A||{},ie=se.range!=null?se.range:g["!ref"];switch(se.header===1?B=1:se.header==="A"?B=2:Array.isArray(se.header)?B=3:se.header==null&&(B=0),typeof ie){case"string":ae=safe_decode_range(ie);break;case"number":ae=safe_decode_range(g["!ref"]),ae.s.r=ie;break;default:ae=ie}B>0&&(W=0);var le=encode_row(ae.s.r),pe=[],he=[],ue=0,ce=0,fe=Array.isArray(g),me=ae.s.r,ke=0,xe={};fe&&!g[me]&&(g[me]=[]);var Le=se.skipHidden&&g["!cols"]||[],Se=se.skipHidden&&g["!rows"]||[];for(ke=ae.s.c;ke<=ae.e.c;++ke)if(!(Le[ke]||{}).hidden)switch(pe[ke]=encode_col(ke),L=fe?g[me][ke]:g[pe[ke]+le],B){case 1:q[ke]=ke-ae.s.c;break;case 2:q[ke]=pe[ke];break;case 3:q[ke]=se.header[ke-ae.s.c];break;default:if(L==null&&(L={w:"__EMPTY",t:"s"}),re=J=format_cell(L,null,se),ce=xe[J]||0,!ce)xe[J]=1;else{do re=J+"_"+ce++;while(xe[re]);xe[J]=ce,xe[re]=1}q[ke]=re}for(me=ae.s.r+W;me<=ae.e.r;++me)if(!(Se[me]||{}).hidden){var Te=make_json_row(g,ae,me,pe,B,q,fe,se);(Te.isempty===!1||(B===1?se.blankrows!==!1:se.blankrows))&&(he[ue++]=Te.row)}return he.length=ue,he}var qreg=/"/g;function make_csv_row(g,A,L,B,W,q,J,re){for(var ae=!0,se=[],ie="",le=encode_row(L),pe=A.s.c;pe<=A.e.c;++pe)if(B[pe]){var he=re.dense?(g[L]||[])[pe]:g[B[pe]+le];if(he==null)ie="";else if(he.v!=null){ae=!1,ie=""+(re.rawNumbers&&he.t=="n"?he.v:format_cell(he,null,re));for(var ue=0,ce=0;ue!==ie.length;++ue)if((ce=ie.charCodeAt(ue))===W||ce===q||ce===34||re.forceQuotes){ie='"'+ie.replace(qreg,'""')+'"';break}ie=="ID"&&(ie='"ID"')}else he.f!=null&&!he.F?(ae=!1,ie="="+he.f,ie.indexOf(",")>=0&&(ie='"'+ie.replace(qreg,'""')+'"')):ie="";se.push(ie)}return re.blankrows===!1&&ae?null:se.join(J)}function sheet_to_csv(g,A){var L=[],B=A??{};if(g==null||g["!ref"]==null)return"";var W=safe_decode_range(g["!ref"]),q=B.FS!==void 0?B.FS:",",J=q.charCodeAt(0),re=B.RS!==void 0?B.RS:`
`,ae=re.charCodeAt(0),se=new RegExp((q=="|"?"\\|":q)+"+$"),ie="",le=[];B.dense=Array.isArray(g);for(var pe=B.skipHidden&&g["!cols"]||[],he=B.skipHidden&&g["!rows"]||[],ue=W.s.c;ue<=W.e.c;++ue)(pe[ue]||{}).hidden||(le[ue]=encode_col(ue));for(var ce=0,fe=W.s.r;fe<=W.e.r;++fe)(he[fe]||{}).hidden||(ie=make_csv_row(g,W,fe,le,J,ae,q,B),ie!=null&&(B.strip&&(ie=ie.replace(se,"")),(ie||B.blankrows!==!1)&&L.push((ce++?re:"")+ie)));return delete B.dense,L.join("")}function sheet_to_txt(g,A){A||(A={}),A.FS="	",A.RS=`
`;var L=sheet_to_csv(g,A);return L}function sheet_to_formulae(g){var A="",L,B="";if(g==null||g["!ref"]==null)return[];var W=safe_decode_range(g["!ref"]),q="",J=[],re,ae=[],se=Array.isArray(g);for(re=W.s.c;re<=W.e.c;++re)J[re]=encode_col(re);for(var ie=W.s.r;ie<=W.e.r;++ie)for(q=encode_row(ie),re=W.s.c;re<=W.e.c;++re)if(A=J[re]+q,L=se?(g[ie]||[])[re]:g[A],B="",L!==void 0){if(L.F!=null){if(A=L.F,!L.f)continue;B=L.f,A.indexOf(":")==-1&&(A=A+":"+A)}if(L.f!=null)B=L.f;else{if(L.t=="z")continue;if(L.t=="n"&&L.v!=null)B=""+L.v;else if(L.t=="b")B=L.v?"TRUE":"FALSE";else if(L.w!==void 0)B="'"+L.w;else{if(L.v===void 0)continue;L.t=="s"?B="'"+L.v:B=""+L.v}}ae[ae.length]=A+"="+B}return ae}function sheet_add_json(g,A,L){var B=L||{},W=+!B.skipHeader,q=g||{},J=0,re=0;if(q&&B.origin!=null)if(typeof B.origin=="number")J=B.origin;else{var ae=typeof B.origin=="string"?decode_cell(B.origin):B.origin;J=ae.r,re=ae.c}var se,ie={s:{c:0,r:0},e:{c:re,r:J+A.length-1+W}};if(q["!ref"]){var le=safe_decode_range(q["!ref"]);ie.e.c=Math.max(ie.e.c,le.e.c),ie.e.r=Math.max(ie.e.r,le.e.r),J==-1&&(J=le.e.r+1,ie.e.r=J+A.length-1+W)}else J==-1&&(J=0,ie.e.r=A.length-1+W);var pe=B.header||[],he=0;A.forEach(function(ce,fe){keys(ce).forEach(function(me){(he=pe.indexOf(me))==-1&&(pe[he=pe.length]=me);var ke=ce[me],xe="z",Le="",Se=encode_cell({c:re+he,r:J+fe+W});se=ws_get_cell_stub(q,Se),ke&&typeof ke=="object"&&!(ke instanceof Date)?q[Se]=ke:(typeof ke=="number"?xe="n":typeof ke=="boolean"?xe="b":typeof ke=="string"?xe="s":ke instanceof Date?(xe="d",B.cellDates||(xe="n",ke=datenum(ke)),Le=B.dateNF||table_fmt[14]):ke===null&&B.nullError&&(xe="e",ke=0),se?(se.t=xe,se.v=ke,delete se.w,delete se.R,Le&&(se.z=Le)):q[Se]=se={t:xe,v:ke},Le&&(se.z=Le))})}),ie.e.c=Math.max(ie.e.c,re+pe.length-1);var ue=encode_row(J);if(W)for(he=0;he<pe.length;++he)q[encode_col(he+re)+ue]={t:"s",v:pe[he]};return q["!ref"]=encode_range(ie),q}function json_to_sheet(g,A){return sheet_add_json(null,g,A)}function ws_get_cell_stub(g,A,L){if(typeof A=="string"){if(Array.isArray(g)){var B=decode_cell(A);return g[B.r]||(g[B.r]=[]),g[B.r][B.c]||(g[B.r][B.c]={t:"z"})}return g[A]||(g[A]={t:"z"})}return typeof A!="number"?ws_get_cell_stub(g,encode_cell(A)):ws_get_cell_stub(g,encode_cell({r:A,c:L||0}))}function wb_sheet_idx(g,A){if(typeof A=="number"){if(A>=0&&g.SheetNames.length>A)return A;throw new Error("Cannot find sheet # "+A)}else if(typeof A=="string"){var L=g.SheetNames.indexOf(A);if(L>-1)return L;throw new Error("Cannot find sheet name |"+A+"|")}else throw new Error("Cannot find sheet |"+A+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(g,A,L,B){var W=1;if(!L)for(;W<=65535&&g.SheetNames.indexOf(L="Sheet"+W)!=-1;++W,L=void 0);if(!L||g.SheetNames.length>=65535)throw new Error("Too many worksheets");if(B&&g.SheetNames.indexOf(L)>=0){var q=L.match(/(^.*?)(\d+)$/);W=q&&+q[2]||0;var J=q&&q[1]||L;for(++W;W<=65535&&g.SheetNames.indexOf(L=J+W)!=-1;++W);}if(check_ws_name(L),g.SheetNames.indexOf(L)>=0)throw new Error("Worksheet with name |"+L+"| already exists!");return g.SheetNames.push(L),g.Sheets[L]=A,L}function book_set_sheet_visibility(g,A,L){g.Workbook||(g.Workbook={}),g.Workbook.Sheets||(g.Workbook.Sheets=[]);var B=wb_sheet_idx(g,A);switch(g.Workbook.Sheets[B]||(g.Workbook.Sheets[B]={}),L){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+L)}g.Workbook.Sheets[B].Hidden=L}function cell_set_number_format(g,A){return g.z=A,g}function cell_set_hyperlink(g,A,L){return A?(g.l={Target:A},L&&(g.l.Tooltip=L)):delete g.l,g}function cell_set_internal_link(g,A,L){return cell_set_hyperlink(g,"#"+A,L)}function cell_add_comment(g,A,L){g.c||(g.c=[]),g.c.push({t:A,a:L||"SheetJS"})}function sheet_set_array_formula(g,A,L,B){for(var W=typeof A!="string"?A:safe_decode_range(A),q=typeof A=="string"?A:encode_range(A),J=W.s.r;J<=W.e.r;++J)for(var re=W.s.c;re<=W.e.c;++re){var ae=ws_get_cell_stub(g,J,re);ae.t="n",ae.F=q,delete ae.v,J==W.s.r&&re==W.s.c&&(ae.f=L,B&&(ae.D=!0))}return g}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function IncluirEstudantes({alunosExistentes:g=[],onInclude:A}){const L=reactExports.useRef(),[B,W]=reactExports.useState(null),q=async re=>{const ae=re.target.files[0];if(ae){W({status:"processando"});try{const se=ae.name.split(".").pop().toLowerCase();let ie=[];const le=ae.name.replace(/\.(pdf|xlsx|xls)$/i,"");let pe=!1;if(se==="pdf"){const fe=await ae.arrayBuffer(),me=await pdfExports.getDocument({data:new Uint8Array(fe)}).promise;let ke="";for(let nt=1;nt<=me.numPages;nt++){const Ae=await me.getPage(nt);ke+=(await Ae.getTextContent()).items.map(De=>De.str).join(" ")+`
`}const xe=ke.match(/-\s*(Matutino|Vespertino|Noturno)/i),Le=xe?xe[1]:"",Se=/(\d+)\s+([A-ZÀ-Ú][A-ZÀ-Ú\s]+?)\s+(\d{2}\/\d{2}\/\d{4})\s*\/\s*\d+\s*anos\s*([FM])/gi;let Te;for(;(Te=Se.exec(ke))!==null;)ie.push({codigo:Te[1].trim(),nome:Te[2].trim(),nascimento:Te[3],sexo:Te[4],turma:le,turno:Le,inativo:!1});if(!ie.length)throw new Error("Nenhum aluno encontrado no PDF.");const ge=utils.json_to_sheet(ie,{origin:"A2",skipHeader:!0}),Ce=["código","nome","nascimento","sexo","turma","turno"];utils.sheet_add_aoa(ge,[Ce],{origin:"A1"});const be=utils.book_new();utils.book_append_sheet(be,ge,"Alunos"),writeFileSync(be,ae.name.replace(/\.pdf$/i,".xlsx"),{bookType:"xlsx",cellStyles:!0}),pe=!0}else{const fe=await ae.arrayBuffer(),me=readSync(new Uint8Array(fe),{type:"array"}),ke=me.Sheets[me.SheetNames[0]];if(ie=utils.sheet_to_json(ke,{defval:""}).map(xe=>({codigo:String(xe.Código||xe.código||"").trim(),nome:String(xe.Estudante||xe.nome||"").trim(),nascimento:String(xe["Data Nascimento"]||xe.nascimento||"").trim(),sexo:String(xe.Sexo||xe.sexo||"").trim(),turma:le,turno:String(xe.Turno||xe.turno||"").trim(),inativo:!1})),!ie.length)throw new Error("Nenhum registro encontrado no XLSX.")}const he=new Set(ie.map(fe=>fe.codigo)),ue=g.filter(fe=>fe.turma===le&&!he.has(fe.codigo)).map(fe=>({codigo:fe.codigo,inativo:!0})),ce=[...ie,...ue];A(ce),W({status:"sucesso",localizados:ie.length,inseridos:ie.filter(fe=>!g.some(me=>me.codigo===fe.codigo)).length,duplicados:ie.filter(fe=>g.some(me=>me.codigo===fe.codigo)).length,inativados:ue.length,baixado:pe})}catch(se){W({status:"erro",message:se.message})}finally{L.current&&(L.current.value="")}}},J=()=>W(null);return React.createElement("div",{className:"mb-6"},React.createElement("input",{type:"file",accept:".pdf,.xls,.xlsx",ref:L,onChange:q,style:{display:"none"}}),React.createElement("button",{onClick:()=>L.current&&L.current.click(),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"},"🗂️ Incluir Estudantes"),B&&React.createElement("div",{className:"mt-2 block p-3 bg-white border border-gray-200 rounded shadow-lg relative max-w-xs"},React.createElement("button",{onClick:J,className:"absolute top-1 right-1 text-gray-500 hover:text-gray-700"},"×"),B.status==="processando"&&React.createElement("p",{className:"text-gray-600"},"Processando importação…"),B.status==="sucesso"&&React.createElement(React.Fragment,null,React.createElement("p",{className:"text-gray-800"},"📄 Localizados: ",B.localizados),React.createElement("p",{className:"text-green-600"},"✅ Inseridos: ",B.inseridos),React.createElement("p",{className:"text-yellow-600"},"⚠️ Já existiam: ",B.duplicados),React.createElement("p",{className:"text-red-600"},"❌ Inativados: ",B.inativados),B.baixado&&React.createElement("p",{className:"text-gray-600"},"(arquivo XLSX baixado)")),B.status==="erro"&&React.createElement("p",{className:"text-red-600"},"❌ Erro: ",B.message)))}function Alunos(){const g=useNavigate(),[A,L]=reactExports.useState([{codigo:"1001",nome:"Ana Souza",nascimento:"01/01/2010",sexo:"F",turma:"6º ANO A",turno:"Matutino",inativo:!1}]),[B,W]=reactExports.useState(!1),[q,J]=reactExports.useState(!1),[re,ae]=reactExports.useState(null),[se,ie]=reactExports.useState(""),le=xe=>{L(Le=>{let Se=[...Le];return xe.forEach(Te=>{Se.some(Ce=>Ce.codigo===Te.codigo)?Se=Se.map(Ce=>Ce.codigo===Te.codigo?{...Ce,inativo:!0}:Ce):Se.push(Te)}),Se})},pe=xe=>{L(Le=>[...Le,xe]),W(!1)},he=xe=>{L(Le=>Le.map(Se=>Se.codigo===xe.codigo?xe:Se)),W(!1)},ue=()=>{ae(null),J(!1),W(!0)},ce=xe=>{ae(xe),J(!0),W(!0)},fe=xe=>{window.confirm(`Deseja realmente inativar o aluno ${xe}?`)&&L(Le=>Le.map(Se=>Se.codigo===xe?{...Se,inativo:!0}:Se))},me=se.toLowerCase(),ke=A.filter(xe=>{var Ce,be,nt,Ae;const Le=((Ce=xe.codigo)==null?void 0:Ce.toString().toLowerCase())||"",Se=((be=xe.nome)==null?void 0:be.toLowerCase())||"",Te=((nt=xe.turma)==null?void 0:nt.toLowerCase())||"",ge=((Ae=xe.turno)==null?void 0:Ae.toLowerCase())||"";return Le.startsWith(me)||Se.includes(me)||Te.includes(me)||ge.includes(me)});return React.createElement("div",{className:"p-6 bg-blue-50 min-h-screen"},React.createElement("h1",{className:"text-3xl font-bold text-blue-900 mb-4"},"🎓 Gestão de Alunos"),React.createElement("form",{className:"flex justify-between items-center mb-6",onSubmit:xe=>xe.preventDefault()},React.createElement("button",{type:"button",onClick:ue,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},"➕ Adicionar Estudante"),React.createElement("input",{type:"text",placeholder:"🔍 Buscar aluno",className:"border p-2 rounded w-1/3",value:se,onChange:xe=>ie(xe.target.value),onKeyDown:xe=>xe.key==="Enter"&&xe.preventDefault()})),React.createElement(IncluirEstudantes,{alunosExistentes:A,onInclude:le}),React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"w-full border-collapse mt-4"},React.createElement("thead",{className:"bg-blue-100"},React.createElement("tr",null,React.createElement("th",{className:"p-2 border"},"Código"),React.createElement("th",{className:"p-2 border"},"Estudante"),React.createElement("th",{className:"p-2 border"},"Data de Nasc."),React.createElement("th",{className:"p-2 border"},"Sexo"),React.createElement("th",{className:"p-2 border"},"Turma"),React.createElement("th",{className:"p-2 border"},"Turno"),React.createElement("th",{className:"p-2 border"},"Ações"))),React.createElement("tbody",null,ke.length>0?ke.map((xe,Le)=>React.createElement("tr",{key:Le,className:xe.inativo?"bg-gray-200":"hover:bg-blue-50"},React.createElement("td",{className:"p-2 border"},xe.codigo),React.createElement("td",{className:"p-2 border"},xe.nome),React.createElement("td",{className:"p-2 border"},xe.nascimento),React.createElement("td",{className:"p-2 border"},xe.sexo),React.createElement("td",{className:"p-2 border"},xe.turma),React.createElement("td",{className:"p-2 border"},xe.turno),React.createElement("td",{className:"p-2 border flex gap-3 justify-center"},xe.inativo?React.createElement("button",{className:"text-red-600 hover:text-red-800",title:"Reativar estudante",onClick:()=>L(Se=>Se.map(Te=>Te.codigo===xe.codigo?{...Te,inativo:!1}:Te))},"❌"):React.createElement("button",{onClick:()=>fe(xe.codigo),className:"text-red-600 hover:text-red-800",title:"Inativar estudante"},React.createElement(Trash2,{size:18})),React.createElement("button",{onClick:()=>ce(xe),className:"text-green-600 hover:text-green-800",title:"Editar estudante"},React.createElement(Pencil,{size:18})),React.createElement("button",{onClick:()=>alert(`Ficha de ${xe.nome}`),className:"text-blue-600 hover:text-blue-800",title:"Ficha do estudante"},React.createElement(FileText,{size:18})),React.createElement("button",{onClick:()=>g(`/boletim?aluno=${xe.codigo}`),className:"text-gray-600 hover:text-gray-800",title:"Abrir boletim"},React.createElement(BookOpen,{size:18}))))):React.createElement("tr",null,React.createElement("td",{colSpan:7,className:"text-center p-4 text-gray-500"},"Nenhum aluno encontrado."))))),B&&React.createElement(ModalAdicionarAluno,{onSave:q?he:pe,onClose:()=>W(!1),alunoParaEditar:re}))}function Professores(){const[g,A]=reactExports.useState([{cpf:"123.456.789-00",nome:"Ana Beatriz",disciplina:"Matemática"},{cpf:"987.654.321-00",nome:"Bruno Silva",disciplina:"História"},{cpf:"111.222.333-44",nome:"Carlos Eduardo",disciplina:"Português"},{cpf:"555.666.777-88",nome:"Daniela Rocha",disciplina:"Biologia"},{cpf:"999.888.777-66",nome:"Eduardo Lima",disciplina:"Física"},{cpf:"123.987.654-32",nome:"Fernanda Costa",disciplina:"Química"},{cpf:"111.555.999-00",nome:"Gustavo Nunes",disciplina:"Geografia"},{cpf:"333.666.999-11",nome:"Helena Dias",disciplina:"Educação Física"},{cpf:"444.555.666-77",nome:"Igor Pereira",disciplina:"Inglês"},{cpf:"222.333.444-55",nome:"Juliana Ramos",disciplina:"Artes"}]);return React.createElement("div",{className:"p-6 bg-blue-50 min-h-screen space-y-6"},React.createElement("h1",{className:"text-3xl font-bold text-blue-900 mb-4"},"👩‍🏫 Gestão de Professores"),React.createElement("div",{className:"overflow-x-auto bg-white rounded shadow p-4"},React.createElement("table",{className:"w-full table-auto"},React.createElement("thead",{className:"bg-blue-100"},React.createElement("tr",null,React.createElement("th",{className:"p-3 border"},"CPF"),React.createElement("th",{className:"p-3 border"},"Nome"),React.createElement("th",{className:"p-3 border"},"Disciplina"),React.createElement("th",{className:"p-3 border"},"Ações"))),React.createElement("tbody",null,g.map((L,B)=>React.createElement("tr",{key:B,className:"hover:bg-blue-50"},React.createElement("td",{className:"p-3 border"},L.cpf),React.createElement("td",{className:"p-3 border"},L.nome),React.createElement("td",{className:"p-3 border"},L.disciplina),React.createElement("td",{className:"p-3 border flex gap-2 justify-center"},React.createElement("button",{className:"text-green-600 hover:text-green-800",title:"Editar"},React.createElement(Pencil,{size:18})),React.createElement("button",{className:"text-red-600 hover:text-red-800",title:"Excluir"},React.createElement(Trash2,{size:18})))))))))}function Boletim(){const g={codigo:"202020",nome:"Joazinho da Silva",serie:"3º CICLO - BLOCO 2",turno:"MATUTINO",turma:"2A"},A=[2024,2025],L=["1º BIM.","2º BIM.","3º BIM.","4º BIM."],B=["Arte","Ciências Naturais","Educação Física","Geografia","Geometria","História","Língua Inglesa","Língua Portuguesa","Matemática","Prática Estudantil"],[W]=reactExports.useState(()=>{const J={},re=[5,6,7.5,8];return A.forEach(ae=>{J[ae]={},B.forEach(se=>{J[ae][se]={},L.forEach((ie,le)=>{const pe=`b${le+1}`;J[ae][se][pe]={nota:re[le].toFixed(2),faltas:"22"}})})}),J}),q=(J,re)=>{const ae=L.map((ie,le)=>parseFloat(W[J][re][`b${le+1}`].nota)||0);return(ae.reduce((ie,le)=>ie+le,0)/ae.length).toFixed(2)};return React.createElement("div",{className:"p-2 bg-blue-50"},React.createElement("div",{className:"bg-white rounded shadow p-2 mb-2 flex justify-between items-center"},React.createElement("img",{src:"/LOGO_CEF04.png",alt:"Logo CEF04",className:"h-16"}),React.createElement("div",{className:"text-center space-y-0.5 text-xs uppercase"},React.createElement("p",null,"GOVERNO DO DISTRITO FEDERAL"),React.createElement("p",null,"SECRETARIA DE ESTADO DE EDUCAÇÃO"),React.createElement("p",null,"CRE - PLANALTINA"),React.createElement("p",null,"CENTRO DE ENSINO FUNDAMENTAL 04 - COLÉGIO CÍVICO MILITAR"),React.createElement("p",null,"INEP 53006160")),React.createElement("img",{src:"/LOGO_CCMDF.jpg",alt:"Logo CCMDF",className:"h-16"})),React.createElement("div",{className:"bg-gray-200 rounded shadow p-2 mb-2"},React.createElement("div",{className:"grid grid-cols-3 gap-4 text-sm"},React.createElement("div",null,React.createElement("span",{className:"font-semibold uppercase"},"Código:")," ",g.codigo),React.createElement("div",null,React.createElement("span",{className:"font-semibold uppercase"},"Estudante:")," ",g.nome),React.createElement("div",null,React.createElement("span",{className:"font-semibold uppercase"},"Série:")," ",g.serie),React.createElement("div",null,React.createElement("span",{className:"font-semibold uppercase"},"Turno:")," ",g.turno),React.createElement("div",null,React.createElement("span",{className:"font-semibold uppercase"},"Turma:")," ",g.turma))),React.createElement("div",{className:"overflow-x-auto bg-white rounded shadow p-2"},React.createElement("table",{className:"min-w-full table-auto border-collapse text-xs"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{rowSpan:"3",className:"border p-1"},"Componentes Curriculares"),A.map((J,re)=>React.createElement("th",{key:J,colSpan:L.length*2+1,className:`${re===0?"bg-orange-200":"bg-green-200"} border p-1 text-center`},J)),React.createElement("th",{colSpan:"2",rowSpan:"2",className:"bg-orange-200 border p-1 text-center"},"Resultado Final"),React.createElement("th",{rowSpan:"3",className:"bg-blue-400 border p-1 text-center"},"Situação Final")),React.createElement("tr",null,A.map((J,re)=>React.createElement(React.Fragment,{key:re},L.map((ae,se)=>React.createElement("th",{key:se,colSpan:"2",className:"bg-yellow-200 border p-1 text-center"},ae)),React.createElement("th",{rowSpan:"2",className:"bg-gray-100 border p-1 text-center"},"Média")))),React.createElement("tr",null,A.map((J,re)=>React.createElement(React.Fragment,{key:re},L.map((ae,se)=>React.createElement(React.Fragment,{key:se},React.createElement("th",{className:"border p-0.5 text-center",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"}},"Notas"),React.createElement("th",{className:"border p-0.5 text-center",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"}},"Faltas"))))),React.createElement("th",{className:"bg-orange-200 border p-0.5 text-center",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"}},"Notas"),React.createElement("th",{className:"bg-orange-200 border p-0.5 text-center",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"}},"Faltas"))),React.createElement("tbody",null,B.map((J,re)=>React.createElement("tr",{key:re,className:"hover:bg-blue-50"},React.createElement("td",{className:"border p-1"},J),A.map(ae=>React.createElement(React.Fragment,{key:ae},L.map((se,ie)=>React.createElement(React.Fragment,{key:ie},React.createElement("td",{className:"border p-0.5 text-center"},W[ae][J][`b${ie+1}`].nota),React.createElement("td",{className:"border p-0.5 text-center"},W[ae][J][`b${ie+1}`].faltas))),React.createElement("td",{className:"bg-gray-100 border p-0.5 text-center"},q(ae,J)))),React.createElement("td",{className:"bg-orange-200 border p-0.5 text-center"},q(2025,J)),React.createElement("td",{className:"bg-orange-200 border p-0.5 text-center"},"22"),React.createElement("td",{className:"bg-yellow-200 border p-0.5 text-center"},"APROVADO")))))),React.createElement("div",{className:"bg-yellow-100 rounded shadow p-2 mt-2 flex justify-between items-center"},React.createElement("div",{className:"text-xs"},React.createElement("div",null,React.createElement("strong",null,"Soma das notas:")," 400,00"),React.createElement("div",null,React.createElement("strong",null,"Seu ranking:")," 25/562"),React.createElement("div",null,React.createElement("strong",null,"Observações:")," Atenção!! sua média está igual ou melhor que ano passado!!")),React.createElement("button",{onClick:()=>window.print(),className:"px-4 py-2 border uppercase text-xs font-semibold"},"Imprimir")))}function PraticaEstudantil(){const[g,A]=reactExports.useState(""),[L,B]=reactExports.useState(""),[W,q]=reactExports.useState(""),[J,re]=reactExports.useState(""),[ae,se]=reactExports.useState([]),[ie,le]=reactExports.useState([]),[pe,he]=reactExports.useState({}),[ue,ce]=reactExports.useState(""),[fe,me]=reactExports.useState(null),ke=["1A","1B","2A","2B"],xe=["Matemática","Português","Ciências","História"];reactExports.useEffect(()=>{if(!g){se([]);return}se([{codigo:"1001",nome:"Ana Souza",turma:g},{codigo:"1002",nome:"Bruno Lima",turma:g},{codigo:"1003",nome:"Carla Mendes",turma:g}]),he({})},[g]);const Le=ie.reduce((Ae,De)=>Ae+De.pontos,0),Se=parseFloat(Le.toFixed(1)),Te=()=>{const Ae=W.trim().slice(0,15),De=Number(J);!Ae||!De||(fe!==null?Le-ie[fe].pontos+De:Le+De)>5||ie.length>=15&&fe===null||(fe!==null?(le(Ct=>Ct.map((ft,Et)=>Et===fe?{nome:Ae,pontos:De}:ft)),me(null),ce("")):le(Ct=>[...Ct,{nome:Ae,pontos:De}]),q(""),re(""))},ge=()=>{const Ae=Number(ue);if(isNaN(Ae))return;const De=ie[Ae];q(De.nome),re(De.pontos),me(Ae)},Ce=(Ae,De,lt)=>{he(Ct=>{const ft={...Ct[Ae]||{}};return ft[De]=lt===""?"":Number(lt),{...Ct,[Ae]:ft}})},be=()=>{if(!g||!L||!W.trim()||!J)return!0;const Ae=Number(J);return(fe!==null?Le-ie[fe].pontos+Ae:Le+Ae)>5||ie.length>=15&&fe===null},nt={transform:"rotate(-90deg)",transformOrigin:"center center",whiteSpace:"nowrap"};return React.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},React.createElement("h1",{className:"text-2xl font-bold mb-6"},"Prática Estudantil"),React.createElement("div",{className:"grid grid-cols-2 gap-6 bg-white p-6 rounded-lg shadow mb-8"},React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Turma"),React.createElement("select",{className:"w-full border rounded px-3 py-2 disabled:opacity-50",value:g,onChange:Ae=>A(Ae.target.value),disabled:fe!==null},React.createElement("option",{value:""},"Selecione a turma"),ke.map(Ae=>React.createElement("option",{key:Ae},Ae)))),React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Disciplina"),React.createElement("select",{className:"w-full border rounded px-3 py-2 disabled:opacity-50",value:L,onChange:Ae=>B(Ae.target.value),disabled:fe!==null},React.createElement("option",{value:""},"Selecione a disciplina"),xe.map(Ae=>React.createElement("option",{key:Ae},Ae)))),React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Nome da atividade"),React.createElement("input",{type:"text",maxLength:15,className:"w-full border rounded px-3 py-2",placeholder:"Até 15 caracteres",value:W,onChange:Ae=>q(Ae.target.value)})),React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Pontos (0–5)"),React.createElement("input",{type:"number",min:0,max:5,className:"w-full border rounded px-3 py-2",value:J,onChange:Ae=>re(Ae.target.value)})),React.createElement("div",{className:"col-span-2 flex items-center space-x-2"},React.createElement("button",{onClick:Te,disabled:be(),className:"flex items-center bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50"},React.createElement(Plus,{className:"mr-2"}),fe!==null?"Atualizar":"Salvar"),React.createElement("select",{value:ue,onChange:Ae=>ce(Ae.target.value),className:"border rounded px-3 py-2"},React.createElement("option",{value:""},"Editar atividade..."),ie.map((Ae,De)=>React.createElement("option",{key:De,value:De},Ae.nome," (",Ae.pontos,")"))),React.createElement("button",{onClick:ge,disabled:!ue,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50"},React.createElement(Pen,{className:"mr-2"}),"Editar"),React.createElement("span",{className:"text-sm text-gray-500 ml-auto"},ie.length," / 15 colunas — Soma: ",Se," / 5"))),React.createElement("div",{className:"overflow-x-auto bg-white rounded-lg shadow"},React.createElement("table",{className:"w-full table-fixed border-collapse"},React.createElement("colgroup",null,React.createElement("col",{className:"w-24"}),React.createElement("col",{className:"w-48"}),React.createElement("col",{className:"w-24"}),ie.map((Ae,De)=>React.createElement("col",{key:De,className:"w-auto"})),React.createElement("col",{className:"w-24"})),React.createElement("thead",{className:"bg-gray-100"},React.createElement("tr",{style:{height:"7.5rem"}},React.createElement("th",{className:"p-2 border"},"Código"),React.createElement("th",{className:"p-2 border"},"Estudante"),React.createElement("th",{className:"p-2 border text-center"},React.createElement("div",{style:nt},"Turma")),ie.map((Ae,De)=>React.createElement("th",{key:De,className:"p-2 border text-center"},React.createElement("div",{style:nt},Ae.nome))),React.createElement("th",{className:"p-2 border text-center"},"Total (0–5)"))),React.createElement("tbody",null,ae.length===0?React.createElement("tr",null,React.createElement("td",{colSpan:3+ie.length+1,className:"p-4 text-center text-gray-500 italic"},"Selecione uma turma.")):ae.map(Ae=>{const De=pe[Ae.codigo]||{},lt=ie.reduce((Ct,ft,Et)=>Ct+Number(De[Et]||0),0);return React.createElement("tr",{key:Ae.codigo,className:"hover:bg-gray-50"},React.createElement("td",{className:"p-2 border"},Ae.codigo),React.createElement("td",{className:"p-2 border"},Ae.nome),React.createElement("td",{className:"p-2 border text-center"},Ae.turma),ie.map((Ct,ft)=>React.createElement("td",{key:ft,className:"p-2 border text-center"},React.createElement("input",{type:"number",max:ie[ft].pontos,value:De[ft]??"",onChange:Et=>Ce(Ae.codigo,ft,Et.target.value),className:"w-full border rounded px-1 py-0.5 text-center no-spinner"}))),React.createElement("td",{className:"p-2 border text-center font-semibold"},parseFloat(lt.toFixed(1))))})))))}function PlanoBimestral(){const[g,A]=reactExports.useState(""),[L,B]=reactExports.useState("Prova"),[W,q]=reactExports.useState(""),[J,re]=reactExports.useState(""),[ae,se]=reactExports.useState(""),[ie,le]=reactExports.useState(""),[pe,he]=reactExports.useState({}),[ue,ce]=reactExports.useState([]),[fe,me]=reactExports.useState(""),[ke,xe]=reactExports.useState(null),[Le,Se]=reactExports.useState([]),Te=reactExports.useRef(""),ge=["6º ANO A","6º ANO B","7º ANO A","7º ANO B"],Ce=ue.reduce((ft,Et)=>ft+Et.valor,0),be=ue.filter(ft=>ft.tipo==="Prova").reduce((ft,Et)=>ft+Et.valor,0),nt=10-Ce,Ae=Ce===10,De=Ae&&ke===null;reactExports.useEffect(()=>{const ft=Te.current;ft&&he(Et=>({...Et,[ft]:ue})),ce(g?pe[g]||[]:[]),Te.current=g,xe(null),me(""),q(""),re(""),se(""),le("")},[g]),reactExports.useEffect(()=>{if(!g){Se([]);return}Se([{codigo:"1001",nome:"Ana Souza",turma:g},{codigo:"1002",nome:"Bruno Lima",turma:g},{codigo:"1003",nome:"Carla Mendes",turma:g}])},[g]);const lt=()=>{const ft=(L==="Prova"?W:ae).trim(),Et=Number(L==="Prova"?J:ie);if(!ft||!Et)return;if(L==="Prova"&&be+Et-(ke!==null&&ue[ke].tipo==="Prova"?ue[ke].valor:0)>5){alert("Não é possível adicionar. Provas totalizariam mais de 5 pontos.");return}if(Ce+Et-(ke!==null?ue[ke].valor:0)>10){alert("Não é possível adicionar. Plano geral ultrapassaria 10 pontos.");return}const gt={tipo:L,nome:ft,valor:Et};ce(bt=>{if(ke!==null){const Ie=[...bt];return Ie[ke]=gt,Ie}return[...bt,gt]}),xe(null),me(""),q(""),re(""),se(""),le("")},Ct=()=>{const ft=Number(fe);if(isNaN(ft))return;const Et=ue[ft];B(Et.tipo),Et.tipo==="Prova"?(q(Et.nome),re(Et.valor),se(""),le("")):(se(Et.nome),le(Et.valor),q(""),re("")),xe(ft)};return React.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},React.createElement("h1",{className:"text-2xl font-bold mb-4"},"Plano Bimestral"),React.createElement("div",{className:"grid grid-cols-2 gap-6 bg-white p-6 rounded-lg shadow mb-6"},React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Turma"),React.createElement("select",{className:"w-full border rounded px-3 py-2",value:g,onChange:ft=>A(ft.target.value)},React.createElement("option",{value:""},"Selecione a turma"),ge.map(ft=>React.createElement("option",{key:ft},ft)))),React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Tipo"),React.createElement("select",{className:"w-full border rounded px-3 py-2",value:L,onChange:ft=>B(ft.target.value),disabled:De},React.createElement("option",{value:"Prova"},"Prova"),React.createElement("option",{value:"Avaliação"},"Avaliação"))),L==="Prova"?React.createElement(React.Fragment,null,React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Nome da prova"),React.createElement("input",{type:"text",maxLength:15,className:"w-full border rounded px-3 py-2",value:W,onChange:ft=>q(ft.target.value),disabled:De})),React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Valor da prova"),React.createElement("input",{type:"number",min:0,className:"w-full border rounded px-3 py-2",value:J,onChange:ft=>re(ft.target.value),disabled:De})),React.createElement("div",{className:"col-span-2 text-sm text-gray-600"},"Soma Provas: ",be," / 5")):React.createElement(React.Fragment,null,React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Nome da avaliação"),React.createElement("input",{type:"text",maxLength:15,className:"w-full border rounded px-3 py-2",value:ae,onChange:ft=>se(ft.target.value),disabled:De})),React.createElement("div",null,React.createElement("label",{className:"block mb-1"},"Valor da avaliação"),React.createElement("input",{type:"number",min:0,className:"w-full border rounded px-3 py-2",value:ie,onChange:ft=>le(ft.target.value),disabled:De}))),React.createElement("div",{className:"col-span-2 flex items-center space-x-4"},React.createElement("button",{onClick:lt,disabled:De||(L==="Prova"?!W||!J:!ae||!ie),className:"bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50"},ke!==null?"Editar":"Salvar"),React.createElement("select",{className:"border rounded px-3 py-2",value:fe,onChange:ft=>me(ft.target.value)},React.createElement("option",{value:""},"Editar tópico..."),ue.map((ft,Et)=>React.createElement("option",{key:Et,value:Et},ft.tipo," – ",ft.nome," (",ft.valor,")"))),React.createElement("button",{onClick:Ct,disabled:!fe,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50"},"Editar"),React.createElement("span",{className:"ml-auto text-gray-700"},"Pontos restantes: ",nt," / 10"))),Ae&&React.createElement("div",{className:"mb-4 p-4 bg-green-100 text-green-800 rounded"},"🎉 Plano de avaliação concluído! Você atingiu os 10 pontos permitidos."),React.createElement("div",{className:"overflow-x-auto bg-white rounded-lg shadow"},React.createElement("table",{className:"w-full table-auto border-collapse"},React.createElement("thead",{className:"bg-gray-100"},React.createElement("tr",{style:{height:"8rem"}},React.createElement("th",{className:"p-2 border text-left"},"Código"),React.createElement("th",{className:"p-2 border text-left"},"Estudante"),React.createElement("th",{className:"p-2 border text-left"},"Turma"),ue.map((ft,Et)=>React.createElement("th",{key:Et,className:"p-2 border text-center"},ft.nome,React.createElement("br",null),React.createElement("span",{className:"text-xs text-gray-500"},"(",ft.valor,")"))),React.createElement("th",{className:"p-2 border text-center"},"Total"))),React.createElement("tbody",null,Le.length>0?Le.map(ft=>React.createElement("tr",{key:ft.codigo,className:"hover:bg-gray-50"},React.createElement("td",{className:"p-2 border"},ft.codigo),React.createElement("td",{className:"p-2 border"},ft.nome),React.createElement("td",{className:"p-2 border"},ft.turma),ue.map((Et,gt)=>React.createElement("td",{key:gt,className:"p-2 border"})),React.createElement("td",{className:"p-2 border text-center font-semibold"},Ce,"/10"))):React.createElement("tr",null,React.createElement("td",{colSpan:4+ue.length,className:"p-4 text-center text-gray-500 italic"},"Selecione uma turma."))))))}function App(){return React.createElement(BrowserRouter,null,React.createElement("div",{className:"flex"},React.createElement("aside",{className:"w-48 bg-blue-800 text-white min-h-screen p-6 space-y-4 print:hidden"},React.createElement(Link,{to:"/principal",className:"block hover:bg-blue-700 p-2 rounded"},"Principal"),React.createElement(Link,{to:"/",className:"block hover:bg-blue-700 p-2 rounded"},"Estudantes"),React.createElement(Link,{to:"/professores",className:"block hover:bg-blue-700 p-2 rounded"},"Professores"),React.createElement(Link,{to:"/boletim",className:"block hover:bg-blue-700 p-2 rounded"},"Boletim"),React.createElement(Link,{to:"/pratica",className:"block hover:bg-blue-700 p-2 rounded"},"Prática Estudantil"),React.createElement(Link,{to:"/avaliacao",className:"block hover:bg-blue-700 p-2 rounded"},"Avaliação")),React.createElement("main",{className:"flex-1 p-6 bg-blue-50 min-h-screen"},React.createElement(Routes,null,React.createElement(Route,{path:"/principal",element:React.createElement(TelaInicial,null)}),React.createElement(Route,{path:"/",element:React.createElement(Alunos,null)}),React.createElement(Route,{path:"/professores",element:React.createElement(Professores,null)}),React.createElement(Route,{path:"/boletim",element:React.createElement(Boletim,null)}),React.createElement(Route,{path:"/pratica",element:React.createElement(PraticaEstudantil,null)}),React.createElement(Route,{path:"/avaliacao",element:React.createElement(PlanoBimestral,null)})))))}ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(React.StrictMode,null,React.createElement(App,null)));
